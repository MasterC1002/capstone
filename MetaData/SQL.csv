created_utc,id,title,author,ups,downs,num_comments,selftext,subreddit_id,is_self
1354608410.0,1494mj,"free online DB class from stanford, starts january",mrkurtz,57,1,http://www.reddit.com/r/SQL/comments/1494mj/free_online_db_class_from_stanford_starts_january/,http://a.thumbs.redditmedia.com/XWMrbx_QwjdNq4uN.jpg,
1376572691.0,1kezyc,Offer of *free* SSRS course for reddit readers...hopefully you will find something of use,garyk1968,52,5,16,,t5_2qp8q,False
1371240252.0,1gcy6f,"Cringesome, Funny Blast from [MS SQL]'s Past",xilanthro,45,5,http://www.reddit.com/r/SQL/comments/1gcy6f/cringesome_funny_blast_from_ms_sqls_past/,http://a.thumbs.redditmedia.com/d09rXAvdBRUDRRhf.jpg,
1360760072.0,18fxho,Are there any sites like Codecademy to learn sql?,rbevans,46,6,25,For my current job I utilize SQL and I know some basic SQL usage.  I want to expand on what I know and I enjoy Codecademy's approach.,t5_2qp8q,True
1346960130.0,zgqgv,TIL: The Significance Of The Year 1753 In SQL,iheartreddit2,42,6,2,,t5_2qp8q,False
1373216692.0,1ht563,In defence of SQL,lukaseder,40,7,10,,t5_2qp8q,False
1359642111.0,17mo1d,SQL formatter(s): best thing ever,vectaur,39,5,36,"Saw the ""poorly written"" SQL post and made me think of this.

If you write/tweak a lot of SQL -- especially *other people's* SQL -- consider tracking down a free SQL (re)formatter.  I ""inherited"" a crapton of SQL from others at my job, etc).  The formatter has changed my life.

What it does is pretty simple, it kind of shows you some good recommendations on formatting for readability.

I've been using [this one](http://sourceforge.net/projects/fsqlf/) at work

Hope you guys find this as helpful as I did.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/17mo1d/sql_formatters_best_thing_ever/
1354126302.0,13y0bu,"When commenting out large chunks of data, I've starting using /* followed by --*/",,36,6,http://www.reddit.com/r/SQL/comments/13y0bu/when_commenting_out_large_chunks_of_data_ive/,False,
1375416585.0,1jjlzo,I literally only know how to write queries and get results. Where to go from here?,becausefuckuthatswhy,27,3,26,"So recently got a job with a lot of adhoc reporting. I think I'm doing pretty good as far as writing queries and knowing my company's database

The real issue I have is that I don't know what I don't know. So I guess my question is
&gt;tl;dr Currently writing queries at my job,False,self,t5_2qp8q,False,,,t3_1jjlzo
1316996242.0,kraof,Stanford Open Course - Introduction to Databases,b1tsh1ft,26,2,0,,t5_2qp8q,False
1342007714.0,wdpws,Congratulations on 2000 readers /r/SQL,Quadman,26,7,10,"To celebrate

    WITH two as (SELECT 'foo' as a UNION SELECT 'bar' )
    
    SELECT
    COUNT(*) as [SQL-redditors]
    FROM two as [2] ,two as [16],five as [80],five as [400],five as [omg]",,False,t5_2qp8q,True
1336097744.0,t66gj,"Beck, expressed in SQL code",,25,4,http://www.reddit.com/r/SQL/comments/t66gj/beck_expressed_in_sql_code/,http://d.thumbs.redditmedia.com/YUCw3hqcGZu28OaE.jpg,
1365131084.0,1bpk48,What are some good sites to practice queries?,ITCHY_VAGINA,24,4,13,Title says it all. Thanks everyone.,t5_2qp8q,True
1304340320.0,h27l5,What should I expect in the day to day life in a  SQL job?,notBenstar,19,3,2,"Hello everyone. I am seeking jobs in Sql

*What are some major points I should make sure I have a firm grip on?

*What level of knowledge should I have in order to actually get a job?

I am currently going through the process of studying for OCA/OCP

Any information would be greatly appreciated.

Thanks Reddit.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/h27l5/what_should_i_expect_in_the_day_to_day_life_in_a/
1365943385.0,1cbmqe,7 Handy SQL Features,hernamesbarbara,23,7,1,,t5_2qp8q,False
1363021370.0,1a39y1,My homework this week is on SQL. I have gotten everything right but this problem. I don't understand what I'm doing wrong!,enfinitee,21,3,19,,t5_2qp8q,False
1314380385.0,jvbca,Friday Freebies – 10 FREE ebooks about SQL!,bran0923,18,3,4,,t5_2qp8q,False
1347761193.0,zyc57,What is the best interactive website to learn SQL? Something equivalent to codeacademy.,LOVE_CHOCOLATE_MILK,19,3,7,,t5_2qp8q,True
1364254048.0,1b08iy,"Why use joins (inner, outer, etc)?",hbiz,18,59, today I had my first interview with a company (trying to get hired for an industry placement) and they had three questions for me

It may be because I am used to doing:

    SELECT s.studentid,n.ContactTelNo 
    FROM student s
    WHERE s.studentid = n.studentid and `sex` = 'm' 
    Order By lName

but using joins makes the code seem very difficult to read?

I hear its all to do with load on the server?

I appreciate anyone that can shed some light for me.

EDIT:
to be clear guys, we re still using them.",,False,self,t5_2qp8q,1364315820.0,,
1351622624.0,12cng8,Instant SQL Formatter - I use this SQL formatter all the time for T-SQL and Oracle SQL. /r/SQL: What other web based tools do you find useful?,MeGustaDerp,16,1,21,,t5_2qp8q,False
1320875886.0,m6lpa,The Query of Despair - The Daily WTF,j1mcamp,18,2,10,,t5_2qp8q,False
1368020428.0,1dxiiv,What self learning book is best to learn SQL?,question89,16,2,25,"I want to learn this better. I think i am going to buy Sams learn SQL in 10 minute book. But wanted a second opinion first.

Ive heard its not all that hard to learn the basics of in a short amount of time. True?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1dxiiv/what_self_learning_book_is_best_to_learn_sql/
1348236028.0,108xpy,Visual guide to SQL joins.,Sofa_King_Hard,15,0,3,,t5_2qp8q,False
1339036286.0,up3ug,"What is the ""best"" [MS SQL] certification or class for someone already using SQL?",BinaryMagick,18,2,14,"I am already a working professional using MS SQL every day

I'd say I already know enough so a beginner's SQL book would bore me. Select, update, etc. have been grokked, but the exact reason indexes work to optimize queries is still a little magical to me and following an execution plan makes my eyes glaze over. So, what I'm really looking for is a curriculum in the intermediate range. I'd prefer not to fly through an introductory class just for the pretty certificate to hang on my wall or whatever.

The company is large enough that they will pay for the classes

Any suggestions?

EDIT: clarifying my current knowledge level.",self,t5_2qp8q,1339036489.0,,,True,http://www.reddit.com/r/SQL/comments/up3ug/what_is_the_best_ms_sql_certification_or_class/
1374604937.0,1iwfy6,[Help] I'm new to SQL and trying to make a list of 20 MySQL/DB2/Oracle/SQL Server commands and their differences. I need help checking it!,SupermotoChick,21,8,12,,t5_2qp8q,False
1359590903.0,17lfva,[MS SQL] A poorly written query. But why?,drakefyre,13,0,31,"OK

My first thought is that there are multiple joins on the same data that seem to be poorly defined

-----
    SELECT Customers.CompanyName
	
	
	
    FROM Products INNER JOIN Customers 
 	 INNER JOIN Orders ON Customers.CustomerID = Orders.CustomerID
 	 INNER JOIN [Order Details] ON Orders.OrderID = [Order Details].OrderID 
	 ON [Order Details].ProductID = [Order Details].ProductID
    Where Orders.ShippedDate Between '4/1/2008' And '4/30/2008'
	And products.productname = 'TOFU'
    Order By CompanyName

-----

The question asked is

My answer

I feel like I've missed a glaringly obvious facet of the language. Is this really just about query optimization

---
**EDIT** : Thank you everyone who gave input on this. I've learned more about joins from this thread than I have with my course material. Our whole IT curriculum got messed up when the state switched us to semesters from quarters. The original Intro to Databases that  I took last year did not cover anything at all regarding SQL other than its existence. It was all taught in Access. Since I got credit for the *new* Database I course,False,self,t5_2qp8q,1359616671.0,,,t3_17lfva
1359055938.0,177fr8,Simple Trick to Copy and Paste Web Data into SQL Server,sqltrainingonline,18,5,4,,t5_2qp8q,False
1353424501.0,13if1a,How I Write SQL,gthank,21,8,22,,t5_2qp8q,False
1370529791.0,1fsjcl,"Learn Some SQL: a ""learning by doing"" prototype for SQL",mwilliamson,16,4,3,,t5_2qp8q,False
1366505649.0,1crvak,Best Practice for storing email (gmail) into SQL?,jgagnon_in_FL,14,3,8,"Title almost says it all.  Ideally I'd like to be able to send an email to my SQL Server to either reply by sending me reports or to disable jobs etc.  I figured the easiest way to accomplish this would be to have it poll on a timed interval (every 5-10 seconds) to check for new mail on an email account

If there are relatively inexpensive 3rd party tools available those are ok too.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1crvak/best_practice_for_storing_email_gmail_into_sql/
1363809211.0,1aom2h,Read and write in one statement with OUTPUT,darrenkopp,15,2,5,,t5_2qp8q,False
1355019337.0,14j0fb,Learning SQL for a Marketing Job,avon_barksale,12,2,24,"My situation--

I'm learning SQL to become a stronger candidate for a marketing job(account exec) in the online advertising space. For most jobs they mention ""SQL skills is a plus"". So

I installed MAMP, I just installed Sequel Pro and things are much easier. It auto-completes queries, I can save queries and just edit as need be, also I can adjust tables via GUI, overall MUCH easier than a CLI.

My question: 

What skills should I focus on to become fluent in SQL for this type of job? I'd imagine id just having to retrieve(select) data rather than create or insert data.

Can I say i'm fluent in SQL without knowing how to hand write queries via a CLI ? is using a program  like SequelPro a handicap ?

Any help would be appreciated,False,self,t5_2qp8q,1355019842.0,,,t3_14j0fb
1348495023.0,10e4e7,"DBA vs. ETL. vs BI - Wait, what are all the jobs again in this field?",factory81,20,7,http://www.reddit.com/r/SQL/comments/10e4e7/dba_vs_etl_vs_bi_wait_what_are_all_the_jobs_again/

There seem to be at least these kinds of jobs I have identified

DBA's - actual server admin. Backups

ETL work - ETL with SSIS involving everything from .net

Report builder/Analysis work - Building reports

Consulting - I still.........dont know exactly what this is



Anyways,? Or do they just expect you to know the whole SQL server stack, C#, .net, and java.


Coming from a physical infrastructure side of things, you may be a network technician, you may be a vmware specialist, you may be an exchange/windows server specialist, you may try and become good in all of these fields even. But you can get a job just having a good understanding of one of these rather HUGE topics.


After leaving the PASS event I never felt more disqualified in my life for a job. As if college has left a void by not teaching me the SQL server stack

I have a class on data mining coming up with that R stats program or whatever,,False,self,t5_2qp8q,1348503347.0,,True
1343941089.0,xl0xq,How do you know data that you queried is data that you were wanting?,loki0wn,14,3,15,"I had some interview questions over the last month that asked 'When you do a query

I gave some answers about looking at methodology, etc. but I don't think that they were sufficient. How would you answer this?",,False,self,t5_2qp8q,False,,
1320451818.0,m0wwc,(DB Newb) What makes MS SQL Server worth paying for over MySQL?,lwl,12,2,19,"Considering well designed
Is it a performance thing? security

UPDATE: Hey,False,self,t5_2qp8q,True,,,t3_m0wwc
1317075690.0,ks9zy,Dangers of string concatenation in SQL,geofft,12,2,3,"So I had some slow code in SQL Server 2008 that I was maintaining that looked something like this:

    declare @s varchar(max)
    set @s = ''

    select @s = @s + sometable.somecolumn
    from sometable

This was massively slow for large amounts of data

I did some performance tests and noticed that while SQL displayed the expected O(n^2) time when repeatedly concatenating strings (due to the creation of a new string and copying the data)

Enough words

",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/ks9zy/dangers_of_string_concatenation_in_sql/
1369375941.0,1eygjx,SQL noob here. What is this program?,Darrensmushbrain,13,2,28,,t5_2qp8q,False
1368715829.0,1egbn6,I am learning SQL and having problems understanding this logic of a self join,sqllearner298,11,0,14,"My books example is

Select c1.Cust_ud
from customers as c1
where c1.cust_name= c2.cust_name
and c2.cust_contact= 'Jim Jones '


why dont all the results of the query just return with Jim Jones as the cust_contact?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1egbn6/i_am_learning_sql_and_having_problems/
1357544383.0,163yxn,"New SQL based subreddit, /r/SQLOptimization!",bingostud722,16,7,http://www.reddit.com/r/SQL/comments/163yxn/new_sql_based_subreddit_rsqloptimization/

I have taken it upon myself to create a subreddit specifically for SQL Optimization discussion, creating indexes, and just going on an optimization spree :p.

Anyway, but wanted to throw it out there to see if there is interest. If it's ok with the mods here I'd like to steal the sidebar data, as it will be basically the same format as /r/SQL, but more focused on specifically optimizing queries, stored procedures, etc.

Any interest in this kind of thing?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/163yxn/new_sql_based_subreddit_rsqloptimization/
1343329287.0,x7d0p,[Oracle and/or SQL Server] IDE's - What do you use?,sqldiaries,14,1,22,"With the recent announcement about the acquisition of Quest Software by Dell

My employer currently has an unlimited Enterprise license with Quest for all of their software (which is actually quite nice)

So

We do have some features that are ***must haves*** simply because of our daily reporting needs:

* Ability to build automated scripts to execute, etc. (#1 reason why we use TDA)

* Cross-functional ability to use with Oracle &amp; SQL Server is desired.  Note, quite frankly, it's crap and doesn't work right 99% of time (Really Quest, using MS JET as the driver?!?!)

* Large (100k+) data set support.  We regularly pull down 100k records, pull 15M down.

* Relatively small memory footprint.  I develop on a crappy Dell laptop (sense a theme?!) with XP and 2GB of RAM because IT has no clue what I do and doesn't care.

So,,False,self,t5_2qp8q,False,,True
1318527681.0,lb1oc,DBA in Space,Eat1,14,2,3,,t5_2qp8q,False
1317913262.0,l3115,I would like to teach myself SQL now that I have lost my job.  Any of you know a good place to learn that's online and free?,mapguy,12,2,20,,t5_2qp8q,True
1312508110.0,j9f19,Interview Questions for an Entry-Level SQL Developer Job,b1tsh1ft,14,2,21,"Hey

Keep in mind this is an entry-level position for someone with little experience and coming out of college. I am expected to know SQL obviously but I'm wondering what could be asked. I know little of stored procedures because I never used them in school but I am decent on general queries. Any tips,False,self,t5_2qp8q,True,,,t3_j9f19
1288731437.0,e08wt,Ma lost her job as an AS/400 and other mainframe report writer/data analyst.  Everyone hiring wants SQL experience.  What (free) resources are available to help her get up to speed on writing queries for SQL?,smooth_and_creamy,11,0,10,"Getting her the SQL server software isn't really the challenge

Any thoughts on where to start

I found BicycleWorks for MS SQL 2008 server but I haven't taken a look at it yet

Lastly, but she should probably start with fundamental SQL knowledge first, then apply those tools as required.",,False,self,t5_2qp8q,,http://www.reddit.com/r/SQL/comments/e08wt/ma_lost_her_job_as_an_as400_and_other_mainframe/
1373669027.0,1i6oe1,SQL case study: Finding the most recent purchase by each customer,getmetrica,11,0,8,,t5_2qp8q,False
1363279596.0,1aajtb,A very newbie and stupid question about SQL,,13,4,13,"Hi guys

I know that this is a very stupid and silly question about SQL - but I have never actually used SQL in real business environments (Just Business Objects)

However I understand the structure of how SQL commands are run etc... but this is what I don't know and it's basically laughable..


Where do you type in the queries and where does the data go? 

Excel? CSV? etc? ",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1aajtb/a_very_newbie_and_stupid_question_about_sql/
1361578750.0,191x9x,How to solve this particular join (maybe it's not a join)...,mitzman,10,0,8,"So I'm working on this report in SSRS (so this is in MS SQL obviously).  The table I'm reading from contains the following columns:

Vendor Name

Now the receiving period will be in the format YYMM (i.e. 1210, 1210, 1209, 1208, 1207). 

What I need to do is select from the sum from the vendor table and group it on vendor name and period which is easy

    select vendorname, period

The problem is that say that for vendor ABC, the oldest period [in this example 1207]) will be a sum of the amount for that period and all periods prior (1206, 1205, 120,etc).  It's pretty easy to sum up the oldest period and previous ones by just doing a case in my query...

    select vendorname, period

I'm still just stuck on getting rows to show a 0 sum when there's no rows for a vendor and a period in that table.  I've been picking my brain on this all day and I'm just not sure where else to look.  Any thoughts?",self,t5_2qp8q,1361578943.0,,,True,http://www.reddit.com/r/SQL/comments/191x9x/how_to_solve_this_particular_join_maybe_its_not_a/
1353286343.0,13fak2,"In a SELECT with multiple WHERE, does the order of the WHERE matter?",frescani,10,0,http://www.reddit.com/r/SQL/comments/13fak2/in_a_select_with_multiple_where_does_the_order_of/

(assume all additional WHERE are preceded with AND

edit: a couple letters ran off somewhere",self,t5_2qp8q,1353291552.0,,,True,http://www.reddit.com/r/SQL/comments/13fak2/in_a_select_with_multiple_where_does_the_order_of/
1342848267.0,wwvht,Discussion:  Best practices for long queries/stored procedures,einhverfr,11,1,2,,t5_2qp8q,False
1313234183.0,jhmj8,Best way to become fluent in SQL? No prior experience.,whipper515,13,4,19,"I work with a RDBMS that keeps tracks of a vast amount of equipment moving around all over the place. I don't need much knowledge with SQL to do my current role,self,
1303321847.0,gun6p,"The Biggest, Baddest SQL Query I've Ever Written (DB2)",ninjaroach,12,3,http://www.reddit.com/r/SQL/comments/gun6p/the_biggest_baddest_sql_query_ive_ever_written_db2/

I just learned about Common Table Expressions (CTEs) last week and now I've littered them all over the query.  I award myself extra bonus points for the recursive CTE titled ""JDECATALOG.""

So here it is

WITH 

-- Start with all Item Master records
IM AS (
	SELECT RTRIM(IMLITM) AS IMLITM, IMSRP8, IMSTKT, RTRIM(IMDSC1) as IMDSC1, IMIFLA FROM HPPRDDTA.F4101
)

-- Find all Alternative Descriptions for language 'S' and combine both description fields to provide a single 60 char field

ALTDSC AS (
	SELECT IMITM
)

-- Find distinct configurator children in Branch Plant 10

Configurator AS (
	SELECT DISTINCT KYITM FROM HPPRDDTA.F3293 WHERE KYMCU = '          10'
)

-- Find branch plant availability for parts

BPCHECK AS (
	SELECT IBITM
		CASE 
			WHEN IBMCU = '         255' THEN 2
			WHEN IBMCU = '          20' THEN 1
			ELSE 0 
		END) AS ""BPSUM"" FROM HPPRDDTA.F4102 GROUP BY IBITM
)

-- Convert BPCHECK SUMs back into the most-preferred branch plant. Created as CTE for re-usability purposes (once in the SELECT and again in the join to SHIPPING)

BP AS (
	SELECT BPCHECK.IBITM
	CASE
		WHEN BPCHECK.""BPSUM"" &gt; 1 THEN '         255'
		WHEN BPCHECK.""BPSUM"" = 1 THEN '          20'
		ELSE '          10'
	END AS ""BranchPlant"" FROM BPCHECK
)

-- Shipping dimensions

SHIPPING AS (
	SELECT IQITM, IQGDEP / 100 AS ""Depth"", IQGHET / 100 AS ""Height"", IQGWEI / 100 AS ""Weight"" FROM HPPRDDTA.F46011
)

-- Part Replacement Message:  Pull all type ""R"" X-Ref records with AN8 = 0 and combine description with optional ""S"" and ""SS"" records

REPLACEMENTS AS (
	SELECT RTRIM(R.IVCITM) || RTRIM(COALESCE(' / ' || S.IVCITM, R.IVLITM AS ""Old""
	FROM HPPRDDTA.F4104 R LEFT JOIN HPPRDDTA.F4104 S
		ON S.IVAN8 = 0 AND S.IVXRT = 'S' AND R.IVLITM = S.IVLITM
	LEFT JOIN HPPRDDTA.F4104 SS
		ON SS.IVAN8 = 0 AND SS.IVXRT = 'SS' AND R.IVLITM = SS.IVLITM
	WHERE R.IVAN8 = 0 AND R.IVXRT = 'R'
)

-- Recursively build JDE Catalog Hierarchy

JDECATALOG (ID, CATFIELD, CATCODE, LEVEL) AS (
	SELECT IHUKID AS ""ID"", CASE WHEN IHDTAI = '' THEN NULL ELSE IHDTAI END AS ""CATFIELD"", CASE WHEN IHKY = '' THEN NULL ELSE IHKY END AS ""CATCODE"", 1 AS ""LEVEL""
	FROM HPPRDDTA.F4101H ROOT
	WHERE IHPUKID = 0

	UNION ALL

	SELECT CHILD.IHUKID AS ""ID"", CASE WHEN IHDTAI = '' THEN NULL ELSE IHDTAI END AS ""CATFIELD"", CASE WHEN IHKY = '' THEN NULL ELSE IHKY END AS ""CATCODE"", ROOT.LEVEL +1 AS ""LEVEL""
	FROM JDECATALOG ROOT INNER JOIN HPPRDDTA.F4101H CHILD ON CHILD.IHPUKID = ROOT.ID
)

-- Self-Join 5 copies of JDECATALOG to build ""Online Catalog"" + 5 columns of ""Categories"".  Use Coalesce to grab the right-most Item Master Selection Criteria

CATEGORIES AS (
	SELECT 'Online Catalog' AS ""CATALOG"", ""3"".CATEGORY AS ""CATEGORY3"", ""4"".CATEGORY AS ""CATEGORY4"", ""5"".CATEGORY AS ""CATEGORY5"", COALESCE(""5"".CATFIELD, ""4"".CATFIELD, ""3"".CATFIELD, ""1"".CATFIELD) AS ""CATFIELD"", ""2"".CATCODE
	FROM JDECATALOG ""1"" INNER JOIN JDECATALOG ""2"" ON ""1"".LEVEL = 1 AND ""2"".LEVEL = 2 AND ""2"".PARENT = ""1"".ID
	LEFT JOIN JDECATALOG ""3"" ON ""3"".LEVEL = 3 AND ""3"".PARENT = ""2"".ID
	LEFT JOIN JDECATALOG ""4"" ON ""4"".LEVEL = 4 AND ""4"".PARENT = ""3"".ID
	LEFT JOIN JDECATALOG ""5"" ON ""5"".LEVEL = 5 AND ""5"".PARENT = ""4"".ID
)

-- Return (perhaps duplicate) Item Master records with category information based on selection criteria defined in CATEGORIES CTE

ITEMCATEGORIES AS (
	SELECT IMITM, CATEGORIES.CATEGORY2, CATEGORIES.CATEGORY3, CATEGORIES.CATEGORY4, CATEGORIES.CATEGORY5 FROM HPPRDDTA.F4101 IMCATS INNER JOIN CATEGORIES ON CATEGORIES.CATFIELD = 'SRP1' AND IMCATS.IMSRP1 = CATEGORIES.CATCODE
)

-- Grab ""Flash Message"" UDC codes

FLASH AS (
	SELECT LTRIM(DRKY) AS DRKY
)

 SELECT 

 IM.IMLITM

 IM.IMITM

 IM.IMUOM1

 CAST('2010-01-01' as DATE) as ""EffectiveFrom""

 CAST('2020-01-01' as DATE) as ""EffectiveThrough""

 SHIPPING.""Weight"" as ""Weight""

 SHIPPING.""Width"" as ""Width""

 SHIPPING.""Height"" as ""Height""

 SHIPPING.""Depth"" as ""Depth""

 CASE

 	WHEN IM.IMSRP8 =  'E' THEN 1

 	ELSE 0

 END as ""Order Online""

 '' as ""ThumbnailImg""

 '' as ""ActualPicture""

 0 as ""BasePrice""

 '' as ""ExcelFile""

 '' as ""WordFile""

 '' as ""PDFFile""

 '' as ""PPTFile""

 IM.IMSTKT

 0 as ""MinQty""

 COALESCE(ALTDSC.""CombinedDesc""

 '' as ""Long Description""

 '' as ""Specs""

 '' as ""Features""

 FLASH.DRDL01 as ""Desc1""

 'This item has been replaced by '||REPLACEMENTS.""New"" as ""Desc2""

 '' as ""Desc3""

 '' as ""Desc4""

 '' as ""Desc5""

 '' as ""MetaKeywords""

 '' as ""MetaDescription""

 '' as ""MetaTitle""
 BP.""BranchPlant"" as ""BranchPlant""

 ITEMCATEGORIES.CATALOG as ""Catalog""

 ITEMCATEGORIES.CATEGORY1 as ""Category1""

 ITEMCATEGORIES.CATEGORY2 as ""Category2""

 ITEMCATEGORIES.CATEGORY3 as ""Category3""

 ITEMCATEGORIES.CATEGORY4 as ""Category4""

 ITEMCATEGORIES.CATEGORY5 as ""Category5""

 FROM 

 IM LEFT JOIN Configurator ON Configurator.KYITM = IM.IMITM

 LEFT JOIN ALTDSC ON IM.IMITM = ALTDSC.IMITM

 LEFT JOIN BP ON IM.IMITM = BP.IBITM

 LEFT JOIN SHIPPING ON IM.IMITM = SHIPPING.IQITM AND BP.""BranchPlant"" = SHIPPING.IQMCU

 LEFT JOIN REPLACEMENTS ON IM.IMLITM = REPLACEMENTS.""Old""

 LEFT JOIN FLASH ON IM.IMIFLA = FLASH.DRKY

 LEFT JOIN ITEMCATEGORIES ON IM.IMITM = ITEMCATEGORIES.IMITM -- This is the only JOIN that should ever 
have the chance to produce multiple matches
 
 WHERE

(IM.IMSRP8 = 'E' OR IM.IMSRP8 = 'SO' OR Configurator.KYITM IS NOT NULL)
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/gun6p/the_biggest_baddest_sql_query_ive_ever_written_db2/
1374255333.0,1in6rc,Cohort Analysis: Data Sourcing With SQL,michaelherman,10,1,0,,t5_2qp8q,False
1368396984.0,1e7gu3,Why can't UPDATE statements be reverted?,Xolom,15,6,39,"I screwed up a query at work and wiped out a whole bunch of data with an update statement. There are backups
Why can't an update be easily reversed?

This is on SQL Server 2008 and SQL has been around for decades - is there a structural reason why queries can't be revered or a change history instituted? I don't expect Ctrl+Z

Also, etc.)? What are the professional practices for when these mistakes occur? Any DBAs here that can chime in?",,False,self,t5_2qp8q,False,,
1366417258.0,1cplgq,"My friends are getting married, and I want to gift them a SQL statement. Help!",BidipBoo,16,7,http://www.reddit.com/r/SQL/comments/1cplgq/my_friends_are_getting_married_and_i_want_to_gift/

I'm not much of a coder

I figured that maybe a SQL join would be fun

Here's what I got:

SELECT Beth.Smith FROM tbl.Brides
Dave.Williams FROM tbl.Grooms 
JOIN Wedding ON 
Wedding.Date = '2013-04-27'",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1cplgq/my_friends_are_getting_married_and_i_want_to_gift/
1364342088.0,1b2rrt,MS SQL Management Studio collapse tree by pressing left arrow,lews0r,11,2,10,"Hey folks

I think this is just a default OS action which works in windows explorer and anywhere else you have a tree structure but when working between several databases I find this simple little shortcut to be all kinds of awesome and saves me having to do a lot of scrolling :-)",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1b2rrt/ms_sql_management_studio_collapse_tree_by/
1357316599.0,15yf3w,[LINUX] Help with Database ETL process.,IceMenthols,10,3,6,"As someone that primarily uses Microsoft products and relies heavily on SSIS for ETL to get data from files and databases

When dealing with 'dirty' files (is there a term for these?) that are outside the scope of the included transformations then .net scripts can normally provide a stop-gap but how is this performed in Linux/Unix? 

Are scripting languages used primarily? reg-ex? is the file first processed by a script to get it into a usable state then processed by the database client?

For example, or parsing a log file and ensure the time also has the date, etc.

I know this is a very open ended question but I'm very new to this and your input/perspective would be welcomed. Many thanks.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/15yf3w/linux_help_with_database_etl_process/
1348233499.0,108vrc,Can this query be more efficient?  Get all users' names and their highest price order if any.,not_a_temp_account,12,1,12,"I think my query performs a pretty common need so I imagine that there's a better way to do this.  I want to find ALL the people in my customers table (whether or not they've ever placed an order).  If they HAVE placed an order



I already have an answer.  This query will work:



SELECT DISTINCT cust.full_name

FROM customers cust

LEFT JOIN orders od1 ON od1.cust_id = cust.id 

WHERE order_price= 

		     (SELECT max(order_price) 

		     FROM orders od2 

		     WHERE od1.cust_id = od2.cust_id) 

OR order_price is null;



But I can't help but feel that there's an easier way to do this

Thanks for any help.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/108vrc/can_this_query_be_more_efficient_get_all_users/
1341989193.0,wdh6m,Think Before You Hit 'Execute',LepcisMagna,11,3,10,"I am new to learning SQL (and to Reddit), and since we don't have a computer science degree, which

tl:dr - I deleted all the student GPA records because of a badly thought out stored procedure and a giant 'D'oh' moment on my part.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/wdh6m/think_before_you_hit_execute/
1339827123.0,v4p20,"Job Interview 
Basic knowledge in SQL server is a plus",3,10,http://www.reddit.com/r/SQL/comments/v4p20/job_interview_basic_knowledge_in_sql_server_is_a/,"Its been a few years since I have done anything with SQL server. I'm sure I could pick it up again pretty easily. I was seeing if anyone could offer any tips that I might be able to help me bullshit my way through any questions or direct me to any sites that offers a crash course. I really need this job or my mom will  kick me out of the basement and has threaten to stop doing my laundry 

Thanks in advance ",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/v4p20/job_interview_basic_knowledge_in_sql_server_is_a/
1332635270.0,rc2eq,[ANSI] Help me expand the SQL:2011 article on Wikipedia,ysangkok,9,0,1,,t5_2qp8q,False
1330055520.0,q3kr3,SQL 2005 Need help returning NULL values,,10,1,3,"Hi
 
Table 1
Column 1a           
2
4
7
8

Column 1b
22-Feb-2012
13-Jan-2012
05-Jan-2012
18-Dec-2011
 
Table 2
Column 2a
1
2
3
4
5
6
7
8
9
 
I am trying to write a query which would return the values for Column 1b and Column 2a where Column 1a = Column 2a.  However,False,self,t5_2qp8q,False,,,t3_q3kr3
1328723355.0,pghx0,Fun Fact:  The T-SQL LEN() function for determining the length of the string does not count trailing spaces.,hypo11,12,2,11,"Today I Learned: The SQL LEN() function (to determine the length of the string) does NOT include trailing spaces.  It DOES include leading spaces and spaces between non-space characters:

    SELECT LEN('hi') = 2  
    SELECT LEN('hi ') = 2!  
    SELECT LEN(' hi') = 3  
    SELECT LEN('hi 1') = 4  
    SELECT LEN('hi 1 ') = 4!  

Heads up for anyone who uses this function.
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/pghx0/fun_fact_the_tsql_len_function_for_determining/
1324138383.0,ngeop,New /r/SQL Moderators! Huzzah!,,10,1,2,"Please welcome your new moderators:
## [hypo11](http://www.reddit.com/user/hypo11) 

and 

##[mgdmw](http://www.reddit.com/user/mgdmw)

Both are active and well-karmaed posters and commenters with what I feel is a good sense of community. Do right by each other, and moderator, and /r/SQL will thrive and be a source of joy to all!",,False,self,t5_2qp8q,,http://www.reddit.com/r/SQL/comments/ngeop/new_rsql_moderators_huzzah/
1324093399.0,nfz9c,/r/sql moderator stepping down. Long live the new moderator!,,9,0,3,"I started this subreddit because I had an interest in SQL and database programming in general,,False
1320242093.0,lxoaf,Learning to write better queries,ElvisLikeBear,11,1,13,"Hi all!

In my current role I'm finding myself using more and more SQL on a daily basis (Microsoft SQL R8). I feel like I'm at a point where I know enough to get by

I really want to change this to be a better developer - What resources would you recommend for learning good practices and writing more efficient queries? What are good standards? What should I completely avoid doing even though it may seem like the best way to approach a problem?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/lxoaf/learning_to_write_better_queries/
1313769446.0,jnymv,Finally!! (Denali CTP3),firepool,14,3,2,,t5_2qp8q,False
1311177553.0,iuwxr,"Noob here, right now I have been running my SQL stuff in Access and I was wondering where to go from here.",vpersaud03,10,0,http://www.reddit.com/r/SQL/comments/iuwxr/noob_here_right_now_i_have_been_running_my_sql/,False,
1252848016.0,9k34p,Ten Common SQL Programming Mistakes,,9,0,0,,t5_2qp8q,False
1371841938.0,1gt8su,"[SQL Server] How do I Search for a specific value, within all tables of a database.",270,8,1,http://www.reddit.com/r/SQL/comments/1gt8su/sql_server_how_do_i_search_for_a_specific_value/

I have been tasked to search and find which table a certain field lives in

I have this query below that has helped searching for a column name within a table. The results show me the Table Name, I would like the results to show ""Table Name"", ""Schema Name"" and ""Column Name"" when I search for ""Value1"". Please let me know if you can help.

Thank you

Here is the query I use to search for Column Name:
    
    USE DATABASE NAME
    GO
    SELECT t.name As table_name
    Schema_name(schema_id) AS Schema_name
    c.name AS column_name
    FROM sys.tables AS t
    INNER JOIN sys.columns c ON t.OBJECT_ID = c.OBJECT_ID
    WHERE c.name LIKE '%results%'
    ORDER BY schema_name

EDIT: **I am using SQL Server 2005**",self,t5_2qp8q,1371851989.0,,,True,http://www.reddit.com/r/SQL/comments/1gt8su/sql_server_how_do_i_search_for_a_specific_value/
1369765783.0,1f7pql,Editing Skype history database (SQLite),Dima_Stefantsov,8,1,2,,t5_2qp8q,False
1363907788.0,1arjtc,Oracle Database 11g: SQL Fundamentals I Exam,SparraticDitto,8,2,3,"Will be taking the exam this weekend

Some people have told me it was more difficult than most of their practice tests

Any help would be appreciated,False,self,t5_2qp8q,False,,,t3_1arjtc
1361574541.0,191sva,Pretty new. Need help with the 'Like' command.,Cassiop,10,0,13,"Hello

Is there any way to use the like command to display only results with one word?  I have a long list of books and want to display only the books with one word for their title. I have a basic concept of wildcards but I can't seem to figure this one out.

Any help would be great!

Thank you.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/191sva/pretty_new_need_help_with_the_like_command/
1359872699.0,17solp,Database developers: triggers; good or bad? (x-post from /r/oracle),MeGustaDerp,13,5,4,,t5_2qp8q,False
1359398818.0,17fxlh,Webcast: View Updating: How to Make it Work,MeGustaDerp,8,0,0,,t5_2qp8q,False
1359314008.0,17dpoo,"Need help with a syntax error, please",Targetshopper4000,10,1,http://www.reddit.com/r/SQL/comments/17dpoo/need_help_with_a_syntax_error_please/
the line in question is

CONSTRAINT EMP_FK FOREIGN KEY (EMP_ID) REFERENCES EMPLOYEE_TBL (EMP_ID)

im using MySQL if that helps at all.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/17dpoo/need_help_with_a_syntax_error_please/
1355294126.0,14pplc,[MSSQL] Grouping by fortnight,youarenotyourjerb,8,2,9,"Hi guys!

I have a challenge for you...

I've got daily data that I want to group by fortnight for summing up.

So far

    SELECT 
         DATEADD(DD, TABLE.DATE) / 15 * 15, '1-Jan-2013') AS FORTNIGHT, 
         sum(mynumbers) AS SUM
    from TABLE
     GROUP BY DATEADD(DD, t1.date) / 15 * 15, '1-Jan-2013')


The problem lies in that months have a different number of days

    FORTNIGHT               SUM
     2013-01-01 00:00:00.000	456
     2013-01-16 00:00:00.000	518
     2013-01-30 00:00:00.000	537
     2013-02-13 00:00:00.000	535
     2013-02-27 00:00:00.000	508
     2013-03-13 00:00:00.000	530
     2013-03-27 00:00:00.000	516
     2013-04-10 00:00:00.000	558
     2013-04-24 00:00:00.000	586


EDIT: Desired result set:

       FORTNIGHT               SUM
    2013-01-01 00:00:00.000	456      this is 1/1/13 to 15/1/13
    2013-01-16 00:00:00.000	518      this is 16/1/13 to 31/1/13
    2013-02-01 00:00:00.000	537      this is 1/2/13 to 15/2/13
    2013-02-16 00:00:00.000	535      **this is 16/2/13 to 28/2/13**
    2013-03-01 00:00:00.000	508      this is 1/3/13 to 15/3/13
    2013-03-16 00:00:00.000	530      etc.
    2013-04-01 00:00:00.000	516
    2013-04-16 00:00:00.000	558
    2013-05-01 00:00:00.000	586

Thanks",self,t5_2qp8q,1355303657.0,,,True,http://www.reddit.com/r/SQL/comments/14pplc/mssql_grouping_by_fortnight/
1354385356.0,14406m,How difficult/easy was it to find your first SQL job?,,9,1,15,"Hey

I've recently finished uni and seeking a job as a junior SQL dba. Problem is

How did you get your job as a SQL developer/ dba? ",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/14406m/how_difficulteasy_was_it_to_find_your_first_sql/
1354038545.0,13vsp3,[MS Access SQL],jayvfman,10,1,10,"I am a SQL noob so any explanation will help.

I have a table that list patient visit times to a doctor's office. What I am trying to do is be able to count the number of visits falling in a specific time period (ex. number of visits between 8:00 AM and 8:59 AM.

I am able do a count on one set of criteria:

    SELECT Count(EnterTM)
    FROM [Prescription_Timing_9/12]
    WHERE (EnterTM) Between #8:00# And #8:59#

But is it possible to me to count multiple ""time blocks"" and get a count result for each?

I am trying to get a count for 
*8-8:59
*9-9:59
*10-10:59
*etc

Is somthing like this possible?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/13vsp3/ms_access_sql/
1347905529.0,1017pn,Giving back to the community. Here are some random tips for jr DBA interview exams,aboxofrice,13,4,8,"I'm not a DBA by trade but I do work with a few DBAs and have a huge interest in SQL. The DBA I work with was doing interviews and I reviewed the exam he had given for a juniour DBA postion. I was surprised at how many people didn't catch some simple things. 

1. If you have a question asking to delete some records

2. Look very carefully at the schema including the column types and ask questions. I saw a price column of Price varchar(255), and a album name column Albumn_Name nvarchar(128). I questioned him about it and he mentioned that nobody brought up any questions about it and essentially failed for not noticing the basic. 

I'm hoping some people here will post more to help out anybody going for a Jr DBA. ",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1017pn/giving_back_to_the_community_here_are_some_random/
1340678865.0,vlxcg,I am somewhat new to SQL still.  I have a question on views and temp tables.,,9,1,17,I was told by someone who review my stored procedure that I should not use so many tables(even temps) and that I should start to incorporate Views more into my programming more.  To my understanding Views are sort of product tables?  Can I interchange temp tables with Views as far as functionality?  ,t5_2qp8q,True
1334107140.0,s3k2s,Have a SQL question about WHERE vs. ON,syneofeternity,9,2,16,"EDIT: Fixed formatting... somewhat
I had a question about the uses for both.


Example with WHERE:

SELECT tab1.col1

FROM tab1

WHERE tab1.col1 = tab2.col1


Example with ON:


SELECT tab1.col1, tab2.col1

FROM tab1

JOIN tab2 ON tab1.col1=tab2.col1


Is it just because there is a JOIN?
Also,False,self,t5_2qp8q,True,,,t3_s3k2s
1328288856.0,p9fy2,Bringing two rows into one,captshady,8,0,11,"What my table data looks like:

    Division Number	GDGROUP	Group Name	Division Phone Number	Local Code	VNG_Plan_ID	Subscriber_Count	Local_Name
    173	127112	CARL C FEESMAN BUILDING	555.555.5555	3924	ADM-ADMINISTRATION	8	BUILDERS ASSOC OF AMERICA
    173	127112	CARL C FEESMAN BUILDING	555.555.5555	3924	ADM-ANCILLARY	2	BUILDERS ASSOC OF AMERICA

What I want my SELECT statement to produce:

    Local Code 	Local Name                      	Division Name                   	Total Members At 11.00	Total Members At 3.00 
    3924		CARL C FEESMAN BUILDING                 BUILDERS ASSOC OF AMERICA			8			2

I need the 2 lines above to output as one line.

",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/p9fy2/bringing_two_rows_into_one/
1291774671.0,ei0rs,Visual Representation of SQL Joins - CodeProject,,10,2,1,,t5_2qp8q,False
1282832626.0,d5q1p,How fucked is my database ? ,cms,13,5,3,,t5_2qp8q,False
1376735903.0,1kjlrr,Need help with an SQL Select Query,makonde,10,3,11,"Given this table: 

City		|	Person
------------|----------
Cape Town	|	Fred
Cape Town	|	Joe
Cape Town	|	Anna
Durban		|	John
Durban		|	Mary
Johannesburg|	Frank

I need a SELECT Query that will get these results

City		|	Person
------------|----------
Durban		|	John
Durban		|	Mary
Johannesburg|	Frank
Cape Town	|	Anna
Cape Town	|	Fred
Cape Town	|	Joe

The best I have been able to do is use a CASE:


    SELECT * FROM Customers
    	ORDER BY (
    	CASE Region
    		WHEN 'Durban' THEN 1
    		WHEN 'Johannesburg' THEN 2
    		WHEN 'Cape Town' THEN 3
    		ELSE 100 END)

		
But this feels kinda hacky
		
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1kjlrr/need_help_with_an_sql_select_query/
1375806798.0,1jtixc,How can I combine two rows in the same column?,lamppost9,9,2,7,"[TSQL]  I am trying to combine two values in the same column into one.  Specifically I have a column where if a visit is 1 hours and 15 minutes for client 132151

Duration             Client ID

15 MINUTES	  132151

1 HOUR	          132151

I need to get it into one cell which is similar to '1 HOUR 15 MINUTES'.  I can take it from there but am stuck at this point.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1jtixc/how_can_i_combine_two_rows_in_the_same_column/
1375800454.0,1jtarj,Is this really an error?,pythor,10,3,14,"Say we have    
table1 (name varchar(30)
and    
table2 (name varchar(30)

And we have a query:

    select t1.*
    from table1 t1 inner join 
           table2 t2 on (t1.name=t2.name)
    where jobdate &gt; to_date('20130101'
    order by jobdate


So... Should this throw an error?  name exists in both tables, there's only one name field involved (ignoring the fact that the two tables fields would be the same because of the join, anyway).  

",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1jtarj/is_this_really_an_error/
1375303169.0,1jg2h3,[MS SQL] PIVOT for a range of data,softball753,8,2,14,"(Accidentally hit F5 before submitting


Using MS SQL 2008R2, I can PIVOT the table like this without an issue:

    	SELECT * FROM
    		(SELECT 
    		 AgeYears
    		 FROM #Ages
    		 ) as A
    	PIVOT
    		(
    		count(AgeYears)
    		FOR AgeYears IN ([0],[3],[4],[5],[6],[7],[8],[10])
    		) AS PT

What I would like to do is include a range in the FOR/IN clause of the statement, or [10-20]. I've only seen this mentioned in one blog (that I cannot now find) using the ""-"" for range as well as *OVER* and *UNDER* and a value. I consistently get this error ""The incorrect value ""10-20"" is supplied in the PIVOT operator."" so I'm assuming that the blog I saw didn't apply to MS SQL.

The SP will update without error

I've tried several syntax alterations (throwing crap at the wall)

Is what I'm trying out of the scope of the PIVOT operator? If so I can think of a few workarounds,False,self,t5_2qp8q,False,,,t3_1jg2h3
1375151492.0,1jbllk,Weird Schema [MY SQL],Better-reddits,10,3,4,"OK, and 'O' for COO. I'll put the schema and sql to populate below. Now

select e.name

But what I need is a join of some kind that gives me the employer and all three officers in the same row. Actually

    create table corp_officers (
    name VARCHAR(80)
    ceo_name VARCHAR(80)
    cfo_name VARCHAR(80)
    coo_name VARCHAR(80)
    )

But I'm just trying to create a query to return all those 4 things in a row. CROSS JOIN? INNER JOIN? CROSS APPLY? 

Can you help me out?

    create table employer (
    id IDENTITY
    name VARCHAR(80)
    );

    create table officer (
    id IDENTITY
    type CHAR
    emp_id INT
    name VARCHAR(80)
    FOREIGN KEY (emp_id) REFERENCES employer(id)
    );

    insert into employer (name) values ('Yahoo');
    insert into employer (name) values ('Google');

    insert into officer (name, 'E', 0);
    insert into officer (name, 'O', 0);
    insert into officer (name, 'F', 0);

    insert into officer (name, 'E', 1);
    insert into officer (name, 'F', 1);
    insert into officer (name, 'O', 1);",,False,self,t5_2qp8q,,http://www.reddit.com/r/SQL/comments/1jbllk/weird_schema_my_sql/
1375112026.0,1ja4li,Sorting a table by the end characters.. example provided.,wolfman3127,7,0,10,"Say I have a table and I want to create a query to sort these properly.. example is  

Orange Tomatoes 
Yellow Tomatoes  
Green Bananas    
Blue Grapes  
Green Grapes  
Red Tomatoes  
Purple Tomatoes  
Grey Grapes  


And I want to group these items by the last 6 characters, I am unsure about how to do this.. any help would be amazing.


  

[SOLVED]

  select fruitname
    
from table 
order by right(fruitname


  Worked perfectly.",self,t5_2qp8q,1375127556.0,,,True,http://www.reddit.com/r/SQL/comments/1ja4li/sorting_a_table_by_the_end_characters_example/
1370617009.0,1fv4tx,New to SQL. How do I practice?,tatvamasi88,12,3,21,"I am learning SQL and I would like to practice the statements I am learning.  I am wondering if 
1) there are any free platforms I can use (I'm operating off of a mac btw).  I assume that Oracle and Microsoft SQL server either cost money or don't work on my MacBook.  Could I use Access?
2)I would like some sample data sets with which I can practice.  ",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1fv4tx/new_to_sql_how_do_i_practice/
1366813634.0,1d0e8e,Question concerning MSSQL replication,whoisearth,8,1,7,"We have a database that is actively being written to with various SELECT/UPDATE/DELETE/ETC statements.  This Database

What I'd like to do is setup a copy of this Database

How is this done within MSSQL?

tl'dr - 2 databases A and B.  Want to sync A -&gt; B daily but add new rows to B without deleting the old rows.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1d0e8e/question_concerning_mssql_replication/
1364683975.0,1bbrtl,[MySQL] Queries to queue up music,,8,0,6,"I'm looking to have a bit of fun with a large music collection to see if it's possible to create a radio like experience with queries on a library. Lots of audio managers have some sort of smart playlists

I'm curious to see if there is interest in this and if anyone wants to contribute

Example Radio Station:
            
    SELECT * FROM library WHERE 
    UPPER(artist) LIKE ""%RAILROAD EARTH%"" 
    OR UPPER(artist) LIKE ""%OLD CROW%"" 
    OR UPPER(artist) LIKE ""%YONDER%"" 
    OR UPPER(artist) LIKE ""%FLECK%"" 
    OR UPPER(artist) LIKE ""%TRAMPLED%"" 
    OR UPPER(artist) LIKE ""%CHEESE%"" 
    ORDER BY RANDOM() LIMIT 50
    

We could swap queries by RSS and discover new music to add to personal collections to enjoy other ""stations"".


Proposed schema:
http://pastebin.com/mGE8HYZF

Demo Layout:
http://i.imgur.com/ZlRQWlp.png
http://i.imgur.com/rahYn8p.png

My demo is currently written with FuelPHP as the framework,False,self,t5_2qp8q,1364743462.0,,,t3_1bbrtl
1364599104.0,1b9t9y,Connecting Web Services to SQL and then SQL to Cognos Framework,270,7,0,6,"Hello!
 I current have 2 data sources that I do not own the intellectual property of the data on the servers they are stored on. When speaking with the companies who do own the servers
 I have read little on this and was curious if there is anyone here that can help me with first hand experience.
 My goal is to connect web services to SQL Server
 Has anyone done this (Connected Web Services to SQL Server)? What would be my first step in connecting Web Services to SQL Server?
 Thank you",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1b9t9y/connecting_web_services_to_sql_and_then_sql_to/
1363385866.0,1adkh4,Is this possible?,StuckHereWithYou,10,3,5,"saw this on my facebook feed. tried searching reddit but couldn't find any reference.
edit. ooops link got lost.
http://gizmodo.com/5498412/sql-injection-license-plate-hopes-to-foil-euro-traffic-cameras",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1adkh4/is_this_possible/
1362490178.0,19pe7r,Optimizing query [MS SQL],volric,8,1,35,"Have an update query that is filling tempdb (over 30gigs)

Only run once a year

    /** CLOSING BALANCE **/
    update BALANCE
    set BALANCE.CB = SCHEDULE.sum_AMOUNT
    from BALANCE inner join
    (
        select STNO
    from SCHEDULE
    where SCHEDULE.YEAR &lt;= YEAR.YEAR
    group by STNO
    ) as SCHEDULE
    on BALANCE.STNO = SCHEDULE.STNO
    and balANCE.year = schedule.year
  

Also have tried 'with'

    WITH t2 (stno
    (
    select schedule.STNO
    from dbo.SCHEDULE
    where SCHEDULE.YEAR &lt;= YEAR.YEAR
    and BALANCE.STNO = SCHEDULE.STNO
    and balANCE.year = schedule.year
    group by schedule.STNO
    )
    UPDATE balance SET balance.cb = t2.sum_amount
       FROM balance
          INNER JOIN t2 ON BALANCE.STNO = t2.STNO
    and balance.year = t2.year


Any suggestions on how to improve the query?

We normally do simple/basic queries so this is above our level :/


EDIT: Thanks all for your comments and suggestions. I'm going to try the following:

* create a separate temp table with the aggregate calculation and use it to update the BALANCE table
* do it year by year (limit quantity of rows being updated)
* learn how to use indexes
* try and not use outdated syntax/language

",self,t5_2qp8q,1362557056.0,,,True,http://www.reddit.com/r/SQL/comments/19pe7r/optimizing_query_ms_sql/
1361984581.0,19c3lu,Understanding Data Warehouses,learningsql,8,3,27,"I'm having a fairly hard time understanding some of the more meta-level setups

Our business is fairly small and we've not yet developed really good policies or procedures for SQL type stuff - we don't even employ a full-time DBA. All our SQL stuff is handled by a team of about ten who each sorta do their own thing for their own work.

I would like to get organized. Part of my investigation as of late has been around data warehousing but I can't seem to wrap my little brain around the concept. So a few questions: What is a data warehouse? When would it make sense to avoid a data warehouse and when would it make sense to utilize one? What about more than one? Is a data warehouse always a secondary database where the data is simply a denormalized version of a normalized source DB?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/19c3lu/understanding_data_warehouses/
1361368967.0,18vw5z,Can someone help me write this SQL stored procedure? It was asked in an interview.,,12,4,23,"Given a table ""ShopsBranches"" with columns: latitude and longitude.

Write a SQL stored procedure that takes a ""lat"" and a ""long"" from the user and then returns the branches in the table sorted by distance from user's input.

You will have to populate the table with enough data to test your ""nearest points"" algorithm.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/18vw5z/can_someone_help_me_write_this_sql_stored/
1359241807.0,17c7w5,Statistics in Oracle and SQL Server (recorded webinar with Johnathan Lewis and Grant Fritchey),MeGustaDerp,8,2,0,,t5_2qp8q,False
1358805050.0,170i8b,[MS SQL 2008] Attempting to convert vertical data to horizontal.,aburger,9,0,11,"[ Solved
  
  
-----------------------------------------------------------------------------
  
  
Context: I'm using a table to, attribute, and value). Profile 1 could, for example, be concerned with 5 attributes, while profile 2 uses 10 attributes -- making a hard number of JOINS (almost) an impossibility. (My first instinct was to join the table to itself a few times but, with an unknown total number of possible values
  
  
Problem: I'm trying to convert this to something where a user could basically:
  
    SELECT [profiles.id] WHERE [attribute] = [value]
  
  Basically
  
    WHERE ResX='1080' AND ResY='1920' AND ColorSpace='RGB'
  
  --and ResX, etc, are all values of profiles.attr
  
  
  The more I dig into this, and I apologize for that. I hope it makes sense.
  
  
  Help me,,False,self,t5_2qp8q,1358810194.0,,True
1355320455.0,14q3ly,"[MySQL] noob design question - avoiding cheating with ""arrays""",njtrafficsignshopper,9,2,18,"I haven't touched a database in a while but I am curious about this topic. Say you have a table that needs to store a person's name (one per person)

e.g.

    name     foods     intro

    David    pizza     Hi I'm David
             oranges
             cake
    Amanda   pork      Greetings everyone

It's tempting to just use one row per person and make the foods column store multiple values by separating them with a comma or some other trick.

However

Edit after more thought. 

Problems I see with this:

* Don't you risk having multiple intros for David when there should only be one? (Probably it's smarter to use an id field as an incrementor rather than the person's name
* Also, won't you end up with a lot of junk uids? As in, uid 1 would be David, pizza, and the intro text. uid 2 would be David, oranges, and no intro text. 
* * Amanda would be uid 4
* Is there a better solution?",self,t5_2qp8q,1355321611.0,,,True,http://www.reddit.com/r/SQL/comments/14q3ly/mysql_noob_design_question_avoiding_cheating_with/
1355028888.0,14j8ub,"Excluding wildcards from a ""Like"" query",Bloghairy,9,1,8,"I know how to escape individual wildcard characters when doing a search using 'like'. I need to search a column in a table using a string that is input from the user that may contain one or many wildcard characters.

Other than surrounding the incoming string with Replace commands for each possible wildcard
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/14j8ub/excluding_wildcards_from_a_like_query/
1354891752.0,14g1ie,[MS SQL] Difference between &lt;&gt; and !=,rcsAlex,10,3,9,"Is there any difference between using &lt;&gt; and != in MS SQL? In the office I see people using both,self,
1353185697.0,13d7ot,NuoDB elastically scalable NewSQL database releases RC1,gnurizen,10,1,0,,t5_2qp8q,False
1352228430.0,12qs5j,"Cannot create SSPI context in SSMS, *can* telnet to 1433, *can* connect with SSMS using the IP",Tofinochris,8,10, but I'm trying.

Trying to connect to a new server using SSMS gives me ""Cannot create SSPI context"".  I know from past experience that this has something to do with Kerberos so I checked the SQL log and found that the SPN was successfully registered.  I did a bit of random poking at it and found:

1. I can ping the server from the machine running SSMS

2. I can telnet to 1433 on the server from the machine running SSMS

3. I can connect to the server from SSMS if I supply the IP instead of the name.

#3 makes me suspect some DNS issue of course

Any help would be appreciated.  I hate this problem :)

Relevant log bit:

The SQL Server Network Interface library successfully registered the Service Principal Name (SPN) [ MSSQLSvc/herp.derp.org ] for the SQL Server service. 

The SQL Server Network Interface library successfully registered the Service Principal Name (SPN) [ MSSQLSvc/herp.derp.org:1433 ] for the SQL Server service. ",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/12qs5j/cannot_create_sspi_context_in_ssms_can_telnet_to/
1351567460.0,12bie5,Oracle Help - trying to automate a short program,mcdougan,7,0,7,"I just started work two weeks ago and part of my job includes using sql for an oracle server using SQL Navigtor. 

I wrote a code that was supposed to be automated last week but took the lazy route and used trunc(sysdate-1) as the method of pulling the previous days record. 


As I ran the code this morning to send out reports I realized that this will not work on mondays. Is there a way to set a parameter that will change depending on the day?

I was thinking a case statement but it kind of fell apart when I tried to write the code all out.

Thanks!
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/12bie5/oracle_help_trying_to_automate_a_short_program/
1346580970.0,z84iq,DBA Diaries - informative posts from a DBA working with SQL Server and MySQL technology,compchess,8,1,0,,t5_2qp8q,False
1344488648.0,xxauu,Should I learn SQL?,brewsteal,12,6,29,"I have pretty good skills in MS Excel

There have been quite a few job positions that require SQL, would you start learning an alternative?

(From Wiki) A distinction should be made between alternatives to relational query languages and alternatives to SQL. Below are proposed relational alternatives to SQL. See navigational database and NoSQL for alternatives to relational:
.QL - object-oriented Datalog
4D Query Language (4D QL)
Datalog
HTSQL - URL based query method
IBM Business System 12 (IBM BS12) - one of the first fully relational database management systems
ISBL
Java Persistence Query Language (JPQL) - The query language used by the Java Persistence API and Hibernate persistence library
JoSQL[33] - Runs SQL statements written as Strings to query collections from inside Java code.
LINQ - Runs SQL statements written like language constructs to query collections directly from inside .Net code.
Object Query Language
QBE (Query By Example) created by Moshè Zloof
Quel introduced in 1974 by the U.C. Berkeley Ingres project.
Tutorial D
SBQL - the Stack Based Query Language (SBQL)
UnQL - the Unstructured Query Language
XQuery",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/xxauu/should_i_learn_sql/
1335834453.0,t0r48,(Beginner Question),derikd,9,0,4,I'm really struggling understanding functional dependencies and also the three(four) forms of normalization of databases. Anyone have a good video or can explain this to me? I'm getting extremely frustrated.,t5_2qp8q,True
1334555816.0,sc0f0,Help: How to set up a database of drug characteristics? Is it possible to have nested tables?,MSBSpectator,7,0,4,"Hello all

I'm trying to create a database of drug characteristics such as onset of action, side effects, indications for use, contraindications, etc. This will then be part of a searchable web database, hopefully with capability of adding additional drugs via an online form. 

For most of the characteristics, such as side effects, will be tables in their own right because for each side effect, there needs to be a description of the side effect and what to do if it occurs. 

I was initially thinking of using JOIN to link a side effects table with the medications,,False,self,t5_2qp8q,False,,True
1331591195.0,qtkuz,I broke my brain and can't figure this out (grouping),gadorp,10,3,14,"I've got a stored proc and I need to group cases together by client:

     select name, description
     from case c
     left join descriptions d
     on c.caseid = d.caseid
     where date between @var1 and @var2
     and clientid = @var3

The clients will often have several ""descriptions"" under a single case

For some stupid reason I have spent 3 hours on this and cannot get recall what exactly I need to do here.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/qtkuz/i_broke_my_brain_and_cant_figure_this_out_grouping/
1328558427.0,pdkii,Making null fields into empty fields in bulk insert?,gadorp,7,1,6,"For some reason I can't seem to get my empty fields to import as anything but NULL when doing a bulk insert from csv into MS SQL 2008. The column defaults are all ('')

I'm sure I'm missing something incredibly simple/stupid.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/pdkii/making_null_fields_into_empty_fields_in_bulk/
1324306115.0,niima,Best way to learn T-SQL for MS SQL Server?,seiken,10,2,5,"Hello Everyone

At work, so apparently it's Transact-SQL.

As someone who went to school for programming, which can prepare me for something more advanced once I'm comfortable. To give you an idea of my current knowledge and understanding, I struggle with understanding JOINs, and wouldn't be able to write my own stored procedure.

Thanks very much.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/niima/best_way_to_learn_tsql_for_ms_sql_server/
1319081565.0,lib3e,What are some great ideas for sql sample code?,thehof,10,1,5,"I have to provide some sample code and am fairly unwilling to pull just random code I've written while employed because I don't own it... and I think it communicates the wrong message to my interviewer if I do so!

What are some good random ideas for sample code? Give me some ideas

I'm applying for a Microsoft Sql Server position,False,self,t5_2qp8q,False,,,t3_lib3e
1316113878.0,kgt34,Query Help (JOIN ahead),gunkabilly,7,2,5,"For the sake of argument

The information for these manuals is stored in 2 tables:

manual_index

and

manual_content, a page index, the actual page content, and a title.

So I've made a big nasty SQL INNER JOIN query to return all the pages for just the first manual for a specific client:

SELECT CONVERT(TEXT

What's giving me trouble, I just work here, alright?). Is there any way to make this query do ""manual_index.ordinal = (just the lowest one)""? Or do I need to break this into two queries - one on the manual_index that JUST returns the first row ORDERed BY ordinal ASC, then run the second query off the id I get from that (which would probably work, but is using two queries for something I bet can be done with one)?

I don't know how to describe this concisely enough to Google

edit: Typo",self,t5_2qp8q,True,,,True,http://www.reddit.com/r/SQL/comments/kgt34/query_help_join_ahead/
1303840996.0,gxxta,Which is a better join method?,Hactococcus,8,0,9,"So I was wondering which is a better syntax.  Let's say I have Table1 which has a single key and Table2 &amp; Table3 which have multiple keys for each.  All tables share PKey.

So my Select starts off like this:

    Select t1.PKey
    From Table1 t1

Normally I would write the join as such:

    Where
        t1.Key = t2.Key
        t1.Key = t3.Key
        other criteria....

The other day I ran across:

    Where
        t1.Key = t2.Key
        t2.Key = t3.Key
        other criteria...

I'm no expert but I would think creating a many-to-many join would have more processing overhead than two one-to-many joins.

Any opinions?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/gxxta/which_is_a_better_join_method/
1299043951.0,fvlfs,Alternate column alias syntax?,tclas,8,0,19,"Somewhere along the line I picked up this habit for aliasing my column names but I can't seem to find it documented anywhere. I'm worried it might be doing more than just aliasing my columns. Anyone know?

SELECT
   'Total Rows' = COUNT(*)
FROM Table",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/fvlfs/alternate_column_alias_syntax/
1298487649.0,fr7z2,A handy graphical explanation of SQL joins ,expertvoice,13,7,1,,t5_2qp8q,False
1290105859.0,e887e,Looking for feedback regarding my ridiculous project,Abstrct,9,1,3,"So a couple years back I found a neat game called the mysqlgame (www.mysqlgame.com). At least the concept was neat

Thus

After about a year of working on it on and off, but I would love to hear everybody's thoughts on my ridiculous project. 

The projects main site is http://www.schemaverse.com
Documentation can be found on the wiki: http://github.com/Abstrct/Schemaverse/wiki

Anybody who has ever written a proper SQL statement will likely cringe when they see a lot of the code as it is all FAR from optimized. This is because I want to work on optimization after it is stable and then compare results so I can learn more about how Postgres handles different scenarios.
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/e887e/looking_for_feedback_regarding_my_ridiculous/
1376793135.0,1kl2a0,Got an interview coming up. What's a good resource to brush up on T-SQL?,Ein_Bear,7,0,9,"I'm not exactly sure what it will cover,self,
1376639035.0,1kh5ql,Help for a complete noob to look better at work?,Aztec_Mayan,8,2,4,"Hey guys. So at work the data team uses SQL. They are not currently here and I urgently need to pull some stuff from a client. Basically I know how to open the program

I a table called dbo.Cube with millions of rows. One of the columns is called “agent_name” of which there are something like 37


On another table called dbo.Agents are the 37,000 fit into one of the 100. One of those ~100 is called “United”
What I need to do is from dbo.Cube get all the entries where the “agent_name” would fall into the “United” group of dbo.Agents column “LEVEL 1”

Any suggestion? I can imagine that this would be a super basic thing… I am just not knowledgeable at all at this stuff!

Thanks in advance and sorry for being an annoying noob =(
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1kh5ql/help_for_a_complete_noob_to_look_better_at_work/
1375721901.0,1jqzw0,[OBIEE] - Splitting rows into columns?,daniebanes13,7,1,14,"Hi

My original data set looks like this: 

First Name | Last Name  |  System    |  Start Date  |    Role

Mark		Smith	             DOS	      04/13/2010	Admin
Mark		Smith	           Windows	     04/13/2010	Admin
Sarah		Cape	            MAC          05/22/2013	Senior
Sam		Hart	           Windows	    06/21/2012	Admin
Sam		Hart	            MAC	    06/21/2012	Admin

Is it possible to take the multiple rows of data (each system) and place them into columns like such: 
First Name | Last Name  |  System1 |  System2| System3|  Start Dat
Mark		    Smith	       DOS	    Windows		         2010	
Sarah		    Cape				             MAC	
Sam		    Hart		            Windows     MAC	

I am trying to avoid multiple lines of data. Can anyone help me with the coding? 
Thanks 
D
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1jqzw0/obiee_splitting_rows_into_columns/
1375416947.0,1jjmdl,Books/resources for just learning queries?,shinja59,8,2,6,"So I'm a 2012 college grad who has been working at a market research firm for the last year. I've recently decided to switch paths to being a Business Analyst/Data Analyst, so that's what I'd like to really zero in on and become good at.

I've had some exposure to Microsoft Access which I've heard is essentially SQL on training wheels,False,self,t5_2qp8q,False,,,t3_1jjmdl
1374820212.0,1j2zxf,Need help deciphering date/time format,TurdMurder,8,1,4,"Hi all

I just got an Android log app for my phone. Inputting two years of logs on my phone is far too tedious so I found the database file it stores the logs in and loaded up in SQLite on my computer. 

All the data is straightforward

1320125460758 = 10/31/2011

1322202480556 = 11/02/2011

1320734040589 = 11/07/2011

Does anyone have any idea how the date/time is being formatted? Thanks.
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1j2zxf/need_help_deciphering_datetime_format/
1374683564.0,1iyqad,Finding duplicate (aside from one field) records and selecting the appropriate,Grachuus,7,1,12,"I am using a temp table to reduce issues with another SQL statement and in this temp table I'm getting shipping times for various objects.  Sometimes individual objects have multiple ship times.  I only care about the latest date.  How can I ensure my temp table only shows one ship time per object?  In the data sample I get ~106,False,
1373729808.0,1i7yvw,SQL Execution Plans In Javascript,gmsieling,10,3,0,,t5_2qp8q,False
1373481750.0,1i0wf3,Double at (@@) weirdness in SQL*Plus,oddtimed,9,3,2,"Hi guys

Today i was trying to deploy some code into QA using HP DMA. My master script ""A"" was calling other master scripts located in subdirectories which were calling script in other sub directories and I encountered some @@ weirdness.
The folder structure was like this:

    Folder-A
    |
    |___Master-A.sql
    |___Folder-B
          |___Master-B.sql 
          |___B.sql
          |___Folder-C
                |___one.sql
                |___two.sql
    
Master-A.sql

    @@FolderB/Master-B.sql

Master-B.sql

    @@B.sql
    @@Folder-C/one.sql
    @@Folder-C/two.sql

When I exe'd Master-A.sql

When I changed Master-B.sql to:

    @@B.sql
    @@Folder-B/Folder-C/one.sql
    @@Folder-B/Folder-C/two.sql

it could find all the scripts. I have no clue why this happened and have a couple questions

1. Is there any difference in execution between:

        @@FolderB/Master-B.sql 
and

        @@./FolderB/Master-B.sql

2. Master-B.sql could find B.sql, one.sql and two.sql were executed. Why did it find only B.sql and not one.sql and two.sql?

Looking forward to your help and wisdom on this one.",self,t5_2qp8q,1373741242.0,,,True,http://www.reddit.com/r/SQL/comments/1i0wf3/double_at_weirdness_in_sqlplus/
1372782640.0,1hi73q,[MS SQL]Return all records that had taken place within 14 days of the previous at any point in time.,newdaydre,9,4,6,"Greetings and thanks for any assistance.  I'm trying to figure out how to return records for any individual vehicles that took place within 14 days of the previous event for the vehicle.  It is a bit confusing to explain so here is the code.

    SELECT Encounter01.EncounterID, Encounter01.CheckOutDate, Encounter02.CheckInDate AS NextCheckInDate
    FROM RecordsDB.dbo.Encounter AS Encounter01
    INNER JOIN RecordsDB.dbo.Encounter AS Encounter02 
    ON Encounter01.VehicleID = Encounter02.VehicleID AND Encounter02.CheckOutDate BETWEEN (Encounter01.CheckOutDate) AND DATEADD(d
    ORDER BY VehicleID

I don't think it is returning information properly since it seems to me to be returning duplicates or something.

EDIT: Actually I think it is working.  I added Encounter02.EncounterID to the SELECT and it is showing unique EncounterID for each time the overlap occurs.",self,t5_2qp8q,1372783109.0,,,True,http://www.reddit.com/r/SQL/comments/1hi73q/ms_sqlreturn_all_records_that_had_taken_place/
1372729290.0,1hgup2,[MS ACCESS] How do you use an aggregation in a calculated field?,Jolly_Wally,8,1,2,"Hi guys


| ID         | Field1      | Value        |
|:-----------|------------:|:------------:|
| A          |1            |  10 
| B          |2            |  20
| C          |2            |  20   
| D          |3            |  30     

I am aggregating on Field1 with the following sort of query:

SELECT Field1

Producing a recordset such as:

| Field1     | Value       |
|:-----------|------------:|
| 1          |10  
| 2          |20        
| 3          |30  


I would like to extend the query to include a third


| Field1        | Value       | Calculation  |
|:-----------|------------:|:------------:|
| 1          |10           |  Value/SUM(Value)
| 2          |20           |  Value/SUM(Value)
| 3          |30           |  Value/SUM(Value)   

Yielding:

| Field1        | Value       | Calculation  |
|:-----------|------------:|:------------:|
| 1          |10           |  10/60
| 2          |20           |  20/60
| 3          |30           |  30/60    

Is this possible in a single query?

EDIT: Corrected table headers",self,t5_2qp8q,1372738158.0,,,True,http://www.reddit.com/r/SQL/comments/1hgup2/ms_access_how_do_you_use_an_aggregation_in_a/
1372277821.0,1h4qd0,"getting error "" Can not divide by 0""",fa2442,8,1,15,"I am trying to create a field in SQL by diving two of the fields in two different tables

It looks like

TableA.Balance/TableB.Total Revenue

however

Suggestions on how to resolve this?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1h4qd0/getting_error_can_not_divide_by_0/
1371986255.0,1gwk5d,[MS SQL] How to open job,brochaos,6,1,4,"Hey guys, it just opens like a regular query.  Thanks!",t5_2qp8q
1370803117.0,1fzsbl,"Book to learn stored procedures, functions and transactions from",damnated,9,5,http://www.reddit.com/r/SQL/comments/1fzsbl/book_to_learn_stored_procedures_functions_and/, functions

I don't have a specific database in mind, MySQL's etc stored procedures/transactions very different, or are they roughly the same?",,False,self,t5_2qp8q,,http://www.reddit.com/r/SQL/comments/1fzsbl/book_to_learn_stored_procedures_functions_and/
1370714266.0,1fxpm2,[MS SQL] 2012 performance with spatial queries,p2501,9,4,11,"We're pushing the boundaries of what our current configuration can handle with respect to SQL spatial joins and ""windowing"". I've reduced the pagefile size to alleviate some of the sluggishness of interacting with the server via Management Studio and RDP

We're completely virtualized.

Backend:

* VMware vSphere 5.1 U1
* NetApp FAS2240 for storage using NFS

VM:

* MS Windows Server 2008 R2 Standard (8 CPU
* MS SQL Server 2012 Standard
* 8 TB storage
* Databases live on SAS 15K disks

Examples of resource hogs:

* CPU - spatial join of 11 million blocks' relation to nearby points of interest

* RAM - 130 GB table (half is indexes)

We're about to purchase Windows Server 2012 Standard since they've increased the amount of RAM allowed. We're also about to purchase SQL Server 2012 Enterprise so we can utilize the Resource Governor. I don't think there's a way to do active/active MS SQL clustering without doing read-only databases and a lot of headaches.

Something I'll be testing with the new purchases is putting our database volumes directly on the NetApp's CIFS shares

Is there something better that isn't Oracle (money reasons)? Or any SQL optimization tweaks that you've come across in your travels that could possibly increase performance?
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1fxpm2/ms_sql_2012_performance_with_spatial_queries/
1370640218.0,1fw0i0,Suggest SQL Classes?,ryanmcstylin,8,2,5,"Hey everybody
I am starting to work with SQL at my job and want to accelerate my learning.  My company has tuition reimbursement (does not have to be university)

",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1fw0i0/suggest_sql_classes/
1370564170.0,1ftv42,Interview Questions for a Jr. Level SSRS Report Developer,iDrinan,9,2,6,"Hey guys! Next Wednesday I have an interview for a junior level SSRS job, though

I have over a year and a half experience in creating SSRS reports and writing complex stored procedures, but I am worried that I will not be able to articulate when they ask particular questions. I am very much so a hands on person, and I know incredibly well how to DO the tasks and I can work my way around SSMS and BIDS fluently. However, I can't help but worry I'll fumble over my words and not seem as knowledgeable as I really am, or that they'll ask a very simple question and I'll just be dumbfounded while I know the intricacies when it's in front of me.

So

Also

Thanks everyone!",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1ftv42/interview_questions_for_a_jr_level_ssrs_report/
1370550817.0,1ftd54,[MS Sql] [EF] Good or bad design?,sevenalive,8,2,3,,t5_2qp8q,False
1369098053.0,1eqes1,Looking for a SQL tutorial for programmers,Shyntzyne,7,1,12,"I already know how to code in various languages (mainly Java and Python) and feel pretty competent in both the coding itself and the computer science algorithms behind the languages.

I'm looking to learn SQL for my new job. I've never worked with databases before although I feel very comfortable manipulating data and storing in various abstract structures.

Any suggestions?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1eqes1/looking_for_a_sql_tutorial_for_programmers/
1367352995.0,1dfm6b,"I need help removing an entry from my Music Library's .db file, as the entry causes my computer to crash when launching the application. Details inside!",Darkness12,7,1,http://www.reddit.com/r/SQL/comments/1dfm6b/i_need_help_removing_an_entry_from_my_music/

Let me preface by saying I do not know SQL language at all, which is where I need your help!

That little ""Delete Record"" button in the corner does nothing

If it would be easier done by one of you hands-on redditors

Thank you so much for any advice!!

**UPDATE**

I was able to resolve my problem using the following line

     UPDATE Songs SET SongTitle = """" WHERE IDAlbum = 1997

in order to remove the title. I figured out that the problem with the methods that you kind redditors were suggesting was the fact that the Collate for this particular program doesn't work with most SQL readers. This made it so I was unable to DELETE

Thank you all again for the help!",self,t5_2qp8q,1367365516.0,,,True,http://www.reddit.com/r/SQL/comments/1dfm6b/i_need_help_removing_an_entry_from_my_music/
1366140929.0,1chbh7,Is there a postgresql to mysql syntax converter? or can some one help me?,helpprogram2,10,3,2,I have this public [script](https://gist.github.com/sephto/5398895) in postGREsql but it needs to be in my sql. I don't really have too much SQQL background and i'm having trouble changing the syntax,t5_2qp8q,True
1365462142.0,1by84l,[T-SQL] Creating dummy date values in reporting table,randomperson24,8,0,7,"Currently I have my table listed as the doctor
[Here](http://postimg.org/image/xnudgkwu9/)
Based on this example, Mar, July, Aug, Oct 2012 according to the visit’s datetime() value from the original table.  The datetime value was then split apart into the values above through DatePart(year, column) and DatePart(month, column).
The issue I am running into, Jun, Sep, Nov, Dec 2012, than there will be no rows for my reporting table.  Is there a way to create a row for a provider which would create a year and month when there is none present?  I have been trying ISNULL but am having a problem of coming up with a way to use it correctly.
Currently I have
SELECT
	Provider
Datepart(year
Datepart(month
INTO #temp
FROM
	Visit table
GROUP BY 
Provider
Datepart(year
Datepart(month
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1by84l/tsql_creating_dummy_date_values_in_reporting_table/
1364235244.0,1azj65,Invalid Syntax issue with a DB query,lonerangers,7,2,6,"SQL is not even in my skill set. I am helping a client who has an ecommerce platofrm(volusion). They tell me how to do everything [here](http://support.volusion.com/article/export-google-merchant-center).

When I run the query

My guess is that the lines I copy out of there have a comma at the begining of it and there are no ; at the end of lines.

How would I know which lines to end with the syntax?

Sorry for the very basic question. I looked for a volusion subreddit
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1azj65/invalid_syntax_issue_with_a_db_query/
1362854447.0,19zc48,Assistance with T-SQL JOIN?,statuek,7,1,5,"Right now I have two tables

Singles is:
    
    PersonID (PK)
    EventID (FK)
    best
    worldRank

Averages is:

    PersonID (PK)
    EventID (FK)
    best
    worldRank

I'm trying to combine these two tables.
Basically

""Merge is:

    PersonID (PK)
    EventID(FK)
    bestSingle ('best' from Singles)
    bestAverage ('best' from Averages)
    worldRankSingle ('worldRank' from Singles)
    worldRankAverage ('worldRank' from Averages)""

Here's what I have right now.

    SELECT  RanksAverage.[personId]
	RanksAverage.[eventId]
	RanksAverage.[best] AS 'averageBest'
	RanksAverage.[worldRank] AS 'averageRank'
	RanksSingle.best AS 'singleBest'
	RanksSingle.worldRank AS 'singleRank'

    FROM [cubing].[dbo].[WCA_export_RanksSingle] AS RanksSingle

    JOIN [cubing].[dbo].[WCA_export_RanksAverage] AS RanksAverage
	ON RanksAverage.personId = RanksSingle.personId


I'm using SQL Server 2012,False,self,t5_2qp8q,False,,,t3_19zc48
1362598956.0,19sklx,[MySQL] Walk me through this SQLZoo problem?,nakedbitches,6,0,13,"I'm currently stuck on Question 16 [here](http://sqlzoo.net/wiki/More_JOIN_operations).

You may want to read more about the database via the link at the top. Here's the question:

&gt;List all the people who have worked with 'Art Garfunkel'.

Here's the correct query from the answer key:

    SELECT DISTINCT a.name

    FROM actor a JOIN casting b ON (a.id=b.actorid)

        JOIN casting c ON (b.movieid=c.movieid)

        JOIN actor d ON (c.actorid=d.id

            AND d.name = 'Art Garfunkel')

        WHERE d.id &lt;&gt; a.id

I'm just not able to wrap my head around the need for the extra joins or what exactly they're doing. Here was my (failed) attempt at the problem:

    SELECT name FROM actor

        WHERE movieid IN (SELECT movieid FROM actor

            WHERE name='Art Garfunkel' AND actor.id=actorid)   

        AND name &lt;&gt; 'Art Garfunkel'

        AND actor.id=actorid

This query fails to run at all.

PS - For those who are interested I've found SQLZoo very useful,False,self,t5_2qp8q,1362599497.0,,,t3_19sklx
1360700463.0,18eajs,[MySQL] How to join these,pandamaja,7,0,6,"I'm working with a very old mysql 4.0 database.   tableA has two numeric fields 'Num1'

One of the dev's informed that to get 'Num1' you must query tableB as:

    SELECT tableB.text
    from tableB
    where tableB.id = '1'
    and tableB.status = 'A""
    and tableB.value = 'tableA.Num1'

Similarly 'Num2' can be retrieved with an almost identical query by changing the tableid  value

    SELECT tableB.text
    from tableB
    where tableB.id = '26'
    and tableB.status = 'A""
    and tableB.value = 'tableA.Num2'

Is there a way I can return the text definitions for both Num1 and Num2 within a single query? thanks!

*edit - sorry for the crappy non descriptive title.


Solution :


    SELECT b1.text as 'Num1'
          
    FROM tableB b1 
       join tableA a on b1.value = a.Num1
       join tableB b2 on b2.value = a.Num2
    WHERE 
       b1.id = ""1""
    AND 
       b1.status = ""A""
       and a.acct = 'abcdefg'  (table a key)
    
Thanks again for your help!",self,t5_2qp8q,1360704218.0,,,True,http://www.reddit.com/r/SQL/comments/18eajs/mysql_how_to_join_these/
1360436578.0,187d5m,SplendidCRM on FirebirdSQL demo page and database structure,mariuz,7,1,0,,t5_2qp8q,False
1357132508.0,15todi,Are recursive queries actually used in data warehousing or large coorporations?,igotocollege,9,4,21,"I'm a senior master industrial engineer computer science student and i was wondering
I would like to know how this is used in real life or is it just another academical waste of time?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/15todi/are_recursive_queries_actually_used_in_data/
1354726657.0,14bvc1,"Using Case When and Getdate Function(), where to place parentheses?",randomperson24,6,0,http://www.reddit.com/r/SQL/comments/14bvc1/using_case_when_and_getdate_function_where_to/

SELECT

	#Client_Diagnosis.""Client_ID""

CASE WHEN #Client_Diagnosis.""Birth_Date"" &lt; GETDATE()-2189 THEN '0-5'

	WHEN #Client_Diagnosis.""Birth_Date"" BETWEEN GETDATE()-2190 AND GETDATE()-4379 THEN '6-11'

	WHEN #_Client_Diagnosis.""Birth_Date"" BETWEEN GETDATE()-4380 AND GETDATE()-6569 THEN '12-17'

	ELSE 'Older than 18' END AS 'Age_Group'

	#Client_Diagnosis.""Diagnosis""

FROM 

	#Client_Diagnosis

When I run this script I get only 0-5 and Older than 18; '6-11' and '12-17' are not present in the final table.  However,False,self,t5_2qp8q,1354727773.0,,,t3_14bvc1
1351796093.0,12gz0i,Poor C# developer needs some mad SQL skilled help.,AbstractLogic,9,3,9,"Problem. At some point some one or SQL created a .ndf file. Then al shitton of tables had their storage mapped to this .ndf file. Now my company would like me to delete this .ndf file. 

To do so I see that I should run DBCC SHRINKFILE('USERGROUP1'

However this command will only move between files in the same file group. Currently my .ndf and .mdf are in separate file groups. 

Any clues on how to move all the data from the .ndf to the .mdf when they are in different file groups?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/12gz0i/poor_c_developer_needs_some_mad_sql_skilled_help/
1351284577.0,1255q1,Data from XML,Dylan_Ram_Brick,8,2,9,"I have a database that stores a large chunk of XML containing information about installations our companies products. There is no schema defined for the XML and no one has a list of all potential tags.

Each record has hundreds of structures like this:
array type=""DWORD"" name=""m_somesetting.SMTPPorts"" size=""5""&gt; &lt;set&gt;19&lt;/set&gt; &lt;set&gt;1D0&lt;/set&gt; &lt;set&gt;14B&lt;/set&gt; &lt;/array&gt;

I have been asked to create a table showing each possible tag a value and a count of how many of our tens of thousands of records have that particular setting. 

Does anyone know how I might automate this? I have a reasonable understanding of how to do queries against XML but I need some way to first get each tag that exists and then get each unique value that exists and finally a count of records that contain that value. 

Any ideas of how to do this short of hand coding each possible tag into a query?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1255q1/data_from_xml/
1350566200.0,11or7g,"Help me /r/sql, you're my only hope!",Jayzar,8,3,http://www.reddit.com/r/SQL/comments/11or7g/help_me_rsql_youre_my_only_hope/

Am really stuck on a project at the moment and would very much appreciate your help!

I am using SQL Server 2008

I have a table that has a primary key on a uniqueidentifier (no good for clustered indexing then)

I have a clustered index on a column ""CreationDate"" which is a datetime2(7) and has a default value of sysdatetime().


Am getting ""Cannot insert duplicate key row in object"" errors when trying to insert multiple items at once using c#.  They are in the same transaction though

Completely stuck by this and google has been no help at all so far :(


EDIT: When I say ""at once"" I mean in a linear order but one straight after another.

EDIT2: Thank you to everyone who's posted here. I've learned a new thing!  Mission successful :)
",self,t5_2qp8q,1350633094.0,,,True,http://www.reddit.com/r/SQL/comments/11or7g/help_me_rsql_youre_my_only_hope/
1350432471.0,11lmga,"Given no budget constraints, why would I choose mirroring over clustering (MSSQL 2008)",Tofinochris,8,1,http://www.reddit.com/r/SQL/comments/11lmga/given_no_budget_constraints_why_would_i_choose/, unlimited Enterprise licenses

The general need from the folks we're supplying the HA solution to is for automatic failover

I'm having problems finding any reason not just to replace my grid with a giant ""Screw it
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/11lmga/given_no_budget_constraints_why_would_i_choose/
1350405729.0,11ksbk,"open source, cross platform data flow diagramming software?",ashtray_nuke,8,1,http://www.reddit.com/r/SQL/comments/11ksbk/open_source_cross_platform_data_flow_diagramming/,False,
1350397461.0,11kk37,Pull unique records from 2 tables?,jp_pennypacker,7,1,15,"Pretty new to sql and i am having problems figuring out this query
table 1
part number
price
quantity
table 2
part number 
price

I would like to see what part numbers in table 2 are not in table 1?  I've tried using DISTINCT but i'm sure i'm using it wrong as it returns the full runout of parts from table 1 instead of table 2.

Any help is GREATLY appreciated thanks guys!",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/11kk37/pull_unique_records_from_2_tables/
1349662160.0,1147o7,Interview tomorrow. Writing questions to test knowledge before interview and writing queries. Mind taking a look and see where I'm failing?,loki0wn,6,0,5,"Question:
Top 30 product groups, in a shipped to a given zip code.

Query:

SELECT pi.ProductName

FROM

(SELECT pi.productname, RANK() OVER 
(PARTITION BY product group ORDER BY revenue DESC) as rank)

FROM

(SELECT pi.productname
(PARITION BY o.productid) as revenue)

FROM

orders o JOIN productinfo pi ON o.productid = pi.productid

JOIN

ShipToInfo Ship

ON

o.customerid = ship.customerid

GROUP BY pi.productgroup

WHERE ShipToInfo.zipcode = ""44444"" AND rank &lt;= 30

Question 2:

Customers often buy a product and an accessory. However, and only the accessory. Return in a single query.
SELECT 

sum(CASE WHEN o1.productid = ""Product"" THEN 1 ELSE 0 END)

sum(CASE WHEN o1.productid = ""Product AND o2.productid = ""Accessory"" THEN 1 ELSE 0 END)

sum(CASE WHEN o2.productid = ""Accessory"" THEN 1 ELSE 0 END)

FROM

orders o1 RIGHT JOIN orders o2 ON o1.customerid = o2.customerid


Anyone else have questions that could possibly be related to this that I could try?

THANKS!

",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1147o7/interview_tomorrow_writing_questions_to_test/
1347172295.0,zlczj,"MySQL v. PostgreSQL, an apples to oranges comparison",einhverfr,7,1,http://www.reddit.com/r/SQL/comments/zlczj/mysql_v_postgresql_an_apples_to_oranges_comparison/,default,
1345877878.0,ysq4m,SQL Questions (Beginner here),SQLLEARNERRR,8,4,12,"Studying book on SQL and comparing to actual code I am seeing and wtf I have tons of questions. Let's take the following code for example:
( case when (select  w.PRIMARY_ASSIGNMENT_FK from worker_edition w where v.WORKER_EDITION_ID = w.WORKER_EDITION_ID) = WORK_ORDER_ASSIGNMENT_NUMBER then 'Y' else 'N' end)

why do some of the column names have ""w"" and then there are floating w's

This is form an Oracle db.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/ysq4m/sql_questions_beginner_here/
1344262749.0,xrl5m,"It's not that complicated Google, it's only SQL..",imdsm,20,15,http://www.reddit.com/r/SQL/comments/xrl5m/its_not_that_complicated_google_its_only_sql/,http://b.thumbs.redditmedia.com/XYW3WXZh-1Dzv_1I.jpg,
1340910442.0,vr6zg,I need a crash course in the basics of SQL database management before an interview Monday,Esparno,17,13,23,"I have an interview for a tier 1 support position working with SQL databases and need some recommended reading/viewing to cram with or at least learn some basic syntax.

They do in-house training and I intend on using the almighty google to look myself

Any help would be appreciated.

EDIT: Derp I am now reading the stuff on the sidebar.",self,t5_2qp8q,1340910855.0,,,True,http://www.reddit.com/r/SQL/comments/vr6zg/i_need_a_crash_course_in_the_basics_of_sql/
1339587179.0,uznv6,MSSQL Table Variable vs. Temporary Table.. Nerdyness at its best :),wokawaka,7,0,7,,t5_2qp8q,False
1339451141.0,uwtlm,MSSQL Junior BI Developer Interview on Friday. What should I be reading up on?,chainofoli,7,0,12,"So I have an interview for a junior BI developer position on Friday. I've been working as a trainee dba for 6 months for a company that does everything wrong when it comes to database administration/development (not the DBA's fault

I'd say I'm competent with my query knowledge for 6 months experience (selects, sub-queries). I have a little knowledge in transactions, stored procedures, XML and I'm studying towards taking my MCTS exam. I have never used SSIS or SSAS but know my way around SSRS. The company takes the Kimball approach to data warehousing and although I understand the concept I haven't worked with a data warehouse before. BI is the path I want to go down and this job will give me a massive amount of valuable experience.

So Reddit,False,self,t5_2qp8q,False,,,t3_uwtlm
1334990758.0,sl05m,Never ever touch a programmer,Andrey_Karpov_N,10,3,2,,t5_2qp8q,False
1332270770.0,r5hdn,[Access] Question on filtering Query results,NkafKe,6,1,4,"I have 3 tables involved (Leads

The Leads table consists of five columns: Agent_ID (which corresponds to the Agent table), and End_Date (not used here).  There's also Lead_ID which is used for the Primary Key, but not much else.

An agent is given X amount of leads every X amount of days

I can bring up just the most recent dates

Later I run this through another query which pulls up Application data based on the Received_Date

I have a basic understanding of databases

Any help is greatly appreciated.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/r5hdn/access_question_on_filtering_query_results/
1329491414.0,ptxbx,1million records of Spatial Data with Postgre and PostGIS,mexitek,7,0,2,,t5_2qp8q,False
1329232034.0,pp59n,MS-Access SQL : multiple where statements,KingZing,7,1,6,"Quick question as I'm fairly new to using SQL.

I want to show results that do not meet critiera
For example (would be 9 or 10 of these)

* If field1 = 1000 and field 3 &lt;&gt; 302000123 then report result


* If field1 = 2000 and field 3 &lt;&gt; 230300030 then report result


* If field1 = 2500 and field 3 &lt;&gt; 002390400 then report result

**EDIT**
Awesome

it ended up being multiple nested iif statements as access didn't allow case statements.

Thanks again for the help",self,t5_2qp8q,True,,,True,http://www.reddit.com/r/SQL/comments/pp59n/msaccess_sql_multiple_where_statements/
1313509905.0,jkk45,SQL Server - Is it possible to view/modify a SP from TSQL? ,xstockix,6,0,3,"I am responsible for a single DB on an instance with several DB's. My security access prevents me from seeing anything in the Object Explorer. I need to make a small syntax change to a stored procedure. I'm wondering if it's possible to pull up the Modify SP script using TSQL. 

Thanks in advance!",self,t5_2qp8q,True,,,True,http://www.reddit.com/r/SQL/comments/jkk45/sql_server_is_it_possible_to_viewmodify_a_sp_from/
1294585714.0,eyz99,Good SQL learning materials?,,6,0,5,I want to learn SQL. I know a little about databases but would like to get some SQL learning in. Should I work on DBs then move to SQL?,t5_2qp8q,True
1291785427.0,ei3r0,New SQL Dev - struggling with larger queries,sqldev34,6,0,13,"Hi all

I've recently started my first SQL programming job

One of my first tasks has been to fix a report which has a query with approximately 10 joins, and imagining the result set at each of the joins, however once I get past four or five, I lose it. 

Surely there has to be a better way to understanding how a query works than stepping through TABLE1 INNER JOIN TABLE 2 ON TABLE1.PK= TABLE2.FK INNER JOIN TABLE3 AS TABLEX ON TABLE2.PK=TABLE3.FK INNER JOIN TABLE4 ON TABLE3.PK=TABLE4.FK etc.?

Does anyone have any advice on how to picture/comprehend the result-set (tablespace) for a larger query? How do people who write queries with ~10 joins and large numbers of aliases comprehend what they're doing?

I'm thinking it could require a higher cognitive or IQ aptitude than I possess

For reference, but the work I'm being given feels like it's going to be very difficult for me to achieve. 

My manager's in meetings most of the day, and feel scared to admit that I can't do this work at the moment. I've let my manager know I'm having trouble.

I know what each join is

Does anyone have any advice on how I can get to grips with larger SQL queries (with subqueries),False,self,t5_2qp8q,False,,,t3_ei3r0
1273850239.0,c43su,Checking for a live database connection considered harmful,Samus_,6,0,0,,t5_2qp8q,False
1265930041.0,b11a5,Top 10 Reasons Why Access Still Doesn't Rock,cruise02,7,0,5,,t5_2qp8q,False
1255540673.0,9u108,SQLite Foreign Key Support,,8,1,0,,t5_2qp8q,False
1376959055.0,1kp9tq,is it possible to query 2 separate items in 1 query?,whoisearth,6,1,6,"I'm trying to figure out how to do this.

Basically what I have is a database where some items drill down 3 levels.

Think of it like so - 

ID  prntid Name  DateTime
23452 NULL Item1 Time
23456 23452 Item2 Time
23459 23456 Item3 Time

What I want to do is give me the info for Item1  with the Time from Item3.

Unfortunately you can't do something like - 

SELECT ID

If that makes sense

I know it could be done by selecting the time and associating it with the prntID as the ID and then doing it again associating the time with the prntID again (to get to the top level) but then I'm making 3 temp tables just to get the data I want into one table.  PITA but it works.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1kp9tq/is_it_possible_to_query_2_separate_items_in_1/
1375801592.0,1jtc71,[MS SQL] Where 'last week',YouGiveSOJ,7,2,5,"I have a where clause here which returns all BLANK with a date within last week. It works, then said

Does anyone want to take a crack at explaining how?

    WHERE 
       ReturnDate &gt;= dateadd(day,0,dateadd(day,-1*datepart(weekday,getdate())+1,dateadd(week,-1
    AND ReturnDate &lt; dateadd(day,0,dateadd(day,7,dateadd(day,-1*datepart(weekday,getdate()),-1,self,
1375668968.0,1jpr55,I'm moving from MySQL to PostgreSQL with PHP as a backend. I need a little direction.,Tcullen1121,6,2,2,"I'm making the move to cut the cost of distribution as low as possible on my web application. I'm still learning quite a bit as a programmer and don't really have a full grasp on everything to begin with as I have just been having to pick up learning so much so fast at this point with only 5 months of development and a full time job

I was using mysqli prepared statements and I'm looking for the closest equivalent in pgsql. Is PDO using prepared statements my only option? I'd like to avoid escape strings as well.

If PDO is my only option where is the best place to get started aside from php.net?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1jpr55/im_moving_from_mysql_to_postgresql_with_php_as_a/
1375241288.0,1jeby6,"[MS SQL] Need help turning rows of varchar data into columns (similar to PIVOT, but with text)",ITAndrew,5,1,http://www.reddit.com/r/SQL/comments/1jeby6/ms_sql_need_help_turning_rows_of_varchar_data/

    Item_ID
    ITEM1
    ITEM1
    ITEM2
    ITEM3
    ITEM2

There is a maximum of four Tag records for one Item. I want to get the result set below:

    Item_ID, TAG3, TAG4
    ITEM1, NULL, NULL
    ITEM2, NULL, NULL
    ITEM3, NULL

I have done this previously by creating a temp table with an ID column and the structure of the second table, updating the rows in the second where the second table's Item_ID matches the first's, but there isn't an existing Tag field with the value for that Item_ID.

The problem with this solution is it means looping through the first table, which is very resource intensive. I've looked at the PIVOT command, but I can't find any samples with varchar values (the samples I've seen all have some sort of aggregation/count which I can't see how to adapt).

Does anyone know any more efficient ways of doing the above transformation?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1jeby6/ms_sql_need_help_turning_rows_of_varchar_data/
1374878553.0,1j4lkc,08 R2 Query index fragmentation with names,killer833,6,2,5,"Ok

&gt;

SELECT object_id AS ObjectID

  index_id AS IndexID

  avg_fragmentation_in_percent AS PercentFragment

  fragment_count AS TotalFrags

  avg_fragment_size_in_pages AS PagesPerFrag

  page_count AS NumPages
   

FROM sys.dm_db_index_physical_stats(DB_ID(N'DatabaseName')

  NULL, 'DETAILED')

WHERE avg_fragmentation_in_percent &gt; 20

ORDER BY PercentFragment,,False,self,t5_2qp8q,False,,True
1374253984.0,1in4vh,help running querie off of linked tables,fareaf3,6,2,7,"ok.... I have two tables and I need to create a join between the two based on Reference Numbers.

however

the reference numbers in table B are in number format.

I get a type mismatch expression when i try to run this query in access.

these tables are linked from other databases and i do not have access to go in and modify the table paramaters.

is there any way around this rather than making a copy of one of the tables every single time i run this query

",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1in4vh/help_running_querie_off_of_linked_tables/
1373821570.0,1ia7u1,Looking for pl/sql practice,mrdedwardel,9,4,3,"This sub has helped me once before and I hope to contribute in a meaningful way in the future but for now I come seeking answers.  Here goes, create and execute triggers just to keep practicing?  I will still be able to access the server used in class until mid August but after that nothing.  I am using oracle client and sql tools.  Any help is greatly appreciated!
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1ia7u1/looking_for_plsql_practice/
1373390945.0,1hy3c1,[MSAccess] Can anyone help with my code?,daniebanes13,7,2,5,"I am dealing with 3 dates - If date1 is null use date 2, [MILESTONES]![Date3]

Thanks in advance",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1hy3c1/msaccess_can_anyone_help_with_my_code/
1371866876.0,1gu18w,Using SQL in econometric analysis,Loonga,6,0,3,"Hi

Thanks a million",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1gu18w/using_sql_in_econometric_analysis/
1371085238.0,1g8j3m,"Looking to learn, didn't know if you guys had any links or a wiki provided for resources...",mistawac,10,5,http://www.reddit.com/r/SQL/comments/1g8j3m/looking_to_learn_didnt_know_if_you_guys_had_any/

Any recommendations?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1g8j3m/looking_to_learn_didnt_know_if_you_guys_had_any/
1370249224.0,1fkklq,I'm looking for a SQL PL tutor,xCHRISTIANx,6,2,4,"Hello,False,
1369922990.0,1fc4uw,[MySQL] Help with calculating totals and ordering in a single query,Dicko21,5,0,7,"Hi all

I've created [this](http://i.imgur.com/nG8JRhe.png) picture to better demonstrate my point as I probably can't word too good after spending hours with this problem. The gist of it is that I have 4 (3?) tables that I need to join with each other in order to gather a total to sort by

Any help would be hugely appreciated - if you need any more info from me please let me know.

Cheers!",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1fc4uw/mysql_help_with_calculating_totals_and_ordering/
1369869074.0,1fau1f,Calculate Mortgage Payment (SQL Server 2008),kci-04,6,0,1,"Hi SQL Guru's... For my job I have been assigned the task of converting a legacy program/report from SAS into our SQL Server environment. I've been successful thus far
Below is a sample from the SAS documentation:

&gt;In the following statement
    payment=mort(50000,30*12);
The value that is returned is 438.79 (rounded). The second argument has been set to missing

Syntax
MORT(a,n) - the period(.) in sas is the same as NULL.
Arguments
a=is numeric
p=is numeric
r=is numeric
n=is an integer

Any thoughts? 
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1fau1f/calculate_mortgage_payment_sql_server_2008/
1369830687.0,1f9ja4,"SQL string help, oh masters of the database!",shemp5150,6,0,http://www.reddit.com/r/SQL/comments/1f9ja4/sql_string_help_oh_masters_of_the_database/

I'm trying to remove 3 characters from a column within a table.   The three characters are all the same, so I'd like to automate it instead of manually doing it. Any help with this would be immensely appreciated!

*edit* Also,False,self,t5_2qp8q,False,,,t3_1f9ja4
1369487546.0,1f10dc,[Oracle] Joins question,almost665evil,5,0,6,"I am still new to SQL. I am using the SQL Developer to query Banner

If I am joining Table A with Table B and then also with Table C,False,self,t5_2qp8q,False,,,t3_1f10dc
1369261788.0,1ev54k,What is the easiest way to transfer Excel data to MS SQL Server?,yellising,6,0,27,"Seeing as they are both MS products

Thanks,False,self,t5_2qp8q,False,,,t3_1ev54k
1368906925.0,1elbwq,An online tool to build simple tables and test SQL statements,kuszi,6,0,2,,t5_2qp8q,False
1368332695.0,1e6258,[MS SQL] Need help optimizing a SELECT query that pulls from some huge tables.,mcraamu,7,0,12,"SQL 2005. 

Almost every one of the tables called has more than 20 million rows in each table. All of the columns referenced have some sort of index on them. 

This query takes hours to run. I'm hoping to improve the run time to &lt;1 hours rather than 5+. Any advice would be appreciated

    SELECT DISTINCT
    LBTS.LoadNum AS LoadNum
    LBTS.StopSeqNum AS StopSeqNum
    LBT.CustomerCode AS CustomerCode
    C.Name AS CustomerName
    FROM
    dbo.LoadBillToStops LBTS(NOLOCK) --55 million rows
    INNER JOIN
    dbo.LoadBillTos LBT (NOLOCK) ON LBTS.LoadNum= LBT.LoadNum AND LBTS.BillToSeqNum = LBT.SequenceNum --24 million rows
    LEFT OUTER JOIN
    dbo.Stops ST(NOLOCK) ON LBTS.LoadNum= ST.LoadNum AND LBTS.StopSeqNum = ST.SeqNum --50 million rows
    INNER JOIN
    dbo.Warehouses WA (NOLOCK) ON ST.WarehouseCode = WA.CompanyCode -- 6 million rows 
    INNER JOIN
    dbo.Customers C (NOLOCK) ON C.CompanyCode= LBT.CustomerCode -- 850K rows
    INNER JOIN
    dbo.LoadMatch LM(NOLOCK) ON LBTS.LoadNum= LM.LoadNum -- 20 million rows
    INNER JOIN 
    dbo.Loads LD(NOLOCK) ON LM.LoadNum= LD.LoadNum -- 21 million rows
    INNER JOIN
    dbo.PBBARegion PBAR (NOLOCK) ON -- 0 rows
    (LM.CustomerBranch = PBAR.BranchNumber
    OR
    LM.CarrierBranch = PBAR.BranchNumber
    OR
    LD.ControlBranchCode = PBAR.BranchNumber)
    INNER JOIN
    dbo.PBBADateRange PBADR (NOLOCK) ON -- 1 row
    (LD.EnteredDate BETWEEN
    PBADR.StartDate AND
    PBADR.EndDate
    OR
    LD.UpdatedDate BETWEEN
    PBADR.StartDate AND
    PBADR.EndDate
    OR
    C.UpdatedDate BETWEEN
    PBADR.StartDate AND
    PBADR.EndDate
    OR
    WA.UpdatedDate BETWEEN 
    PBADR.StartDate AND
    PBADR.EndDate)
    AND
    LM.LoadStatus = 90
    AND
    LM.Condition &lt;&gt; 'X'
    AND
    LM.Condition = 'F'
    ",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1e6258/ms_sql_need_help_optimizing_a_select_query_that/
1368129785.0,1e0t30,"Is it possible to make this query? Seems simple, but I can not figure it out.",BusinessBoy38,5,2,http://www.reddit.com/r/SQL/comments/1e0t30/is_it_possible_to_make_this_query_seems_simple/
Two tables

Table  (A) has three fields- (1) Billing Item  (2) Fee  (3) Status(Price or Tax)

 Billing item shows up twice. Once with a Tax Status and once with a Price Status.  


Table (B) has two fields. (1) Billing Code. (2) Fee

This billing code matches the billing code from Table (A).  However

The Fee in table A was a grand total of every product bought.  And the Fee in table B is a single products price which is always different.

I want to make a query that looks like this

Billing Code------Sum Table A FEE--------- Sum Table B Fee


the two fee columns should sum to 0.

I will be doing more than this at the end,False,self,t5_2qp8q,False,,,t3_1e0t30
1367112973.0,1d8ys8,[Oracle] Getting multiple errors. Any kind of help would be greatly appreciated.,Windrider,5,0,5,"I'm trying to use a subquery to join two tables. I think that it's the last part of the subquery where I'm getting all of my errors. I want to be able to find out if the current date is 14+ days past the date recorded in the ""BILL_DATE"" column. I'm pretty new at this so all of this could be completely wrong. Anything would be appreciated.    

The code that I have:    
      
    UPDATE CUSTOMER    
    SET CUS_STATUS = 'INACTIVE'    
    WHERE CUS_ID IN(    
                    SELECT CUS_ID    
                    FROM BILLING    
                    WHERE BILL_STATUS = 'OPEN'    
                    AND SYSDATE() &gt;= DATEADD(day 14
);    
Edit: Using Oracle Database 10g Express Edition.
            ",self,t5_2qp8q,1367116461.0,,,True,http://www.reddit.com/r/SQL/comments/1d8ys8/oracle_getting_multiple_errors_any_kind_of_help/
1366826435.0,1d0v5f,SSIS - help passing date parameters to SQL Task,mmohon,6,1,6,"I'm about to beat my head up against the wall over this

I've got an Insert query I need to run to update a table

My connection type in SSIS is an OLE DB.
I have both variables mapped to DATE type parameters called 0 &amp; 1

In my query I've tried:

WHERE DDATE Between ? AND ?;

I've also tried:

Declare @StartDate Date

Declare @EndDate Date 

Set @StartDate = ?

Set @EndDate = ?

WHERE DDATE Between @StartDate AND @EndDate;

I keep getting parse errors,False,self,t5_2qp8q,False,,,t3_1d0v5f
1365631039.0,1c3cft,[MS SQL] Beginner COUNT question,lazerus,7,1,7,"So I'm just starting to learn and am having some trouble coming up with some totals. I have a Table Main with columns for TaskID

    SELECT ModuleID
    FROM AmsTaskMain
    WHERE Priority = 'U'
    GROUP BY ModuleID
    ORDER BY 'Total Tasks' desc
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1c3cft/ms_sql_beginner_count_question/
1365608544.0,1c2h1r,Displaying all stores that have above the average amount of employees?,S-Q-L,6,3,14,"I am new to SQL so I apologize ahead of time if there is a simple answer to this. We have been discussing functions in class

There are two tables involved: Employee and Store. Employee has within it the store ID. What I had in mind was this:

SELECT *

FROM Store

WHERE Count &gt; (SELECT AVG(Count));

I know this is wrong,False,self,t5_2qp8q,1365610612.0,,,t3_1c2h1r
1365533307.0,1c08s6,Question about splitting SQL,CodingCarpenter,6,1,6,"Hello everyone

So finally we come to splitting the file. I used a program to hack it down to roughly 15MB files the original being 178MB. I start importing them but its saying I have duplicate entries on every single one I try to upload.

Is there a better way to split these files up? Or a program a bit better at its job than sql_splitter? I just need this database up and running...",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1c08s6/question_about_splitting_sql/
1365458313.0,1by2va,Conversion Failed[MS SQL],tedistkrieg,5,1,5,"I have an automated sql reporting server report that runs Monday-Friday.  It has worked fine until today. I ran the SQL script and I keep getting this error     

    Conversion failed when converting the varchar value '5
    data type int.

Nothing has changed from Friday to Today so I have no idea why its doing that. Any ideas?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1by2va/conversion_failedms_sql/
1365034410.0,1bmjr3,How to use IS NOT in a join?,ExceptionallyStrange,6,1,15,"For this problem I have 2 tables I'm using. This query needs to use SELECT to find any auctions that didn't receive any bids. 

The tables and columns used for this query are ""AUCTION_ITEM"" with the columns ""itemName"" and ""itemDescription"" and table ""BID"" using column ""bidAmount""

The tables are joined via the key column ""itemID""

This is what I have tried:

SELECT AUCTION_ITEM.itemName

FROM AUCTION_ITEM 

JOIN BID
ON AUCTION_ITEM.itemID=BID.itemID

WHERE AUCTION_ITEM.itemID NOT IN BID.itemID

GROUP BY itemName


//My understanding for this query to work

Can anyone tell me what I'm doing wrong?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1bmjr3/how_to_use_is_not_in_a_join/
1364403899.0,1b4bf1,Lost in Integers - DATETIME and Latitude/Longitude,I_637261636b_bits,5,0,7,"Ok Reddit
  
I am building a down and dirty OpenOffice Calc operation in order to quickly convert the text files into a SQL INSERT line.  
However
  
I don't need/want to know how to do this via SQL
  
Here are some examples:  
**SQL Value : Text Field**  
1359014801 : 08:06:41  
1359014886 : 08:08:06  
  
13993000 : 353131N  
126044000 : 0350044E  
  
  
ANY and ALL help is appreciated. I apologize if I didn't use the proper terminology,,False,self,t5_2qp8q,False,,True
1364225222.0,1az6m0,[MS SQL] collapsing multiple records into one,pennywaltz,5,0,7,"I am very new and inexperience with SQL. I need help!   So I have appointment data and I have counted all my appointments for each person and created a table.

    id	type		count
    
    1	canceled	55
    
    1	no show		10
    
    1	show		5
    
    2	canceled	40
    
    2	no show		15
    
    2	show		22

So with this table above

    id	canceled	noshow		show
    
    1	55			10			5
    
    2	40			15			22

At first, it would work, but it didn't. I am unsure how would I do this. I am thinking perhaps merging it a few times by each appointment type. BUt I am not sure.

I am hoping someone can provide me some guidance!


    ",self,t5_2qp8q,1364244040.0,,,True,http://www.reddit.com/r/SQL/comments/1az6m0/ms_sql_collapsing_multiple_records_into_one/
1364154679.0,1axg7s,[SQLITE] Creating new databases,iarcfsil,6,0,1,"Hey folks

Anyways

But when I try to run the command `ex1.db &lt; ex1.sql` I get an error saying that `ex1.sql is not a file in the directory`

I'm confused as to how to create the `.sql` file since it's never explained in the introduction or the [first lesson](http://sql.learncodethehardway.org/book/ex1.html). 

Any help would be appreciated.

Also,False,self,t5_2qp8q,False,,,t3_1axg7s
1363817473.0,1aoxd7,[MSSQL] Just a bit of bother with a Query ,SeniorNoob,5,0,4,"Just a Query that I have been stuck with for the past couple of hours.
I am using MS Access at the minute to do my sql queries in if that makes a difference.

Here is a picture of the table Im doing :- [Table](http://i.imgur.com/ZQQJslF.png)



So what I have to do is use select statements to show each unique album name

    SELECT AlbumName
    FROM Tracklists
    GROUP BY AlbumName;

So I know this may be a rookie question but any help will be greatly appreciated. ",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1aoxd7/mssql_just_a_bit_of_bother_with_a_query/
1363810868.0,1aooe1,[MS SQL] Need some help on a query...,tehxeno,8,3,3,"I have two tables:

    Appointments 	(CustomerID,Status,AppointmentDate)

    ResultedSales	(CustomerID

I am looking for records in Appointments where:

1. 	The status is resulted(As opposed to pending, etc)
2. 	The Customer has been sold to previously (CustomerID in ResultedSales)
3. 	The Appointment was not resulted as a sale (AppointmentID not in ResultedSales)
4. 	The Appointment occurs after the first time the customer was sold to  
(AppointmentDate &gt; AppointmentDate of the smallest AppointmentID record in ResultedSales for that CustomerID)
5. 	The SalesRep who was assigned to the appointment is the same as the previous sale  
(SalesRepID = SalesRepID of any AppointmentID record in ResultedSales for that CustomerID)

The first three are achieved with 

    Select Distinct .AppointmentID from Appointments A
        join ResultedSales RS on A.CustomerID=RS.CustomerID
	Where A.StatusID='resulted'
	And A.CustomerID in (Select CustomerIDfrom ResultedSales)
	And A.AppointmentID Not in (select AppointmentID from ResultedSales)


But I cannot figure out how to achieve #4 and #5

Any help/tips?
",self,t5_2qp8q,1363812461.0,,,True,http://www.reddit.com/r/SQL/comments/1aooe1/ms_sql_need_some_help_on_a_query/
1363708553.0,1aljqi,[IDE Suggestions] Switching from Rapid SQL,TurboGranny,9,3,30,"We have been using Embarcadero Rapid SQL and Embarcadero DB Artisan for several years at my company, Oracle 9i - 11g, but only Oracle and MSSQL are of serious consequence.

We are a free hand SQL shop, and function/procedure editing are a must.  Code hinting, code generators, and live table editors are appreciated.",,False,self,False,t3_1aljqi
1363374070.0,1ad643,[PostgreSQL] COALESCE with GROUP BY?,PavementBlues,5,0,5,"Hi all. I was wondering if anyone else has encountered issues with using COALESCE in a grouping statement.

Here is what I'm working with:

    SELECT 'Controlled - HbA1c &lt; 7' AS group_name
        coalesce(round(avg(v19_g1_rate) *100,
        coalesce(to_char(sum(v19_g1_count),999,999'), '0') as formatted_count,
        1 as order_id
    FROM hca.v19_org_grouped_data
    JOIN kali.dat_date AS start_date
          ON start_date.dat_uid = v19_dat_uid_start
    JOIN kali.dat_date AS end_date
          ON end_date.dat_uid = v19_dat_uid_end
    WHERE /* Lots of irrelevant stuff */
    GROUP BY v19_dat_uid_start
    ORDER BY v19_dat_uid_start desc
    LIMIT 1

My problem is the no data condition. When I run this without the GROUP BY, the COALESCE is rendered ineffectual.

Does anyone know how to get around this? Thanks!",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1ad643/postgresql_coalesce_with_group_by/
1362523141.0,19qib3,MIN is actually giving me MAX?? help ,sports89,5,0,8,,t5_2qp8q,False
1359270184.0,17cykk,SQL on mac OS,uptothetop,7,2,6,"Hi

I currently use sql fairly often at work and I am looking to improve my skills.  I often result to writing simple queries and then performing the rest of the analysis in excel.  I would like to try to avoid some of this by doing more with sql.

**QUESTION**:

Is there any type of software that I can use on **MAC OS**?  Something that I can:
1.  Make my own database/schema with my own play data
2.  Run queries and the like on this data that I can add/edit/delete

My knowledge is not the best but I feel I have a solid foundation and in order to get better I would need hands on experience.  Thanks",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/17cykk/sql_on_mac_os/
1357592229.0,1651s2,[MSSQL] How do I select rows where multiple items of a list are present?,black27696,6,0,9,"Database containing sales for stores. I need to know every ticket where at least two of the items in {1, 5

I'll figure out the structure, so I need to know every time that at least two items in my list have appeared.

I'm just not well versed enough in sql to know how to set up a clause that translates to ""at least two of these""",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1651s2/mssql_how_do_i_select_rows_where_multiple_items/
1356934457.0,15pnk8,Looking for a prof online SQL class that goes at your own pace. ,lksdford,8,3,3,My work has $1250 that I can use until 12/31/12 for a SQL class that would need to start by that day. Any ideas for online classes that I could start on 12/31/12?,t5_2qp8q,True
1356375220.0,15duw3,"Certified peoples of sql, how hard was it for you?",LeTroniz,9,5,http://www.reddit.com/r/SQL/comments/15duw3/certified_peoples_of_sql_how_hard_was_it_for_you/

How hard is say,False,self,t5_2qp8q,False,,,t3_15duw3
1356315365.0,15cq49,[MS SQL] - Some newbie questions regarding SQL 2008R2 views,DickPuncht,7,1,6,"I've been tasked to do a development project which requires me to learn SQL in a very short time on a tight schedule.   What I'm trying to do is create a View which will display a subset of data from a table.

The table contains a foreign key which references an ID of a user from another 'users' table.   My question is

This is hard for me to describe so please let me know if you need clarification on this question.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/15cq49/ms_sql_some_newbie_questions_regarding_sql_2008r2/
1356034436.0,156nk4,"[Oracle] to [MS SQL] trigger question.
",1,10,http://www.reddit.com/r/SQL/comments/156nk4/oracle_to_ms_sql_trigger_question/,"I am trying to write a trigger in MS SQL that will populate the empty date field with the current date when the rest of the record is inserted. I would do something like this in oracle.

    BEGIN
       -- Update create_date field to current system date
       :new.create_date := sysdate;

__________________________________________

This is what I have for MS SQL but it is updating other rows that were already in the table too. 

    Update R0_J
    Set InDate = DATEADD(dd, 0, GETDATE()))
    FROM R0_J  join inserted 
    on R0_J.NAME = inserted.NAME
",self,t5_2qp8q,1356037054.0,,,True,http://www.reddit.com/r/SQL/comments/156nk4/oracle_to_ms_sql_trigger_question/
1355957742.0,154unz,Line length issues for SQL 2012,jennym123,6,1,12,"I'm trying to learn SQL Server 2012 by doing a little project involving creating a database for monsters from the d&amp;d monster manual. 

I set up the same thing in MySQL but I'm having some troubles with length allowed by the individual columns. 

One of the columns is supposed to be a short description of the monster in question. To compensate for this I made the character limit 1000 characters. 

I get the whole thing set up and the one issue I'm having is that SQL Server has imposed it's own length of 128 characters. 

I know how to change the character limit to higher but I'd like to know is if it'll work. If it doesn't work

EDIT&gt;&gt; For those of you who wanted to see what I used to set up the table:

CREATE  TABLE rawmonsters (

  Name varchar(50) NOT NULL 

  CR DECIMAL(10

  xp DECIMAL(10

  race VARCHAR(max) NULL 

  class VARCHAR(max) NULL 

  monsterSource VARCHAR(max) NULL 

  alignment VARCHAR(max) NULL 

  size VARCHAR(max) NULL 

  aType VARCHAR(max) NULL 

  Subtype VARCHAR(max) NULL 

  aInit DECIMAL(10

  Sense VARCHAR(max) NULL 

  Aura VARCHAR(max) NULL 

  AC DECIMAL(10

  AcMods DECIMAL(10

  HP DECIMAL(10

  HD DECIMAL(10

  HpMods VARCHAR(max) NULL 

  Saves VARCHAR(max) NULL 

  Fort DECIMAL(10

  Ref DECIMAL(10

  Will VARCHAR(max) NULL 

  SaveMods VARCHAR(max) NULL 

  DefensiveAbility VARCHAR(max) NULL 

  DR VARCHAR(max) NULL 

  Immune VARCHAR(max) NULL 

  Resist VARCHAR(max) NULL 

  SR VARCHAR(max) NULL 

  Weakness VARCHAR(max) NULL 

  Speed VARCHAR(max) NULL 

  SpeedMod VARCHAR(max) NULL 

  Melee VARCHAR(max) NULL 

  Ranged VARCHAR(max) NULL 

  aSpace VARCHAR(max) NULL 


  Reach VARCHAR(max) NULL 

    PRIMARY KEY (Name) )


",self,t5_2qp8q,1356062567.0,,,True,http://www.reddit.com/r/SQL/comments/154unz/line_length_issues_for_sql_2012/
1355858629.0,152d3z,[MySQL] Learning MySQL: Need some advice on practice,phamilyy,5,1,2,I just recently started learning mysql. I have had a little experience prior when I was still in school but am looking up to sharpen my skills for a job.  I setup ubuntu and installed mysql server/mysql workbench and have loaded up sakila sample database.  Does anybody know where there are sample questions that uses the sakila sample database as a basis?  Questions that will test me on my knowledge of sql.  Any help will be appreciated.,t5_2qp8q,True
1355759397.0,14zwhw,[MS SQL] need help selecting certain records on a SELECT statement,Geig,8,3,11,"so

i am a newbie with SQL

i am trying to use a current table in our SQL server

for some reason

is there a way to only select employee numbers that are &lt;700 and &gt;2500??

",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/14zwhw/ms_sql_need_help_selecting_certain_records_on_a/
1355507280.0,14uogy,[TSQL] question with SSRS reports,randomperson24,6,0,8,"Does anyone know if it is possible to view a SSRS report outside a network,self,
1355378968.0,14rttx,"[MSSQL] Questions about ""Exam 70-461:
Querying Microsoft SQL Server 2012"" Certification",1,7,http://www.reddit.com/r/SQL/comments/14rttx/mssql_questions_about_exam_70461_querying/,"I don't have much if any MSSQL experience, but I want to get the MCSA: SQL Server Solutions Associate certification. 

There's no guidance for prep on the Microsoft website except for the ""10774: Querying Microsoft SQL Server 2012"" course which costs upwards of $2

Sorry if I'm posting incorrectly.

Thank!",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/14rttx/mssql_questions_about_exam_70461_querying/
1354803336.0,14dtmu,[Oracle] join where only multiple matches exist,borensoren,5,0,5,"(I'm exactly a week into a new job working with Oracle

I'm trying to compare two tables and get back the unique identifiers of accounts that only have one valid email.  The end goal is to update JM_DUMMY_120512 with those emails.

Here's as far as I've been able to get:

    SELECT COUNT(A.EMAIL) AS EMAIL_COUNT
    FROM PBANIEWICZ.AIEMAIL A
    JOIN 
    JM_DUMMY_120512 B PARTITION BY (B.PID)
    ON A.PID = B.PID
    AND A.EMAILVALID = 'VALID'
    AND A.UNSUBSCRIBED = 'N'
    GROUP BY B.PID
    ORDER BY EMAIL_COUNT",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/14dtmu/oracle_join_where_only_multiple_matches_exist/
1353638280.0,13nd33,"Oracle, need help with outer join.",cowkingslayer,5,1,http://www.reddit.com/r/SQL/comments/13nd33/oracle_need_help_with_outer_join/

    SELECT z.zip
        COUNT(DISTINCT s.student_id) as Students
    FROM enrollment e
        student s RIGHT OUTER JOIN zipcode z
    ON (z.zip = s.zip)
    WHERE e.student_id = s.student_id
    AND z.state = 'NY'
    AND z.city = 'Flushing'
    GROUP BY z.zip;

edit: got it work thanks for helping this is now the code:

    SELECT z.zip
        COUNT(DISTINCT s.student_id) AS students
    FROM student s JOIN enrollment e
    ON (s.student_id = e.student_id) RIGHT JOIN zipcode z
    ON (z.zip = s.zip)
    WHERE z.state = 'NY'
    AND z.city = 'Flushing'
    GROUP BY z.zip
    ORDER BY z.zip;",self,t5_2qp8q,1353650934.0,,,True,http://www.reddit.com/r/SQL/comments/13nd33/oracle_need_help_with_outer_join/
1353033129.0,139yz7,[MSSQL] MERGE vs TRUNCATE and INSERT,Mizue,5,1,5,"I recently upgraded to MSSQL 2008 R2 and was wondering whether or not the ""new"" Merge function was more efficient/faster than Truncating and Inserting for updating tables given each table has millions (~40 million) of rows. If anyone could provide some data of their performance,False,
1352414164.0,12vqim,[MS SQL] Replication between Microsoft SQL versions - 2008R2 and 2012,Kalypso_,5,0,8,"I am wondering if anyone has gotten replication running between 2008R2 and 2012. The publisher would be the 2008R2 and the distributor/subscriber is 2012. 

From what I was able to find (not much)

I know I was able to get a 2005 publisher running with a 2008 distributor/subscriber but even that was little fight. 

Please help me.. my google fu can only do so much.

Thank you!",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/12vqim/ms_sql_replication_between_microsoft_sql_versions/
1351255246.0,124col,Selecting first record in a group,oldfoxpro,5,2,18,"I have a table of doctor billings. For each patient visit, I only want to count one visit for each  set of associated fees,
1351032450.0,11z198,Anyone wanna give me a second set of eyes on this issue. Haven't been working with SQL for very long so this could just be me being stupid.,Deli1181,6,2,3,"Is there a way to return a list of entries in Column A (some sort of ID number

For example

    A    B    C

    1    X    Z
    1    X    Y
    1    Z    Y
    2    X    Z

I'm just trying to return ""1"". Sorry for it being so vague,,False,self,t5_2qp8q,1351041862.0,,True
1351011690.0,11ydbz,[Oracle] Help with something either very trivial (and I'm a dumbass) or not.,_Old_Greg,7,1,11,"The following code is probably self explanatory


-- Lists number of active subscribers 1st of june
select count(subscribers) as activesubscribers
from subscriberlist sub
where to_date('2012-06'


But if I want to get the number of subscribers in the beginning of every month the past year

I will genuinely appreciate any help. Thank you! :)",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/11ydbz/oracle_help_with_something_either_very_trivial/
1350508021.0,11ngag,"[SQLite] Learning SQLite, need help with triggers/checks",bzjones,5,1,http://www.reddit.com/r/SQL/comments/11ngag/sqlite_learning_sqlite_need_help_with/

So I have a table Players, a PlayerID, and a TargetID. 

gameID is a foreign key for Game.GameID

Essentially the player and target should form a circularly linked list

    SELECT GameID

would result in:

    1|1|2

    1|2|3

    1|3|4

    1|4|1

(player 1's target is p2

I'd like to impose restraints onto this table

Is there a way I can enforce this? I thought about a Check with a select inside it (not actually sure if that legally works) but it doesn't work because then there's no way to add an first user,False,self,t5_2qp8q,False,,,t3_11ngag
1350435391.0,11lpll,"[MySQL] select 10 rows, then another 10....",Tikuf,5,0,http://www.reddit.com/r/SQL/comments/11lpll/mysql_select_10_rows_then_another_10/
I want to make a procedure that I could select 10 rows from say a 20k row table

I have no real concept of how to implement this.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/11lpll/mysql_select_10_rows_then_another_10/
1350416947.0,11l4of,[MS SQL] Hypothetical question regarding mirroring with a witness.,soyjesus,8,1,7,"Say I have the following setup:

Primary DB Server (site 1)
Secondary DB Server (site 2)
Witness Server (site 1)

The 3 are mirroring a single database. The primary database being the live copy

The primary server and witness server are destroyed by a combined nuclear explosion

Does the database failover to Secondary DB server on its own? Can it be forced? What happen? 

Thanks!",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/11l4of/ms_sql_hypothetical_question_regarding_mirroring/
1346938815.0,zg5vz,Conditional Joins,Sotall,7,2,21,"So

    rownum email
    1      hello@123.com
    2      hola@345.com      

One of these lists is 400

I need to find those 115 records, so outer joining them on email address returns no results where either email address is null. 

Thoughts? 

EDIT: This is T-SQL. 

EDIT2:  Got something that works

    with sendTable 
    as
    (
    select
    		COUNT(*) sendcount
    	
    	from stats.[Send] s (nolock) 
    	join Members_ m
    	on m.MemberID_ = s.SubscriberID 
    	where s.JobID = 13659916 
    	group by m.emailaddr_ 
    	
    )
    
    as
    (
    	select 
        COUNT(*) decount
    	
    	from c172300.[2012-08-30 Payment not Received - wave2] (nolock) 
    
    	group by EMAIL 
    )
    select * from DETable 
    except 
    select * from sendtable
",self,t5_2qp8q,1346965106.0,,,True,http://www.reddit.com/r/SQL/comments/zg5vz/conditional_joins/
1346106482.0,yxeux,[MS SQL] Need to figure out a good way to have a weekly database backup/restore between a dev and test system,panda_foo,6,2,7,"Im new to this

So right now I have two identical win2008 R2sp1 boxes running with SQL2008 on both. They are duplicate images/builds of each other. Currently we will manually backup our test system and restore to dev every so often when asked to do so. I would like to find a way to automate this. 
I need to be able to do a full backup of a database on ServerA and then be able to restore that backup to ServerB without keeping the database on ServerB in recovery mode. At first I thought about having a backup script run on ServerA then have a job that copies the .bak file over to ServerB and the restores,,False,self,t5_2qp8q,False,,True
1345700886.0,yokxy,"Just starting to learn how to run queries, would like some help with a task.",DangJuice,6,1,http://www.reddit.com/r/SQL/comments/yokxy/just_starting_to_learn_how_to_run_queries_would/, workbooks per system. I have 3 systems and so I end up having 27 tables. 

I drew a picture in case my text was a little confusing.
http://imgur.com/EgKDh

I say relatively simple because if this was MatLab,False,self,t5_2qp8q,False,,,t3_yokxy
1340806964.0,vooyd,Column Aware Query,CompEngCraft,8,4,6,"This one has had me stuck for about 24 hours now. Im sure it is obvious but I am just missing something

Basically I need to do a single query on 2 tables. The tables are related by a row name (its basically a huge number). Table A has a timestamp and Table B has a timestamp (both tables obviously have more data than that but irrelevant).

The problem is that Table A can have multiple entries for 1 name with different timestamps and unfortunately I need to get rows that contain the following format

    A.Name | A.Time | B.*

The hard part being that the times listed in B are just slightly later than A so I need to do a small comparison. My understanding is that I need to somehow pick A row based on the closest one to a given B row (by time) and return in a table... does this make sense? I'm stumped. I think it needs to somehow be aware of the already returned columns from the other table.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/vooyd/column_aware_query/
1339628644.0,v0nqb,[tsql] reddit gifts programming challenge,joshuaerda,5,0,9,"Just for giggles

I realize SQL really isn't the best tool to accomplish a task of this nature (at least the matching part

Thoughts?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/v0nqb/tsql_reddit_gifts_programming_challenge/
1339526482.0,uycz6,How to draw a snowflake. Using [PostgreSQL]. (Not my blog),,5,0,4,,t5_2qp8q,False
1338577028.0,ug0kb,Made a typo and instantly thought of this...,R-P-2008,13,10,5,"begin tranny
update man
set genitalia = 'VAGINA'
where genitalia = 'PENIS'
and wants_sex_change = 'Y'
commit",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/ug0kb/made_a_typo_and_instantly_thought_of_this/
1337977905.0,u504x,Reference books,ectoplasm,9,2,9,Hey Guys I am looking for a good reference book for sql. Know of any good ones?,t5_2qp8q,True
1335358895.0,sronz,Entity-Relationship Diagram,captshady,7,3,2,"It was so easy to get to in SQL 2000.  I've been using access,self,
1335207626.0,soktt,[MySQL] Will I need to autoincrement respective foreign keys?,redelman431,5,0,2,"Right now I was instructed to make both primary and foreign keys in integers. I know it's good practice to autoincrement primary keys,self,
1334941739.0,sjxvm,[MS SQL] Restoring permissions in a database,dfl2m,7,1,7,"I am not a DBA of any sort

Thanks!",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/sjxvm/ms_sql_restoring_permissions_in_a_database/
1334795387.0,sgyzi,Minimum skill set to be a Jr. DBA,SQL_opportunity,10,3,13,"Hi All

I've been trolling Google and reading a bunch of blogs on how to become a SQL Server DBA. It seems a majority of the people looking to break into the field come from development &amp; BI backgrounds or have an IT degree of some sort. I have a job where I work with SQL in a basic capacity

In my current job I:
* Install SQL Server
* Manage automated backups
* Perform database restores
* Query data using T-SQL 101 skills (basic SELECT statements with JOINS
* I've done some role based security administration

I'm wondering,,False,self,t5_2qp8q,False,,True
1333471743.0,rrdwp,[MS SQL] (2008) UpdateTimeStamps on dimension tables.,legohax,5,0,6,"Hey reddit!  I am developing a new application with multiple dimension tables (mapping).  I have columns called: InsertTimeStamp datetime, there are triggers AFTER UPDATE that update those columns whenever any of the other columns change.  The problem is that the triggers say:

WHERE Inserted.Column1 &lt;&gt; Deleted.Column1
	OR Inserted.Column2 &lt;&gt; Deleted.Column2
	etc...
	etc...

When new columns are added to the tables
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/rrdwp/ms_sql_2008_updatetimestamps_on_dimension_tables/
1330440151.0,q9pn9,Problem inserting 2.8 million rows in MySQL on Windows but not Mac?,TinyLebowski,5,0,9,"Hi guys

I'm just getting started with SQL and for practice purposes I downloaded a huge database from [MaxMind](http://www.maxmind.com/app/worldcities) containing all the world's cities

The file is written in comma separated values so I wrote a Java program that creates the schema and table and inserts the values in their proper columns.

The weird thing is that it works fine on both my Macs but my friend's Windows laptop stops importing after about 71.000 rows with no error messages. He wrote a different version of Java code with exactly the same result.

What could be wrong?

**EDIT**

It turned out to be a problem with text encoding. Who knew there were different versions of Latin1? I didn't. It's all smooth sailing now that I forced Java to use the correct charset.
Thanks for the comments guys!",self,t5_2qp8q,True,,,True,http://www.reddit.com/r/SQL/comments/q9pn9/problem_inserting_28_million_rows_in_mysql_on/
1329764520.0,py466,Need help with a subselect and max value,whitedonkey,6,0,8,"Alright

The data that I need to report are ages for a given student major grouped by the past 3 fiscal years. Each fiscal year has 3 semesters (summer

I currently have this for my SQL statement:



&gt; Select COUNT(distinct StuID)
&gt;
&gt; from tblStatic 
&gt; 
&gt; where Campus like 'World%' and (enrl_act like 'REG%' or enrl_act like 'SCH%')
&gt; and StuMaj = 'LAWSC' and FiscalYear IN ('09/10'
&gt; 
&gt; group by FiscalYear
&gt; 
&gt; order by FiscalYear




So this is all fine and dandy except it doesn't match my headcount of students for the fiscalyear. The reason being


How can I use a subselect to resolve this duplicate entry? The field I have been trying to get working is my semester field and using a max to find the max semester during a fiscalyear that the student was enrolled in class.",self,t5_2qp8q,True,,,True,http://www.reddit.com/r/SQL/comments/py466/need_help_with_a_subselect_and_max_value/
1328114611.0,p6aa8,Easiest way to learn SQL?,somenerdyguy,6,1,14,"I'm a health researcher who uses SAS for statistical analyses. While the majority of the data manipulations I can do in SAS,False,
1324661863.0,no3qx,Need help excluding numbers with decimal places (supern00b),d3adbor3d2,5,1,5,"This is my query

from am_jobs
where job_status = 'ABORTED'
order by job_started

Within am_jobs there's a 'job_id' column. Job IDs are listed in numbers with a max of 2 decimal places. I want to create a table that ONLY lists the job IDs without decimals in it (ex. 312555 will be in the table

I apologize if I've missed a sql term or twelve. I will try to give more info. THANK YOU",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/no3qx/need_help_excluding_numbers_with_decimal_places/
1321710893.0,mi14l,"""Window functions"" are standard since SQL:2003, widely implemented, not well-known, but hugely useful:  they make departmental budget subtotals, for example,claird,http://www.reddit.com/r/SQL/comments/mi14l/window_functions_are_standard_since_sql2003/,http://b.thumbs.redditmedia.com/rSf2xtX3VIxbiQWC.jpg
1318053905.0,l4wyf,Microsoft SQL Compact Databases for experimenting,ElvisLikeBear,5,1,3,Fairly simple question - I'm brushing up on my SQL knowledge after not utilizing it very well for a few years. I was wondering if anybody knew where I can get a Microsoft SQL Compact database pre-made with data for experimenting with?,t5_2qp8q,True
1318019871.0,l4hyd,"Need advice on SQL 2008 Maintenance plans, I've attached what is running on mine and would really like advice on which ones need to be ran. (xpost from r/sysadmin)",binarycontrol,5,1,http://www.reddit.com/r/SQL/comments/l4hyd/need_advice_on_sql_2008_maintenance_plans_ive/,http://thumbs.reddit.com/t3_l4hyd.png,
1317965340.0,l3uug,Database structure question,matty348,7,2,4,"I am developing a website to track stats for my board game group and am using mysql to keep track of the data. The way I currently have my database set up is a table for each game which uses the player id and game session number as the primary key. Each board game has a different set of stats that I would like to keep track of (points

 What I am wondering is if there is any better way of organizing this even if it means restructuring everything.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/l3uug/database_structure_question/
1317944106.0,l3jt5,"Wierd SQL issue, I'm totally stumped!",moc_tidder,6,0,http://www.reddit.com/r/SQL/comments/l3jt5/wierd_sql_issue_im_totally_stumped/

I have been working on a SP that takes in a user id with some parameters and passes me a recursive list of users that are being managed. This was originally a function but was too slow

Here is where the issue is, hoping to get some help here. 
Thanks

EDIT: Got solution! sunovavich parameter sniffing! [Interesting Read] (http://www.sqlpointers.com/2006/11/parameter-sniffing-stored-procedures.html)
 

",self,t5_2qp8q,True,,,True,http://www.reddit.com/r/SQL/comments/l3jt5/wierd_sql_issue_im_totally_stumped/
1313762596.0,jnv33,Question about using COUNT(*) multiple times in a query,Javadocs,5,0,12,"I'm trying to optimize this query

Example query below. Let me know if anything I said above is wrong. Thanks!

    SELECT
    ColumnA
    ColumnB
    ColumnC
    ColumnD = COUNT(*)
    ColumnE = SUM(COLUMN1)
    ColumnF = SUM(COLUMN2) / COUNT(*)
    ColumnG = SUM(COLUMN3)
    ColumnH = SUM(COLUMN3) / COUNT(*)
    ColumnI = SUM(COLUMN4)
    ColumnJ = SUM(COLUMN4)/ COUNT(*)
    FROM SomeTable
    WHERE etc...

EDIT: Put spaces in COUNT( * )'s because of formatting",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/jnv33/question_about_using_count_multiple_times_in_a/
1311701788.0,j0c2u,Need help with SQL command,Concordiaa,6,1,8,"Hi r/sql

I have this table ""attendance"" that has a primary, an integer ""person_id"" that corresponds to the id of a certain person from another table, and a bool ""attended"" that has either 0 if person_id did not attend event_id or 1 if person_id did attend event_id

So if I have 3 people and 4 events

    id         event_id   person_id  attended
    1             1              1             0
    2             1              2             1
    3             1              3             1
    4             1              4             0
    5             2              1             1
...etc.

Now I want to write a command that will return the person_id's of people who have attended event_id 95, if person_id 42 has attended=1 in the entries for 95, 96, and 97 I want his or her person_id to be retrieved, but if he or she has attended=0 for at least one of those entries I don't want it to appear.

Can I do that in one SQL command or do I have to write a few lines of PHP to do it?

Thanks!",self,t5_2qp8q,True,,,True,http://www.reddit.com/r/SQL/comments/j0c2u/need_help_with_sql_command/
1311003827.0,isvv5,Using MSSQL how can I count the frequency of a record being greater than a certain value during a given time?,topazsparrow,5,0,4,"&gt;""a report that shows trending on packet loss or the number of times packet loss has occurred may be useful showing a troublesome circuit that has issues popping up from time to time""

~ My boss.

I'm not a huge SQL expert so I'm a bit stumped on this one. If anyone could get me pointed in the right direction it would be much appreciated. Thanks!",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/isvv5/using_mssql_how_can_i_count_the_frequency_of_a/
1310543116.0,io92d,MS SQL 2008 R2 Service Pack 1 Released,jacobmross,5,0,0,,t5_2qp8q,False
1310226932.0,iky91,Facebook trapped in MySQL ‘fate worse than death’,,11,8,5,,t5_2qp8q,False
1308871174.0,i7m2h,Question - How to limit access to a SQL database through lots of hoops,Uphoria,6,1,3,"Ok

I am trying to do these: I want to limit access to an SQL database to specific users in an Active Directory AND to a specific application

Also need to keep open a back door for superadmin groups.

I am at a loss and googling it out but nothing I can find seems to fit right. Does anyone know the quick answer to this? if so,False,self,t5_2qp8q,False,,,t3_i7m2h
1308242924.0,i1ck4,SQL Help. Challenge: Difficult.,rikrokola,9,5,13,"I am not an admin of a DB nor do I have a lot of permissions on our servers

However

Right now I have this ran as a .bat appending to a .csv of the fields and information. That's great,False,self,t5_2qp8q,False,,,t3_i1ck4
1307645219.0,hvqbd,SQL Server - Is it possible to sneak multiple GO statements into a single stored procedure by using dynamic sql?,xstockix,6,0,5,"I've got a nightly stored procedure that is deadlocking. It's joining 30+ views together to perform some tough calculations and dump them into a table that gets recreated each time it runs. To fix this I've broken it into a bunch of smaller batches. I'd like to keep them together,False,
1297979022.0,fngyk,MS SQL - convert ip addresses to int,mistralol,6,0,1,,t5_2qp8q,False
1297702889.0,fl7kp,SQL n00b needs help with a query! ,UNHDude,7,2,9,"I don't really have much experience with SQL or programming or anything


I have a report that's supposed to look at the statuses of mailboxes that our software processes. Unfortunately the database right now only provides a number for the status. Is there a way to make a temporary table or something that would look like this:

2 = started, 5 = erred, 6 = deleted.

I've never done temporary tables or anything like that. In the past I've just done an IIF expression in the layout for the report

Any help would be greatly appreciated!",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/fl7kp/sql_n00b_needs_help_with_a_query/
1294863408.0,f13d1,SQL monitoring tools. Recommendations?,nonrate,6,1,6,"Hi SQL experts

I am looking to trial a few different products that can help monitor performance of a SQL server and also guide in the troubleshooting of database problems that may affect application performance.

I am looking for either commercial or open source options.

The servers I will be testing with would be Microsoft SQL server and Oracle 11g,False,self,t5_2qp8q,False,,,t3_f13d1
1287806002.0,dv6w6,How much is the real cost of MySQL/Postgress? ,amaxen,5,0,15,"So, etc.   

Assume that we can magically retrain everyone on one of these techs with no cost. 

",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/dv6w6/how_much_is_the_real_cost_of_mysqlpostgress/
1287553312.0,dtp9v,"How are things like upvotes or ""likes"" stored?",mysticrudnin,5,0,5,"I'm not that great with SQL. I do stuff occasionally for some storage

But I can't imagine how things like upvotes on here, storing the number of times liked in the ""comment"" table)

But this seems unlikely

I feel bad for being so clueless,False,self,t5_2qp8q,False,,,t3_dtp9v
1283888461.0,dar3d,Equation from two cells in the same table.,Smotpoker,5,0,10,"I have two similar part numbers item1 and item1rebate. I need to subtract item1rebate.cost from item1.cost.

The problem is I have lots of parts and not all the parts have an associated rebate.

So I guess I need to run an if/then statement. If there is a part number like item1 with the suffix ""rebate"" then subtract item1rebate.cost from item1.cost.

I've managed to assign a variable to item1rebate.itemno or item1rebate.cost

table headers:

items.itemno, items.cost

All of the rebate itemno's are all in the same category (which is not the same category as the standard itemno's)

Any tips on how to get this working would be much appreciated! Let me know if you need more information. 

",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/dar3d/equation_from_two_cells_in_the_same_table/
1283025965.0,d6ngw,"Need SQL advice... You're my greatest hope, /r/sql",FrankReynolds,7,1,http://www.reddit.com/r/SQL/comments/d6ngw/need_sql_advice_youre_my_greatest_hope_rsql/

I have tried everything at my disposal and I can't seem to get it to work.

Any advice?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/d6ngw/need_sql_advice_youre_my_greatest_hope_rsql/
1272391354.0,bwus8,The I-Hate-Oracle Club,amaxen,7,3,1,,t5_2qp8q,False
1255540751.0,9u10v,SQLite Release 3.6.19 On 2009 Oct 14 (3.6.19),,5,0,0,,t5_2qp8q,False
1376939191.0,1kok4t,Identifying entries that don't match both of two attributes,CWSwapigans,5,1,12,"I've got two tables and I need the first one to tell me which entries aren't in the second one. They're roughly as follows:

**Table 1** (generated by a query mashing together parts of a few different tables)

[SalesmanID] [CustID] [Date]

**Table 2**

[CustID] [Date] [Amt]

I'm looking to add a column to Table 1 that indicates whether the specific combination of *CustID* and *Date* exists in Table 2. Any given *CustId* or *Date* is

Seems like I could use some sort of ""case when"" here

Thanks for any help!",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1kok4t/identifying_entries_that_dont_match_both_of_two/
1376745318.0,1kjqjm,A beginner's question!,AerialBreakfast,4,1,4,"Assume we have a database of tennis matches:

PlayerID | MatchID | SetsWon | SetsLost
:--|:--|:--|:--
... | ... | 2 | 1
... | ... | 0 | 2

Starting with this

PlayerID | MatchID | SetsWon | SetsLost | Outcome
:--|:--|:--|:--|:--
... | ... | 2 | 1 | Win
... | ... | 0 | 2 | Loss

So basically Outcome is:

* Win - if SetsWon &gt; SetsLost

* Loss - if SetsWon &lt; SetsLost

I'm still learning SQL but I got stuck with this problem! Does SQL have something like if...else in other programming languages?


This is what I have so far: (not much I know)

    SELECT PlayerID, SetsLost
    FROM matches
    ...",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1kjqjm/a_beginners_question/
1376355142.0,1k8v4u,Trying to land my first job.,ronpaulreuben,6,2,16,"Being self taught in SQL,self,
1376085348.0,1k1y3j,[MS SQL] Shifting Data,tedistkrieg,4,0,6,"So I have a simple query 
  
    SELECT MachineNumber
    FROM machines

The results are like this

    3   Simpson Homer
    7   Simpson Bart
    15  Simpson Lisa

and so on. Is there a way I could shift the names up or down. For example if I want it up:

    15 Simpson Homer
    3  Simpson Bart
    7  Simpson Lisa

",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1k1y3j/ms_sql_shifting_data/
1376059937.0,1k10w9,Need some help I am a noob! syntax error,Crazii-P,7,3,10,"select dem.last_name

Error 1064 (42000)",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1k10w9/need_some_help_i_am_a_noob_syntax_error/
1376008500.0,1jzt9d,[MS SQL] Anyone know of a good crash course for the Microsoft Sequel Server level 1 certification?,strikethat_reverseit,7,2,3,"I need to learn enough to pass the course within the next week.  I've gone through SQLzoo.net but I was wondering if anyone knew of any Microsoft specific training.  

Any help is appreciated!",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1jzt9d/ms_sql_anyone_know_of_a_good_crash_course_for_the/
1375827921.0,1jucef,Metrica - SQL Case Study: Removing bias from customer analysis (x-post from r/analytics),getmetrica,6,1,0,,t5_2qp8q,False
1375632402.0,1jonm0,Can anyone explain the APPLY statement?,Trek7553,4,0,7,"I'm learning about it in a book I'm reading and it just isn't clicking for me. I've read some online articles and nothing has helped. Any tips?

Edit: T-SQL",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1jonm0/can_anyone_explain_the_apply_statement/
1373677294.0,1i6xk8,"[MS SQL] Looking to optimize a basic query, insert with a 'not exists' select",Sphexi,4,1,http://www.reddit.com/r/SQL/comments/1i6xk8/ms_sql_looking_to_optimize_a_basic_query_insert/, if it's different then I insert.  This way I only have new data

Problem is this takes about 35-40 minutes each time to run and destroys my CPU on my VM server.

    INSERT INTO events.dbo.eventLog     (eventId,state,dateTimeStamp)
     SELECT 'D20268C3-301F-4DD5-930D-2417B356EE05'
     '1016'
     '23'
     'Preparation'
     '2013-07-09 16:35:31.000'
     WHERE not exists (SELECT TOP 1 state FROM events.dbo.eventLog     
    WHERE eventId='D20268C3-301F-4DD5-930D-2417B356EE05' 
     AND worldId='1016' AND mapId='23' AND state = 'Preparation'     
    ORDER BY datetimestamp DESC)


Any ideas to how to optimize this a bit?  This is running in a vbs file locally on the server, haven't gotten there yet but if it's faster internally with SQL then I may go that way.

Thanks!",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1i6xk8/ms_sql_looking_to_optimize_a_basic_query_insert/
1373323723.0,1hw9bq,[MS SQL] SQL Report Building cutting off columns,tedistkrieg,6,4,2,"I am trying to figure out why it keeps cutting off a little bit on the right hand side of the columns.

Its a matrix
Example:
http://i.imgur.com/sZW1NMq.png",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1hw9bq/ms_sql_sql_report_building_cutting_off_columns/
1373029183.0,1hosq7,"[MySQL] Trying to SUM transactions in 30 day ""buckets"" - Goal is to reduce # of records returned",Jason_SM,6,2,13,"**EDIT** - It is MS SQL not MYSQL. 

I'll start by saying I have a little SQL experience and typically pull information from our database with the excel query wizard. That said

My challenge is that when I need to pull records over a span of time, copy and paste into another workbook so that it's not an enormous file.

My goal is to modify the SQL statement so that the summary level results are what is returned. Then I can just refresh my query to update my values.

Here is my current SQL statement:

SELECT TRANS.Client_ID,     TRANS.Transaction_Amount, ACCOUNT_SELFPAY.Assigned_Date

FROM DataRepository.dbo.ACCOUNT_SELFPAY ACCOUNT_SELFPAY

WHERE ACCOUNT_SELFPAY.Account_ID = TRANS.Account_ID AND ((TRANS.Client_ID='STRIPCLUB01') AND (ACCOUNT_SELFPAY.Assigned_Date Between {ts '2012-01-01 00:00:00'} And {ts '2012-03-31 00:00:00'}) AND (TRANS.Transaction_Code In (1


Perfect world, Sum of transactions that posted the same month as the assigned month, sum of transactions that posted the following month and so on for 4 months. 

I hope that makes sense. Any thoughts or suggestions are greatly appreciated!

Thanks in advance
Jason",self,t5_2qp8q,1373335849.0,,,True,http://www.reddit.com/r/SQL/comments/1hosq7/mysql_trying_to_sum_transactions_in_30_day/
1373009351.0,1hoi5d,[MSSQL] Learn Practical SQL Skills course just $1 for /r/sql readers,garyk1968,13,8,5,,t5_2qp8q,False
1372894662.0,1hln3q,"[MySQL] Lost all data, but still have the .frm files. How do i fix this?",GiantGerman,8,3,http://www.reddit.com/r/SQL/comments/1hln3q/mysql_lost_all_data_but_still_have_the_frm_files/

I need help and i need it desperately. Theres an awful lot of data stored in the files that i need.

(I know i should do regular backups,False,self,t5_2qp8q,False,,,t3_1hln3q
1372860542.0,1hkfge,Is WAITFOR DELAY possible in a single query?,Pulch,6,1,6,"Is it possible to use a WAITFOR command but get the results in a single query? I'm trying to find an easy way to see if the count of a table is changing in a single query.

e.g. 
SELECT Count(table)
FROM   [database]

WAITFOR delay '00:00:15'

SELECT Count(table)
FROM   [database]  ",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1hkfge/is_waitfor_delay_possible_in_a_single_query/
1372364625.0,1h79ut,[Oracle] conditional limiting of displayed rows,just_dig_in_work,6,2,9,"Give a table t1 that has any number of columns but includes a status_code where it is 'O' for Open and 'C' for Closed and a date column

    select * 
      from t1 
    where status_code = 'O'
     Union
    (select * 
       from (
     select
      from t1 
    where status_code = 'C'
     order by t1date desc)
       where rownum &lt;= 10);

I was looking for something like:

    decode(status_code, 'C', rownum, 0) &lt;= 10

The problem with that is that the rownum values are &gt; 10 if there are 10 open records for example. 

Any help would be greatly appreciated.

Thanks in advance!

Edit: Formatting didn't come through as expected so tweaked it.",self,t5_2qp8q,1372365232.0,,,True,http://www.reddit.com/r/SQL/comments/1h79ut/oracle_conditional_limiting_of_displayed_rows/
1372352832.0,1h6td5,[SQL Server 2008] Is there a way to do this?,lekua47,7,2,11,"I have two tables,False,
1372347849.0,1h6mrr,[MS Access] Basic SQL query syntax help,Jenako,5,1,3,"Hello /r/SQL

I'd appreciate it if someone could help me out with making this simple query. Here is an image with the Table I'm working with: http://imgur.com/P7bIfHT

I'd like to make a query to SELECT all RuleIDs and Rules FROM RulesTable (table shown in image) WHERE Auditable = -1 (checked) and Status = -1 (checked) and ExpenseType = (something I select from a drop box in a form). 

In addition, NA, Exception.

I know this is pretty simple,False,self,t5_2qp8q,False,,,t3_1h6mrr
1372256992.0,1h3xyx,[sql server] Pivot Table how to?,_ralph_,7,3,13,"i have a table consisting of  datetime and value (and a few other fields

now i want to make a pivot table where the rows are the time and the columns are the days

would be nice if anybody could tell me how to build that statement.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1h3xyx/sql_server_pivot_table_how_to/
1372205906.0,1h2p7m,Contains text query,Krainz,5,1,13,"Hello

    SELECT Loteamentos.Nome, Documentos.Arquivo_presente, Documentos.Data_entrada, Documentos.Pessoa_entrada, Documentos.Data_retirada, Documentos.Pessoa_retirou, Documentos.Entidade_cobrar, Documentos.Parecer
    FROM Loteamentos INNER JOIN Documentos ON Loteamentos.[Cod_lot] = Documentos.[Lot_pertence];

And I'd like to make three new queries based on this:

    
1. First would show only Documentos.Documento that have 'Protocol' in its name
2. Second would show only Documentos.Documento that have '(' in its name
3. Third would show only Loteamentos.Nome that have 'Project' in its name, 'Project in Chicago', etc.

Is it possible?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1h2p7m/contains_text_query/
1372204886.0,1h2nzm,[MS SQL] Help with MERGE to avoid duplicate entries,dreadpiratetyge,7,2,4,"I'm hoping to find some help with the MERGE statement in T-SQL.  I'm using MS SQL Server 2008 R2

The gist of it is: I have 2 tables, I'd like to skip that record in the second table.  I figure it would be sloppy of me to just do an INSERT INTO statement and hope for the best.

Here's what I have so far:

Tables A and B have the same fields:

    codeID  int
    docID int
    codeTypeID int

The MERGE code would look something like this:

    MERGE tableA AS a
    USING  tableB AS b
        ON a.codeID = b.codeID AND a.docID = b.docID AND a.codeTypeID = b.codeTypeID

    WHEN MATCHED THEN
          &lt;what do I do here?  I want it to ignore/skip the record.  I don't need to update anything&gt;
    WHEN NOT MATCHED THEN
        INSERT (codeID
        VALUES (b.codeID

My questions are:

* Is MERGE the right statement to use and if not
* What should I put under the WHEN MATCHED THEN line?
* Am I able to use 3 comparisons in the ON statement?

Any help would be appreciated.  I'll be offline for an hour or two

Thanks in advance!",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1h2nzm/ms_sql_help_with_merge_to_avoid_duplicate_entries/
1372027300.0,1gxld4,Been on Reddit a while...,mrdedwardel,10,5,7,"Created my account just for help with SQL.  So first post ever and I'm asking for help.  So anyway
SELECT pat_id AS ""patron""
To_Char (Check_out_date - CHECK_in_date
FROM checkout;


Using oracle and sql tools

EDIT - Thanks for the help on this one
",self,t5_2qp8q,1372034104.0,,,True,http://www.reddit.com/r/SQL/comments/1gxld4/been_on_reddit_a_while/
1371149865.0,1gaar9,[MS SQL] Need a somewhat complicated script..,fresheggroll,8,4,6,"I need a script to update a customers value based on a change log. The change log lets us know what was changed in the past. The problem is

Is there a way to select the last change in a table based on changetime and change type - then update the customer table based on that?

edit: some more info

the change log has columns (customernumber
I need to select the latest row based on change date, but if there are multiple entries for the same customer, it will want to update the same account multiple times... Any help?",,False,self,t5_2qp8q,,http://www.reddit.com/r/SQL/comments/1gaar9/ms_sql_need_a_somewhat_complicated_script/
1370188850.0,1fiurr,[PL/SQL] variables aren't declared .. but they are?,s1mpd1ddy,6,2,2,"I'm starting the journey into PL/SQL

here is the code and errors generated:

    CREATE OR REPLACE create_new_emp(	e_name emp.ename%TYPE
									j_ob emp.job%TYPE
									m_anager emp.mgr%TYPE
									d_no emp.deptno%TYPE)
    IS
	    e_no emp.empno%TYPE;
	    hire_date emp.hiredate%TYPE;
	    salary emp.sal%TYPE;
	    commission emp.comm%TYPE;
    BEGIN
	    SELECT MAX(empno) + 5
	    INTO e_no
	    FROM emp;
	
	    SELECT sysdate
	    INTO hire_date
	    FROM dual;
	
	    INSERT INTO emp(empno, mgr, hiredate, sal, comm, deptno)
	    VALUES(e_no, m_anager, hire_date, salary, commission, d_no);
	
	COMMIT;
    END;

Errors:

ERROR at line 3:

ORA-06550: line 3

PLS-00201: identifier 'E_NO' must be declared 

ORA-06550: line 4

PL/SQL: ORA-00904: : invalid identifier 

ORA-06550: line 2

PL/SQL: SQL Statement ignored 

ORA-06550: line 7

PLS-00201: identifier 'HIRE_DATE' must be declared 

ORA-06550: line 8

PL/SQL: ORA-00904: : invalid identifier 

ORA-06550: line 6

PL/SQL: SQL Statement ignored 

ORA-06550: line 11

PL/SQL: ORA-00984: column not allowed here 

ORA-06550: line 10

PL/SQL: SQL Statement ignored 
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1fiurr/plsql_variables_arent_declared_but_they_are/
1369772437.0,1f7yv2,[MSSQL]I'm looking for some for some better resources for writing and troubleshooting queries.,KilledByDeath,4,1,8,"Basically,self,
1369761365.0,1f7ju1,how to search LIKE where a character appears more than once?,whoisearth,5,1,15,"I have a column that has variations of the following - 

YNNNN
NNYNN
NYYYN
NYYNN
etc.

I want to be able to search only when the column contains 1 'Y' how would I do this?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1f7ju1/how_to_search_like_where_a_character_appears_more/
1369498549.0,1f18xc,[MS SQL] Anyone got a suggestion on how to speed up a date range query for a large table?,chapmjw,6,2,22,"I've got a table that collects data from equipment throughout the plant. This table has around 20 million records and is setup something like this.

Id,Data2,,,,,,

My problem is if I need to see what happened over some given time span many months ago

I have to display the last 24 hours at all time and to speed that query I use something like this.

-- from memory not tested.
Select * from 
(Select top 10000 * from Table1) as T1
where TimeStamp &gt; '5-24-13'
order by Id desc


Thanks to all that helped.

Indexing the timestamp drops the time from a 20 seconds query to less than 1s. I didn't realize I could index anything other than the primary key.",self,t5_2qp8q,1369512451.0,,,True,http://www.reddit.com/r/SQL/comments/1f18xc/ms_sql_anyone_got_a_suggestion_on_how_to_speed_up/
1369448201.0,1f0cbe,"[MySQL] How to get ""recommended"" items based on euclidean function and something like that?",101008,4,1,7,"I started to read this book:

http://shop.oreilly.com/product/9780596529321.do

(Intelligence Collective, such like Products Suggestions from Amazon, Music Recomendation of Last.fm, etc. I have a strong background in Math, so I understand (and a few I already knew) examples, etc.

The book also has code implementing the algorithms

The example used is an array with critics

Then a function (using the euclidean metric) gives a score between two persons, you got the most similar reviewer.

My question is... this example is with 5 elements in an array.

How do you implement this in MySQL?

For example


    - Critics
    -- id
    -- person


    - Movies
    -- id
    -- title


    - Scores
    -- critic_id
    -- movie_id
    -- score

How do you involve all the euclidean logic and everything in a query? Is that possible? I know SQL

Thank you :)

PS: English isn't my natural language,False,self,t5_2qp8q,False,,,t3_1f0cbe
1368582254.0,1ect9t,[Oracle] What's the best free sql editor for new SQL devs?,ora408,5,0,11,"What's the best light,,False
1368206356.0,1e2v0h,"What is ""DEV instance""? [TSQL]",randomperson24,5,1,6,"I'm pretty new to QAT,False,
1367867332.0,1dt55p,Select multiple occurrences from a distinct range of values,airtrixxx1080,6,0,7,"In some cases

V001 | 123 Main St  
V001 | 123 Main St  
V002 | 24 Broadway  
X051 | East 90th St  
R032 | 123 Main St  

I would want my report to say:  
V001 | 123 Main St  
R032 | 123 Main St

*Things to consider:*  
1) The report would **not** show ""V001"" **more than** once
2) The report would **not** show ""V002"" or ""X051"" since their addresses only occur once.

Thanks for your help!",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1dt55p/select_multiple_occurrences_from_a_distinct_range/
1367510559.0,1dk2n7,[MS SQL] How to list prior value for a column?,twonx,5,3,4,"I have a table like this:

Name|Year|Sequence|Amount
--:|--:|--:|--:
John|2007|1|$300
John|2008|2|$400
Mary|2005|1|$100
Mary|2005|2|$200

What's the best code to use if I need to list create a 'PriorAmount' column that lists the person's previous amount

Thanks!",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1dk2n7/ms_sql_how_to_list_prior_value_for_a_column/
1366959693.0,1d52q1,Access SQL nested IIF with DateAdd problem...,redditaccount1975,4,0,3,"ok this works fine with numbers in the inner IIF:

     IIf(IsNull(RR.RexpirationDate),9999,1)) AS EndDate,   

When I put in my Date calc function

     IIf(IsNull(RR.RexpirationDate),DateAdd(""m"",[RR].[RexpirationDate]+[RR].[StartDate]),DateAdd(""m"",[RR].[RexpirationDate]+[RR].[RStartDate] -2,[OAProperty].[AnalysisStart]))) AS EndDate, ",False,,http://www.reddit.com/r/SQL/comments/1d52q1/access_sql_nested_iif_with_dateadd_problem/
1366906542.0,1d39ic,Update: Displaying all stores that have above the average amount of employees?,S-Q-L,4,1,4,"This is an update to [this](http://www.reddit.com/r/SQL/comments/1c2h1r/displaying_all_stores_that_have_above_the_average/) post and I just wanted to provide the solution my professor gave us.

    SELECT * 
        FROM Store 
        WHERE s_id IN 
        (SELECT e_sid FROM Employee GROUP BY e_sid HAVING COUNT(*) &gt; 
            (SELECT AVG(e_count) FROM (SELECT COUNT(*) AS e_count FROM Employee GROUP BY e_sid)));

Thanks again to those who helped.

Edit: ~~Whoops didn't realize the asterisks would screw it up. I put a period where there should be an asterisk since there is no way to turn that off.~~ Thanks for the correction!",self,t5_2qp8q,1366923232.0,,,True,http://www.reddit.com/r/SQL/comments/1d39ic/update_displaying_all_stores_that_have_above_the/
1366727805.0,1cxr4j,MSSQL - Win Serv - iSCI - Best Practices,pmpjr6465,4,0,3,"Hi

Need some help

So far the only tweak I've made

I am going to also disable the File/Printer Sharing for MS Networks for the iSCI NICs.  

Where should I go from here?  If this is the wrong sub please let me know.  Many thanks :)",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1cxr4j/mssql_win_serv_isci_best_practices/
1366381781.0,1coeru,When is it a good idea to mix RIGHT and LEFT outer joins?,MeGustaDerp,5,2,21,"I just had to navigate a nasty mess of LEFT and RIGHT OUTER joins. Similar to this. *(The objects have been changed to protect the not so innocent)*

&gt;SELECT 'yada yada yada'				 
&gt;FROM Table1 INNER JOIN
&gt;                      Table2 ON Table1.aID = Table2.aID 
&gt;	RIGHT OUTER JOIN
&gt;                      Table3 ON Table2.bID = Table3.bID LEFT OUTER JOIN
&gt;                      Table4 ON Table3.cID = Table4.cID LEFT OUTER JOIN
&gt;                      Table5 ON Table3.dID = Table5.dID	

I tend to stick with left joins when I need one or the other. When is it a good idea to mix left and right joins?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1coeru/when_is_it_a_good_idea_to_mix_right_and_left/
1366225610.0,1cjv07,Help with SQL Tutorial Question,i_have_a_gub,5,1,3,"I'm a complete SQL novice and am having trouble figuring out Question 13 on this [SQLZoo Tutorial](http://sqlzoo.net/wiki/The_JOIN_operation).  Obviously,False,
1364960318.0,1bkddu,Help! Advanced sql question (or maybe I'm just not getting it?),takemeanywhere,4,2,9,"I have a table B with a foreign key to another table A (so table B has a column a_id).

Table B also has some data. I want to get all records from table A that has each one of its foreign records in B match some criteria. 

Maybe a concrete example Mary. Say table A is User and table B is Phone number. I want to get all users that ONLY have phone numbers in a list of known numbers.

So known phone numbers are [1,4,5]

User Mary has the numbers 1
User Fred has the numbers 3

I've thought of finding the users that have a number outside that list and then getting the users that aren't in that list. But that seems slow.

Maybe a left join?

Any help would be greatly appreciated! Thanks",self,t5_2qp8q,1364970381.0,,,True,http://www.reddit.com/r/SQL/comments/1bkddu/help_advanced_sql_question_or_maybe_im_just_not/
1364928947.0,1bj6s0,Introducing the JackDB Heroku Plugin - Database Development in the Cloud,jackdb,5,2,1,,t5_2qp8q,False
1364505402.0,1b7961,How do you evolve your schemas? [x-post /r/SQLServer],kaaskop42,6,1,0,,t5_2qp8q,False
1364487463.0,1b6mwx,"[MS SQL] Selecting 5 columns, only want distinct on 4",OrinMacGregor,6,1,http://www.reddit.com/r/SQL/comments/1b6mwx/ms_sql_selecting_5_columns_only_want_distinct_on_4/

    SELECT
     e.Arrival
     c.SupplierName
     f.DestinationName
     a.ControlNumber AS [SID]
     a.GrossWeight
    FROM ManualAsnMaster a  
     INNER JOIN plants b on a.plantid = b.plantid    
     LEFT  JOIN suppliers c on a.supplierid = c.supplierid    
     INNER JOIN destinations f on f.plantid = a.plantid    
     INNER JOIN plantrouting d on f.destinationid = d.plantid and a.receivedwid = d.warehouseid    
     INNER JOIN trailers e on a.trailerid = e.trailerid    
    WHERE arrival &lt; @EndDate and arrival &gt;= @StartDate AND e.WarehouseID = @WarehouseID",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1b6mwx/ms_sql_selecting_5_columns_only_want_distinct_on_4/
1364401806.0,1b48sh,Modify column data type which contains data,een54,4,0,7,"Hi

Is it possible to modify the data type of a column from DateTime to vchar even when data exists on the table?

I have tried the following with no luck:
 ALTER TABLE dbo.ScanData
  ALTER COLUMN ScanDate
    nvarchar(50)
GO

Any advice would be great!",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1b48sh/modify_column_data_type_which_contains_data/
1363879788.0,1aqilk,Help a newbie fix his 5hour+ CROSS JOIN query,wallyflops,4,1,26,"
Hey

So I have two tables
I want to use SQL servers GEOGRAPHY data type

The code below should be fairly self explanitory

Thanks for your help.




    ---THIS QUERY WILL TAKE HOURS
    --Now compare distance between #cinemas &amp; #OAData
    SELECT
      c.*
      pc.OA_Code AS OA_Code_PC
      c.GeoLoc.STDistance(pc.GeoLoc) AS DistanceApart
    INTO #output
    FROM #Cinemas c
    	JOIN #OAData pc ON (C.GeoLoc.STDistance(pc.GeoLoc) &lt;= 24140.16) -- 24,False,self,t5_2qp8q,False,,,t3_1aqilk
1363471458.0,1afixk,SQL 2008 Linked to FirebirdDB configuration question,StrangeCaptain,5,1,23,"Howdy

We use FishBowl Inventory (don't get me started)

The included reporting functionality is lacking


I am currently in the process of connecting the FishBowl Data Base to SharePoint as an external data source (don’t get me started)


I was able to get some success connecting sharepoint to the linked server


TLDR
I’m looking for a way to update SQL Tables from a Linked Firebird database
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1afixk/sql_2008_linked_to_firebirddb_configuration/
1363218714.0,1a91dq,Annoying (apparent) lack of a feature in SQl Server 2012,mentalorigami,6,4,19,"The feature in question is creating a copy of a table's structure without using:

    select * 
    into NewTable
    from OldTable
    where 1 = 2;


I'm a bit of an SQL noob so maybe I'm just missing something,,False,self,t5_2qp8q,False,,True
1363216044.0,1a8y0v,First and Last day of prior month &amp; year (ms sql),tedistkrieg,5,1,12,"I know these get me the first and last days of the prior month

    DATEADD(month, GETDATE())-1, 0)    
    DATEADD(dd

But I cant seem to figure out how to get the first and last days of the previous month and year. For example

EDIT: was able to get 2-12-2012

    DATEADD(mm,DATEADD(mm,-1,DATEADD(YY,-1,GETDATE()))),0)

",self,t5_2qp8q,1363217170.0,,,True,http://www.reddit.com/r/SQL/comments/1a8y0v/first_and_last_day_of_prior_month_year_ms_sql/
1362843980.0,19z264,[ACCESS] Help with query,vinsite,4,1,9,"This is probably easy but you know sometimes you just can't figure it out. I have a small DB with a transaction table and a referList table. What I want to do is get the count of each referListID that appears in the transaction table. ex. Lets say there is 30 transactions this month. I want to know the total of each referral. There were 15 transactions that came from the internet. 5 came from radio. 10 came from friends.

I could do this by creating individual recordsets with a where clause but that is not efficient. This code returns the correct number
any ideas? Thanks guys",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/19z264/access_help_with_query/
1362777560.0,19xncg,[MS SQL] Please help me find a way to deal with effective dates.,twonx,5,2,15,"So I have a table of something like below:


|State  |Effective  |Rate  |
|-------|-----------|------|
|AK      |1/15/2011  |1.3    |
|AK      |3/31/2012  |1.5    |
|KY      |4/1/2010    |1.2    |
|KY      |7/1/2011    |1.4    |


Say I want to join a table with the value AK and the date is 1/19/2011,False,self,t5_2qp8q,False,,,t3_19xncg
1362589039.0,19s7rk,[MS SQL] A tip to help improve performance,nycgags,5,2,5,"I'm not sure if this is the best way to solve this problem but I have used it a number of times to much success.

I do a lot of back testing of financial data often touching tables with millions of rows.  There are times when I will hit a wall and cannot seem to optimize my code through indexes or other means.  So I have come up with this process which seems to work pretty effectively.  (It's pretty similar to picking a minimum ID and looping through to perform the update statement which I have also done

-- depending on what you are updating and the performance 
-- gains you want to use

    set rowcount 10 
    select 1    
    while @@rowcount &gt; 0
    
    update u    
    set [...]    
    
    from [table] u    
    [joins...]    
    where    
    [where clauses...]    
    and u.updCode != 1
    
    set rowcount 0

The key is to also update the updCode column I created and to filter against it in the where clause to avoid any infinite loops (once the row is updated it is removed from a possible row to update).",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/19s7rk/ms_sql_a_tip_to_help_improve_performance/
1362168874.0,19hct6,How to get date fields to group by month,JCollierDavis,5,0,13,"I'm working on the following query to run in an Oracle Db.

    SELECT support_uic, 'MON-YYYY')date_completed, COUNT(won) close_count

    FROM 
	mgt0.V_WON_R_VIEW_ALL		

    WHERE 
    support_uic IN
    ('big_list')

    AND TO_CHAR(compl_dt, 'DEC-2012', 'JAN-2013', 'FEB-2013')
    AND compl_dt IS NULL

    GROUP BY support_uic, TO_CHAR(compl_dt, 'MON-YYYY')
    ORDER BY support_uic, TO_CHAR(compl_dt, 'MON-YYYY')

The results end up similar to what I'm looking for except the GROUP_BY still uses the actual date 'DD/MM/YYY HH:MM:SS' instead of just 'MON-YYYY' like I'd want.

Any suggestions?  


I'd really like to lean how to work with dates
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/19hct6/how_to_get_date_fields_to_group_by_month/
1362080325.0,19ew9d,"[MS SQL]multiple columns, multiple WHERE.",yellising,7,1,http://www.reddit.com/r/SQL/comments/19ew9d/ms_sqlmultiple_columns_multiple_where/


Is there a way to generate two columns using 2 different WHERE clause? 

I'd like to seperate yearly stats per column.

Something like:

    Select
        Branch
        
        
        
    From allScores
    Group By Branch

I know the code above won't work


Thank you!",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/19ew9d/ms_sqlmultiple_columns_multiple_where/
1362006552.0,19cwy8,[MySQL] Comparing entries against entries with adjacent dates,boiling_penis,5,1,7,"I have a table with three (relevant) columns: application_id,False,
1361198561.0,18r2h6,Replicating data intensive IO on SQL Server database? HELP?,amsterDerp,5,0,10,"I have set up a database on Sql Server 2012 which has multiple relational tables and one main table consisting of about 2500 entries. 

My end aim from all of this is to monitor system performance of different environments (for example Virtual Machines environments vs. physical servers). What type of query(s) should I be executing to put my hardware under heavy constant load? Should I be selecting and updating in a loop constantly?

Any help would be great as I'm quite the novice. 

Thanks! 

[Link to DB code if needed](http://pastebin.com/0uN519YK)",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/18r2h6/replicating_data_intensive_io_on_sql_server/
1361081341.0,18oihw,[Oracle] Sql query problem,too_kind,4,0,12,"Appreciate your help in forming the following query.

I have tables TAB A and TAB B. TAB A is related to TAB B with 1 to many relationship. TAB B has a column B.X which can have 3 possible values; Apple

Queries that I want to form:

1) Count number of records in TAB A that has a mix of Apple and Orange

2) Count number of records in TAB A that has a mix of Apple

3) Count number of records in TAB A that has only Apple
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/18oihw/oracle_sql_query_problem/
1360951864.0,18lb3x,"[Generic SQL] 2 questions: Add 1 literal line header, multiple table XML style output.",ImHighCurrently,4,0,http://www.reddit.com/r/SQL/comments/18lb3x/generic_sql_2_questions_add_1_literal_line_header/

Question #1: I want to stick a header on my table output.  Any clues how to?

    This is my header
    t1.f1
    t1.f1


Question #2: Can a nested XML style output be done?

    FileHeaderTable.f1
      ParentObjectHeaderTable.f1
        ChildObjectValue.f1
        ChildObjectValue.f1
      ParentObjectFooter.f1
      ParentObjectHeaderTable.f1
        ChildObjectValue.f1
        ChildObjectValue.f1
      ParentObjectFooter.f1
    FileFooterTable.f1


Happy Friday and a preemptive thank you very much for being awesome.


",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/18lb3x/generic_sql_2_questions_add_1_literal_line_header/
1360039548.0,17wz92,Ask /r/SQL: Would it be beneficial to understand mathematical statistics in order to understand the concepts behind index statistics in databases?,MeGustaDerp,5,0,10,"I'm pretty much a self taught a database developer. For career and personal development,self,
1358970925.0,1752r6,Group By Select Query is close but I need to make it slightly more unique,macness234,7,3,14,"**EDIT SOLUTION BELOW**

SQL Sever 2000. I'm trying to make this query slightly more unique.

*Any help you guys can provide... I've been struggling with this for 2 days now...*

The Query:

    USE MyDatabase
    GO
    
    SELECT MAX(x.provider_entry_id) as provider_entry_id
         x.provider_entry_type_id
         x.provider_entry
         x.provider_entry_visit_dt -- the date the entry was created
    FROM tbl_claimant_provider_entry x
    JOIN (SELECT p.provider_entry_type_id
                 p.provider_entry
                 MAX(provider_entry_visit_dt) AS max_date
            FROM tbl_claimant_provider_entry p
            WHERE provider_entry_clmnt = 4963 -- change this for you user 
            GROUP BY p.provider_entry_type_id
                              AND y.max_date = x.provider_entry_visit_dt
    GROUP BY x.provider_entry_type_id

returns:

    provider_entry_id   provider_entry_type_id  provider_entry  provider_entry_visit_dt
    1052                109                     1088            2013-01-22 00:00:00.000
    1051                109                     1665            2013-01-23 00:00:00.000
    1049                130                     264             2013-01-01 00:00:00.000
    1050                130                     1126            2013-01-02 00:00:00.000
    1045                132                     NULL            2013-01-22 00:00:00.000
    1047                132                     260             2013-01-22 00:00:00.000
    1044                132                     1115            2013-01-10 00:00:00.000
    1048                132                     1130            2013-01-22 00:00:00.000
    1043                142                     1356            2013-01-10 00:00:00.000
I'm looking to narrow this list to show me only one instance of each unique provider_entry_type_id based on the most recent     provider_entry_visit_dt

So the results would be (keep in mind that there will not need to be a need for tie breakers for the provider_entry_visit_dt

    provider_entry_id   provider_entry_type_id  provider_entry  provider_entry_visit_dt
    1051                109                     1665            2013-01-23 00:00:00.000
    1050                130                     1126            2013-01-02 00:00:00.000
    1048                132                     1130            2013-01-22 00:00:00.000
    1043                142                     1356            2013-01-10 00:00:00.000

**SOLUTION**

        SELECT  b.*
        FROM    dbo.tbl_claimant_provider_entry AS b 
        INNER JOIN
                    (SELECT provider_entry_type_id
                                    FROM    dbo.tbl_claimant_provider_entry
                                    GROUP BY provider_entry_type_id) AS m ON b.provider_entry_type_id = m.provider_entry_type_id AND b.provider_entry_visit_dt = m.maxdate
        WHERE   (b.provider_entry_clmnt = 4963)",self,t5_2qp8q,1358978525.0,,,True,http://www.reddit.com/r/SQL/comments/1752r6/group_by_select_query_is_close_but_i_need_to_make/
1358804461.0,170hg7,UK Qualifications?,pix1985,6,3,7,"I've been working with MS SQL for a couple of years and have recently become a junior DBA. My work has said for me to look into some courses. I'm not sure how much they're willing to pay yet,self,
1358542243.0,16u5s0,natural keys in fact table: Pros and Cons,Q7guy,5,2,5,"Is it acceptable to use natural keys (composite) in a fact table? There are instances
Example:
SELECT  
   s1.field_SK
   s1.status_sk
   s2.status_name
   s1.status_value
   s1.status_COUNT
   FROM FACT_STATUS s1
where s1.status_sk = s2.status_sk

",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/16u5s0/natural_keys_in_fact_table_pros_and_cons/
1358362234.0,16p5vb,[MS SQL 2008] Question about page splitting in indexes,chafe,4,2,5,"Hey guys

The way page splitting happens as described in my self paced training kit book

&gt;"" ...two additional pages are allocated to the index in a process called page splitting. The existing root page is pushed down the structure to become a leaf-level page. **SQL Server takes half of the data on the index page and moves it to one of the newly allocated pages.** The other new page is allocated at the top of the index structure to become the new root page...""

Now, starting with 00001, and there are orders all the way through 50000). So if the page fills up with data being entered, sorted by the Order Number column, and the last row is Order Number 50000, then according to the above, when the page split occurs, and the other will have 25001 -  50000.

So since orders are being placed sequentially, which is how an index works, right?). The second leaf will fill up twice as fast (since it only has 25000 free spaces instead of 50000 like the original root page did) causing another page split, and so on and so forth. This seems very strange and inefficient. Do I not understand this properly, or is this really how it works??",,False,t5_2qp8q,True
1358349271.0,16or1i,[TSQL] Need help creating a Trigger with a cURL command to post a text file to a webpage. ,e13ct,5,0,10,"Hey everybody

I have an academic web application that can be programmatically updated using the cURL command. I have some syntax for the curl command

I guess this would be similar to EPL which I haven't done much of

Has anyone ever done something like this before?

TL;DR Need help creating a trigger to send a plaintext file update to an URL. 
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/16or1i/tsql_need_help_creating_a_trigger_with_a_curl/
1357282763.0,15xtm6,[PostgreSQL] pg_message_queue 0.2.0: A simple LISTEN/NOTIFY message queue with payload tables,einhverfr,5,0,0,,t5_2qp8q,False
1356470256.0,15fotj,Need help to solve DateDiff function,Hakiki1,6,2,9,"I am currently working on simple library database (in MS Access) and cannot figure out a query which should show all book lenders who have returned their books on time (in 15 days).

I have a table in which all records of lending are kept (Times) and another table with all lenders of the library (Lenders). 

The code currently looks like this:

    SELECT COUNT(DateDiff (""d"", t.Lender_ID, l.[First Name], l.[Last Name], l.[Contact Number], l.[Email]
    FROM Times AS t
    WHERE l.Lender_ID=[t].[Lender_ID] AND DateDiff (""d""
    GROUP BY DateDiff (""d"", t.Lender_ID, l.[First Name], l.[Last Name], l.[Contact Number], l.[Email]
    ORDER BY t.[Lender_ID];

The current query gives me separate results, but the query gives me one row with 2 books and another row with 1 book counted.

If you could help out,False,self,t5_2qp8q,False,,,t3_15fotj
1355260592.0,14ooei,[MS SQL] How to conditionally remove rows between two other rows in sorted result?,THLycanthrope,4,0,12,"Also posted in /r/SQLServer  using 2008  
A massive simplification of my problem
I have a date SORTED list of events of 3 types (0
If any number of 0 are between a 1 and 2
1 will always be followed by a 2
    Jan 0  
    Feb 2  
    Mar 1  
    Apr 2  
    May 0  
    Jun 1  
    Jul 0  
    Aug 2  
    Sep 0  
    Oct 1  
    Nov 2  
    Dec 0  
Jan and Jul should not be in my result set.  
.  
**EDIT: Thank you everyone for the help.  They adjusted the requirements and I don't think I need this anymore.  I'm going to have to write a StoredProc.  
My goal was to calculate the days between events (0)
The new requirements are that all events should be considered but I should not add days when the Case was OnHold.  I think I need to traverse two cursors to pull it off.**",self,t5_2qp8q,1355343562.0,,,True,http://www.reddit.com/r/SQL/comments/14ooei/ms_sql_how_to_conditionally_remove_rows_between/
1355176066.0,14mkkd,VBA &amp; ADODB connection to execute stored procedure is extremely slow. Any ideas?,d1sturbdapeace,4,0,9,"I created a new ADODB connection in VBA with Excel 2007 to execute a stored procedure on SQL Server 2005 which creates a recordset of about 10 columns by 40K rows. It takes about one minute to deposit that into a range when kicking off the macro.

However

Is there a way to make this query faster without having a table in my workbook?
Thanks!",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/14mkkd/vba_adodb_connection_to_execute_stored_procedure/
1354719398.0,14bofh,How do i go about developing a user interface so a non-technical user can add to the database which will then be shown on a website? [MySQL],Tobias4rmT,6,3,7,Hope this is in the right place but it will be using mysql so thought i would post it here.,t5_2qp8q,True
1354655552.0,14a5ni,[MS SQL] How do I search for double-quotes?,sql_no_run,5,2,5,"I need to fix double-quotes in a field so they are single quotes
I've done:
    select * from tbl
        where person_data like '%""%'

and
    select * from tbl
        where patindex('""'
and the execute does not find anything,000 records to find.
Thanks!",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/14a5ni/ms_sql_how_do_i_search_for_doublequotes/
1354295688.0,14250c,How can I filter bad fields before math function?,ImHighCurrently,4,0,3,"**UPDATE: SOLVED**
    
    isnumeric(MyField) = 1 

Thank you!!



Hi /sql!  I've got a horrid DB that can not be modified:

MyTable.MyField should be numeric but it is actually a varchar and it has old records with non numeric values.  Specifically

Now I want to 

     SELECT MyField 
     FROM MyTable 
     WHERE MyField &gt; 10

But this will crash because of the old garbage records.  

So

    SELECT MyField 
    FROM (
        SELECT MyField 
        FROM MyTable 
        WHERE NOT (MyField LIKE '%?%')
        )  AS MyTable2
    WHERE MyField &gt; 10

But that doesn't work

MSSQL if it matters.

PS: Before you ask, and I can't update the table to fix the records.  =/

PPS: Happy Friday.

",self,t5_2qp8q,1354298958.0,,,True,http://www.reddit.com/r/SQL/comments/14250c/how_can_i_filter_bad_fields_before_math_function/
1353436526.0,13ir8o,General SQL Question,A_Nearby_Tree,7,3,7,"First off I'm sorry i know nothing about SQL.

I'm currently an accounting student and one of the programs we use is microsoft dynamics. Dynamics needs SQL to work properly.

My question is the disc i've been given contains SQL 2005. 2005 is not compatible with windows 8

This is a mid level course that deals with general accounting for a company. I've never used Dynamics or SQL before and this is the first semester they are doing this so i feel they are falling through it.

Any help or suggestions is greatly appreciated. Thanks!",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/13ir8o/general_sql_question/
1353018717.0,139j5n,[SQL Server] Parallel execution of a complex job,LyndsySimon,5,1,6,"Say I have a complex job

The flow:

1. Execute A
2. Execute B1
3. When B1, execute C

In my case B1, and take about 10-15 minutes each. Doing them in series takes about 40 minutes; opening 3 sessions and executing them simultaneously by hand takes about 15. Executing them in parallel like this - but in an automated way - is the only way I'll be able to scale my project.

Note also that B1, so there shouldn't be an issue with them locking each other out.",,False,self,t5_2qp8q,False,,
1351540708.0,12aks3,Terrible performance from SQL view,mark8cato,5,2,8,"For my job I've written a fairly simple view (with my limited SQL knowledge):

    
    CREATE OR REPLACE VIEW SYSAUDIT_V AS
    (
    SELECT date, user, session, ORA_ROWSCN  FROM (
    SELECT DISTINCT date, user, session, ORA_ROWSCN, Rank() Over (Partition BY session Order By ROWID ) As minRow
    FROM SYSAUDIT
    )
    WHERE minRow = 1
    );

As you can see

The problem is that performance is terrible. The underlying table has a HUGE number of records

Can anyone with more knowledge of SQL tell me how this could be improved please? I imagine that Rank() &amp; Partition By bit is not as efficient as possible,False,self,t5_2qp8q,False,,,t3_12aks3
1350664404.0,11r5jx,[Foxpro SQL] Help with Self-Select,oldfoxpro,5,1,5,"I still use VFP, the 'index case'. Basically,000 records
My code so far is:

SELECT a.ptid, a.diagnosis, b.diagnosis FROM patients a;
INNER JOIN patients b ON (a.ptid=b.ptid) AND (a.diagnosis=b.diagnosis) AND (a.admitdate&lt;&gt;b.admitdate)

I am also doing this in Access, thanks.

EDIT: Also, and the dates have to be evaluated in sequence in sets of two, ie 1, 2, 3, 4, 5 admit dates requires a check of 2-1, 4-3,,1350668775.0
1350639478.0,11qntk,"[MS SQL] Finding duplicates, but leave out first one ",Unomagan,5,1,http://www.reddit.com/r/SQL/comments/11qntk/ms_sql_finding_duplicates_but_leave_out_first_one/

Iam really a noob in MS SQL. And I need your held.

I got a table with duplicates in it. It has no ID

Example table:

UID VARCHAR(20)
COSTNR VARCHAR (20)
ACCNR VARCHAR (20)
DTYPE VARCHAR (20)

DTYPE is duplicated

Thank you for your help

EDIT: I dont want to get none duplicates.

For example:

UID: 100; DTYPE: 33; NR:1

UID: 101; DTYPE: 33; NR:2

UID: 102; DTYPE: 33; NR:1

UID: 103; DTYPE: 33; NR:3

should result in:

UID: 102

Not more. (The rest ignored)

EDIT TWO: If we got three duplicates

EDIT THREE: I dont know how many duplicates we got...",self,t5_2qp8q,1350649753.0,,,True,http://www.reddit.com/r/SQL/comments/11qntk/ms_sql_finding_duplicates_but_leave_out_first_one/
1350536227.0,11oazx,My free ebook - A Primer on SQL,rbatra,7,3,0,,t5_2qp8q,False
1350373546.0,11k7fa,IDE for PROGRESS database(s)?,carlhunt3r,4,0,6,"Hello /r/sql

One of the core systems which I support runs on a Progress database. I have an openEdge ODBC connection to access this data, and Management Studio is where I usually can be found. Is there an equvielent tool for PROGRESS? Can I connect my instance of Management Studio to the instance our instance of PROGRESS?

Any ideas would be superb guys.

For information, and it is not the ideal solution. It throws errors constantly and hangs, and also complains about too many indexes when linking to tables.",,False,self,t5_2qp8q,,http://www.reddit.com/r/SQL/comments/11k7fa/ide_for_progress_databases/
1350327179.0,11iw5i,Need your opinion on the time and man power required for linking a phone or laptop to automatically input data into a SQL server based upon the user's input,,4,1,4,"Before I even propose this to my supervisor
The other option is currently the field workers are using iphones, what could you foresee as concerns I should consider?
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/11iw5i/need_your_opinion_on_the_time_and_man_power/
1350313380.0,11ihou,Tune Your Indexing Strategy with SQL Server DMVs,wordsmithie,7,3,1,,t5_2qp8q,False
1350071352.0,11dqbj,Proper Case,Bandude,5,1,14,"Is there an easy way to apply proper case to an address?

EX&gt; 

12345 ANY WOODS TRAIL

to

12345 Any Woods Trail


",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/11dqbj/proper_case/
1349661032.0,1146lk,Hi r/SQL  - How much do you make?,Dicedvo,12,10,17,"I'm considering a new job offer

**Job Title:**     

**Experience:**

**Salary:**

**Location:**",self,t5_2qp8q,1349662348.0,,,True,http://www.reddit.com/r/SQL/comments/1146lk/hi_rsql_how_much_do_you_make/
1349463909.0,1108d1,[SQL Server] Transpose Rows to Columns,zylo4747,4,1,20,"I am having a hellish time trying to figure out how to do this.  I have a table with about 20 columns and 3 columns that I need to transpose each row for into a column (so 3 columns per row).

I found this article (http://www.simple-talk.com/blogs/2007/09/14/pivots-with-dynamic-columns-in-sql-server-2005/) which does a pretty good job explaining how to dynamically transpose rows to columns which is what I need.  What I can't figure out is what to put in the pivot statement because it involves me pivoting 3 fields.

Here's a simplified example of what I mean:

    StudentID | StudentName | Question | Answer | Score
    1 | Bob | What is your name? | Bob | 10
    1 | Bob | What is your favorite color? | Blue | 15
    1 | Bob | What year were you born? | 1999 | 5
    2 | Mary | What is your name? | Mary | 10
    2 | Mary | What is your favorite color? | Green | 15
    2 | Mary | What year were you born? | 2001 | 5

I want the above to be transformed into this:

    StudentID | StudentName | Question1 | Answer1 | Score1 | Question2 | Answer2 | Score2 | Question3 | Answer3 | Score3
    1 | Bob | What is your name? | Bob | 10 | What is your favorite color? | Blue | 15 | What year were you born? | 1999 | 5
    2 | Mary | What is your name? | Mary | 10 | What is your favorite color? | Green | 15 | What year were you born? | 2001 | 5

Any help would be appreciated.  Hopefully using the dynamic method in the site mentioned above

Thanks!",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1108d1/sql_server_transpose_rows_to_columns/
1349232541.0,10urwp,32 Bit ODBC Connection Login Failure,PoglaTheGrate,4,0,9,"ENVIRONMENT: Windows Server 2008R2

Software: MS SQL SERVER 2008

Heya Peeps!

So I have a third party application that hangs off MS SQL SERVER 2008 and creates code etc.

All connections are done via ODBC, even though I'm on a 64bit system.

I'm having trouble getting a Windows User authenticated by the ODBC.  It is a windows user with the credentials of [Domain]\\[Sys-Account-Name].  I have added the user to the SQL Server instance - using Windows authentication, db_ddladmin on the database I'm trying to connect to.  The SQL Server instance has mixed authentication

When I try to use the third party application

Connection failed:

SQLState: '28000'

SQL Server Error: 18456

[Microsofto][SQL Server Native Client 10.0] [SQL Server] Login failed for user '[Domain]\\[SYS Account Name]'.

The Error log states:

Logon

Trying to find a solution just comes up with:

1. Make sure the instance has mixed authentication (it does)

2. Make sure the user is added to the logins (it is)

**edit** Fixed formatting

**edit, edit and drop tables.",,False,self,t5_2qp8q,1349240047.0,,
1348969136.0,10oy8t,Finding All empty tables in MS SQL db ,theavatare,6,1,7,,t5_2qp8q,False
1348839861.0,10m8zb,MS SQL 2008 R2: SSRS Reporting Services - Pagination Problems,AnonymooseRedditor,5,0,6,"Hi All
I have a report that was developed in SSRS 2005. The report is used to print paperwork for tracking serialized items.  There are supposed to be 2 pages per serial #,False,self,t5_2qp8q,False,,,t3_10m8zb
1348497883.0,10e6p7,[MS SQL] Need to compare two collumns. Help?,Riotreaver,5,1,9,"I'm still fairly new to the SQL game so I was hoping Reddit can help me out!

I have two columns,125 etc). 2 Has repeated values (1,2,1,2).  Each value in C1 should ALWAYS have a value of 1 in C2.

I need to run a query that will return all values from C1 that DO NOT contain a value of 1 only.

Any help on this would be appreciated!",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/10e6p7/ms_sql_need_to_compare_two_collumns_help/
1347651210.0,zw3vi,"Insert using Distinct, Max and one other column.",Dylan_Ram_Brick,4,0,http://www.reddit.com/r/SQL/comments/zw3vi/insert_using_distinct_max_and_one_other_column/

The table I am selecting from has three fields, the MAX date_created and the settings associated with that row.

I am saying:
INSERT INTO xActiveUser  (serial_number
SELECT DISTINCT serial_number
FROM xTempUser
GROUP BY serial_number

But it always returns all the records
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/zw3vi/insert_using_distinct_max_and_one_other_column/
1346155481.0,yyh2s,Declaring a variable using Sybase ,whipper515,5,0,6,"I'm trying to declare a variable so I can recall a list of serial numbers multiple times within a query. For example

    where serial_no in ('3990004184'

I've got that a number of times in my query

    where serial_no in setofSERIALNUMBERS

setofSERIALNUMBERS being my variable that I declare,False,self,t5_2qp8q,False,,,t3_yyh2s
1345337956.0,ygahy,"New to SQL, trying to choose a book or two to get me underway. ",jaroto,5,0,http://www.reddit.com/r/SQL/comments/ygahy/new_to_sql_trying_to_choose_a_book_or_two_to_get/

I'm considering three books (listed below) -- any recommendations among these books or others for someone in my position? Any input would be greatly appreciated. 

[Sams Teach Yourself SQL in 10 Minutes](http://www.amazon.com/gp/product/0672325675/ref=ox_sc_act_title_1?ie=UTF8&amp;smid=A1QJ4UH6FW3UH1)

[SQL Cookbook](http://www.amazon.com/gp/product/0596009763/ref=ox_sc_act_title_2?ie=UTF8&amp;smid=A18OZMH8UQINVM)

[SQL Queries for Mere Mortals: A Hands-On Guide to Data Manipulation in SQL](http://www.amazon.com/gp/product/0321444434/ref=ox_sc_act_title_3?ie=UTF8&amp;smid=ASWK2P83YYFWO)

**EDIT:** Thanks everyone for the comments/advice.  Based on what I've heard,,False,self,t5_2qp8q,1345430297.0,,True
1344879515.0,y5jxi,[SQL] - Case Statement Help,SirCaptainMitch,5,0,10,"Trying to pass a variable before the actual Case statement

DECLARE @Item VARCHAR = ''


DECLARE @DataType VARCHAR = '' 




SELECT * 


FROM Employee e 


	 INNER JOIN PaymentCheck pc ON e.EmployeeGUID = pc.PayeeGUID 

	 INNER JOIN PaymentBatch pb ON pc.PaymentBatchGUID =   pc.PaymentBatchGUID 


WHERE @Item LIKE CASE WHEN @DataType = 'EmployeeID' 
				   THEN e.EmployeeID 


			  WHEN @DataType = 'CheckNumber' 
				 THEN pc.CheckNumber 

			  WHEN @DataType = 'Name' 
				 THEN '%' + e.LastName + '%'e.FirstName + '%'

EDIT: Is there a site for displaying this kind of stuff? Makes formatting easier.... ",self,t5_2qp8q,1344880698.0,,,True,http://www.reddit.com/r/SQL/comments/y5jxi/sql_case_statement_help/
1343631876.0,xdqib,Database Abstraction and SQL Injection - How much prevention should be done at the database access layer?,lukaseder,5,3,6,,t5_2qp8q,False
1343239818.0,x55fb,n00b Query question (displaying Y and N values),d3adbor3d2,5,2,7,"This is my query: 

select count(active)
from am_modules
where ACTIVE = 'Y'

It lists the number of active jobs. I just want to include the number of inactives as well (active = N). I can run it on a separate query

 I use an app called Application Manager that does this so the query is not very straight on. I apologize for my lack of know-how. I'm not very well-versed in SQL and pretty much just go at it by process of deduction. Thank you in advance. ",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/x55fb/n00b_query_question_displaying_y_and_n_values/
1343237790.0,x5338,Single DB vs. Multiple smaller DB's,The14thScorpion,8,3,10,"We are designing a comprehensive loan system and one of our ideas is to build the system in such a way that major functionalities/tools have their own database and front-end


What are some of the pros and cons I should consider before implementing such a design?


Some of my thoughts are

**Pros:**

Smaller databases means smaller size and smaller Tx log

Greater Plug and Play possibilities

Lower possibility of bottlenecks as compared to a single DB structure



**Cons:**

More work in maintaining multiple systems

Possible data and structural redundancy 

Data concurrency and integrity challenges




Please help with your suggestions.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/x5338/single_db_vs_multiple_smaller_dbs/
1341946619.0,wcaxj,oracle syntax conversion to ms sql 2005,ectoplasm,8,4,7,"here is the query

Pretty complex query let me know if i need to clarify anything.

SELECT T3.PAYMENT_DATE, (SELECT COUNT(*) FROM INVOICE_ARCHIVE T4 WHERE TO_NUMBER(TO_CHAR(T4.PAYMENT_DATE, 'MM')) &lt;= T3.""Hr"" AND TO_NUMBER(TO_CHAR(T4.PAYMENT_DATE, 'DD')) &lt;= T3.""Min"") AS ""NUM""
FROM(SELECT T1.PAYMENT_DATE
FROM (
SELECT (FLOOR((LEVEL + 359)/60)) AS ""Hr""
FROM dual CONNECT BY LEVEL &lt;= 961) T2
ORDER BY T1.PAYMENT_DATE,,False,self,t5_2qp8q,False,,True
1340562807.0,vj74y,What is the best SQL server for a 512mb webserver?,zeal23,6,0,8,"I have a virtual server with 512mb ram. So far Ive determined that nginx is probably the best option for my webserver

This server will have a very light load. Just a portfolio site with blog. Also,False,self,t5_2qp8q,1340563006.0,,,t3_vj74y
1340313871.0,vehl8,Does anyone know where I can download database with towns and cities by location worldwide for free?,boy1ritchy,9,5,5,,t5_2qp8q,False
1339148395.0,urcrb,[MSSQL] Why is this query better?,DrTrunks,6,0,15,"I've made a query to get the total amount of leave employees have left:

    SELECT [Employee No_]
    SUM(CASE WHEN [Absence Type Code] LIKE 'Leave' THEN [Quantity Hour] ELSE 0 END) AS [Total Leave Left]  
    FROM dbo.[Company$Leave Entry]  
    GROUP BY [Employee No_]

Because this query took 'long' I tried to make it better:

    SELECT  [Employee No_]
    SUM([Quantity Hour]) AS [Total Leave Left]  
    FROM dbo.[Company$Leave Entry]  
    where [Absence Type Code] LIKE 'Leave'  
    GROUP BY [Employee No_]

||Query||Client processing time||Total exec time||WAit time on server replies||  
||1||21.4||33.2||8||  
||2||52.5||66.5||14||  

So the second query is actually worse
edit: i see the table didn't come out as expected...",self,t5_2qp8q,1339148682.0,,,True,http://www.reddit.com/r/SQL/comments/urcrb/mssql_why_is_this_query_better/
1337695736.0,tz92x,[Help request] Bulk loading every .txt file in a folder,j0llyllama,5,1,7,"So I normally work with IIS

I have been able to clean out all of the tags that are generated so any individual file can be cleanly BULK inserted into a properly formatted DB

This is the script that works for inserting an individual file:

    BULK INSERT [dbo].[TABLENAME] FROM 'c:\File_Name.txt'
    WITH (
        FIELDTERMINATOR = ' '
        ROWTERMINATOR = '\n'
    )

",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/tz92x/help_request_bulk_loading_every_txt_file_in_a/
1337339241.0,tt42s,[MS SQL] Need help with a sub query problem,handsome_devlin,5,2,6,"Hey guys
I'm having a problem running a query on a costume rental system that i'm working on.  What I want the query to display is the customer no

So far I have it correctly displaying the Customer No
i.e. Customer 1 has 3 rentals and spent £296 but this shows as Customer 1 having 3 rentals and spending £6456 in the output of the query.        

I'm using a sub-query to calculate how much each customer has spent so can anyone out there tell me why this code won't work?

    Use RENTALS
    select c.customerno,
          (select SUM(daysrented*costperday) as [Total Spent] 
            from rentalitem ri inner join costume cm on ri.costumecode=cm.costumecode
            inner join rental r on ri.rentalno=r.rentalno
            inner join customers c on c.customerno=r.customerno
            where r.CustomerNo = c.CustomerNo) as [Total Spent]
    from customers c inner join rental r on c.customerno=r.customerno
    Group by c.customerno,,False,self,t5_2qp8q,False,,True
1336622537.0,tfxu5,"[MSSQL] Processing 39+ million rows, more than I've ever done before, performance taking huge hit using currently known techniques.",realmkiller,6,13

Every row is different in many different ways

I have two tables

    grab all @CID(unique)
    start loop:
    BEGIN TRANSACTION
    
    process cduration and ctype in this area. the cduration is numeric and can be anything from 1 to max column size varchar(50)
    ctype could be one of 6 things
    
    INSERT INTO History (columns) SELECT (matching columns and certain set variables) FROM Calendar where cid = @cid
    if not exists (select 1 from History where hid = @cid)
    BEGIN
        RAISERROR('Insert failed, -1)
        ROLLBACK TRANSACTION
        BREAK
    END

    COMMIT TRANSACTION

    DELETE FROM Calendar WHERE CID = @cid
    end loop

That's the basic of what we currently have and use on small databases. It works without issue

Any tips/tricks..etc on executing such a thing?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/tfxu5/mssql_processing_39_million_rows_more_than_ive/
1335477673.0,su9ff,[Access SQL query] Comparing two text-based columns,KingZing,4,0,18,"I am trying to compare two columns of data that contain product names.  I want to be able to see the differences between one name column and the next.
Ideally

Thanks for the help.  You guys/gals have been great in the past.

    
    Example Table 1
    ProductIDA   ProductNameA ProductIDB   ProductNameB
    100   Jupiter VA     101   Jupiter VB
    200   Hercules VA    201 Hercules VB
    300   Orion BA     301 Ares VB
    
    
    Example Table 2
    ProductIDA   ProductNameA ProductIDB   ProductNameB
    100   A     101     B
    200   A    201    B
    300   Orion BA     301 Ares VB


Update:  Maybe it would be easier to start at the beginning. Maybe the Tables I ended up with made it harder than it is. (P.s. You guys have been very helpful and I've already learned some things even though they were not exactly helping )

**Breakdown:**

* I have a list of 10
* Most of these comes in sets of three or four. for example: osiris a; osiris b; osiris c
* 
* There is one piece of logic built into our system where if the product type B variant is sold out
* 
* The main problem is that the field that drives the B to A transfer is manually entered.
* 
* The Osiris B should always go into the Osiris A but if someone misskeyed
* 
* I thought it would be easy to run a query that listed all B products
* 
* My next train of though was to somehow subtract one column from the other so that I only see the differences.  This would mean if the B to A was right

Maybe there is an easier way if I modify it or run it differently from the beginning?
I thought maybe I could use the InstrRev function inside the select statement but I am completely new to this function.
[Instr Function](http://www.techonthenet.com/access/functions/string/instrrev.php)

I tried this

        &lt;&gt;Left([TABLE1].[PRODUCTNAME]

Maybe I could trim the right side of each string by a few letters then they would ""ideally"" match perfectly and I could use a not-equal-to?

Anyways.  Thanks again for all the help.  This is a great learning experience and I have really enjoyed this subreddit!",self,t5_2qp8q,True,,,True,http://www.reddit.com/r/SQL/comments/su9ff/access_sql_query_comparing_two_textbased_columns/
1334453371.0,sa8wx,[MS SQL] Beginner needing a little help with joining tables and and duplicate fields.,RobotRollCall24,7,2,5,"I'm doing an assignment for my Database Programing class, and PROJECT). The question I am working on reads as follows (I find the wording slightly confusing):

""Who are the employees assigned to each project? Show ProjectID, LastName, FirstName, and Phone.""

I have been trying to figure out the syntax for this SQL command but it has been driving me nuts. Could anyone give me a push in the right direction? Here are some screenshots of the tables if it helps (All info in the tables is just dummy info

http://i.imgur.com/XyRXS.jpg
http://i.imgur.com/G7N3l.jpg
http://i.imgur.com/4s9av.jpg
http://i.imgur.com/5kfo5.jpg

Thanks in advance!
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/sa8wx/ms_sql_beginner_needing_a_little_help_with/
1333285464.0,rnvc6,HELP PLEASE.  I have a set of queries that i need help with.  ,athysrock,4,0,6,"It includes listing

List the total income received by city.

http://i.imgur.com/6lqgu.png",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/rnvc6/help_please_i_have_a_set_of_queries_that_i_need/
1333168263.0,rm0fp,"Rocking ""Catalog Views"" in SQL Server 2012",janet1237,6,1,2,,t5_2qp8q,False
1332882769.0,rgftw,[Access] Building a query in VBA method 'execute' of object '_connection' failed,redditaccount1975,4,1,6,"UPDATE: Looks like DateDiff and AddDate are reserved words (http://www.everythingaccess.com/tutorials.asp?ID=Problem-names-and-reserved-words#D)  

anyone know a way to get around this and perform the DateDiff and AddDate Functions?

googling leads me to believe I'm using a reserved word in the query somewhere.  Could it be the DateDiff function? thanks!


    Option Explicit
    Sub Access_Data()
     'Requires reference to Microsoft ActiveX Data Objects xx Library
    Dim Cn As ADODB.Connection
    Dim MyConn
     
    Dim Rw As Long
    Dim MyField
     
     'Set destination
    Set Location = [B2:c2]
     'Set source
    MyConn = ""C:\RealogicTools\TestDB_v14.mdb""
     'Create query
    sSQL = ""SELECT RR.TenantID, RR.Suite,"" &amp; _
            ""IIf(IsNull(RR.StartDate),[OAProperty].[AnalysisStart]),RR.StartDate) AS LeaseStart,"" &amp; _
                ""IIf(IsNull(RR.RexpirationDate),[OAProperty].[AnalysisStart],[RR].[ExpirationDate])),0,DateDiff(""""m"""",[OAProperty].[AnalysisStart],[RR].[ExpirationDate])) AS EndPeriod
            ""IIf(IsNull(RR.RexpirationDate),0),DateAdd(""""m"""",[RR].[RexpirationDate],[OAProperty].[AnalysisStart])) AS EndDate, t3.Section "" &amp; _
            "" FROM OARentRoll AS RR

    sSQL = sSQL &amp; ""WHERE (((t3.Section)=""""Base Rent"""") AND ((OAProperty.PropID)=[RR].[PropID]) AND "" &amp; _
            ""((OAProperty.VersionID)=[RR].[VersionID]) AND ((RR.PropID)="""""" &amp; Range(""A1"") &amp; """""") AND ((RR.VersionID)="" &amp; Range(""b1"") &amp; "") AND "" &amp; _
            ""((t3.LineID)=[RR.TenantID]) AND ((t3.PropID)=[RR].[PropID]) AND ((t3.VersionID)=[RR].[VersionID]))""

    sSQL = sSQL &amp; "" ORDER BY IIf(IsNull(RR.RexpirationDate),0),"" &amp; _
            ""DateAdd(""""m""""
    
     Debug.Print sSQL 'copy-paste to Access works great
  
     'Create RecordSet
    Set Cn = New ADODB.Connection
    With Cn
        .Provider = ""Microsoft.Jet.OLEDB.4.0""
        .Open MyConn
        Set Rs = .Execute(sSQL) 'error is here
       
    End With
     
     'Write RecordSet to results area
    Rw = Location.Row
    Col = Location.Column
    c = Col
    Do Until Rs.EOF
        For Each MyField In Rs.Fields
            Cells(Rw
            c = c + 1
        Next MyField
        Rs.MoveNext
        Rw = Rw + 1
        c = Col
    Loop
    Set Location = Nothing
    Set Cn = Nothing
    End Sub",self,t5_2qp8q,True,,,True,http://www.reddit.com/r/SQL/comments/rgftw/access_building_a_query_in_vba_method_execute_of/
1332582087.0,rb90p,SQL Entity diagram,vixemp,5,0,4,"I am looking for a program that can create a database in sql from an entity relationship diagram. I have found for example SQL creator,self,
1331929017.0,qzuw9,[Oracle] Query Assistance,digitalnoise,5,0,7,"I've been struggling with trying to build this report for weeks

I have a product sales report that, the report I originally built worked just fine, until we discovered that Wash Sales were being counted as an actual sale. A wash sale is one that happens when a customer adds another product, and during the course of that transaction, an existing product gets changed - new price point, etc. - but the existing product itself is not truly added or removed. We use product codes to for each product and price point (not my design).

This first sub-select looks for any customer orders that have a product (a customer can have more than one product per order) that has a reporting center of 1

    NVL((SELECT 1 FROM IDST_RATE_REPORTING_CENTER RC INNER JOIN IDST_WIP_CUST_RATE WR ON RC.ACCTCORP=WR.ACCTCORP AND RC.DRATECODE=WR.RATECD
                   WHERE RC.ACCTCORP = 99999 AND WR.HOUSE=C.HOUSE AND WR.CUST=C.CUST AND WR.WPCNT=W.WPCNT AND WR.RATESIGN IN (' '
                   AND (RCTR01 IN (' 1') OR RCTR02 IN (' 1') OR RCTR03 IN (' 1') OR RCTR04 IN (' 1') OR RCTR05 IN (' 1') OR RCTR06 IN (' 1')
                    OR RCTR07 IN (' 1') OR RCTR08 IN (' 1') OR RCTR09 IN (' 1') OR RCTR10 IN (' 1') OR RCTR11 IN (' 1') OR RCTR12 IN (' 1')
                    OR RCTR13 IN (' 1') OR RCTR14 IN (' 1') OR RCTR15 IN (' 1') OR RCTR16 IN (' 1') OR RCTR17 IN (' 1') OR RCTR18 IN (' 1')
                    OR RCTR19 IN (' 1') OR RCTR20 IN (' 1'))
                   AND ROWNUM = 1)

The ""WR.RATESIGN IN (' '

The problem for this particular select is that because it's looking at products (being the only way I can make this work at the moment)

If the order has a net zero change in product

This sub select will give a -1 for order where the product is being removed (much like the one above where it's being added) - the only difference is the WR.RATESIGN argument:

    NVL((SELECT -1 FROM IDST_RATE_REPORTING_CENTER RC INNER JOIN IDST_WIP_CUST_RATE WR ON RC.ACCTCORP=WR.ACCTCORP AND RC.DRATECODE=WR.RATECD
                       WHERE RC.ACCTCORP = 99999 AND WR.HOUSE=C.HOUSE AND WR.CUST=C.CUST AND WR.WPCNT=W.WPCNT AND WR.RATESIGN IN ('-'
                       AND (RCTR01 IN (' 1') OR RCTR02 IN (' 1') OR RCTR03 IN (' 1') OR RCTR04 IN (' 1') OR RCTR05 IN (' 1') OR RCTR06 IN (' 1')
                        OR RCTR07 IN (' 1') OR RCTR08 IN (' 1') OR RCTR09 IN (' 1') OR RCTR10 IN (' 1') OR RCTR11 IN (' 1') OR RCTR12 IN (' 1')
                        OR RCTR13 IN (' 1') OR RCTR14 IN (' 1') OR RCTR15 IN (' 1') OR RCTR16 IN (' 1') OR RCTR17 IN (' 1') OR RCTR18 IN (' 1')
                        OR RCTR19 IN (' 1') OR RCTR20 IN (' 1'))
                       AND ROWNUM = 1)

What I've been struggling to do is find a way to combine both of these so that they return a 1 when it's a true add

I'm pretty sure there's a fairly simple solution to this problem,,False,self,t5_2qp8q,False,,True
1331434093.0,qr1wl,Help with a basic problem (if statement) X-post from r/learnprogramming,Moonj64,4,0,1,,t5_2qp8q,False
1330712830.0,qerdl,[Oracle] Date Calculation for Report,digitalnoise,5,2,9,"Quick background: My employer uses a rather odd (to others

Up until this point I've been able to use SYSDATE and simple functions to calculate dates in my reporting - they've just been the previous day

Now I need to work on reports that have this dynamic date range

What I'm looking for is something that will look at today's date (03.02.2012, the report range needs to stay 02.22.2012 - 03.21.2012, and it's not until the 23rd that it would move on to the next fiscal month.

Is this even possible?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/qerdl/oracle_date_calculation_for_report/
1328219005.0,p8a7e,"Continue learning, more complex stuff in SQL Server",captshady,4,0,http://www.reddit.com/r/SQL/comments/p8a7e/continue_learning_more_complex_stuff_in_sql_server/, I'm coming across seriously complicated stuff (at least from a seasoned IT perspective - I assume a computer scientist wouldn't find much of it complex at all).  

So I need a book that delves into that subject.  Anything I can find covers basic inner joins
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/p8a7e/continue_learning_more_complex_stuff_in_sql_server/
1328108851.0,p666h,[MS SQL] Need Help - BULK INSERT with default values,PeppersMagik,6,1,4,"I've been searching around for quite sometime and can't find much documentation on this

I'm trying to add email suppression files from multiple sites into one table:
Table is pretty straight forward:
ID,SOURCE

My main question is how to do a BULK INSERT from a file containing a list of just EMAILS and specify a value for SOURCE to be populated in for the entire file - sounds simple in my head and I feel like i'm missing something from sql 101...

Furthermore and this I've found a lot more documentation on this is populating the MD5 column automatically with the MD5 version of the email address.

Any help would be greatly appreciated even if that help is a 'why didn't you look in this place' answer.

**UPDATE:** First thanks for the help and advice. I ended up just writing a bash file to normalize the email

    #!/bin/bash
    echo File to process
    read infile
    echo What source name should be used?
    read source
    cat $infile | sed '/^$/d' | tr '[:blank:]' '\b' | tr 'A-Z' 'a-z' &gt; scraps.txt;
    cat scraps.txt | while read line
    do
    echo -n $line | md5sum | awk '{print $1}'
    done &gt; test.txt
    pr -m -t -s
    cat scraps2.txt | awk -v source=""$source"" '{ print $0 ""'""
    rm -f scraps.txt
    rm -f scraps2.txt

Doing everything in SQL would save a step in the long run but being that I'm pressed on time to get this in place it will have to be something I come back to at a later date.",self,t5_2qp8q,True,,,True,http://www.reddit.com/r/SQL/comments/p666h/ms_sql_need_help_bulk_insert_with_default_values/
1328100929.0,p6283,[Access]Would appreciate some help with this query.,achillesminor,5,1,3,"So my boss wants me to do some reporting on a list of calls we're taken in our support desk.  
  
The list is contained in a single table in an Access(2003) file.  
  
Anyway
ID(Int), Customer(VarChar), AccountName(VarChar), EnteredBy(VarChar), DateCreated(Date), AssignedTo(VarChar)  
  
So I'm trying to get list of distinct AccountNames
  
So far
  
    SELECT DISTINCT
        AccountName
        INT(Left(DateCreated
    FROM
        Sheet1
    WHERE
        AccountName &lt;&gt; null
    ORDER BY
        AccountName ASC
  
  
This produces a table like so:  
  
AccountName|Month  
-|- 
Account A|2.0  
Account A|4.0  
Account B|3.0  
Account B|6.0   
  
  
And I'm hoping to produces a table like so:  
  
AccountName|CallMonth|Calls  
-|-|-  
Account A|2.0|12  
Account A|4.0|45  
Account B|3.0|65  
Account B|6.0|34  
  
  
I've tried various queries to achieve it; this being the most recent attempt
  
    SELECT DISTINCT
        AccountName
        INT(Left(s1.DateCreated
        (SELECT
            Count(Int(Left(s2.DateCreated
            as tempDate
        FROM
            Sheet1 s2
        Where
            tempDate = CallMonth)
    FROM
        Sheet1 s1
    WHERE
        AccountName &lt;&gt; null
    ORDER BY
        AccountName ASC

Any ideas? I appreciate it!",self,t5_2qp8q,True,,,True,http://www.reddit.com/r/SQL/comments/p6283/accesswould_appreciate_some_help_with_this_query/
1327754869.0,p0ftn,Postgres Case sensitive issue anyone know a workaround?,mistralol,6,0,4,,t5_2qp8q,False
1327697025.0,ozlhp,Need help on where I can find .... help with SQL/JBoss,KingZing,4,0,2,"Everything involving this new SQL project at work is really confusing and am trying to find some help


Platform1 has

subplatform PD and DM

each of these subplatforms each have 2 tables (x and Y)

Platform14 has

subplatform AB and PS

each of these subplatforms each have 2 tables (x and Y)



* I am using JBOSS database developement and teiid designer.  
* I have configured and deployed two data sources(platform 1 and 14) into one VDB
* I 'UNION ALL' all of the x tables across all subplatforms
* I am trying to run a SQL query that will compare values across all subplatforms for a single value in one of the tables and if any of the values are different between the subplatforms

For example if Platform1SubPD

* Table X
* name = 1
* ssn = 200
* price = 100

And Platform14SubPS has

* Table X
* name = 1
* ssn = 200
* price = 120

then this difference(price) would be generated in my results containing the fields I specify from one of the tables.

**tl;dr
I am new to writing SQL queries against data sources with jboss/teiid.  I am unable to find a good resource for information about this.  Primarily I want to run a query that can show differences between the same tables across different systems by a unique qualifer**",self,t5_2qp8q,True,,,True,http://www.reddit.com/r/SQL/comments/ozlhp/need_help_on_where_i_can_find_help_with_sqljboss/
1327445862.0,ov53g,"How to join products, categories, subcategories",Bit_Blitter,5,4

    products
      product_id
    
    categories
      category_id
      parent_id
    
    products_categories
      product_id
      category_id


It's a fairly standard n-&gt;m relationship between products and categories. Categories have a parent_id which is the id of another category that is its parent. The parent_id is set to 0 if this is a top level category. Products can be linked to a top-level or a sub category.

I have a query that returns a list of only the categories that have products in them by doing an INNER JOIN between the tables above. However this does not return categories whose children have products, or whose children are linked to products?

This is the query that returns all categories that have a product in them

    SELECT *
    FROM categories
      INNER JOIN products_categories ON categories.category_id = products_categories.category_id
      INNER JOIN products ON products_categories.product_id = products.product_id


Any ideas?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/ov53g/how_to_join_products_categories_subcategories/
1326835045.0,old8f,Working with DATETIME boundaries. (SQL Server),tombatron,6,2,1,,t5_2qp8q,False
1325651808.0,o22wd,"Looking for resources to improve my knowledge of 
transactions in RDBMS systems",2,3,http://www.reddit.com/r/SQL/comments/o22wd/looking_for_resources_to_improve_my_knowledge_of/,"Hi all,

I am looking for books or comprehensive articles about transactions, pitfalls, etc.

Anything you can recommend?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/o22wd/looking_for_resources_to_improve_my_knowledge_of/
1325603670.0,o158m,"Oracle self-joins ""(+)"" inside OR loops",mpstein,4,0,16,"I am trying to modify a view to return a value if a entry isn't null

          (
            (
                TBL_TRANSACTIONS.EQUIPSVCSEQ IS NOT NULL
                and GREATEST(TBL_EQUIPANDSERVICES.DEINSTALLWORKORDERSEQ
            )
            OR
            (
                TBL_TRANSACTIONS.EQUIPSVCSEQ IS NULL
                
                and TBL_TRANSACTIONS.WORKORDERSEQ = TBL_WORKORDERS.WORKORDERSEQ (+)}
        )
      )    

Unfortunately

Any suggestions?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/o158m/oracle_selfjoins_inside_or_loops/
1325094630.0,ntsey,Data Structures Question,SEA-Sysadmin,7,3,9,"Hi All

I'm learning SQL as I go

Let me give you an example:
Let say you have a thousand families in a room

You ask EVERY person in the room to list all members of their family.

What you end up with is totally redundant and overlapping arrays.

Now, how is this kind of information typically worked with?  Is there a recommended structure for information like this?

Let's say I want to group every family into a logical unit.  What's the smartest way to handle this?

(now just replace families with hypervisors and  their guest virtual machines

",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/ntsey/data_structures_question/
1321039451.0,m900x,The first issue of the Firebird Project official newsletter,mariuz,4,0,0,,t5_2qp8q,False
1320530450.0,m1s5o,String parsing help,Sotall,5,1,6,"Okay

In the script I am writing for work

30Y,3SRegistered

Each comma-delimited element is a name-value pair. The first two characters of the element (in the example,I2,3S') are the name, and the rest of the characters are the value (can be anywhere from 1 character to 255 characters)

I need to parse this string and dump out each element into records in a temp table with two fields (name and value). For the example above:

    name  value
    30    Y
    95    Square
    I2    Y
    3S    Registered

Any ideas? 

EDIT:
Thanks for all of the suggestions - it got me thinking in the right direction.

First

Here is what I ended up using

    --Take the length of the string containing the string to be parsed
	--and subtract the length of the same string
	--to delete out the delimiter(in this case
    v_n_oo := ((length(v_oo))-(LENGTH(REPLACE(v_oo
	
	--v_n_oo now contains the number of iterations that i need for my loop
	while v_n_oo &gt; 0
        -- the first office_option_type_code is parsed into v_ootc.
            v_ootc := substr(v_oo

            --if no pipes exist in v_oo(making it the last office_option in the string) ...
            if instr(v_oo
        
             -- then assign v_oov the remainder of the string ...
            v_oov := substr(v_oo
		    else
        
                --otherwise
                v_oov := substr(v_oo, '|')-3));

            end if;   
            --now that the office_option is loaded
            v_oo := substr(v_oo

			/* OPERATE ON VALUES HERE*/

            --decrement v_n_oo
            v_n_oo := v_n_oo - 1;
        
        end loop;",self,t5_2qp8q,True,,,True,http://www.reddit.com/r/SQL/comments/m1s5o/string_parsing_help/
1320510193.0,m1hh4,Ram suggestion for ad hoc users,rikrokola,5,0,10,My company uses mssql. What is the suggested ram for querying ~500k records. Is 2g of ram enough?,t5_2qp8q,True
1320165501.0,lwkek,"Help! How do I restore an sql database using phpmyadmin, online guides aren't helping.",,4,0,http://www.reddit.com/r/SQL/comments/lwkek/help_how_do_i_restore_an_sql_database_using/

From 'import' when I select my .sql file I get an error message saying that my database already exists

And if I go to the 'sql' tab I see no one to select a file from my computer to upload.

Any help is appreciated thanks!",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/lwkek/help_how_do_i_restore_an_sql_database_using/
1316204359.0,ki0f4,Self-join Craziness: I can't tell whether the query I just wrote is clever or clunky.,cincodenada,5,1,6,"So
    
    SELECT s.*,prev.rank-s.rank AS moved
    FROM `serps` s 
    INNER JOIN serps prev 
        ON s.keyword_id=prev.keyword_id 
        AND s.search_engine_id=prev.search_engine_id 	
        AND s.time_retrieved &gt; prev.time_retrieved 
    WHERE s.search_engine_id IN(1
    GROUP BY s.keyword_id
    ORDER BY s.time_retrieved

`serps` is a table of search engine rankings, so there are missing days and such.  So this is what I came up with, and it does the job - but as expected, it's pretty slow.  It'll have more WHERE clauses on it in actual use, but...is there a better way to do this?  I could also just loop through each keyword in the code and do a quick LIMIT 2 query - would that be significantly faster or slower?

This

|id|select_type|table|type|possible_keys|key|key_len|ref|rows|Extra|
|:---|:---|:---|:---|:---|:---|:---|:---|:---|:---|
|1|SIMPLE|s|ALL|engine
|1|SIMPLE|prev|ref|engine

",self,t5_2qp8q,True,,,True,http://www.reddit.com/r/SQL/comments/ki0f4/selfjoin_craziness_i_cant_tell_whether_the_query/
1315422342.0,k7vxx,Returning the last inserted or updated row.,jimktrains,6,1,12,"Is there a way to return the last row,False,
1314109145.0,jrp62,SQL Server 2008 SP2 is available for Download.,firepool,10,6,3,,t5_2qp8q,False
1314036591.0,jqsv0,"Migration from Firebird 1.5 to 2.5: 75Gb database, 564 tables, 5000+ procedures",mariuz,5,0,False,
1313873987.0,jp41v,Is there a way to do two queries in one?,twoqueries,6,1,14,"Hi

Sort of:

SELECT * FROM cats WHERE cat = ""black""
AND
SELECT * FROM dogs WHERE dog = ""brown""

So that from the one database and one query I can get all the black cats and brown dogs?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/jp41v/is_there_a_way_to_do_two_queries_in_one/
1312490116.0,j96ab,SQL Server 2008 Failover Cluster fails at install,BruisedGhost,4,0,1,"So I have already configured MS Clustering services to work with my two nodes.  Everything checks out but when I attempt to install SQL Server it errors out telling me that ""The Path is malformed or not absolute"" has anyone ever come across this issue before?

",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/j96ab/sql_server_2008_failover_cluster_fails_at_install/
1312472653.0,j8w2d,[help] A complex query,codl,6,3,11,"Hello /r/SQL

I have a table of tags that can be synonyms (children) of other tags

Note that a tag will not be a parent and a child at the same time

Here is my schema:

    CREATE TABLE tag (
        tag_id SERIAL PRIMARY KEY
        name TEXT NOT NULL
        synonym INTEGER -- tag_id of the tag's parent
    );
    CREATE TABLE image (
        image_id SERIAL PRIMARY KEY
        -- snip
    );
    CREATE TABLE tag_mapping (
        tag_id INTEGER NOT NULL
        image_id INTEGER NOT NULL
    ) WITH OIDS;

And here is the query I've been using, and it feels really hacky:


    SELECT array_agg(t2.name)
    INNER JOIN tag AS t2 ON t.tag_id = t2.synonym
        OR (t2.synonym ISNULL AND t.tag_id = t2.tag_id)
    INNER JOIN tag_mapping AS tm ON t.tag_id = tm.tag_id
    WHERE t2.name LIKE %s
    GROUP BY t.tag_id
    ORDER BY count(*) DESC
    LIMIT 7

Then I can get the first entry of each array to get the tag's name and its parent. It's not exactly what I want and it probably runs slower than it needs to.

Is there any way to do it in SQL entirely?

###Solved,False,self,t5_2qp8q,True,,,t3_j8w2d
1311349936.0,iww83,SQL Server Management Studio Tip: Comment block  ,choudeshell,7,1,3,,t5_2qp8q,False
1310757056.0,iqo3c,SQL Server 2005 - Views needing recompiling?,xstockix,4,1,4,"I found a strange problem on a SQL 2005 SP2 DB today

    SELECT Column1, Column4, Column5 FROM View

This produced an error message saying Column4 and Column5 were invalid. Seeing this I did a quick:

    SELECT * FROM View

And got Column1

    SELECT Column1, Column4, Column5 FROM Table

Total confusion on my end. I ended up just adding a space to the end of it (so it would detect a change and allow me to save it) and everything worked fine. It was like it just needed to be recompiled so to speak. 

I'm currently attributing this to ""ghosts in the schema"" but that's not a very satisfying answer. I would love to know what might have caused this. Anyone come across this before? Care to shine some light on it for me? Thanks!",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/iqo3c/sql_server_2005_views_needing_recompiling/
1310526476.0,io2g5,[help request] Can I return what is missing from a table using a discrete WHERE IN list as the search criteria?,ravag3,5,0,9,"Hey guys

I'm hoping one of you boffins might be able to answer my question.

If I have a table called BOOKS

For example:

My table has three books that are titled :
- Harry Potter
- Ulysses
- A Hobbits Guide to Foot Grooming

and I want to compare a list I have against already existing entries to see if something in my list has not yet been created in the db

select * from BOOKS where bookTitle does not exist in  ('Ulysses'

I want to see only Magician as the output

Is this possible?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/io2g5/help_request_can_i_return_what_is_missing_from_a/
1309484976.0,idtbe,Primary Keys: Surrogate &amp; Composite Keys,tkepongo,6,0,9,"When is it appropriate to use a surrogate vs a composite key? College taught us to use surrogate (SQL Server's identity) but while developing a database at work today (I just graduated),,False
1303930558.0,gylxn,"Introduction to Bitwise ""&amp;"" Operators in T-SQL",lukemerrett,5,3,3,,t5_2qp8q,False
1302733366.0,gpf6o,question about datetime operators,jawz101,4,1,12,"If I have a MS SQL database with a table.timestamp where timestamp is a datetime field is it not acceptable to use
select * from table where timestamp &gt;= '2011' ?

Someone told me ""just don't"" and to at least write it out to '2011-01-01' or even further out to include milliseconds but I don't think it's necessary.  Just wanted to get a 3rd opinion.",self,t5_2qp8q,True,,,True,http://www.reddit.com/r/SQL/comments/gpf6o/question_about_datetime_operators/
1297098541.0,fgy2x,Oracle 11g Grid Infrastructure...,BLUNTYEYEDFOOL,6,2,1,,t5_2qp8q,False
1296308723.0,fbbdy,SQL Performance Explained [xpost from /r/programming],,7,2,0,,t5_2qp8q,False
1295383746.0,f4njl,SQL-splitting program for Ubuntu,,5,0,3,"hey guys

so I have a 12Mb text file full of SQL (2.4Mb when compressed in a zip). I need to upload this to phpMyAdmin (which only allows a max of 2Mb for any single uploaded file). No one is going to go into the php.ini to change any values so that I can upload more than 2Mb, but I can't seem to find any for Ubuntu. Do you guys know of any?

thanks

--Jonathan",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/f4njl/sqlsplitting_program_for_ubuntu/
1295257250.0,f3psw,How to work with a large undocumented database?,sqlninja,6,1,10,"I have recently started working on a legacy project with a fairly large database schema that is not documented at all.

Table names are not carefully chosen and the schema seems to have a bad and unintuitive design.

Long story short: it's difficult for me to understand who's who in the system and as such

Sometimes I have to guess things and implement stuff without confidence that what I am writing is correct, and painful.

Any ideas how I should familiarise myself with this database without asking my colleagues too many questions?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/f3psw/how_to_work_with_a_large_undocumented_database/
1293562733.0,esnyw,SQL 2008R2 on a domain controller - no longer creates security group,,5,0,6,"Previous versions of SQL (2005
Any suggestions.  THANKS in advance!",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/esnyw/sql_2008r2_on_a_domain_controller_no_longer/
1376671697.0,1khwia,[ORACLE] Is there a way to add labels to your query outputs?,RawrBombz,3,0,4,"Ok, C):

    select W
    from A
    where X is 'NULL' group by W;

    select Y
    from B
    group by Y;

    etc.
    etc.

Is there a way to add a label that essentially just shows which Table each output comes from?  Like a **LABEL A, but am having a hard time finding anything.  Thanks so much for your help.

",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1khwia/oracle_is_there_a_way_to_add_labels_to_your_query/
1376649051.0,1khbbn,I have until monday to learn the basics of SQL...,AerialBreakfast,5,1,8,"Hey guys

So as the title says

Thanks!",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1khbbn/i_have_until_monday_to_learn_the_basics_of_sql/
1376434608.0,1kb7ki,[MS SQL] Giving column two different names to be called by,citre,4,1,10,"At my current job, color

EDIT: Let me clarify a bit.  We have a lot of existing sites using column names like ""image"", I just want to use ""imageMed"" (these aren't the actual names, just an example), but I can't rename it in the table because it'll break the old sites.  Is there anyway I can just give this column a second name?",,False,self,1376437951.0,t3_1kb7ki
1376336487.0,1k86cb,[MS SQL] alphanumeric ordering,DoesntWearEnoughHats,4,1,6,"I need a query that will order a single column alphanumerically in a way that will yield results that look something like this.

1

1a

2

3

3a

3b

...

10

11



Thanks in advance for the help. If it makes any difference,False,self,t5_2qp8q,False,,,t3_1k86cb
1376332689.0,1k813o,SQL/VBA Parse code - Showing comparisons between 2 fields of text/string,pole7979,4,1,9,"Hey all
So I'm attempting to find out a way to automate underlining and strikethrough upon different sets of text.  

I work within a sql database but then dump the query into MS Access to develop pdf reports.  We do the underlining of any new text within field text 2 and strikethrough of what has been deleted within field text 1 via PDF pro.  However is there a way to complete this within SQL and dump those results into MS Access or can I complete this within VBA for MS Access?  If so at what level of efficiency/efficacy can this look upon output?

I'm seeking a way to make this an automated process.  I don't have the ability to update the text within SQL database (via code) but can of course create temp tables.  What sort of experiences have you all experienced.",self,t5_2qp8q,1376332912.0,,,True,http://www.reddit.com/r/SQL/comments/1k813o/sqlvba_parse_code_showing_comparisons_between_2/
1376258281.0,1k60xm,Quick question about password,01001000100001,7,5,2,"Hello

I have a webform with a asp:login panel inside it. I made a method which links to a sql database with credentials and checks it against the username and password. To get the username and password,False,self,t5_2qp8q,False,,,t3_1k60xm
1375885138.0,1jvu7p,SQL Script that creates databases...?,ShadowPh0enix,7,6,4,"I have a table titled ""DatabaseNames"" that contains several rows(300+) names of databases that I need to create. Is there a script that can loop through the table

For example, the script creates the YAY database, etc.

Thanks in advance to all contributors!",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1jvu7p/sql_script_that_creates_databases/
1375373851.0,1ji2sl,copying results from columnX in TableA to ColumnX in TableB,whoisearth,6,3,15,"So what I want to do is take a query where I've done

SELECT * FROM TableA

And insert that into an existing TableB

I just tried doing the following - 

Insert into TableB (columnx)

SELECT columnx FROM TableA

Problem is

I'm sure it's something simple but it's not coming to me.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1ji2sl/copying_results_from_columnx_in_tablea_to_columnx/
1375100148.0,1j9soz,[MySQL] SELECT multiple tables?,jamieshepherd,8,4,2,"So I have the following (PHP) code in the header of every content generated page:

$db_query_games = mysqli_query($db

$db_query_reviews = mysqli_query($db

***

Basically: can I just do FROM games

***

For example

$db_games = mysqli_fetch_array($db_query_games);

So would I need to do something like

$db_games = mysqli_fetch_array($db_query[1]); or something?

I assume I should try to reduce the amount of queries I make? This is only an example and the way my little database is going I could require data from several different tables on page load

Any help would be much appreciated,False,self,t5_2qp8q,False,,,t3_1j9soz
1374795233.0,1j2951,How do I create a table in DB2 SQL PL?,xCHRISTIANx,4,1,4,"Hello

Here's some data to use in your example

http://i.imgur.com/OF0diam.png

Edit: Here's the code I have so far. I know it's wrong though.

http://i.imgur.com/ltOAD0F.png",self,t5_2qp8q,1374795571.0,,,True,http://www.reddit.com/r/SQL/comments/1j2951/how_do_i_create_a_table_in_db2_sql_pl/
1374144223.0,1ijuv1,I may need a hint on this one..,G-BuLleT,5,2,11,"Hi guys :)
I've got this project going on and I'm having trouble with a sql query.
I've got a table named Projects and it has these columns:

budget y1t

then I've got budget 1t

What I need to do is loop through all of the budget yXt columns for a certain year

How can I go about doing this?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1ijuv1/i_may_need_a_hint_on_this_one/
1374096739.0,1iij5f,[MSSQL] SSIS package erroring out when using Select into statement,KikoSoujirou,6,3,7,"I'm trying to setup an ssis package to export a file from a query a vendor sent me. The script they sent basically just says 

    SELECT aColumn
    SELECT 'column headers' as columnheaders
    UNION ALL
    SELECT columnheaders from  #tmp
    DROP TABLE #tmp

Whenever I try to put this into the ssis package though using a dataflow ole db source and selecting query

Do I need to create a table upfront with the same columns and then use the rest of their statement or is there a better way for me to approach this?  

Any help or insight is appreciated.

(using visual studio 2008 ver9 fyi)",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1iij5f/mssql_ssis_package_erroring_out_when_using_select/
1374038105.0,1igug5,"Help [2008 T-SQL], trying to Coalesce and Group By in same query",vanGogH20,4,1,http://www.reddit.com/r/SQL/comments/1igug5/help_2008_tsql_trying_to_coalesce_and_group_by_in/

For distinct Date within that table, except there will be distinct rows of Date with the corresponding concatenated Item_No.  

**Example**

Given:

CREATE TABLE #temp1(Item_No varchar(100)

INSERT INTO #temp1

VALUES ((20, 10 Jul 2013), (5, 16 Aug 2013), (9, 16 Aug 2013))   

// I know that my syntax is bad

Want:

[(20

[(5

//^ imagine you're looking at the resultant temp table with each column within parentheses 

http://imgur.com/pES1vGr

I've tried a combination of Group By, multiple temp tables.  Maybe I'm just too tired, but I'm hitting a wall and any help would be greatly appreciated! ",,False,self,t5_2qp8q,,http://www.reddit.com/r/SQL/comments/1igug5/help_2008_tsql_trying_to_coalesce_and_group_by_in/
1373668834.0,1i6o59,Help with a table update[Oracle],liquidDinner,3,0,4,"I have to generate a report of the number of users that come from each state. That part was easy to do with counting the users and grouping by the state they came from.

The problem is that the report only includes the states people came from. No users are from Vermont, so when the report is sent out people can play with it in Excel without breaking things.

My current approach is to create (comp_states) a table with the states as one field
___
***The Problem***
___

I want to update comp_states to set each state's value to whatever that state's count is in the earlier query

If there is another

If I've worded anything stupidly I will answer questions and go back and clarify anything. 

***EDIT***

I can get the values that need to stay zero to stay zero. I have a WHERE in my UPDATE looking for 'ST' in a subquery looking for distinct state values.

However,,False,self,t5_2qp8q,1373669940.0,,True
1372910356.0,1hm3lr,[MS SQL] Rebuilding 1.5TB of partitioned indexes in a production environment,beeeeeeeeks,5,2,7,"I have a SQL Server 2005 database with about 1.5TB of indexes partitioned many many times. I've run some queries that determined the fragmentation levels of these indexes to be 20-98% (inter office politics

After scheduling a downtime for 48 hours I kicked off a query to rebuild or reorganize on everything

My question is

Any tricks or tips for this task?
",self,t5_2qp8q,1372911633.0,,,True,http://www.reddit.com/r/SQL/comments/1hm3lr/ms_sql_rebuilding_15tb_of_partitioned_indexes_in/
1372305940.0,1h5ouq,[MS SQL Server] Should my query be taking this long?,SenseiCAY,4,1,12,"**EDIT:** I want to thank everyone for their help. I took some of your suggestions

    select ...
        [more variables]
        count(distinct(case when A = 3 then B.transaction_ID else 0 end)) as X
        count(distinct(case when A = 2 then B.transaction_ID else 0 end)) as Y
    from ...;

...I did this:

    select ...
        [other variables]
    from ...;

    select count(distinct(B.transaction_ID)) as X from ... where A = 3;
    select count(distinct(B.transaction_ID)) as Y from ... were A = 2;

Total run time on the query was 78 minutes.

-----------------------

Hi

I had a query running a couple of nights ago. It left-joined eight tables

* 25.2 million
* 3
* 8
* 16.7 million
* 22.7 million
* 267 million
* 1.57 billion
* 6.3 million (this table is being left-outer-joined to most of the other ones)

This query took 3 hours and 1 minute to finish. Now, the number of rows in these tables is now:

* 26.0 million
* 3
* 8
* 22.7 million
* 45.6 million
* 267 million (exactly the same as before)
* 1.57 billion (exactly the same as before)
* 12.9 million

Most of the tables have slight increases in size compared to before. One table doubled in size

Thanks in advance for any help and advice!

Edit: code is at http://pastebin.com/4DHHxw01.",self,t5_2qp8q,1372430788.0,,,True,http://www.reddit.com/r/SQL/comments/1h5ouq/ms_sql_server_should_my_query_be_taking_this_long/
1372226584.0,1h3btw,Need help with table/db design,davidintransit,4,1,2,"Hello

I am trying to design a database that would hold different types of items like a computer, computer:processor, printer:dpi etc...)


I need to have a single table called Component that would contain a list of each component. Now I could put everything in one table but I know it is bad design to put a bunch of columns on a single table that may or may not be used (depending on the type of item). So I designed child tables like shown below that would link/reference the parent Component table.


Component
-----------
PK_ID

Name

Description

FK_ComponentType 


.


Then I have the Component Type table:

.



ComponentType
----------------
PK_ID


TypeName


.



Then I have different tables for each of the components:


.




Computer
----------
PK_ID

Brand

CPU

Memory

FK_Component


etc....


.




Is this an okay or bad design?",self,t5_2qp8q,1372227202.0,,,True,http://www.reddit.com/r/SQL/comments/1h3btw/need_help_with_tabledb_design/
1372180859.0,1h1rnr,Need help MSSQL table design please.,willamanjaro,6,4,7,"Hi all

We have a customertable which will hold a record for each of our customers we have. Our customers will be given logins to the database for their users. Users records will reside in the usertable which will have a link to customer table through a customerid

I then have a client table which holds our customer's client records. 

The problem I'm having is that I want a clientstatus table which will hold default records  such as ""live"", but I also want to allow our customers to create their own statuses. Any status a customer creates obviously should only be available to that customer and not others.

Where I am stuck is getting my head around how to design this. The easy route would be to have a customer id in the clientstatus table and repeat the default list for all customers and then allow them to add their own into this table with their customerid assigned to their created records. I really do not want to do this however as I don't want thousands of duplicated default statuses when we should only have one list of default statuses for all our customers to reference.

I thought about having a default clientstatus table and a custom default status table and having a defaultclientstatusid and customclientstatusid in the client table and only allowing one to be filled in at once however I feel that this is messy and bad design.

Any help would be much appreciated thanks.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1h1rnr/need_help_mssql_table_design_please/
1371848226.0,1gtgyr,Demo: A First Look at SQL Server Data Tools (Channel 9),alisa_anny,4,1,0,,t5_2qp8q,False
1371787047.0,1grw0y,How do I *install* Visual Studio 2010 so I can create a SQL database without errors during the creation.,jennym123,4,3,7,"I've been banging my head against my computer for months to the point where I have honestly thought of giving up programming and database design all together. 

I've been trying to create a SQL database using Microsoft Visual Studio C# 2008/10 and I've been running into error message after error message. I've fixed nearly a dozen problems only be be received by another error message to the point where I don't even want to fix them anymore. 

So I'm going to start fresh and delete everything and pretend I've never set up Visual Studio or installed any SQL programs on m computer. 

How do install a copy of Microsoft Visual Studio 2010 (or even 2008) to be able to create a working SQL database without receiving an error in the creation- outside the normal kinds.

Seriously,False,self,t5_2qp8q,False,,,t3_1grw0y
1371493985.0,1gj4jr,problem joining results of a query,whoisearth,5,1,16,"I am querying the same table twice for 2 different sets of info.  Problem with the result is that I'm getting 2 rows per first_name.

first_name   runno   runyes

frank            0           4

frank            2           0

jim               0           4

sally             0           45

harry            23         0

I want the row frank to show as - 

frank            2           4

This is the query I'm using - I need those 2 joins to link the tables together so the query will work

    SELECT first_name
    	CASE
    		WHEN run_val1 = 'N' THEN 'no'
    	END) runno
    	COUNT(CASE
    			WHEN run_val1 = 'Y' THEN 'yes'
    	END) runyes
    FROM run
    	FULL JOIN mst ON (run.mst_id = mst.mst_id)
    	FULL JOIN owner ON (mst.mst_owner = owner.owner_id)
    WHERE run_date = '2013-06-01' AND run.mst_type &gt; 1
    	GROUP BY first_name
    	ORDER BY first_name",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1gj4jr/problem_joining_results_of_a_query/
1370995065.0,1g5s38,Learning SQL the HardWay Help: ex1.db &lt; ex1.sql,sonicace,6,3,5,"In the What you should see section if you scroll down here: http://sql.learncodethehardway.org/book/ex1.html

It tells you to do this line of code ex1.db &lt; ex1.sql but whenever I do that it says ex1.sql: No such file or directory?
Im starting off doing sqlite3 ex1.db and then copying and pasting the code they gave and then .quit but the line of code they offer keeps giving that error?
Any Help? thanks",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1g5s38/learning_sql_the_hardway_help_ex1db_ex1sql/
1369989455.0,1fe73q,[MSSQL] Profiler Blocked Process Help,anon197812,4,1,2,"Hi All

I'm struggling to understand why a process was blocked. The blocking process in on a completely seperate table to the blocked process. How can an unrelated table block another query?

    &gt;       
    &gt;    &lt;blocked-process-report&gt;
    &gt;     &lt;blocked-process&gt;
    &gt;      &lt;process id=""process4332988"" taskpriority=""0"" logused=""0"" waitresource=""KEY: 15:72057594355646464 (7651f42edda6)"" waittime=""9713"" ownerId=""192594018"" transactionname=""implicit_transaction"" lasttranstarted=""2013-05-30T09:25:02.730"" XDES=""0x17101b950"" lockMode=""RangeS-U"" schedulerid=""3"" kpid=""8872"" status=""suspended"" spid=""66"" sbid=""0"" ecid=""0"" priority=""0"" trancount=""1"" lastbatchstarted=""2013-05-30T09:25:02.730"" lastbatchcompleted=""2013-05-30T09:25:02.730"" lastattention=""2013-05-30T06:00:52.683"" clientapp=""Microsoft Dynamics NAV Classic client"" hostname=""ALERTSERVER"" hostpid=""11988"" loginname=""DOMAIN\ALERT"" isolationlevel=""serializable (4)"" xactid=""192594018"" currentdb=""15"" lockTimeout=""10000"" clientoption1=""671156320"" clientoption2=""128058""&gt;
    &gt;       &lt;executionStack&gt;
    &gt;        &lt;frame line=""1"" stmtstart=""26"" sqlhandle=""0x0200000079a05531a083a33a42ac02f684ea01a5cc6eaf3f""/&gt;
    &gt;        &lt;frame line=""1"" sqlhandle=""0x0400ff7fb925310a01000000000000000000000000000000""/&gt;
    &gt;       &lt;/executionStack&gt;
    &gt;       &lt;inputbuf&gt;
    &gt;    (@P1 tinyint)SELECT TOP 1 NULL FROM &amp;quot;DATABASE-LIVE&amp;quot;.&amp;quot;dbo&amp;quot;.&amp;quot;Outgoing Emails&amp;quot; WITH (UPDLOCK)   WHERE ((&amp;quot;Sent&amp;quot;=@P1))   &lt;/inputbuf&gt;
    &gt;      &lt;/process&gt;
    &gt;     &lt;/blocked-process&gt;
    &gt;     &lt;blocking-process&gt;
    &gt;      &lt;process status=""sleeping"" spid=""76"" sbid=""0"" ecid=""0"" priority=""0"" trancount=""1"" lastbatchstarted=""2013-05-30T09:24:20.267"" lastbatchcompleted=""2013-05-30T09:24:20.267"" lastattention=""2013-05-30T09:24:20.243"" clientapp=""Microsoft Dynamics NAV Classic client"" hostname=""CITRIX1"" hostpid=""10048"" loginname=""DOMAIN\AUSER"" isolationlevel=""serializable (4)"" xactid=""192587835"" currentdb=""15"" lockTimeout=""10000"" clientoption1=""671156320"" clientoption2=""128058""&gt;
    &gt;       &lt;executionStack/&gt;
    &gt;       &lt;inputbuf&gt;
    &gt;    (@P1 int,&amp;quot;Document No_&amp;quot;,&amp;quot;Line No_&amp;quot; OPTION (OPTIMIZE FOR UNKNOWN)   &lt;/inputbuf&gt;
    &gt;      &lt;/process&gt;
    &gt;     &lt;/blocking-process&gt;
    &gt;    &lt;/blocked-process-report&gt;

Is it simply because they are both SERIALIZABLE


On a completely unrelated note

So far I've had a play with SSRS

Thanks all",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1fe73q/mssql_profiler_blocked_process_help/
1369843531.0,1f9wnl,[MSSQL] Help needed on a query between two tables,Shtevenen,3,0,9,"So I have a database with hundreds of tables and I've narrowed it down to just the two that I need to work with.
I need to return only unique ID numbers when another column doesn't exist.
Table 1 and Table 2 have a common key, but what I need is a way to exclude that patient ID if the title shows up.

Does this make sense and is it possible to do?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1f9wnl/mssql_help_needed_on_a_query_between_two_tables/
1369743082.0,1f70t7,Our SQL interview questions,jitbit,5,2,1,,t5_2qp8q,False
1369704962.0,1f67yt,"[MS SQL] Which version to use, I feel very lost.",tallandgodless,4,1,http://www.reddit.com/r/SQL/comments/1f67yt/ms_sql_which_version_to_use_i_feel_very_lost/

My question is which version of SQL server do I get?  I have a robust selection (pretty much any version) for free because of my school.  I have a book for 2008 but I'm hesitant to use that when 2012 is already out.

If you could please give me advice on how to proceed,,False,self,t5_2qp8q,False,,True
1369292130.0,1ew2l5,"Hey r/SQL, what is the best software out there for beginners trying to learn SQL?",tarcoal,3,0,http://www.reddit.com/r/SQL/comments/1ew2l5/hey_rsql_what_is_the_best_software_out_there_for/

Ultimately

Thanks for any help :)",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1ew2l5/hey_rsql_what_is_the_best_software_out_there_for/
1369245674.0,1euj39,InnoDB support Spatial index (pure concept of it) ???,vipercvp,3,0,1,"I saw something in the mysql docs but some where it says it has clustered index which is a spatial index ,False,
1369231842.0,1eu1t6,[MS SQL] INSERT INTO probem,HeyJoshuah,3,0,10,"    INSERT INTO ProductsPreferredLocations (ProductID

    SELECT 180, BinID

    FROM ProductsPreferredLocations

    WHERE ProductID = 5407


___


Is it possible to select all ProductID's in the SELECT statement instead of having to just get each individual ID and then constantly run it?

Now that I think of it,False,self,t5_2qp8q,1369232700.0,,,t3_1eu1t6
1369159521.0,1es00k,Down What do I need to get started with SQL?,m0nkeybl1tz,3,0,11,"So I have some coding background,,False
1369158866.0,1erz6p,[LogiAnalytics] Dividing two sql queries,kenseihiko,3,0,11,"Hello everyone

I'm having an issue with getting this code to work

Select a.Paid / b.Owing
From (Select d00_collect.debtor.de_cell_extension
    Sum(d00_collect.de_transaction.tr_to_agency) As Paid
  From d00_collect.debtor
    Inner Join d00_collect.de_transaction On d00_collect.debtor.debtor_rowid =
      d00_collect.de_transaction.debtor_rowid
  Where d00_collect.debtor.de_cell_extension &lt;&gt; 'TEST' And
    d00_collect.de_transaction.tr_type &lt;&gt; '196' And
    d00_collect.de_transaction.tr_type &lt;&gt; '301' And
    d00_collect.de_transaction.tr_type &lt;&gt; '499'
  Group By d00_collect.debtor.de_cell_extension) a
  (Select d00_collect.debtor.de_cell_extension
    Sum(d00_collect.debtor.de_principal + d00_collect.debtor.de_interest +
    d00_collect.debtor.de_misc) As Owing
  From d00_collect.debtor
  Where d00_collect.debtor.de_principal &lt;&gt; 0
  Group By d00_collect.debtor.de_cell_extension) b",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1erz6p/logianalytics_dividing_two_sql_queries/
1368659361.0,1eeyi4,Does the code in this sample look fine before I try it?[TSQL],randomperson24,3,0,4,,t5_2qp8q,False
1368636537.0,1ee3p7,How do i add a default value to a Query?,SOLUNAR,4,1,27,"
SELECT FedTracker.CEC, AllReports.CompletionDate
FROM FedTracker LEFT JOIN AllReports ON FedTracker.CEC = AllReports.CEC;


I want the field AllReports.EnrollmentStatus to have a default value of lets say ""Not Started"" if there is no record

What can i do?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1ee3p7/how_do_i_add_a_default_value_to_a_query/
1368579027.0,1ecp8n,[Postgres] Modeling Hierarchies With Materialized Paths,netghost,6,1,2,,t5_2qp8q,False
1368472018.0,1e9fgs,[MySQL] Selecting Dynamic Date Ranges?,Deanicus,3,0,4,"I searched around on the internet and had difficulty finding what I imagine to be a pretty simple process.

I'm running a report every 5 days with the same tables and data

select *
from table
*where [Date]&gt;= '5/8/2013' and [Date] &lt; '5/13/2013'*",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1e9fgs/mysql_selecting_dynamic_date_ranges/
1368459284.0,1e8yt6,"Just took the CIW 1DO-541 v5 and I failed, AMA",themickeynick,7,6,http://www.reddit.com/r/SQL/comments/1e8yt6/just_took_the_ciw_1do541_v5_and_i_failed_ama/,False,
1368209583.0,1e2yve,[ACCESS] SQL issue.,SOLUNAR,6,3,7,"http://i.imgur.com/T7Wth0p.png 

Im having a bit of trouble

I want to update the yellow reports manually

Im a bit new so just trying to understand the best logic for this type of thing. I assume a SQL query to join left all of them? sorry just confused of the most efficient way.

",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1e2yve/access_sql_issue/
1368199425.0,1e2mp6,[SQLite] Brand-new to SQL. Can somebody help me out?,ansabhailte,3,0,8,"Hey guys

I'm a command-line junkie Linux user, grep, awk; and cron. However, I am thinking that the best way to store this data would be in a SQLite database. 

The current task I'm trying to accomplish is creating a set of information regarding tasks. It will include a task name, the data source, and a description. I thought about just making basic multi-dimensional arrays, but I also want to link this data to a calendar on the same page, and associate it with other data for a historical system. I think SQLite will do fine.

My question, and how could I write and access it?

Thank you all in advance. Please have patience with me :)",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1e2mp6/sqlite_brandnew_to_sql_can_somebody_help_me_out/
1367765943.0,1dqeid,[MS SQL] Need some advice on calculating Exponential moving Average in SQL Server 2012,Effayy,4,1,11,"I've been fiddling with a C# application in order to keep track of stock prices and track their SMA/EMA values over various periods to spot buy/sell signals.

in my DB is a ""Trades"" Table with the following Design:

    tradeID as Int (PK / Identity Auto-Increment)
    tradeDate as datetime
    amount as numeric
    price as numeric

Calculating the SMA (Simple moving Average) for this in a view was quite simple. I used the following query in a view:

    SELECT Maxgrouping.LastTradeID,
    AVG(Maxgrouping.price)OVER(ORDER BY MaxGrouping.TradeDayClose ROWS 89 PRECEDING) as SMA90DayPeriod
    AVG(Maxgrouping.price)OVER(ORDER BY MaxGrouping.TradeDayClose ROWS 29 PRECEDING) as SMA30DayPeriod
    FROM (SELECT B.LastTradeID
       FROM dbo.Trades as A
       JOIN (SELECT max(tradeID) as LastTradeID
       max([date]) as TradeDayClose
       FROM dbo.trades
       GROUP BY CAST([date] as date)) as B
    ON A.tradeID = B.LastTradeID) as MaxGrouping

This gives me accurate SMA values.  Now calculating the EMA is a different ball of wax.  The method of calculating the EMA is as follows:

    Yesterday's EMA + (2/(number of periods +1)) * (Today's price - Yesterday's EMA)

To quote another post I found somewhere that discusses how to seed this EMA:


&gt;    EMAs are initially seeded with SMA, and then the next day you will calculate the EMA using yesterday's SMA.


I've been wracking my head over this for hours.  Is there a way that I can use the same view above to also add EMA30Period and EMA90Period?  Unfortunately unlike the SMA where I used a different column to average (Price)

I was hoping to do this strictly within a view,,False,self,t5_2qp8q,False,,True
1367325310.0,1dengk,[MS SQL] Why does my update trigger prevent the record from being changed?,Sybs,3,0,4,"Hi folks

    DECLARE @AlertText AS NVARCHAR(MAX)
    
    SET @AlertText = (
    				SELECT 'App No: ' + CAST(I.APPLICATION_NO AS NVARCHAR(10)) + CHAR(13) + CHAR(10) + 
    					'Name: ' + I.SURNAME + '
    					CHAR(13) + CHAR(10)
    				FROM INSERTED I WITH (NOLOCK)
    				INNER JOIN DELETED D WITH (NOLOCK) ON I.APPLICATION_NO = D.APPLICATION_NO
    				WHERE (I.COURSE_NO IS NULL AND D.COURSE_NO IS NOT NULL 0)
    				)
    
    IF @AlertText IS NOT NULL
    BEGIN
    
    	EXEC msdb.dbo.sp_send_dbmail
    		@profile_name = 'blah'
    		--@recipients = 'blah@blah.com'
    		@recipients = 'blah@blah.com'
    		@body = @AlertText
    		@subject = 'blah';
    END        

It's basically to email somebody when the COURSE_NO field gets changed from something to NULL.

Only problem is that is it's preventing the users of the application from changing the field to null. It doesn't say what the error is, just not to NULL.

Why is the trigger preventing this from happening?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1dengk/ms_sql_why_does_my_update_trigger_prevent_the/
1366995767.0,1d5wx7,How to list column values as columns? Basically transposing data sets.,twonx,4,1,7,"Let's say the table is created like this:

YEAR|MONTH|ITEM|SALES
--:|--:|:--:|--:
2012|2|W01|830768
2012|9|W01|579341
2012|12|W01|621877
2011|2|W02|5286
2012|5|W02|8710
2012|12|W02|6378
2012|3|W03|7770.94
2012|6|W03|5568.01
2012|9|W03|5697.94
2012|12|W03|4563.99
2012|3|W05|3231.01
2012|6|W05|2593.99
2012|3|W06|-945.99
2012|6|W06|-555
2013|9|W06|-60
2012|3|W08|-24977.97
2012|6|W08|-19846.96
2012|10|W08|-29059.98
2012|7|W12|-1181.99
2013|10|W12|0


What would I have to do so that it lists the item elements as columns and the sales amount are the rows?

I'd like the output to be something like this:

W01|W02|W03|W05|W06|W08
--:|--:|--:|--:|--:|--:|
$Sales|$Sales|$Sales|$Sales|$Sales|$Sales|

Where year = 2012.


Thanks in advance!
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1d5wx7/how_to_list_column_values_as_columns_basically/
1366733242.0,1cxxz7,[MSSQL] Query to return records based on timestamp comparison of previous record (with other checks),The_Ombudsman,3,0,11,"I've got the following query that functions fine:

    SELECT t1.ID
    FROM Table1 t1
    WHERE t1.OtherID = (one ID value)
    AND t1.Type = 1
    AND NOT EXISTS (
        SELECT t2.ID
        FROM	Table1 t2
        WHERE t2.OtherID = (same other ID value as above)
        AND t2.Type = 2
        AND t2.ID = t1.ID
    )

Basically I'm querying for all occurances in a given table for a given ID

The query as above (edited for clarity and paranoia) works fine as far as that goes - but I need it to do something else, a 10 minute span.

Below is the data sample I'm working with: I've flagged the records I'm looking to get back with an  asterisk. They're all Type=1 with no Type=2 within the prev. 10 minutes. 

    ID 	 	Timestamp 	 	 	 	Type
    2879 	2013-04-22 10:03:30.107   	8
    2879 	2013-04-22 10:06:31.530   	2
    2879 	2013-04-22 10:06:40.343   	2
    2879 	2013-04-22 12:41:29.437   	2
    2879 	2013-04-22 12:41:35.843   	2
    2879 	2013-04-22 12:41:40.090   	2
    2879 	2013-04-22 13:55:32.107   	1 *
    2879 	2013-04-22 15:51:06.483   	2
    2879 	2013-04-22 15:52:08.607   	2
    2879 	2013-04-22 15:54:43.997   	2
    2879 	2013-04-22 15:55:42.717   	1
    2879 	2013-04-22 15:56:53.013   	2
    2879 	2013-04-22 16:38:37.467   	1 *
    2879 	2013-04-23 08:44:19.000   	1 *

I've tried adding in this line

    AND DATEDIFF(minute

but that's not doing the trick. I'm either getting back no records

I've also spent the last good while googling around,2) and go that route. Most involve simpler queries with sequential row numbers and using those values as pointers to the next/previous record - my base query is too selective to work that way.

**Edit: Resolved

The trick seemed to be handling the DATEDIFF as a BETWEEN instead of less-than. Just dropping that one line from his example (see his reply below for a link) worked great in my original syntax - but his modification of my original syntax runs a bit faster than my original syntax so I'm going with that.
",self,t5_2qp8q,1366752907.0,,,True,http://www.reddit.com/r/SQL/comments/1cxxz7/mssql_query_to_return_records_based_on_timestamp/
1366639291.0,1cv2xv,Little help with a union problem..,brolax420,3,0,5,"Here is the problem: 
List all students’ first, costs (or fees), and student notes, format dollar amounts to two places, including dollar sign ($), order by student last name in descending order, use “activity fee” as the alias name for the activity fee.

Okay so I understand that in order to pull data from two different tables

select stu_fname,concat('$', format(act_fee,2)) as 'activity fee', stu_notes, 
from student

order by stu_lname desc;

Thanks for any help... 
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1cv2xv/little_help_with_a_union_problem/
1366202160.0,1cj1em,"I can't figure out what I'm doing wrong in this command, can someone help me please?",Novirtue,5,2,http://www.reddit.com/r/SQL/comments/1cj1em/i_cant_figure_out_what_im_doing_wrong_in_this/

   SET Region = b.ID

FROM RafSil_QuarterlyBonus2013 a
   
   WHERE a.Region = b.Region;


A couple things to note

#1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'FROM RafSil_QuarterlyBonus2013 a

**edit:** figured it out!

UPDATE `RafSil_QuarterlyBonus2013` AS a

SET a.Region = b.ID

WHERE a.Region = b.Region
",self,t5_2qp8q,1366206859.0,,,True,http://www.reddit.com/r/SQL/comments/1cj1em/i_cant_figure_out_what_im_doing_wrong_in_this/
1366163748.0,1ci6l0,Novice looking for SQL guidance,OcciferGlass,3,0,17,"Evening everyone

In short

I'm currently a data analyst and have created very trivial queries just for extracting minimal amounts of information from our database, I need to go more down a more developer-related route (EG: creating tables, complex queries, etc.). Any help will be much appreciated, thank you :).

Also,False,self,t5_2qp8q,False,,,t3_1ci6l0
1365950427.0,1cbrfx,[MS SQL] How to calculate the nth root of a number,jgagnon_in_FL,3,0,2,"Example input = output

27^(-3) = 3

1.21550625^(-4) = 1.05 (5% interest compounded quarterly for 1 year)

14.974457839207^(-40) = 1.07 (7% interest compounded daily for 40 days)

I have played around with the POWER function to no avail

ETA: Given a return over a period,False,self,t5_2qp8q,1365950750.0,,,t3_1cbrfx
1365945981.0,1cbo7s,"[MySQL] Trying to install, but failing at configuration",Henshin_A_JoJo,3,0,http://www.reddit.com/r/SQL/comments/1cbo7s/mysql_trying_to_install_but_failing_at/

I'm trying to install MySQL for my database class. I accept terms, client, workbench programs, no documentation or plugins etc), it installs, goes to configure and FAILS. This is the error I receive at configuration:




""Unable to connect to any of the specified MySQL hosts""




I have administrative privileges, and may even start using the workbench...it's all I want to install...and I can't do ANYTHING because of this error.

Please /r/SQL ! Your my only hope!

Note: I realize this may be something really obvious and stupid,False,self,t5_2qp8q,False,,,t3_1cbo7s
1365725379.0,1c67qs,[SQLiteman] Having some trouble with a basic query,Wockna,3,0,2,"Ok so the query is to 'List the video id

Help is appreciated,False,self,t5_2qp8q,False,,,t3_1c67qs
1365684237.0,1c4q3l,[MS SQL] Inserting to multiple tables simulataneously and asp.net,qckslvr42,4,1,7,"Hello. Sorry

 

The basic premise is this: I've created a database to house all our keys for software. Even though it's going to be a pretty small database, I am doing this project so I can learn ASP.NET and SQL Server 2012. I've also never had a database in production, I've only ever done them in undergrad classes and instances needed for things like System Center (I have more sysadmin experience than DBA).


A basic overview of my tables


**Publisher**

pub_id smallint PK identity    
pub_name varchar(50)    
pub_notes varchar(255)    

**Product**

pro_id smallint PK identity    
pub_id smallint FK      
pro_name varchar(50)    
pro_notes varchar(255)    




And so on


So, Version, etc all the way down the line so a user can enter records in with dropdown or by typing in a new name if it doesn't exist. I figured I would create that first and actually populate my database using this method since it's so small. A button would fire a stored procedure that would then insert into publisher, select identity insert into product, select identity insert into version, etc. 


I see a lot of info online to use scope_identity, you can't use that in this scenario since I have an FK constraint on my identity column.


Any and all advice would be welcome. If you made it through all this text you have my thanks.


Edit: I have no clue why the formatting in this post is all messed up. 

",self,t5_2qp8q,1365685119.0,,,True,http://www.reddit.com/r/SQL/comments/1c4q3l/ms_sql_inserting_to_multiple_tables/
1365625205.0,1c341j,Getting a syntax error in the below good. (TSQL),e13ct,3,0,7,"I work for a small-ish university

    USE Enterprise_Test
    Go

    SET ANSI_NULLS ON GO
    SET QUOTED_IDENTIFIER ON GO
    SET ANSI_PADDING ON GO

    Select 
    Student1.FirstName
    Student1.MiddleInitial
    Student1.LastName
    Student1.StudentID
    Student1.StudentUID
    StudentStatus.Campus
    Demographics.StudentUID
    Demographics.Gender
    StudentStatus.StudentUID
    StudentStatus.StudentRegistered
    StudentStatus.GPAGrouping

    From Student as Student1 
	    Inner Join CAMS_StudentDemographics_View as Demographics
	    Inner Join CAMS_StudentStatus_View as StudentStatus
	    ON Student1.StudentUID=Demographics.StudentUID
	    Student1.StudentUID=StudentStatus.StudentUID
	   
 
    Where 
    Demographics.Gender = Female 
    and 
    StudentRegistered = YES 
    and 
    Campus = MAIN 


     Group by Student1.StudentID

Edit1: thanks to Konwayz for the extra comma after GPAGrouping. Win to you sir and/or madam. 

However,False,self,t5_2qp8q,1365626046.0,,,t3_1c341j
1365563016.0,1c1e29,[MS SQL] GROUP BY issue column spaces,,4,1,4,"Using SQL Express 2008 Windows Server 2008 R2

I am a novice at writing queries as I don't have to do it very often and when I do they are very simple but after spending a few hours trying to find a solution or workaround I have decided to ask for help from the pros.  
When using GROUP BY in my queries I normally have no issues as my queries are typically very simplistic in nature…that is until I had to deal with a table that has columns with spaces.  If I run my query on the SQL server in Management Studio it works just fine but if I use SQLCMD or access the data via PHP I keep getting the error ""Each GROUP BY expression must contain at least one column that is not an outer reference.""  I read up and tried to understand what this means but since the query works in Management Studio I don’t think I am doing anything wrong in my query (Please correct me if I am!).
For example
    
    SELECT LastTemplateUsed as NAME
    FROM [DATA_Reports].[dbo].[Photo]
    GROUP BY LastTemplateUsed ORDER BY COUNT DESC

But this next query gives me the error I mentioned above if I use SQLCMD or PHP but works in Management Studio:

    SELECT ‘Branch ID’ as BRANCH
    FROM [DATA_Reports].[dbo].[Archival]
    GROUP BY ‘Branch ID’

If I remove the GROUP BY it works but obviously not as I would like it to.  As far as I can tell the only real difference here is the quotes I have to use because of the column name.  Something just isn’t working when I try to run this query remotely through sqlcmd.  I have tried double quotes just for grins but that doesn’t help.  
This is an example of how I run sqlcmd:

    ""C:\Program Files (x86)\Microsoft SQL Server\90\Tools\binn\sqlcmd” -U username -P password -S SERVERNAME\SQLEXPRESS -i count.sql -s ""

Any help is appreciated!
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1c1e29/ms_sql_group_by_issue_column_spaces/
1365408405.0,1bwn2d,How to do a conditional Sum by distinct id?,,3,0,19,"Suppose you have result set such as:

Items       |   OrderID  |   DeliveryFees

* ItemA     |       1       |       20   
* ItemB      |      1        |      20
* ItemC      |      2        |      20

I want to calculate the Sum of DeliveryFees grouped by Distinct OrderID. 
In the sql statement


Now I need to calculate the Sum of ""DeliveryFees"" column by distinct OrderID. I want it to be a subquery inside the main query. The result should be 40.

I know it's a bit complicated and I can't explain it that well. But is there a way to make a conditional Sum based on a distinct ID?

Thanks in advance.
   
",self,t5_2qp8q,1365408621.0,,,True,http://www.reddit.com/r/SQL/comments/1bwn2d/how_to_do_a_conditional_sum_by_distinct_id/
1365014344.0,1blr6o,[MySQL] How do you join two tables using a third as an index?,guardianfx,4,2,6,"I am trying to learn MySQL / PHP and I am attempting to set up a database for users and purchased products. I have 3 tables. 

    users
    * userid
    * fname
    * lname

    product
    * productid
    * title
    * price
    * description

    purchased
    * id
    * userid
    * productid

What I can't seem to figure out, can't quite get it right. 

EDIT: The query I have which I know is very wrong. 

    SELECT * FROM product
    JOIN purchased ON product.productid
    JOIN users ON purchased.userid
",self,t5_2qp8q,1365015259.0,,,True,http://www.reddit.com/r/SQL/comments/1blr6o/mysql_how_do_you_join_two_tables_using_a_third_as/
1364308161.0,1b1j9r,Logic Death!,BLUNTYEYEDFOOL,4,1,11,"In my table

I want to exclude rows where all three are 0.

When I use this construct
AND		(  
		opening_balance &lt;&gt; 0 AND  
		movement &lt;&gt; 0 AND      
		closing_balance &lt;&gt; 0  
		)   
  
  
When I use this construct:  
AND		NOT (  
		opening_balance = 0 AND  
		movement = 0 AND   
		closing_balance = 0  
		)   
I get the right result

I can't explain this to myself,False,self,t5_2qp8q,False,,,t3_1b1j9r
1364205942.0,1ayse2,"Management Studio Results to File, is it possible to not print the ""number of rows affected""",strama,4,1,http://www.reddit.com/r/SQL/comments/1ayse2/management_studio_results_to_file_is_it_possible/,self,
1361979943.0,19bxu0,Julian dates converting incorrectly when using TO_DATE,JCollierDavis,3,0,8,"*edit:Working with an Oracle Db.*  I have the following piece of a query.

    TO_DATE(date_dol

It finds 96130 and converts it to 5/9/2096 instead of 5/9/1996.  How can I force it to understand the correct year?

Have I discovered a Y2k bug 13 years late?",self,t5_2qp8q,1361986104.0,,,True,http://www.reddit.com/r/SQL/comments/19bxu0/julian_dates_converting_incorrectly_when_using_to/
1361759043.0,19619y,"[MS SQL] Taking a databases/Access SQL class, exam coming up this week, I would appreciate any help on this practice problem!  (Aggregate function)",coll9947,6,8

STUDENT  
stuid*  
stuname  
major  
credits  

The question is: Display all students (stuname) who have less than the average number of credits.

My idiot brain keeps wanting to:

SELECT stuname
FROM student  
GROUP BY stuname  
HAVING AVG(credits) &gt; credits

This isn't returning correct results in my practice table in Access and I have no idea how to even approach this problem.

Any help would be greatly appreciated!  Thank you in advance!

*edited for formatting,False,self,t5_2qp8q,1361760725.0,,,t3_19619y
1361558984.0,1919x4,Calculate a column against itself.,yellising,5,2,6,"Sorry for the not so clear title

So I have a simple table with 2 columns.
AgentName and OVS.
Agentname is just the name of the agent and OVS is the score they receive from customers. OVS can only be 1 to 9.
To be counted as a good survey
So I need to get the overall score of every agent where score=goodsurvey/totalsurvey

--how i get the count of goodsurvey

    select agentname
        count(ovs) as goodSurvey
    from tbl_qos
    where ovs &gt;= 8
    group by agentname

--how i get the count of totalsurvey per agent

    select agentname
        count(ovs) as totalSurvey
    from tbl_qos
    group by agentname


I'm thinking of using the 2 queries above as subqueries so I can calculate them against each other but I'm not really sure how. I'm kinda new to SQL. ",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1919x4/calculate_a_column_against_itself/
1360375621.0,1864xk,[MySQL] Optimizing for huge tables,Fencepost,3,0,6,"I have an extremely large table that can't reasonably be split.
Here's a quick screenshot of the actual schema:

http://imgur.com/q8SOLbS

foreignKeys are implied by naming conventions in that screen cap

Now the dataset in ""runData"" contains close to 50Million rows.

When querying runData
Because of this

The problem is that some of my queries require simple search and that is incredibly painful on this table.
I'd like a way to tell MySQL that this table should be stored sorted on runId or something similar - ie tell it that this is essentially a bunch of separate tables.
I've tried adding an index (ind_on_runid) but it hasn't improved my performance much (and kinda degraded it but not by much). For example
    SELECT DISTINCT coordinateId FROM runData WHERE runData.runId=4;

What can I do? this is really multiple tables that share an identical schema
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1864xk/mysql_optimizing_for_huge_tables/
1359876863.0,17srev,[SQLITE] Convert MySQL to SQLite,rarisgod,4,1,13,"I am currently using the database located [here](http://wing.comp.nus.edu.sg/SMSCorpus/) for a project. However, etc. only to just end up with more errors.

Does anyone know of a clean,False,self,t5_2qp8q,False,,,t3_17srev
1359770905.0,17qdaz,[MS SQL] Can't log into server through mgmt studio,Liger86,4,1,3,http://i.imgur.com/vYvpJYk.png does anyone know why this isn't working?,t5_2qp8q,True
1359602649.0,17luv3,Help with nested queries and multiple data sources (mySQL/msSQL),funky_mesopotamian,3,0,4,"So I'm working on a little project and while I understand the big picture of what needs to be done

I need to create a pass through query in MSAccess to query data in MySQL from two data sources.  While I know that nested queries are not the most efficient and there are likely better ways out there

    **SELECT DISTINCT x1.PK
                      tblPM.fieldMDPK
                      tblPM.fieldODPK
                      tblC.fieldC
                      x1.fieldCC
                      x1.fieldFNK
    FROM (tblPM INNER JOIN tblC 
    ON tblPM.fieldC = tblC.fieldC) 
    INNER JOIN**

    (SELECT tbl2.fieldPK
                     tbl2.fieldCC
                     tbl2.fieldPT
                     tbl2.fieldFNK
                     tbl2.fieldM
    FROM tbl2
    AS mirror
    INNER JOIN tbl2 
    ON (tbl2.fieldM = mirror.fieldM) AND (tbl2.fieldFNK = mirror.fieldFNK) AND (tbl2.fieldPT = mirror.fieldPT) AND (tbl2.fieldCC = mirror.fieldCC)
    WHERE ((tbl2.fieldPK)&lt;&gt;(mirror.fieldPK)) AND ((tbl2.fieldCC)=102))
    AS x1;)

    **ON tblPM.fieldPK = x1.fieldPK);**

Bold is the outer query

    **(ON tblPM.fieldPK = x1.fieldPK);** 

but I can't figure out why.  I need to basically run the subquery and then have the outer query join that temporary table with 2 other tables to get my results.  From what I read on forums found through Googling

In addition

Can anyone enlighten me?  I am very new to this and am learning by doing but I haven't been able to find an example of this online that has been helpful to me.  Can anyone out there help clear this up

Edit: Formatting",self,t5_2qp8q,1359643544.0,,,True,http://www.reddit.com/r/SQL/comments/17luv3/help_with_nested_queries_and_multiple_data/
1359547904.0,17k2ta,[MS SQL] Help with stored procedure,jataja,4,1,5,"Hello

I'm stuck on these two stored procedure which are (at least I assume) similar. I have tables Tags and Products. One stored procedure receives string in format (Gaming, and search all tags with received parameters.
 Now I know I need to make comma separation and loop through each tag and select matching products in this case lets say Assassin's Creed and Assassin's Creed Brotherhood but I'm not very good with SQL queries and don't know how to write it.

Second is updating existing product
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/17k2ta/ms_sql_help_with_stored_procedure/
1359480985.0,17i7fj,translate an Access statement Iif into SQL select statement,randomperson24,3,0,16,"I’m trying to figure out how to translate an Access statement into SQl.  Below is iif’s statement which I cannot get to work in SQl.  I don’t believe I can use Case When because there is more than one column invovled.  Also when I change to the SQL view in Access

SELECT
IIf(Table1.”COLUMN1” Is Not Null
Table1.”COLUMN1”
Table1.”COLUMN2”
Table1.”COLUMN3”)) AS 'Source_ID'
FROM
Table1
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/17i7fj/translate_an_access_statement_iif_into_sql_select/
1359421629.0,17grrt,[MS SQL] Bubble up content,Dahey,3,0,9,"I have the following data set

Source | ID | Property1 | Property 2 | Property3 | Property 4

1          | A1 | Null           | ABC           | Null          | Null

2          | A1 | XYZ           | Null            | AB1         | Null  

3          | A1 | Null           | Null            | OPQ        | Null


I have three data sources that have been merged into a single table. I want to create a new row in this table where content bubbles up per column.  Look at property 1


Source | ID | Property1 | Property 2 | Property3 | Property 4

4          | A1 | XYZ          | ABC            | OPQ          | Null

Any help or direction will be appreciated!

Thank you in advance!",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/17grrt/ms_sql_bubble_up_content/
1359295632.0,17d9wd,How to apply auto filter when opening management studio?,dalenn,5,2,4,"Hi

Is there a way to set this?

Thanks!",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/17d9wd/how_to_apply_auto_filter_when_opening_management/
1358868549.0,1723na,Serious LAG with SQL queries for remote users,falconfox,3,0,6,"Hi. I've been learning SQL for about 9 months now using Access. Just this week

I'm wondering if this problem is a network speed problem on my end, thinking that this might be a solution.

My goal is to have a system where remote users have quick access to the database. In addition, then go to those websites while hiding their IP address.

I can answer any other questions or clarify goals/objectives if I've been unclear. ",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1723na/serious_lag_with_sql_queries_for_remote_users/
1358619858.0,16vw3m,Accessing  files quickly  from a storage drive.,pressthebuttonfrank,3,0,3,"I am looking for a way to access files lumped  into a storage drive.  Most are word, etc.  The files are now just randomly dumped on the drive with little directory structure. Any ideas?",t5_2qp8q
1358281363.0,16myg1,Scripting a Primary Key doesn't work for some reason,macness234,4,1,6,"I'm trying to move a primary key from one Database (SQL2000) to another database. In the original database I have a primary key that I've used SMMS to script this to a new query window:

    USE [DatabaseName_Test]
    GO
    
    ALTER TABLE [dbo].[tbl_itinerary_item] ADD  CONSTRAINT [PK_tbl_itinerary_item] PRIMARY KEY CLUSTERED 
    (
    	[activity_id] ASC
    )WITH (PAD_INDEX  = OFF, IGNORE_DUP_KEY = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
    GO

All I did was change the database:



    USE [DatabaseName]
    GO
    
    ALTER TABLE [dbo].[tbl_itinerary_item] ADD  CONSTRAINT [PK_tbl_itinerary_item] PRIMARY KEY CLUSTERED 
    (
    	[activity_id] ASC
    )WITH (PAD_INDEX  = OFF, IGNORE_DUP_KEY = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
    GO

The error I get is

Msg 170, Line 5
Line 5: Incorrect syntax near '('.

What am I missing?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/16myg1/scripting_a_primary_key_doesnt_work_for_some/
1357321928.0,15yknu,[MS SQL] Need help with query,tedistkrieg,3,0,9,"I work for a casino and I am doing an aging report for the machines on the floor.  I am trying to determine what active machines started on the floor from 1999-2012.  

There are two tables. A machine table and period table. The machine table has all the information about the machines including start and enddates. However, the machine number changes as well and it begins a new startdate.  In order to find the physical machines you have to use the serial number rather than the machine number. 

The period table has the information for the coin-in and coin-out amounts for every time the machine was played from the very beginning. This table can be used to determine when the machine went on the floor for the first time.  But it will return numerous results for a single machine.

For example

    Select distinct(m.serialnum)
        from Machine M left outer join period p on m.mnum=p.mnum
        where date between ('01-01-1999') and ('12-31-1999') and m.status='a'

that will return one machine the Sigma Derby

now when I run the query with dates between 01-01-2000 and 12-31-2000 it will return the machines that started in 2000

Is there a way to run a query that will omit machines that had any play in 1999? Like Select machines where the date is between 01-01-2000 and 12-31-2000 but have no dates in 1999?
Hopefully I explained this well enough. ",self,t5_2qp8q,1357323456.0,,,True,http://www.reddit.com/r/SQL/comments/15yknu/ms_sql_need_help_with_query/
1357320902.0,15yjjs,Slow IN query changed to several quicker queries. How can I further make it faster or reduce number of queries?,hesterbest,5,2,16,"The originating query was something like this:

&gt; SELECT id, 3,  ... , 99) GROUP BY id

The query was very slow so I changed it into:

&gt; CREATE TABLE tmp (
&gt; 	id VARCHAR(32)
&gt; );

&gt; INSERT INTO tmp (id) VALUES (1), ... (99)

&gt; SELECT matches.id

&gt; DROP TABLE tmp;

This was a lot quicker

I am using MySQL.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/15yjjs/slow_in_query_changed_to_several_quicker_queries/
1357048544.0,15rs2f,[MSSQL] Looking to insert a list into an existing table which auto-increments the primary key. Can't get it working.,n35,5,2,22,"I am looking to insert a list formatted as follows:
'Name1'
'Name2'
'Name3' and so on.

Into an existing table tbl1

I've tried using variations of while loop, name 2 etc. into the list.

Can anyone point me in the right direction here?

Clarification:

    SET ANSI_NULLS ON
    GO
    SET QUOTED_IDENTIFIER ON
    GO

    CREATE TABLE [dbo].[Artists](
    	[ArtistID] [int] IDENTITY(1
    	[ArtistName] [nvarchar](50) NULL
     CONSTRAINT [PK_Artists] PRIMARY KEY CLUSTERED 
    ([ArtistID] ASC)
    WITH (PAD_INDEX  = OFF, ALLOW_ROW_LOCKS  = ON,  
    ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
    ) ON [PRIMARY]
    GO

I came up with this:

    declare @name str = List (name1, name4, name5, name6)
    declare @counter int
    	set @counter = 0
    	while @counter &lt; 5
    	begin
            set @counter = @counter + 1
            insert into Artists values (null
        end

My problem is

",self,t5_2qp8q,1357053946.0,,,True,http://www.reddit.com/r/SQL/comments/15rs2f/mssql_looking_to_insert_a_list_into_an_existing/
1356556577.0,15hg5v,SQL 2012 localdb debugging issue,sodakdave,3,0,4,"I just switched to SQL Management Studio 2012 and really like the on-demand concept of the localdb instance. However I am having an issue trying to debug a query. When I attempt to start the debugger I get

""Unable to start T-SQL Debugging. Could not connect to the computer '(localdb)'. The debugger cannot connect to the remote computer. This may be because the remote computer does not exist or a firewall may be preventing communication to the remote computer.""

This is confusing since this is a local instance of (localdb). I am on the same computer. Windows firewall is turned off, it's my computer.

Has anyone seen this?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/15hg5v/sql_2012_localdb_debugging_issue/
1356101260.0,15888h,[FilemakerSQL],liltbrockie,4,2,2,"Hi can someone help with this SQL query please? I am trying to retrieve a list of matching addresses based on what the user enters:

 

ExecuteSQL ( ""

 

SELECT UPPER(addressid)

 

FROM AddressSurname

 

WHERE

 

UPPER(surname) LIKE  ? and

UPPER(firstname) LIKE ? and

UPPER(postcode) LIKE ?

""   

 

    ; """" ; """"; 

Upper(Enquiries::Surname&amp;""%"");

Upper(Enquiries::Firstname&amp;""%"");

Upper(Enquiries::Postcode&amp;""%"")         )

 

The above code kind of works but it does not account for fields that are NULL

The problem being if I enter in ""Smith"" for the surname I ONLY get results if there is date in the firstname field (which there often isnt)",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/15888h/filemakersql/
1355829160.0,151pum,[MYSQL] Interlaced Select Problem,sour_soup,3,0,7,"Hey!
I have 2 Tables:

-----------

1: Comments

comment_id,..

----------

2: wine

wine_id

----------

Obviously the two wine_ids interact with each other.

I need a SELECT where I get the 10 most common wine_id's in comments WHERE active in table 'wine' = 1.

That's what I have so far:

    mysql_query(""SELECT wine_id
											FROM comments a
											WHERE wine_id IN 
												(SELECT wine_id FROM wine WHERE active='1')
											GROUP BY wine_id
											HAVING NOT 
											EXISTS (

											SELECT * 
											FROM comments b
											WHERE b.wine_id = a.wine_id
											AND WHERE wine_id IN 
												(SELECT wine_id FROM wine WHERE active='1')
											GROUP BY b.wine_id
											HAVING COUNT( b.wine_id ) &gt; COUNT( a.wine_id )
											)
											ORDER BY Number DESC 
											LIMIT 0 

I need some adivice please :)

Edit: I'm not very skilled in SQL,False,self,t5_2qp8q,1355829408.0,,,t3_151pum
1355181697.0,14mr89,Production db access: Any authoritative sources?,SupportLackey,3,0,19,"Without going too much into the background here

Strictly speaking, perform initial investigation and potential diagnosis of time-sensitive client admin issues, and are generally expected to go far beyond the duties of Level 1 support.

Sometime earlier this year, then assigned to one of the (overseas) developers. If the developer doesn't ignore instructions in the request, or overlook file attachments, it might be completed the following day. Otherwise, it's another cycle before the clarification can be sent and received.

I know this isn't normal. I know it's generally seen as the exact opposite of how things should be done. I can link my employer to hundreds of articles on the subject, that's just your opinion,"" or ""That's just something some random guy posted on the internet."" I need something authoritative.

So

    select Suggestion
    where Problem like '%production access%'
    and Problem like '%developer%'
    and Authority in ('respectable'
    order by Effectiveness desc",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/14mr89/production_db_access_any_authoritative_sources/
1354918921.0,14gund,Multi-DBMS IDE/Developer Tool,CubedCodeMonkey,4,1,2,"I'm on the search for a new IDE/Developer Tool

I often use SSMS, I have started to see some choppy and sluggish behavior in the tool.  My work machine is a VDI, so I'm thinking there's some sort of conflict between the new version of the tool and our virtual environment.

A combination of this and my seemingly neverending desire to try out new (to me)

What are some multi-DBMS IDEs/developer tools that you use or would recommend?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/14gund/multidbms_idedeveloper_tool/
1354590737.0,148okg,[MySQL]Schema for a board game website,matty348,3,0,9,"My friends and I play quite a few board games and we decided it would be neat to have a database to track our stats. I have come up with a somewhat workable schema but it definitely isn't fully normalized and has scalability problems. 

Here are the requirements that we are looking at:

* Each game may have different things that we would like to track. Some we may want to track points, etc.
* We want to track each game what the name is when we got it
* some stats about each player, etc.
* stats about individual play such as the date it occurred, etc.


What I have come up with is workable but I think I could do better:

* A table for the player that tracks name etc.
* A table for plays that records basic info about each play
* A table for each game that has different columns based on what we are tracking. Each row in these tables corresponds to a user play a single session of a game (So the primary key of this table is a composite primary key that corresponds to the plays and players tables).


Now this structure leads to the need for a new table for each game which seems terrible but I'm having a hard time figuring out a better way of doing this? Is there some other way of doing this or a technology that would be more suitable?

",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/148okg/mysqlschema_for_a_board_game_website/
1354057346.0,13wejq,SQL multi-column display,cozzbp,3,0,12,"I'm not sure how to achieve what I want in SQL
And want it to look like [this](http://i.imgur.com/l9UCe.png) 

The assignments (exam 1 and HW 1) are dynamic and many can be added.  I just want to be able to display it with the name of the assignment as a column.  Is there a way to do this?  Thanks.

EDIT: Missed the [MySQL]",self,t5_2qp8q,1354057853.0,,,True,http://www.reddit.com/r/SQL/comments/13wejq/sql_multicolumn_display/
1353954387.0,13tnq7,Custom card deck distribution,Sotall,4,1,10,"Hello /r/SQL! 

Ive got an interesting problem for you - Didnt know if i should post here or in r/boardgamedesign

So

	Africa	Europe	Australia
	Africa	North America	Europe
    Russia	Australia	Asia
	...
	
and so on.  I am trying to develop a deck of cards like so where: 

1. Total deck size between 40 and 60 cards
2. Each card contains a distinct set of 3 continents(there are 210 distinct sets)
3. Each continent appears exactly the same amount as every other continent in the deck(so exactly 12 cards have africa,
4. All two-country pairs appear exactly the same amount of times(so only 4 cards have both Asia and Africa


I probably could build this out of trial and error

Below is some code to start with - it simply lists all of the distinct sets of three continents:


    SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED  
    
    IF OBJECT_ID('tempdb..#tmp1') IS NOT NULL DROP TABLE #tmp1  
    create table #tmp1
    (
    n varchar(20) 
    )
    
    insert into #tmp1
    select 'Africa'
    insert into #tmp1
    select 'Australia'
    insert into #tmp1
    select 'North America'
    insert into #tmp1
    select 'South America'
    insert into #tmp1
    select 'Europe'
    insert into #tmp1
    select 'Antarctica'
    insert into #tmp1
    select 'Asia'
    
    select 
      row_number() over (order by a.n 
    
    
    
    from #tmp1 a
    join #tmp1 b
    on a.n &lt;&gt; b.n
    join #tmp1 c
    on c.n &lt;&gt; b.n and c.n &lt;&gt; a.n
    
    
    

	",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/13tnq7/custom_card_deck_distribution/
1353812396.0,13qr85,[DB2] Need Help with complex SQL for Logistics/Finance Database Extraction.  ,normanj,4,1,11,"Hi

Apologies for the long post but I want to try and give across as much info as possible. 

My SQL skills have been stretched and looking for assistance in writing an efficient SQL to extract data from a logistics/finance database. 

It's a relatively large database with thousands of financial transactions going through daily. I have been tasked to write a report that links the financial transaction back to the originating task. For example

This may sound simple

Essentially

I have put together some dummy data in the following spreadsheet that illustrates the content of each of the tables and the desired output:
https://dl.dropbox.com/u/432284/JournalsToTask_Example.xlsx

**Transactions**

 * TRAN_ID
 * ACCOUNT
 * AMOUNT
 * ASSET

**Transactions_Movement**

 * TRAN_ID
 * MOVEMENT_ID

**Movement**

 * MOVEMENT_ID
 * TASK_ID
 * MOVEMENT_TYPE
 * MOVEMENT_QTY

**Movement_Task**

 * TASK_ID
 * TASK_TYPE

This is on DB2 database and using QMF v8 to write the SQL. 

I have tried to do this using nested IN statements with SELECT DISTINCTS

Any help or ideas would be greatly appreciated!

Thanks in advance",self,t5_2qp8q,1353812579.0,,,True,http://www.reddit.com/r/SQL/comments/13qr85/db2_need_help_with_complex_sql_for/
1353719471.0,13oyqv,"[Oracle] Coding the DESCRIBE command (homework help, complete newbie!)",Kevspace2,4,2,http://www.reddit.com/r/SQL/comments/13oyqv/oracle_coding_the_describe_command_homework_help/

I've read some posts and gotten some help and insight into SQL. I'm doing some extremely basic work with Oracle SQL (this is only my second assignment). 

The assignment reads:

Write a script that provides all of the information in, the output should add the comments on the rows. Input: owner and table name. Output: columns for Name, Null?, Type, Comments.

I'm lost. I spent hours upon hours looking into different sites for information and I'm just lost. I emailed the Prof and he wrote back 

&gt;Have you run the describe command yet? Step 1 is to find out what it outputs. 
&gt;At an sql prompt run describe STUDENT; or whatever you have a table named.
&gt;Then start querying data dictionary views like dba_tab_columns, &gt;dba_tab_comments, dba_views to find out what views or tables have that information available. 
&gt;Then write one query that joins some of those views together and prompts on owner name 
&gt;and table name to allow you to lookup the information displayed in describe through a prompted query &gt;instead.

I still feel lost. This is a state school online class and my in class assets are emails with my Prof and our textbook. The text doesn't help me too much! I've searched YouTube and around the net and I am not finding much. I watched some videos and read in the book, I can wrap my head around this. 

Thank you for any help or direction you can give me!",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/13oyqv/oracle_coding_the_describe_command_homework_help/
1353307672.0,13fuox,Does ANSI-SQL offers table lock syntax?,Wimea,4,1,3,"i.e is it possible to perform an operation on a table and gain an exclusive lock on it using plain ansi-sql.

There's the goold old ANSI-SQL definition document from 1992
http://www.contrib.andrew.cmu.edu/~shadow/sql/sql1992.txt
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/13fuox/does_ansisql_offers_table_lock_syntax/
1353165041.0,13cps6,[Oracle] Relatively simple problem: function won't return -1 ,rknDA1337,5,2,7,"My function:

http://pastebin.com/dsq6Qyvj

Excuse the Swedish; I realize it makes it harder to understand what the function is supposed to do

The function gets a number and a date


It works fine if the number and date exists, but it's supposed to return ""-1"", because of this part:

http://pastebin.com/pSMpTttz

What am I doing wrong?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/13cps6/oracle_relatively_simple_problem_function_wont/
1353090942.0,13b6v9,"r/SQL, please help with arbitrary file extract in Access.",Jack97,3,0,http://www.reddit.com/r/SQL/comments/13b6v9/rsql_please_help_with_arbitrary_file_extract_in/
Example: 
    FROM table IN {*path* | [""*path*"" ""*type*""] | ["""" [*type*; DATABASE = *path*]]}
Is there a way to,,False,self,t5_2qp8q,False,,True
1352929461.0,137bl0,Help with Event Log filtering,mattmurphy,4,1,4,"I have 2 tables; one is full of windows event log events and the other is exclusions. My company is trying to figure out which events we want to monitor and which ones we want excluded. Currently we are making an ""included"" list also and excluding any events in that list from our query (so we know we've already reviewed those)

I have been trying to figure out the best way to make this query and have been having trouble wrapping my head around it. I am pretty new to writing SQL code so I could really use some help!

I didn't really know where/how to post these tables

[Events](https://www.dropbox.com/s/9nkk3g1o9mse347/events.csv) - table (actually a view) is called vNtEventLog

[Exclusions](https://www.dropbox.com/s/e3xk4tj0hce2fzs/exclusions.csv) - table is called EventSetDef

Would someone be able to help me with a query to return only events that do not match a row in the exclusions list? I've been stumped and none of my code has worked very well at all

    SELECT 
    DISTINCT 
        (SELECT DISTINCT TOP 1 ApplicationName FROM dbo.vNtEventLog a WHERE a.agentGuid=b.agentguid AND a.machine_groupid=b.machine_groupid) AS applicationname
        
        
        
    FROM dbo.eventSetDef AS a INNER JOIN dbo.vNtEventLog AS b 
        ON a.SOURCE LIKE b.applicationname
            AND b.EventMessage LIKE a.description
            AND b.eventId LIKE REPLACE(a.eventId
    WHERE b.logType = 1380569194
        AND b.eventType = 1 AND a.eventSetId IN (57068342
        AND a.SOURCE like b.applicationname
        AND b.EventMessage LIKE a.description
        AND b.eventId LIKE REPLACE(a.eventId
    GROUP BY b.Machine_GroupID, b.EventMessage, b.agentGuid


I hope I posted this correctly! I really appreciate any help people can offer. Thanks!

Edit: Sorry - I forgot to put [MS SQL] at the top!",self,t5_2qp8q,1352929943.0,,,True,http://www.reddit.com/r/SQL/comments/137bl0/help_with_event_log_filtering/
1352833728.0,134wi4,[MS SQL] Multi-File Output with SQLCMD,clegmir,3,1,4,"I've written a small script for extracting data into a CSV

Is there any way that you know of to write a log file independently of the output file in a case such as this? I'd like to avoid having to write a program to wrap around this

Thanks!

(And sorry if this isn't the right subreddit for this question)",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/134wi4/ms_sql_multifile_output_with_sqlcmd/
1352214002.0,12qbqt,"I'm interviewing for a MS SQL supervisor job soon, and I'm looking for a few tips.",AthlonRob,3,0,http://www.reddit.com/r/SQL/comments/12qbqt/im_interviewing_for_a_ms_sql_supervisor_job_soon/, windows systems admin, etc)

My question to you is

Thank you!",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/12qbqt/im_interviewing_for_a_ms_sql_supervisor_job_soon/
1352136731.0,12oco6,"If I want to compare column A and column B, but I only want the column A values which are NOT present in column B from table 1.  What is the best way to go about this?",randomperson24,7,2,http://www.reddit.com/r/SQL/comments/12oco6/if_i_want_to_compare_column_a_and_column_b_but_i/,self,
1351177930.0,122h4k,[SQL via MS Access] Help writing query please.,Fritz_X,5,2,7,"I apologize for my novice question but I am hoping to have a little help so that I can modify the response to this question for other similar queries.  
  
I have several tables which I am trying to query from. The exact use-case is:  
  
I want to be able to run a query for subjects (subjects.id) who have an mri scan (scans.id
  
So the total tables I am referencing for this query are: subjects
  
What I have which doesn't work is this:  
  
    SELECT scans.scan_date, subjects.mrn, subjects.date_of_birth,
        population_roster.population_id
  
    FROM scans
  
    WHERE scans.subject_id=subjects.id AND population_roster.subject_id=subjects.id AND
        population_roster.population_id='12' AND scans.scan_type_id='1'
  
    ORDER BY subjects.last_name
  
  
**EDIT**

**Got the query working! You folks are quick! Thanks so much :-)**",self,t5_2qp8q,1351184661.0,,,True,http://www.reddit.com/r/SQL/comments/122h4k/sql_via_ms_access_help_writing_query_please/
1351120217.0,1218ez,Help with a replace command,whoisearth,6,3,4,"Help no longer required.  I figured out how to do it in a hack method.  Instead of doing both at the same time I just did one at a time.

    select table1.column1, table2.column1 , table2.column2
    ,'goodtext')
    ,'goodtext') 
    from table1
    join table2
    on table2.column3 = table1.column3
    and table1.column4 = 'Y'
    and (
    	table2.column1 like '%badtext%'
    or	table2.column2 like '%badtext%'
    	)
    and table1.column5 != 'X'

Basically what I want to do is replace a single word from wherever it's found in 2 different columns when matching the criteria of a shared column between 2 different tables.

I'm guessing we shouldn't be doing a replace but an update.  any ideas?

edit and sorry forgot the post that this is MS SQL v2008",self,t5_2qp8q,1351128194.0,,,True,http://www.reddit.com/r/SQL/comments/1218ez/help_with_a_replace_command/
1349381355.0,10ycoz,[Oracle] SQL Script to validate two databases,i3orn2kill,3,0,2,"I've been tasked with writing a script to validate data that is being downloaded from one database (db1) to another (db2) during a nightly download by a 3rd party. 

db1 is normalized while db2 is not. The data should be 1 to 1 and my company wants me to prove that because the information is critical and has to be correct. 

I have never done this sort of thing and have never used Oracle before (MSSQL is what I normally use) so I wonder:

What is the best approach/ best practices code wise/documentation wise?

What should I be aware of using Oracle?

 I would consider myself a little more advanced than Junior but I've only been doing SQL development for a few years. So anything else you might be able to think of would be a big help.
 ",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/10ycoz/oracle_sql_script_to_validate_two_databases/
1348689713.0,10iv79,[MySQL] Dell Kace Help,RaptorF22,4,1,11,"Please forgive me as I'm trying to teach myself how to edit these (as I know very little about SQL). How would I edit this to display the deployment count for 3 specific pieces of software? Here is Kace's sample report that does this

    Select 
    PUBLISHER, MACHINE_SOFTWARE_JT)  
    where SOFTWARE.ID = MACHINE_SOFTWARE_JT.SOFTWARE_ID 
    and not IS_PATCH 
    GROUP BY DISPLAY_NAME order by DISPLAY_NAME
I want to be able to refine this to display the deployment count for just those 3 peices of software (Visio
Thanks.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/10iv79/mysql_dell_kace_help/
1348614971.0,10h6cp,[Oracle] Group By Logic,oraclenoob,3,0,8,"I've been working on this script the past few days

.  
When I group by INVIID only
.  

If I group by INVRENTALIID, just tring anything to append the INVRENTALIID to existing result sets, but it breaks my grouping.    
  
  
So my logic must be wrong
If the data below was my table
         
             INVRENTALIID  
             000521  
             000729  

INVRENTALIID is the primary key.  
INVIID is the product ID (identifies what I'm selling.)  

 
    invrentaliid  inviid  dateactive  price  
    000521        P00023   09/21/2012  25
    000622        P00023   09/10/2012  20
    000729        P00152   09/02/2012  50
   .  

    SELECT inviid
    
       SELECT inviid
       
       FROM invrentalprice
    
       WHERE rentalunit = 1
    
       AND inviid in 
    
         (select inviid from invmaster where maingroup='AUDIO')
    
       GROUP BY inviid
    
    GROUP BY inviid",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/10h6cp/oracle_group_by_logic/
1347331100.0,zosb5,MS Access Help,Cyllindra,5,2,20,"So I have a gradebook database I am working on.  I want to write a query (or a few queries) that will look at the scores students have for a given concept and then determine the grade for the concept.

The grading system works like this: each time you test on a concept, then your Grade will be a 5.  Otherwise, your Grade is the best score (homework bonus included) you have gotten so far.  [If this is confusing, let me know, and I will explain better).

Thusfar


    INSERT INTO tblGrades ( StudentID
    SELECT tblConceptChecks.StudentID
    FROM tblConceptChecks
        INNER JOIN tblHomework ON (tblConceptChecks.StudentID=tblHomework.StudentID)
        AND (tblConceptChecks.UnitConceptID=tblHomework.UnitConceptID)
    WHERE ((tblConceptChecks.Score)&lt;3) AND ((tblHomework.Completed)=1);

This code checks if the student has a score less than 3

The problem is that it includes every score the student has gotten

    (tblConceptChecks.Score) = (max(tblConceptChecks.Score))

But that did not work.

Thanks in Advance for your ideas.

-----------

Update:  I can input everything (kind of) now

How do you check for the most recent date (this would be a fix if I add OldScore as a field containing the last score they got)?  Can I just subtract the current date from the date in the cell and then use the min?  How can I see if two scores are next to each other (date-wise).  Already appreciate the help people have thrown out there.",self,t5_2qp8q,1347575364.0,,,True,http://www.reddit.com/r/SQL/comments/zosb5/ms_access_help/
1347316573.0,zod7u,[MS SQL] Need to relearn SQL by Friday...,pole7979,4,2,8,"Hello fellow redditors.  So I'm here to ask for assistance in relearning SQL by Friday.  Reason being is I will be having an SQL assessment test on said day for a BI analyst job.  Now I've used SQL based systems in my career but haven't had to really type out the code since classes I've taken in undergrad 5 years ago.  So I'd like to ask if any of you have taken an SQL assessment before?  If so what sort of questions were asked?  And in general for everybody how should I go about this week in studying?

Thanks ahead of time!",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/zod7u/ms_sql_need_to_relearn_sql_by_friday/
1346160445.0,yykfa,I need help installing SQL 2012.exp on my laptop...Thank you!,SternLecturePlumbing,3,0,6,"Hi
I want to start learning SQL and I'm not off to a great start because I've run into trouble at the instalation stage!

So
but it won't let me continue. When I press ""Next"" it says: 

""[Error Message]
To continue

The problem is it wont allow me to select or deselect any of the features....does anyone know what I'm doing wrong/how I can get around it (please and thank you...) ",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/yykfa/i_need_help_installing_sql_2012exp_on_my/
1346090256.0,ywx1m,Query Logic,oraclenoob,4,1,14,"I'm trying to pull the top department for each product.

Product A has been on 10 orders
Product B has been on 20 orders
I'd like my result set to say 

&gt;PRODUCTA    VIDEO
&gt;
&gt;PRODUCTB    AUDIO


My sql below lists all the departments with their counts

    SELECT c.product
    FROM order a
    WHERE a.orderiid=b.orderiid
    AND c.productiid=b.productiid
    AND c.product in (select product from inventory where department is null)
    GROUP BY a.department

edit*  Imagine all the products are cables

*Oracle",self,t5_2qp8q,1346104995.0,,,True,http://www.reddit.com/r/SQL/comments/ywx1m/query_logic/
1345815263.0,yr3qh,[MSSQL] Maintenance plan question,AnonymooseRedditor,4,1,5,"Hi All

I'm a sysadmin

I've been setting up a new MS SQL 2008 R2 server and right now am working on the maintenance plans.  

Currently I have two plans setup. 
1. Full backup nightly and 2. hourly transaction logs.  My question is with #2.  Should I be shrinking the log files each time?  Right now they are growing quite a lot. I've read mixed things about whether or not shrinking log files is a good thing to do?  ",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/yr3qh/mssql_maintenance_plan_question/
1345663732.0,ynj9s,I want to learn SQL - which version to DL?!?,Fegis,4,1,9,"As title suggests

I searched reddit and a post said DL - SQL Server Express.  But which version do i need (i wanna save HD space here ^^)  

http://www.microsoft.com/sqlserver/en/us/editions/2012-editions/express.aspx

I am guessing SQL Server Express with Tools is enough for home use right?

Thanks in advance ",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/ynj9s/i_want_to_learn_sql_which_version_to_dl/
1345241742.0,yeevn,[SQLITE] many-to-many-to-many in one table or two separate tables,ts4053,4,1,3,"I have noobie question regarding database structure containing relations between three table. 

I have these tables:

* network (**network_id**
* operator(**operator_id**
* service(**service_id**

I have these relations:

   * operator can have multiple networks
   * network can have multiple operators
   * service can have multiple operators
   * operator can have multiple services

So these are easy

   * operator_network -table with **operator_network_id**
   * service_operator -table with **service_operator_id**

My problem comes here. I wan't to be able to list only services which are available in one operator's certain network. I figured out that for this I need to modify the service_operator relation to service_operator_network -relation. 

My question is: should I do one table with three foreign-keys

   *  service_operator_network-table with **service_operator_network_id**, network_id

or should I do this by two different tables:

   * operator_network -table with **operator_network_id**
   * operator_network_service-table with **operator_network_service_id**

I'm sure that one of these methods is better than the other but I can't figure it out which one.",self,t5_2qp8q,1345242047.0,,,True,http://www.reddit.com/r/SQL/comments/yeevn/sqlite_manytomanytomany_in_one_table_or_two/
1345039807.0,y9fbz,[MSSQL] delete trigger,DrTrunks,5,2,12,"People are deleting Orders with Order items in it. Since we can't get a developer license I'm going the SQL way.

I've made a trigger which should block the deletion of Orders with a status between 2 &amp; 5. But only the first one 'works'

When I run the query with the actual table instead of [deleted] I get a right amount of objects.


    ALTER TRIGGER [dbo].[preventOrderdeletion] ON  [dbo].[Company$Order Header] for DELETE AS 
    BEGIN
       IF EXISTS (select No_ from deleted INNER JOIN [Company$Order Items] ON deleted.No_ = [Company$Order Items].[Document No_] WHERE        ([Company$Order Items].[Repair Status Code] between 2 and 5)
      
          ROLLBACK TRANSACTION
          RAISERROR ('Order Items Exist!'
    END

Trigger that does nothing:


    ALTER TRIGGER [dbo].[preventOrderdeletion] ON  [dbo].[Company$Order Header] for DELETE AS 
    BEGIN
       IF EXISTS (select No_ from deleted INNER JOIN [Company$Order Items] ON deleted.No_ = [Company$Order Items].[Document No_] WHERE        ([Company$Order Items].[Repair Status Code] between 2 and 5)
      BEGIN
          ROLLBACK TRANSACTION
          RAISERROR ('Order Items Exist!'
     END
    END

I hope someone can point me in the right direction?",self,t5_2qp8q,1345040014.0,,,True,http://www.reddit.com/r/SQL/comments/y9fbz/mssql_delete_trigger/
1345012750.0,y90pz,Why ACID is a useful building block of eventually consistent transactions.,einhverfr,3,0,5,,t5_2qp8q,False
1344451955.0,xw8b3,PostgreSQL vs MySQL - what's better for large data handle?,antjanus,4,1,26,"I'm building a pretty big project (in comparison to what i'm used to) that needs to handle thousands of rows of data

It'll be built on top of PHP (comments aside, another here, another here) and frequent ""small"" updates (update 10 rows here, 15 here, 50 here) and infrequent larger updates (update 6000 rows right now).

With all that said. I did do my research on PostgreSQL and MySQL but don't seem to come to a conclusion. Some articles are based in the past with irrelevant comments (MySQL is faster than PostgreSQL by a thousand-fold!) while some list specific features and how both can compensate for their shortcomings.

So I guess I'm asking

**EDIT** - I realize I may be jumping back and forth. I'm still trying to figure out what to do. It seems like the majority either agrees that with such little amount of data,,False,self,t5_2qp8q,1344482906.0,,True
1343848276.0,xir0h,[DB2] Finding dates within the past year,ItsKirbyTime,3,0,6,"I'm trying to filter on whether a date is within the past year. I could do something like

    WHERE days(CURRENT DATE) - days(my_date) &lt; 365

However,False,self,t5_2qp8q,False,,,t3_xir0h
1343311734.0,x6udf,[MS SQL] SQL 2012 -So someone by mistake deleted my distribution database..,Kalypso_,3,0,7,"I was in the process of setting up SQL Replication and someone by mistake deleted my distribution database. By delete I mean they deleted the db files not the database from SQL. I tried to use sp_dropdistributor. It fails because it thinks it's still connected to the distribution db.

I tried running sp_dropdistributiondb @&lt;dbname&gt; and that isn't working either. ""Must declare the scalar variable @&lt;dbname&gt; "". I'm pretty sure my syntax is wrong. 

Also in SQL the distribution DB is flagged as (Recovery Pending). 

Can anyone clue me in?

Edit: Explaining the delete.

Update 1: Okay I got the right syntax but now it's complaining about the publisher except I never got to creating the publisher
I also cannot disable the distribution through the GUI because it can't find the distribution database.
...
Now what?",self,t5_2qp8q,1343313662.0,,,True,http://www.reddit.com/r/SQL/comments/x6udf/ms_sql_sql_2012_so_someone_by_mistake_deleted_my/
1343257706.0,x5pl2,[MS SQL] Question for generating serial numbers,CaptainKirk0000,3,0,7,"I am relatively new to MS SQL Server (Using the 2012 Express Edition) and have been using to create a simple business app using Lightswitch. I have been tasked with something I'm not sure how to do. 

The system I am working on is a simple order management web app. All orders have a header record in a headers table. They are currently assigned a unique ID using an identity column.  I have been asked to make an order number column, using the ID column as the serial number, but they want the serial number to reset to 0 with the first order of every year. Would I use a trigger or a stored procedure for something like this? I haven't used either one yet. Any guidance would be greatly appreciated.",,False,self,t5_2qp8q,,http://www.reddit.com/r/SQL/comments/x5pl2/ms_sql_question_for_generating_serial_numbers/
1342537607.0,wpcis,Why complex SQL queries over simple SQL queries?,lsumnler,12,8,16,"I am not an SQL expert and primarily use SQL in my day to day CRUD work.  I have noticed in a large number of job ads that they are looking for people who can work with complex SQL queries.  Generally

NOTE: I understand that there are probably speed and resource advantages; However,False,self,t5_2qp8q,False,,,t3_wpcis
1342030836.0,wealq,[MS SQL] Optimizing a Derived Table with a few joins,Scytone,6,2,2,"So I'm trying to create this table that displays the amount of Servers we have running Each Edition of SQL Server vs The version they are on. I've gone about this via a derived table and a few interesting joins

(Heres the table example: http://i.imgur.com/Mncbe.jpg )

My code looks something like this:  http://pastebin.com/AtqESLkM

I'm not the most talented query writer
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/wealq/ms_sql_optimizing_a_derived_table_with_a_few_joins/
1342017739.0,wdx7i,"SQL Server replication problem, please help.",eps492003,5,2,http://www.reddit.com/r/SQL/comments/wdx7i/sql_server_replication_problem_please_help/

It's picking up the wrong server name for some odd reason &amp; I'm trying to switch to the correct server name.

**** SOLVED ****

I put those [ ] brackets around the name instead of ' ' &amp; it worked.",self,t5_2qp8q,1342019338.0,,,True,http://www.reddit.com/r/SQL/comments/wdx7i/sql_server_replication_problem_please_help/
1341584124.0,w4nwu,MS SQL Server 2008 R2 - getting incorrect results from query in very-high concurrent DB,huncwot,9,6,22,"**Final update: This ended up as an error NOT related to DB, and is still under investigation, but I found out only after trying SQLDave idea to look for patterns... Thanks all.**

Hi

I'm running DB gathering some data (irrelevant here). There are hundreds of interactions with DB from different sources going through IIS.

One of tables stores variable A char(9)

Second table stores (among other things) foreign key to above table.

Each record going to second table is identified with A and B. Several records can use the same A and B variables.

Naturally I check if first table already has provided pair:

 - if not
 - if yes

Here is where the problem appears:

Every now and then

I can't find the reason for that

Query in question is currently not run in transaction, as it was before.

I added workaround where key is used only when 3 SELECT statements in a row get the same result

Database is run with below settings due to deadlocks we've had before:

    SET READ_COMMITTED_SNAPSHOT ON;

    SET ALLOW_SNAPSHOT_ISOLATION ON;

If you have ANY idea

Some more detailed information (I'll use pseudocode here and there):

first table:

    
    if OBJECT_ID ('t_order_tie') is null

    CREATE TABLE t_order_tie
    (
    	id_order_tie int IDENTITY (1
    	order_number char (9) COLLATE SQL_Polish_CP1250_CS_AS NOT NULL
    	order_tie int NOT NULL
    	
    	...
    			
    	CONSTRAINT PK_t_order_tie PRIMARY KEY CLUSTERED (id_order_tie ASC)
    	WITH (PAD_INDEX  = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
    )
    ON [PRIMARY]
    GO

second table:

    if OBJECT_ID ('t_stc') is null

    CREATE TABLE t_stc
    (
    	id_stc int IDENTITY (1
    	stc char (8) COLLATE SQL_Polish_CP1250_CS_AS NOT NULL
    	id_order_tie int NULL
	
        ...		
	
    	CONSTRAINT PK_t_stc PRIMARY KEY CLUSTERED (id_stc ASC)
    	WITH (PAD_INDEX  = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
    )
    ON [PRIMARY]
    GO

procedure called by IIS for each source of incoming data (usually this one is called once every few seconds, no other procedure inserts into t_ot which is worth noting i guess):

**1st version:**

    procedure
    (
        @stc char (8)
        @order_number char (9)
        @order_tie int
        @some more parameters irrelevant here
    )

    declare
        @id_order_tie int

    select
        @id_order_tie = id_order_tie 
    from
        t_order_tie
    where
        order_number = @order_number 
    and order_tie = @order_tie 

    if @id_order_tie is null
        begin
            declare @idot table (id int)
            
            INSERT INTO t_order_tie
            OUTPUT inserted.id_order_tie INTO @idot
            VALUES (@order_number 
            
            select @id_order_tie = id from @idot
        end

    INSERT INTO t_stc
    VALUES (@stc 

**2nd version**

I was playing around with some changes to make sure it's not because of calling outside function (originally instead of select), whenever id was already present, I checked again and used it only when it was the same twice in a row.

    procedure
    (
        @stc char (8)
        @order_number char (9)
        @order_tie int
        @some more parameters irrelevant here
    )

    declare
        @id_order_tie int
        @temp_id_order_tie int
        @confirmed int

    set @confirmed = 0

    select
        @id_order_tie = id_order_tie 
    from
        t_order_tie 
    where
        order_number = @order_number 
    and order_tie = @order_tie 

    if @id_order_tie is null
        begin
            declare @idot table (id int)
            
            INSERT INTO t_order_tie 
            OUTPUT inserted.id_order_tie INTO @idot
            VALUES (@order_number 
            
            select @id_order_tie = id from @idot
            
            if @id_order_tie is not null set @confirmed = 1

        end

    while @confirmed = 0

        begin
        
            select
                @temp_id_order_tie = id_order_tie 
            from
                t_order_tie 
            where
                order_number = @order_number 
            and order_tie = @order_tie 

            if @id_order_tie = @temp_id_order_tie 

                set @confirmed = 1

            else

                set @id_order_tie = @temp_id_order_tie 

        end

    INSERT INTO t_stc
    VALUES (@stc


Unfortunately this didn't help, and will try manual commiting later.

*Update:*

It is worth noting, two of them aquired correct id, while 8 got wrong id, but it was the same id for all 8 of them, and procedure was not called for all of them at the same type. This is why I think it's not random per se, erroneous yes, but not random.

After workaround, usually when id was returned incorrect it was quite close to correct one).

*Update:*

OK, wherever I could. I also pasted above original definition used to create tables.

Below are indexes definitions for 2 tables mentioned above:


    IF EXISTS (SELECT name FROM sys.indexes WHERE name = 'UQ_t_order_tie') drop index UQ_t_order_tie on t_order_tie
    GO

    BEGIN TRANSACTION
    GO

    CREATE UNIQUE NONCLUSTERED INDEX UQ_t_order_tie ON

    	t_order_tie (order_number ASC
	
    WITH( STATISTICS_NORECOMPUTE = OFF, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
    GO

    ALTER TABLE t_order_tie SET (LOCK_ESCALATION = TABLE)
    GO

    COMMIT




    IF EXISTS (SELECT name FROM sys.indexes WHERE name = 'UQ_t_stc') drop index UQ_t_stc on t_stc
    GO

    BEGIN TRANSACTION
    GO

    CREATE UNIQUE NONCLUSTERED INDEX UQ_t_stc ON

    	t_stc (stc)
	
    WITH( STATISTICS_NORECOMPUTE = OFF, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
    GO

    ALTER TABLE t_stc SET (LOCK_ESCALATION = TABLE)
    GO

    COMMIT

    GO

    BEGIN TRANSACTION

    GO

    CREATE NONCLUSTERED INDEX IDX_t_stc ON
    	t_stc (columnX
    		INCLUDE (id_order_tie
		
    GO

    COMMIT

    GO

**Final update: This ended up as an error NOT related to DB, that procedure could be called several times with different data (this should NOT happen, and is still under investigation, whether data is corrupted on data source or IIS), therefore t_debug table gathering raw data with which procedure is called has in this 10 examples I have both correct and incorrect entries. I'm very sorry for the confusion, as I should notice it before, but I found out only after trying SQLDave idea to look for patterns... Thanks all.**",False,,http://www.reddit.com/r/SQL/comments/w4nwu/ms_sql_server_2008_r2_getting_incorrect_results/
1341245641.0,vxgg8,SQL Server 2008 R2 - replicate between sites,uster,6,5,5,"I have a simple SQL database with a web front-end.

I have multiple ""low bandwidth"" sites which each need access to this database. Each site is a subnet of our global network (so network transparency isn't an issue). Each site has a local webserver running the web front-end. Can I setup a local ""copy"" of SQL at each site which will stay in sync? Does SQL have anything built-in facilitate distributed databases?

The whole idea here is to give the users at remote site ""x"" local access to the a distributed copy of the database and web front-end. If that same users goes to remote site ""y"",False,self,t5_2qp8q,False,,,t3_vxgg8
1340688842.0,vm6rc,[MYSQL] Joins where one query doesn't return a result,Chiponyasu,4,1,4,"Hi! 

I have a database that logs everything that happens to an account as a separate line. I'm trying to find all the accounts that were open on a certain date. 

I'm able to find all the accounts that opened before this date and closed after that date


select t1.accountnumer
from
(select * from accounts where stage = 'Opened' and date &lt; '2012-06-23 00:00:00') as t1
(select * from accounts where stage = 'Closed' and date &gt; '2012-06-23 00:00:00') as t2
where t1.accountnumber = t2.accountnumber;

However, the ones that were open before that date, and are still open now). How can I do this?

Thank you in advance. 

(Also, and I'll stop using it)

Edit: I was able to resolve this issue on my own. Thank you to everyone that posted,False,self,t5_2qp8q,1340773782.0,,,t3_vm6rc
1340052324.0,v8peb,Need assistance with an AND/OR situation,Daakuryu,3,0,7,"The statement below is generated based on a series of options a user picks. 

2 of the values (Changed and UpdatedBySteph) are strings containing 13 characters which are either 0 or 1. and All the The PST and GST are based on check boxes above a grid

The user sees a list of products and associated taxes based on their selections, everything updated or everything new.

What it needs to do is if the user chooses to see everything 'new' and all of the selected provinces have their part of the 13 char strings set to 1 the product doesn't show up but if one of them has a 0 the product shows up.

I'm still an SQL neophyte and obviously it's not doing that


SELECT tblGstPstbyProv2.Supplier

	tblGstPstbyProv2.EventCode

	tblGstPstbyProv2.SupplierProduct

	tblGstPstbyProv2.UPCCode

	tblSupplierProducts.ProductDescription

	ZZ_PST

	ZZ_GST

	BC_PST

	BC_GST

	MB_PST

	MB_GST

	NS_PST

	NS_GST 

FROM tblGstPstbyProv2

	INNER JOIN tblsupplierproducts ON tblSupplierProducts.Supplier = tblGstPstbyProv2.Supplier 

	AND tblSupplierProducts.SupplierProduct = tblGstPstbyProv2.SupplierProduct 

	AND tblSupplierProducts.EventCode = tblGstPstbyProv2.EventCode 

WHERE tblGstPstbyProv2.InActiveItem = 'False' 

	AND (SUBSTRING(Changed

		OR SUBSTRING(Changed

		OR SUBSTRING(Changed

	and (SUBSTRING(UpdatedBySteph

		or SUBSTRING(UpdatedBySteph

		or SUBSTRING(UpdatedBySteph

ORDER BY tblGstPstbyProv2.Supplier
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/v8peb/need_assistance_with_an_andor_situation/
1340048013.0,v8l1i,SQL Server suggestions for Product,yaodin,5,2,9,I am working on creating a product with a java front end and a SQL backbone. I am looking for advise on what SQL product to use since I am selling this. A license for MySQL or MSSQL are both out of the question because they would put us greatly over budget. Is there an open source version I can include that allows this? Thanks for the help.,t5_2qp8q,True
1339181269.0,uryse,[MSSQL] A Query to return the last 7 years,-james,7,4,6,"I posted this in learnprogramming but

    YearFilter
    2012
    2011
    2010
    2009
    2008
    ....

I came up with this:

	SELECT YearFilter
	from
		(
			SELECT year(getdate())  YearFilter
			union
			SELECT year(getdate()) - 1
			union
			SELECT year(getdate()) - 2
			union
			SELECT year(getdate()) - 3
			union
			SELECT year(getdate()) - 4
			union
			SELECT year(getdate()) - 5
			union
			SELECT year(getdate()) - 6
			union
			SELECT year(getdate()) - 7
		) years

Don't worry about the missing ORDER BY. I guess my question is this seems a bit messy. Is there a better way to achieve the same result?

-james",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/uryse/mssql_a_query_to_return_the_last_7_years/
1338710376.0,uido2,[Oracle] String Concatenation/Whitespace Elimination,sqldiaries,6,3,11,"Greetings

Ah

Background: I use an enterprise-wide Oracle data store that is a near real-time (&lt;4 hr lag) replication of our main billing application.  I have read-only access, because ""just change the table"" always comes up and that's not possible :)

Situation: I'm often asked for reports that include address information.  In our data store, Direction, Street Name, Apt Designation, Apartment Literal.

As is often the case

    STNUM||' '||STFRACT||' '||STDIR||' '||STNAME||' '||APT||' '||APTN

However (you knew there'd be one :)), either alpha/numeric or a blank space (getting the picture yet?).  This means that if, in the above example, the address doesn't have a fraction or direction, I end up with at least two extra spaces in my output - something that severely annoys my EU's, and since one of them is the boss man...

I've tried the following:

    Trim(Trim(STNUM)||' '||Trim(STFRACT)||' '||Trim(STDIR)||' '||Trim(STNAME)||' '||Trim(APT)||' '||Trim(APTN))

And:

    Trim(NVL(STNUM,''))||' '||Trim(NVL(STNAME,''))||' '||Trim(NVL(APT,''))||' '||Trim(NVL(APTN,''))

And even:

    Trim(Trim(NVL(STNUM,''))||' '||Trim(NVL(STNAME,''))||' '||Trim(NVL(APT,''))||' '||Trim(NVL(APTN,'')))

All to no avail - I continue to get excessive whitespace in the output.

Anyone have any ideas?  All I need is for there to be one space between each section of actual output.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/uido2/oracle_string_concatenationwhitespace_elimination/
1338486680.0,ue6q9,Need a little help with a WHERE clause,kaoticsnow,3,0,11,"Trying to get a list out of the MSSQL database of ICMP only nodes in Orion

&gt;SELECT NodeID, Caption, Customer, Site, Device_Type FROM Nodes WHERE ObjectSubType = 'ICMP';

This will get me a list of ICMP only nodes including the URL's it pulls 586 Rows.

&gt;SELECT NodeID, Caption, Customer, Site, Device_Type FROM Nodes WHERE Device_Type = 'URL';

This will pull the 74 rows I do not care about. However when I combine it into

&gt;SELECT NodeID, Caption, Customer, Site, Device_Type FROM Nodes WHERE ObjectSubType = 'ICMP' AND Device_Type != 'URL;

Only 280 Rows come back I know what's going on the Device_Type filed is optional and not all of them are filled in,False,self,t5_2qp8q,False,,,t3_ue6q9
1338380755.0,uc07o,Need Rank help...,,3,0,7,"Ok so it may be a bit advanced for this board.. but i figured i would give it a shot...

can i use the Rank () (Over partition by &lt;xxx&gt; order by &lt;yyy&gt; ) function with multiple columns?

table datetime

&gt;Select
&gt;trunc(datetime
&gt;topic
&gt;keyword
&gt;count(*)
&gt;rank () over (partition by Trunc(datetime

&gt;from table


Will that work? If not.. is there a way to partition by ""month"" and topic to rank by count(*) ?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/uc07o/need_rank_help/
1337283219.0,ts3qp,"How can I change a default ""null"" to a ""0""? 
",0,10,http://www.reddit.com/r/SQL/comments/ts3qp/how_can_i_change_a_default_null_to_a_0/,"I am using sql2005. I have two tables, one is called ""gcbal_dbfile"" the other one is called ""gctran_dbfile"" they both share the same ""Acct"" numbers, but there are no primary-foreign key relationships between them. They both are on the same database tho. I am writing a subquery in order to get information from both tables into one. My problem is that a column named ""CurrentBalance"" has default values of ""0.00"" (decimal(10, however I get value of ""NULL"" when i execute my query.
Here is my query:
select Acct as AccountNumber, date_issuedc as DateIssued,a.IssueAmount - a.VoidIssueAmount as OriginalIssuanceAmount,a.NoOfSale as RedemptionTotal,a.NoOfReload as ReloadedTotal,(select top 1 CurrentBalance from gctran_dbfile where acct=a.acct and convert(int,GcTran_Dbfile.TranDate, cast('05/15/2012' as datetime)

This is where I need to change my query:
(select top 1 CurrentBalance from gctran_dbfile where acct=a.acct and convert(int, cast('05/15/2012' as datetime),101) order by skey desc) as CurrentUnredeemedBalance

I know that there is a way to add something to the select in order to get the result desired. 
The result desired is to get back ""0.00"" (as a decimal

HELP??",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/ts3qp/how_can_i_change_a_default_null_to_a_0/
1337282396.0,ts31l,Question about stored procedures.,Mathlete86,3,0,3,"Is it possible to make a stored procedure that runs through multiple sets of parameters? If so

Right now, and EndDate.

When I run:
exec TempSalesInfo 310

It puts the sales info between 7/1/2005 and 7/31/2008 for product 310 in a temporary table. If I run the same procedure for product 311 between the same dates

I am trying to get a stored procedure where I can run multiple sets of parameters at the same time. Like running (310, 20050701, 20080731) at the same time instead of independently.

Is this possible? If so,False,self,t5_2qp8q,False,,,t3_ts31l
1336501406.0,tdajb,Need help with simple SQL SELECT statement,whoisearth,3,0,7,"SOLVED by pythor.

THANK YOU!

I have 2 tables I'm trying to parse the query on.  What I currently have is as follows - 

    SELECT product_id FROM [xxx].[dbo].[Table1] WHERE Column1 LIKE '%test%'

Which works fine.  However

    SELECT product_id FROM [xxx].[dbo].[table1] WHERE column1 LIKE '%test%'AND [xxx].[dbo].[table2] WHERE column1='1234'

However it craps out.  I'm an extreme novice to SQL so I know my syntax is crap somewhere just not sure how.
",self,t5_2qp8q,True,,,True,http://www.reddit.com/r/SQL/comments/tdajb/need_help_with_simple_sql_select_statement/
1336421130.0,tbo32,[Oracle] Creating an array of dates.,Hacto,3,0,4,"Is there a more elegant way to create an array of the past six months than what I've concocted?  It would be nice if the scalability was based on some parameter

What I need:

    DATE
    -----------
    01-MAY-2012
    01-APR-2012
    01-MAR-2012
    01-FEB-2012
    01-JAN-2012
    01-DEC-2011

The SQL I'm using:

    SELECT TRUNC(ADD_MONTHS(SYSDATE
    FROM DUAL
    UNION
    SELECT TRUNC(ADD_MONTHS(SYSDATE
    FROM DUAL
    UNION
    SELECT TRUNC(ADD_MONTHS(SYSDATE
    FROM DUAL
    UNION
    SELECT TRUNC(ADD_MONTHS(SYSDATE
    FROM DUAL
    UNION
    SELECT TRUNC(ADD_MONTHS(SYSDATE
    FROM DUAL
    UNION
    SELECT TRUNC(ADD_MONTHS(SYSDATE
    FROM DUAL
    ORDER BY EFFDT DESC;",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/tbo32/oracle_creating_an_array_of_dates/
1336273510.0,t97yp,Join Confusion x-post MySQL,mrmuszynski,3,0,5,"Hi there. I'm pretty new to SQL, etc). Hopefully that's not so hard to see below.

Fine. Easy enough. Now I want to use the ""ID"" value from the ""Order_Line"" table, but I think I might have missed something. How do I reference Order_Line.ID?

    	Select * 
    	FROM Order_Line 
    	JOIN PO ON Order_Line.PO_ID = PO.ID
    	JOIN Employee ON  Order_Line.Emp_ID = Employee.ID 
    	JOIN Type ON Order_Line.Type_ID = Type.ID
    	JOIN Customer ON Order_Line.CUST_ID = Customer.ID
    	JOIN Imprint ON Order_Line.IMPRINT_ID = Imprint.ID
    	WHERE PO_ID = {$PO}",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/t97yp/join_confusion_xpost_mysql/
1335453555.0,stnj7,[t-sql][sybase] can someone explain replication to me as i'm 5?,renser,3,0,7,"Hi!

I'm having a hard time to understand replication. Especially how i proof if a sp can run with replication set on or not.
It has something to so with temporary and persistend tables but i don't have a slight clue.

Thanks everyone for your answers - it's clear to me now. In Addition: The system i'm working on is set up in a specific way as there are no write-operations allowed into persistend tables on the slaves.",self,t5_2qp8q,True,,,True,http://www.reddit.com/r/SQL/comments/stnj7/tsqlsybase_can_someone_explain_replication_to_me/
1335386174.0,sschj,"[MS SQL] 2008 Report Server: user gets ""an error has occured during report processing"" and I can't figure out why",OK_now_what,4,1,5,"....total self-taught SQL novice here

Running SQL Server 08 Report Server and I've written several reports as part of one Project. Each report is pretty simple TSQL and all of the reports run successfully in ""preview"" of the Business Intelligence Dev Studio.

So

She is able to log into the report server website
She is able to open the project folder
She is able to run 3 out of the 4 reports with no problem
the forth report fails with:

*An error has occurred during report processing. (rsProcessingAborted)*

*Query execution failed for dataset 'REPORT_NAME'. (rsErrorExecutingCommand)*

*For more information about this error navigate to the report server on the local server machine

I try when logged in as me - the report works just fine.

Next thing I check - I log back into the report server website as her

Any help would be greatly appreciated!",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/sschj/ms_sql_2008_report_server_user_gets_an_error_has/
1335220324.0,sox29,"[SQLplus]How do I create an sql table with a date feild formated like this  12-JAN-2010
",1,8,http://www.reddit.com/r/SQL/comments/sox29/sqlplushow_do_i_create_an_sql_table_with_a_date/,When it's created the date formats  the default way.,,False,t5_2qp8q,True
1334752185.0,sfwd1,Adding/Subtracting points using SQL and VB6?,Arktri,4,1,5,"I'm doing a school project based on a points system and I am lost at this point.

[Here](http://i.imgur.com/GtLHb.png) is my form design.

I assume it would be an if statement and EDIT statement but I really am unsure.

if cboPointsType = Add then

      Insert SQL here

else if cboPointsType = Remove then

      Insert SQL here


I assume this would be the case. My teacher sent this

strSQL = ""SELECT SUM([Points]) AS MyCount FROM tblStudentRewards WHERE UserID="" &amp; intCurrentUserID &amp; "" AND bShow = true""

This is pretty much to count up the points awarded from the record of inputs but I have no idea how to display it.

I really do apologise if I'm not explaining myself too well and will try to clear anything up. 
       ",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/sfwd1/addingsubtracting_points_using_sql_and_vb6/
1334705494.0,sf1yf,Having trouble with adddate function,redelman431,3,0,2,"Alexamara tries to complete each service
request by the next service date
sometimes this is not possible. Alexamara
has a policy
requests within 14 days of the next
service date.That is
date to complete each service request
would be 14 days after the next service
date. Produce a report that includes the
service ID,
owner number
description
date
service request.

EDIT: Can't get addate to work. It keeps saying add right parenthesis and I tried millions of right parenthesis and it keeps saying add right parenthesis.

",self,t5_2qp8q,True,,,True,http://www.reddit.com/r/SQL/comments/sf1yf/having_trouble_with_adddate_function/
1334428834.0,s9rlo,Learning to write queries for reporting,s0burnt,3,0,3,"Have been a programmer all my life with mediocre sql skills.  

Starting a new job in a week that is mainly creating reports and the queries to support them.  I've been reading some books to try learn more advanced selects and joins

If not, intersects, unions, cursors) that get used a lot in reporting.

If it makes a difference, using with focus on EDI x12 5010's.

Thanks in advance.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/s9rlo/learning_to_write_queries_for_reporting/
1333581142.0,rtq2o,SQL diagrams,GeneralIreton,3,0,8,"Hi.

Question: What does the line between two tables with the key on one end and the squiggly line on the other end mean in SQL diagrams?

Im guessing the side with the key is primary key and squiggly line is foreign key?



",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/rtq2o/sql_diagrams/
1332965861.0,ri2fb,[FoxPro Free Tables] Automatically updating all foreign keys,Phenomena0,3,0,1,"Not sure if this is the right place to ask this

For example. If I have two tables a Customer table

Now lets say I want to change CustID to be Customer_ID. Is there away I could change it the Order table automatically or am I going to have to hunt down all the tables that reference and change it manually?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/ri2fb/foxpro_free_tables_automatically_updating_all/
1332940415.0,rhhcc,Firebird SQL Project Newsletter Issue number 3 ,mariuz,3,0,0,,t5_2qp8q,False
1332452417.0,r8z8k,[MS SQL] Deleting multiple rows from a table,Minoripriest,5,2,9,"My database is out of disk space

EDIT: Thanks for all the responses. I needed to get the database back up as soon as possible,,False,self,t5_2qp8q,True,,True
1332293786.0,r61w8,[Oracle] Student needing help with subquerries,Scarcedflame,4,1,7,"So basically i'm learning SQL in my computer class,self,
1331742130.0,qwc0w,[SQL Server] X-post : performances : what's best between a view or a table-valued Function?,cynferdd,3,0,1,,t5_2qp8q,False
1330628041.0,qd96g,"Issue with returning more rows than expected due to joins (Seeing duplicates and erroneous data)
",2,8,http://www.reddit.com/r/SQL/comments/qd96g/issue_with_returning_more_rows_than_expected_due/,"New-ish to SQL question: PL/SQL connecting to an InForm Clinical Trial database. I'm having an issue with returning more rows than expected due to joins. (Seeing duplicates in the QueryID column and erroneous data in the SiteMnemonic column).  Full question here: https://gist.github.com/1951659

Anybody game for helping me figure this out?  Thanks much!!",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/qd96g/issue_with_returning_more_rows_than_expected_due/
1330442845.0,q9rbc,"[Oracle] Stored Proc to store multiple rows, then delete on the IDs stored",myth84,3,0,http://www.reddit.com/r/SQL/comments/q9rbc/oracle_stored_proc_to_store_multiple_rows_then/

At the moment I'm trying to do something like this but I'm not sure if I'm doing something wrong or even in the right ballpark.
 
    --this will return multiple rows
    select user_group_user_id
    bulk collect into USERGROUPUSERID
    from user_group_user_tab
    where user_id = USERID; --USERID is argument passed in

    --Attemting to delete multiple rows where the above results are found 
    delete from user_group_user_tab 
    where user_group_user_id in USERGROUPUSERID;

    delete from user_group_tab
    where user_group_id in USERGROUPID;

Anyone have some suggestions on how to accomplish this?  I'm not sure if that bulk collect is the way to go or if there's a totally different approach

Thanks!

edit: The USERGROUPUSERID and USERGROUPID are declared earlier",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/q9rbc/oracle_stored_proc_to_store_multiple_rows_then/
1330319652.0,q7pwd,Firebird SQL: choosing an owner for database deployment,mariuz,3,0,0,,t5_2qp8q,False
1330250151.0,q6knh,[MySQL] Group rows with similar timestamps,pomle,4,1,1,"My users upload files and I want to find ""upload events"". By upload events I mean time interval where the user uploaded several files at approximately the same time. For this example

In other words

I'm thinking something like:
    SELECT uploadID, COUNT(*) AS fileCount FROM Uploads GROUP BY FANCY_GROUP_FUNCTION(timeCreated)

For example

Any takers?",self,t5_2qp8q,True,,,True,http://www.reddit.com/r/SQL/comments/q6knh/mysql_group_rows_with_similar_timestamps/
1329150206.0,pnljl,Anyone using Universal SQL Editor?,postliterate,6,2,4,"I normally use Rapid SQL (connected to an Oracle db),self,
1328207761.0,p80c8,Search specific word in all caps.,youjettisonme,5,2,7,"I am sure this is simple

I need to select every row where the text contains a specific word

Thanks!",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/p80c8/search_specific_word_in_all_caps/
1327091733.0,opaqh,Crosspost from r/mysql,edzibit,4,2,2,"Like an idiot

**Ordering in a Nested Set**
http://www.reddit.com/r/mysql/comments/oozxv/ordering_in_a_nested_set/

So

    CREATE TABLE domain_tree (
        domain_id INT UNSIGNED NOT NULL PRIMARY KEY
        domain_name VARCHAR(255) NOT NULL
        domain_left INT UNSIGNED NOT NULL
        domain_right INT UNSIGNED NOT NULL
    )



    Anyhow
    SELECT 
    				
        ( COUNT( domain_tree.domain_id ) - sub_tree.domain_id ) AS depth 
        node.domain_id AS tree_id 
        node.domain_left AS tree_left 
        node.domain_right AS tree_right 
        node.domain_name 
        node.domain_id
    						
    
        FROM domain_tree
        ( 
            SELECT ( COUNT( node.domain_id ) - 1) as depth
                node.domain_id
            FROM domain_tree 
            WHERE node.domain_left
                BETWEEN domain_tree.domain_left AND domain_tree.domain_right
            AND 2 = node.domain_id
            GROUP BY node.domain_id
            ORDER BY node.domain_left
    
        ) AS sub_tree
    
    
    
        WHERE node.domain_left BETWEEN domain_tree.domain_left AND domain_tree.domain_right 
        AND node.domain_left BETWEEN sub_parent.domain_left AND sub_parent.domain_right  
        AND sub_parent.domain_id = sub_tree.domain_id 
    
    GROUP BY node.domain_id
    ORDER BY  node.domain_left
    
I use the output to build a tree object and from there I present it to the user.  However

This does not happen do to *ORDER BY  node.domain_left*.


Quick Note.  I know there are other flat tree models available but I've settled on this one.

Any assistance would be great,False,self,t5_2qp8q,False,,,t3_opaqh
1326724378.0,ojb2f,SQL Server 2008 &lt;--&gt; IIS/ASP.Net Caching - Help request,lwl,3,0,3,"**SOLVED**

My mistake... there was no caching issue. Just needed to apply my change to 5 different places in the database. Fun times. Cheers for the responses

Hi
I've just run an update query on a db, front end etc.), in order to make this change visible. Hope that's enough info. Cheers!",,False,self,t5_2qp8q,,http://www.reddit.com/r/SQL/comments/ojb2f/sql_server_2008_iisaspnet_caching_help_request/
1325793550.0,o4cn2,Could an Oracle pro help me with a little binding upgrade?,rfederici,3,0,1,"I need to upgrade some C files from Oracle 8 to Oracle 11g. Specifically a binding sequence

There was a call to obndra() that I apparently need to change to OCIBindByName(). However, ub2, sword, etc. so converting between the two seems damn-near impossible.

Seriously,,False,self,t5_2qp8q,False,,True
1325389693.0,ny900,/r/SQL moderator stuff,mgdmw,4,3,5,"Hello all!

Since this community was first established Reddit has provided facilities to make a subreddit more homely. I'd like to consider these if they add value to us.

I've started working on a descriptive text for the sidebar (""The goal of /r/SQL is ..."") which should ultimately include information on what is and is not on-topic

Additionally

Happy new year and may your triggers never fail.

Regards
 mgdmw",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/ny900/rsql_moderator_stuff/
1322115773.0,mnn4t,What's my best bet in syncing an MS SQL (2008r2) table on one box to a MySQL (5.x) table on another?,gadorp,4,1,7,"Pretty simple question

I've set up a linked server in MS SQL Management studio

I simply need to sync one table of one of my MS SQL databases to one table of one of my MySQL databases at a fairly regular interval. (it could be instant,False,self,t5_2qp8q,False,,,t3_mnn4t
1321893160.0,mk9vc,extracting distinct members of 2 sets of results,shakewell,4,2,3,"Probably a pretty dumb question

Using PL/SQL
Here's the current code

    select 
  
    ???

      from (select distinct prh.service_num
              from mob_admin.DIST_ORD_ACT_PROD_RECORD prh
             where prh.orr_seq = '2298229'
               and prh.service_action in 'Reconnect') prc
           
           (select distinct ds.service_id
              from mob_admin.DIST_SERVICES ds
             where ds.orr_seq = '2298229'
               and ds.action in 'Reconnect') dsc

Have 2 select statements that return sets of distinct service_id/service_num. I need to combine these 2 sets into 1 set of distinct members

Thanks",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/mk9vc/extracting_distinct_members_of_2_sets_of_results/
1320462032.0,m121d,Is MS Access suitable for this work project? Or would SQL be the ticket?,TxRugby,3,0,8,"Assuming the computer that will be processing this data has specs that are up to this kind of task - is MS Access OK for this?

What I have exactly is over 100+ stores that will be sending me their databases. From these databases

Or possibly extracting the data into a separate database

If MS Access is not suitable
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/m121d/is_ms_access_suitable_for_this_work_project_or/
1319723010.0,lqxoj,SQL 2008 R2 - High Availability Options,AnonymooseRedditor,5,1,10,"Hi All

I'm a sysadmin

I'm looking for some best practises or recomendations on how I should go about protecting the databases.  I have two sites that are connected by a large WAN connection

The DB's that need protecting are probably in the neighbourhood of 30-40gb,False,self,t5_2qp8q,False,,,t3_lqxoj
1317159443.0,ktdwd,"SQL and Relation Theory Master Class - O'Reilly course 
review
",0,0,http://www.reddit.com/r/SQL/comments/ktdwd/sql_and_relation_theory_master_class_oreilly/,,,False,t5_2qp8q,False
1317144210.0,kt4pz,[ACCCESS] Please help me create a query to show availability of booking slots between two dates.,Antagony,4,1,25,"Please forgive me for not making/posting any attempt to create this query myself. I struggle to get my head around SQL and I have no idea how to even approach this – and I've been thinking about it for a day now – or indeed whether it's even possible. 

This is a very simplified example of existing booking data:  

booking_ID|slot_ID|start_Date|end_Date
:---|:---|:---|:---|
1|1|2011/10/16|2011/10/25
2|1|2011/10/31|2011/11/17
3|2|2011/10/21|2011/10/26
4|3|2011/10/03|2011/10/19
5|3|2011/10/23|2011/10/28
6|5|2011/09/22|2011/11/06

**Note:** bookings are actually for `x` no. of nights

Now, this is what should be returned:  

slot_ID|start_Date|end_Date
:---|:---|:---|
1|2011/10/01|2011/10/16
1|2011/10/25|2011/10/31
2|2011/10/01|2011/10/21
2|2011/10/26|2011/11/01
3|2011/10/01|2011/10/03
3|2011/10/19|2011/10/23
3|2011/10/28|2011/11/01
4|2011/10/01|2011/11/01
6|2011/10/01|2011/11/01
7|2011/10/01|2011/11/01
…   

For extra clarity
[http://i.imgur.com/K9nTJ.png](http://i.imgur.com/K9nTJ.png)

Any help will greatly appreciated!

**EDIT:** Just to clarify further: the yellow ""Available"" blocks in the picture don't actually exist – they're just there to illustrate the data (date ranges) I need returning. 

**EDIT 2:** WOW! Thanks for the terrifically detailed responses! I'll try to work through each one in turn, these should give me a great starting point to work out what I need to do. 

Thanks guys!",self,t5_2qp8q,True,,,True,http://www.reddit.com/r/SQL/comments/kt4pz/acccess_please_help_me_create_a_query_to_show/
1316422317.0,kkbgu,Query Help.,whipper515,5,1,10,"My db runs Sybase, Serial Number. I'm trying to query every item that shares a serial number with an item that has a different Item ID Number. Table name is Item List. Sample Table:

**Item ID** **Item Name** **Serial Number**

      1        Pen         0001

      2        Pen         0002

      3        Pen         0003
 
      4        Pen         0001

      5        Pen         0003

      6        Pen         0004
",self,t5_2qp8q,True,,,True,http://www.reddit.com/r/SQL/comments/kkbgu/query_help/
1315324991.0,k6iiq,Question about using CASE update else statements.,Skillet_Lasagna,5,2,13,"Is there any way I can just tell it to do nothing in the else portion?  Basically

    ELSE
        ""whatever value it was before the update""  

the row is still affected.  ",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/k6iiq/question_about_using_case_update_else_statements/
1311270444.0,iw0im,Invalid identifier,oraclenoob,4,1,12,"I'm trying to find a way to filter the results to show only prepdates in the future

Any thoughts or suggestions would be greatly appreciated

SELECT
        a.contractid
        e.reportgroup
        e.sku
        b.quantity Qty
        e.ucdescription
        d.siteiid
        a.type
        TRUNC(GetPeriodDate(a.ContractIID,
        TRUNC(GetPeriodDate(b.ConlineIID

FROM 
      Contract a
      ContractLine b
      SiteMaster d
      InvMaster e
WHERE
              a.siteiid = d.siteiid
        and   a.contractiid = b.contractiid
        and   e.inviid = b.inviid
        and   e.reportgroup like '%E1%'
        and   prepdate &gt;= '21-JUL-11'",self,t5_2qp8q,True,,,True,http://www.reddit.com/r/SQL/comments/iw0im/invalid_identifier/
1309871798.0,ih556,"I'm pretty new to this, so I'm gonna need some help... selecting columns with similar names from multiple different tables AND the tables' names",mwd410,4,1,http://www.reddit.com/r/SQL/comments/ih556/im_pretty_new_to_this_so_im_gonna_need_some_help/

    ||part_number||rev||step||table_name  ||
    ||12345      ||A  ||1   ||table name 1||
    ||12345      ||A  ||2   ||table name 2||
    ||12345      ||A  ||3   ||table name 3||

so i get one part number and one revision and it lists all the steps and the table for each step. i only want distinct part numbers and revisions

any ideas? ",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/ih556/im_pretty_new_to_this_so_im_gonna_need_some_help/
1308844160.0,i78n2,Break a range of prices down into percentile groups,JCollierDavis,3,0,5,"I'm trying to retrieve data from a table of vehicle workorder data.  I need to build a percentile bell graph that I can use to compare future workorders cost or manhours expended against to. My initial thought was to break the cost range down into some number equal sized groups.  One hundred groups would be best

I'd like the resulting table to have fields like:

repair_facility, sum_quantity_repaired, sum_manhours_expended, or sum_total_cost, 

Any suggestions?


EDIT-
Sorry for the paste here
Sample of the data from the source table in csv:

    dol_uic,mh_exp,cost_civ,parts_costs,wo_cost
    W0VC15,14.6,543.85,175,718.85
    W0VC15,45.6,1694.88,162.79,1857.67
    W0VC15,8,298,387,685

dol_uic is the place that did the work

Query used:
    SELECT 
    dol_uic, mh_exp, cost_civ, parts_costs, wo_cost
	
    FROM	
    	    mgt0.vw_Dol_Clsd_Wo	

    WHERE
	    yr = '10'	
    AND
	    ecc = 'HF'
 
    AND dol_uic = 'W0VC15'
	
    AND ROWNUM &lt;= 250




What I'm looking for:

I'd like to split the range of mh_exp down into percentile groups

group 01 = 10 wo
group 02 = 18 wo
. . .
group 10 = 254 wo
group 11 = 200 wo
. . .
group 20 = 2 wo

Then using a graph plotting count of wo as the vertical axis and group as the horizontal axis I can get a visual comparison of how many wo's fall in each group.  I expect it to look something like a bell curve,False,self,t5_2qp8q,True,,,t3_i78n2
1305041951.0,h86j8,SQL Delete Statement w/ Subquery in PHP/MySQL,llDemonll,5,1,6,"So I have a simple tool thing setup that I use and I enter part numbers into arrays and the tool queries a site for the title and price of that part number and stick the part number

What I'm trying to do is make the tool automatically delete any parts from the database that no long exist in the array.

Ex.

    $case = array();
    array_push($case

That's what the array looks like

I know how to loop through the array, but what I want to do is essentially

    $deleteID = '(';
    foreach($case as $item) {
        $deleteID .= ""'"" . $item . ""'
        }
    $deleteID = substr($deleteID
    $deleteID .= ')';
    $SQL = ""DELETE FROM `info` WHERE `neweggID` NOT IN (SELECT `neweggID` FROM `info` WHERE `neweggID` IN $deleteID)"";

This *would* work flawlessly

I'm looking for some way to delete all the `neweggID` in the `info` table where the `neweggID` **isn't** in the $case array.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/h86j8/sql_delete_statement_w_subquery_in_phpmysql/
1304550223.0,h4dj3,Oracle statistics?,Hactococcus,3,0,1,"Is there an easy way to get the number of reads/writes/commits done in an Oracle database for a certain time frame?

I've googled but most of the results I get deal with disk I/O.  The rest is usually over my head regarding optimization of finer details.  I just want to know how many time this application is hitting the database.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/h4dj3/oracle_statistics/
1302783742.0,gpun9,SQL Performance on Growing System Load,,4,1,0,,t5_2qp8q,False
1301516551.0,geysg,Query Help: An aggregate solution required?,rjcarr,3,0,10,"My problem is a bit more complicated than this

Say I have two tables and here are the columns:

Customers: custid(key)

Purchases: purchid(key), total

I would like to know what is the most recent purchase for each customer?  Thanks!",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/geysg/query_help_an_aggregate_solution_required/
1301417276.0,ge1ch,Need to make a decision on a frontend-backend solution for access/sql server. Help needed.,dreamsofastronomy,3,0,8,"Hey guys

I come from web development but recentlty started at a large company as a working student. The department i'm in has an internal MS access solution with somewhat hefty tables that they keep on a network drive (with horrible speed). Trying to make a good impression and get some shit done I decided It would be a good move to use access as their frontend client (there would be something like 25 users) and have all tables linked to an MS SQL Server. 

We also had Oracle 10g as a choice but I thought it would be easier to handle migration and development with MS SQL Server.

Now IT has offered us somewhat of a quickfix solution involving MS SQL Server 2005 on VMWare. I have tried researching today and the issue is somewhat pressing. I cannot fully make sense of whether this would be a good option. I really don't want to give bad advice nor do I want to look like an idiot having started this whole project.

Does any one of you have experience with this setup? Would anybody care to explain the possible setup just a bit since I honestly don't  entirely comprehend how it would function at this point.
Do I just access my database settings via VMWare player and connect it to access via ODBC like I would with other external db's?

I feel like an idiot at this point and don't want to make any stupid decisions. Any comment would be helpful.

Thanks guys!

EDIT: Thanks for all the help. With your support and some more research I was able to give some great serious advice today and not look like an idiot on the phone with IT :))
",self,t5_2qp8q,True,,,True,http://www.reddit.com/r/SQL/comments/ge1ch/need_to_make_a_decision_on_a_frontendbackend/
1301083451.0,gbicl,MySQL Noob: Is there a way to return only specific rows with a query?,DangerouslyDevilish,3,0,9,"Hey guys

I've only been using SQL (MySQL DB) for a little over a week so to say I'm a beginner is an understatement.  I'm doing an analysis of my company's clients and I'd like to setup a query that will only return me the name and revenue of the 25th client, and the 250th client for a weekly basis.  This is just so that I can better understand the gap in spend for my clients.  I can easily pull a list of ALL my clients by name with their revenue, then export to Excel and just hide rows 1-24, 26-49,51-99, and 101-249 but if possible id like SQL to only return me those rows in the first place.

Here's what I have so far:

    SELECT
        clients.`name`
        sum(costs) AS revenue
    FROM
        clients 
        rollup_order_day_costs AS r
        orders
    WHERE
        clients.id = orders.clientid AND
        orders.id = r.order_id AND
        r.dayperiod BETWEEN TO_DAYS('2011-03-07')-TO_DAYS('1970-01-01')-1 AND  TO_DAYS('2011-03-13')-TO_DAYS('1970-01-01')-1
    GROUP BY
        clients.`name`
    ORDER BY
        revenue DESC

This currently returns something to thing to this effect:

    Client A  | 100000
    Client B  |   75000
    Client C  |   50000
    etc...

But I'd really like to see:

    Client J  |  25000
    Client P  |  20000
    Client W |  10000
    Client Z  |     250


Is this possible? I don't know PHP at all which a Google search returns a lot of.
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/gbicl/mysql_noob_is_there_a_way_to_return_only_specific/
1299645391.0,g0970,"How would you model this type of workflow in an 
RDBMS?",0,2,http://www.reddit.com/r/SQL/comments/g0970/how_would_you_model_this_type_of_workflow_in_an/,"Let's pretend we have a product that before release has to be inspected and verified by several persons. So, for example, when Designer inspects and verifies it, say the QA guy should verify it. Again the date and the person need to be recorded. Then say the release manager can verify the product only after the QA person has done so.

One way is to have a table structure like (product_id, qa_person_id, qa_verification_date, release_manager_person_id, release_manager_verification_date) with all the columns with the exception of product_id set to null initially and getting filled as the workflow progresses. But this doesn't look like an elegant solution (maybe because I don't like a lot of nullable columns in my tables?). 

What do you think? Are there better solutions for this problem?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/g0970/how_would_you_model_this_type_of_workflow_in_an/
1299391587.0,fya6n,SQL in Shell,,4,1,0,,t5_2qp8q,False
1299023633.0,fvemz,Can a constraint be made to guarantee only one row will have a certain value per foreign key? (x-post from /r/mysql),picto,3,0,0,,t5_2qp8q,False
1298264446.0,fpcyx,Weird MySQL LIKE query behavior..,PHiZiX,3,0,4,"I'm trying to match usernames to first and last names. I have a list of first names and a list of last names. I do two queries:

    CREATE TABLE firstNameMatches AS
    SELECT * FROM UserNames
     WHERE username LIKE CONCAT(FirstNames.firstName
     GROUP BY userID
    HAVING CHAR_LENGTH(FirstNames.firstName) = MAX(CHAR_LENGTH(FirstNames.firstName));

    CREATE TABLE lastNameMatches AS
    SELECT * FROM UserNames
     WHERE username LIKE CONCAT('%'
     GROUP BY userID
    HAVING CHAR_LENGTH(LastNames.lastName) = MAX(CHAR_LENGTH(LastNames.lastName));

Now

I just ran update set firstName = lower(firstName) on FirstNames and am re-running the query to generate firstNameMatches to see if it helps

P.S. The FirstNames table is 86k records and the LastNames table is 150k records if that makes a difference.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/fpcyx/weird_mysql_like_query_behavior/
1297182538.0,fhkuy,Store image in image column or on disk?,guillotinechoke,3,0,5,I know that an image column is probably going to slow down the performance of my table but I'll most likely have less than 100 records. Can anyone offer advice on pros/cons of using an image column or storing the image on disk (and saving the path in SQL Server)?,t5_2qp8q,True
1297145130.0,fhc2x,SQL Math Formula? ,tkepongo,3,0,2,"I'm having a tough time trying to get this formula: 

GPA Avg= ∑((points/credits)*count) / ∑(count)

This is what a portion of the table looks like:

CrseNo                     Credits        Points        Count

555        6        10     3

555		6	    0		2

666		0	    0		1

666	        4	   16		29

Pretty much I'm trying to get it so that it is grouped by CrseNo and that each CrseNo will have a calculated GPA average. Does anyone have any idea how to do this? I'm using SQL Server 2008. Thanks alot!

Here's an image of the table: http://imgur.com/uE7h4",self,t5_2qp8q,True,,,True,http://www.reddit.com/r/SQL/comments/fhc2x/sql_math_formula/
1297021996.0,fgeuk,Reporting Services 2005 ignoring URL parameters on one Server,sqldev34,3,0,1,"I'm sending properly formed URL parameters to Reporting Services

Example:
http://reportserver/Reports/Pages/Report.aspx?ItemPath=%2fTest+Reports%2fTestReport1&amp;rs:Command=Render&amp;Year=2010

This works when ran on one of our Reporting Servers

I've ensured that the parameter name for the above query is ""Year"",False,self,t5_2qp8q,False,,,t3_fgeuk
1296829691.0,ff72y,SQL server enterprise vs SQL server data center,ringringbananaphone,3,0,11,I was wondering if anyone here had any insights into the major difference between Microsoft SQL server enterprise edition and SQL server data center edition.,t5_2qp8q,True
1296067967.0,f9ifd,How to do a crosstab in SQL,,3,0,7,"I'm not even sure if this is possible, each with a different value.  What I need is the location


Here is what I have so far:



    select distinct dm.fromdatetime
	pd.DescLong
	dspd.Performed*case when dspd.ProcedureID = 1 then 1
											when dspd.ProcedureID = 2 then 2
											when dspd.ProcedureID = 7 then 1
											when dspd.ProcedureID = 23 then 1
											when dspd.ProcedureID = 25 then 2
											when dspd.ProcedureID = 26 then 1
											when dspd.ProcedureID = 27 then 2
											when dspd.ProcedureID = 29 then 1
											when dspd.ProcedureID = 36 then 2
											when dspd.ProcedureID = 37 then 1
											else 0
									end as Collected
    from DriveMaster dm
    LEFT OUTER JOIN DriveShiftDetail dsd on dm.DriveID=dsd.DriveID
    LEFT OUTER JOIN DriveShiftProcedureDetail dspd on dsd.ShiftID=dspd.ShiftID
    INNER JOIN CenterDetail cd on dm.CenterID=cd.CenterID
    INNER JOIN ProcedureDef pd on dspd.ProcedureID=pd.ProcedureID
    LEFT OUTER JOIN ProcedureProductLink ppl on dspd.ProcedureID=ppl.ProcedureID
    and dm.CenterID &lt;&gt; 1
    and dm.fromdatetime between '1/1/2010' and '12/31/2010'



Thanks

",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/f9ifd/how_to_do_a_crosstab_in_sql/
1294972732.0,f1yxn,Help with a query?,markdavidboyd,5,1,4,"Can anyone help me with a query i am stuck on? I'm ok with SQL but not fantastic

The query i have the moment is:

select distinct agentguid
where alertEmail not like 'this@email.com' 
and  eventDateTime between '2011-01-010 00:00:00.000' and '2011-01-12 00:00:00.000'
order by alertSubject asc

The query returns (as a sample)
http://imgur.com/HMVIh

(Really sorry for the image share

What i need to do, the values never distinct because of a time stamp. 

What happens is, i need to generate a report based 1 Server id, that contains multiples of the same error

AS you can see in the screen shot. NOTE is where the acknowledgment of the error sits. If i didn't have the time stamp

Does anyone see a way of diplaying ONESERVERNAME

I have confused myself i hope this makes sense to you kind peoples.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/f1yxn/help_with_a_query/
1294413673.0,exxe0,"How can I find popular articles in my SQL database, viewed by unique IPs?",menuitem,3,0,http://www.reddit.com/r/SQL/comments/exxe0/how_can_i_find_popular_articles_in_my_sql/

I have a table which is a log of web requests of articles in my database (in mysql).  In it are (say) two columns: (1) an article number ""anumber"" and (2) the IP address which requested that article number ""IP"".  

I want a single query which will return a sorted list of the articles with the number of views from *unique* IPs.  I would have thought using ""distinct"" would do it

SELECT DISTINCT anumber

What this does it counts the total number of requests for anumber

Thanks in advance.  I thought I was a pretty intermediate mysql user,,False,self,t5_2qp8q,False,,True
1294284985.0,ex0ku,SQL Reporting Services - Field based off query with another field as a parameter,sqldev34,3,0,2,"I have a report which pulls all of it's data from a stored procedure

An example is if I had a report to show person details, which is pulled from the database.

I've created a query which contains (SELECT Person_Name from Persons WHERE Person_ID = @Person_ID)

Is it possible to run a value-setting query based off the value of another field,False,self,t5_2qp8q,False,,,t3_ex0ku
1290524709.0,eajl0,"Fighting with a very large Oracle 11g DB, attempting to clean up strings returned from CLOBs in output.",Tornado_Wind_of_Love,4,1,http://www.reddit.com/r/SQL/comments/eajl0/fighting_with_a_very_large_oracle_11g_db/

I'm working on an Oracle 11g database (UTF8 is the charset)

The problem arises because when people copy and paste MS Word documents into the client-side (which was originally programmed back in 1980-something) it *seems* to convert everything to ASCII (the backend is UTF8 though).

Ideally

REGEXP_REPLACE(DBMS_LOB.SUBSTR(note_text, CHR(191), CHR(32))

I've been doing some googling for the past day

Unfortunately I can't just wrap it in Python or Java or anything
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/eajl0/fighting_with_a_very_large_oracle_11g_db/
1289942125.0,e75yz,Looking for SQL Server 2008(-R2) Resources,davvolun,3,0,5,"Inspired by [this post](http://www.reddit.com/r/SQL/comments/e1732/recommend_me_books_on_sql_server_2005_novice_and/). I'm looking for current (reddit) knowledge on SQL Server tools and resources. I'm already evaluating the books mentioned by Ken Henderson

Additionally

I'm looking for things across the spectrum -- administration, etc.

Thanks in advance.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/e75yz/looking_for_sql_server_2008r2_resources/
1289239672.0,e30p1,32 and 64 bit 2k5 SQL on a 64 bit 2008 Cluster??,,3,0,3,"From what I can find online

Any help is greatly appreciated!",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/e30p1/32_and_64_bit_2k5_sql_on_a_64_bit_2008_cluster/
1288883840.0,e1732,Recommend me books on SQL Server 2005 - novice and advanced,Louisblack85,4,1,14,"My boss has sent me on a mission to get books for my office on SQL Server 2005. I buy a lot of books on various other computing subjects but I'm a bit over my head when looking for Microsoft stuff.

Now we need a book that's good for novices. These people know a fair bit of SQL but an overview of what's new in 2005 would be good.

We could also use a more advanced book for the developer who'll be delving a little more deeply. 

**edit.** Quite rightly I have been asked to give more details.
The majority of us deal with SQL server on a fairly basic level. We run queries

I'm afraid I'm not as clear about what the developer does. I think anything that covers the useful

I know it's a pretty vague description and for that I apologise!",self,t5_2qp8q,True,,,True,http://www.reddit.com/r/SQL/comments/e1732/recommend_me_books_on_sql_server_2005_novice_and/
1288224722.0,dxgd7,Mathematical operations with date/time,kithkatul,3,0,3,"I'm using MS Access for a school project,,False
1281442636.0,czgmr,MSSQL: Is there a way to ORDER BY when selecting where ID's are not in asc or desc order?,shadowmoses,3,0,4,"I want to execute a query like this:

SELECT * FROM Webpages WHERE ID IN (6,13);

And I want the output to come out in that order, 8 and 13. Is there an ORDER BY clause that allows this in MSSQL?

If I exclude the ORDER BY,False,self,t5_2qp8q,False,,,t3_czgmr
1277699259.0,cjpru,SQL Import - How long should it take? PHPMyAdmin has been ticking away for about an hour now and is still going.,iamstandingbehindyou,3,0,10,,t5_2qp8q,True
1277414585.0,cipjc,Multiple SQL Databases Showing Same Date-Time Stamp,RichardMcCarty,4,1,3,"My company has a number of databases

Does CHECKDB change date-time stamps unless a repair is done? Are we right to think the exact same date-time stamp on multiple databases with different SQL versions is unusual? ",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/cipjc/multiple_sql_databases_showing_same_datetime_stamp/
1276544548.0,cexy6,Handling Slowly Changing Dimensions in SSIS,enolakardia,4,1,0,,t5_2qp8q,False
1274790458.0,c7w1i,"How to Copy an SQL Table Using MySQL, MS-SQL or other SQL Formats.",scientificworld,6,3,http://www.reddit.com/r/SQL/comments/c7w1i/how_to_copy_an_sql_table_using_mysql_mssql_or/,http://thumbs.reddit.com/t3_c7w1i.png,
1272049170.0,bv99k,Worthwhile SQL certification?,EnderofDragon,3,0,4,I'm looking to get certified in SQL so I have something on my resume to stand out a bit. The problem is that there seem to be a lot of different certifications available for the various flavors and I only know the core language. Compounding the problem is that many of the tests I have seen online are of questionable origin and may just be meaningless. Is there a certification that would actually be meaningful to employers or are they all just bits of paper?,t5_2qp8q,True
1271234209.0,bqong,Is it possible and how on SQL server to calculate n number of fields and keep information on the n+1 field.,webholic,3,0,5,"I am very new in SQL and SQL Server 2008 and I'm sorry if it is a stupid question. 

I am working on CRM application that runs on SQL Server 2008.

I have budgets column in the database. I want to calculate e.g 3% of the budget and insert calculated amount into the 3percent column.

Is it possible to do on server level? if yes

The only solution I have right now is calculate data in Excel and then import it via CRM application back to SQL DB.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/bqong/is_it_possible_and_how_on_sql_server_to_calculate/
1270009765.0,bki2o,Best practice for updating prices in Server 2005?,proslepsis,3,0,10,"I'm not a db admin

We sell widgets.  The widget prices are kept on a table that includes, Item Name, Item Unit of Measure, and Item Price.

We want to change our prices. I have been given an .xls with Item Name

What's the best way to update Item Price? Can I take the 4 columns I have and update from the .xls to change Item Price where (Item Name and Item Unit of Measure)?

Thanks!",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/bki2o/best_practice_for_updating_prices_in_server_2005/
1248935406.0,95w5c,"OpenSQL Camp comes to Portland! November 14-15, 2009",siliconflorist,6,3,http://www.reddit.com/r/SQL/comments/95w5c/opensql_camp_comes_to_portland_november_1415_2009/,http://thumbs.reddit.com/t3_95w5c.png,
1234071202.0,7vqbu,Tagging in Normalized Form,FlySwat,5,2,0,,t5_2qp8q,False
1377012184.0,1kqkhu,I need help selecting/joining,Toni_W,2,0,7,"First post here um.. I haven't ever used anything more complex than a SELECT and I am trying to do something that requires joining. I have a Persons table and a Comments table with a common userID column. I would like to pull everything from the Persons table

This was my attempt... 

    SELECT A.*
    FROM Persons A  JOIN Comments B ON A.userID = B.userID; 

This returned the first and last timestamp in general, and I dont have the slightest clue how to get the relevant comment. 

Let me know if more information is needed please,False,self,t5_2qp8q,1377012923.0,,,t3_1kqkhu
1376973860.0,1kpr63,Perspectives on LedgerSMB: In defence of hand coded SQL,einhverfr,6,3,0,,t5_2qp8q,False
1376936016.0,1kogci,How does this cursor work? [Oracle],crustang,2,0,3,"I'm trying to learn how a member of my team codes

I tried using Google

    CURSOR getZip (Pa_Zip_Code M_Zip.Zip_Code%TYPE)   
      IS
       SELECT *
         FROM M_Zip
        WHERE Zip_Code = Pa_Zip_Code;

     ZipRec     getZip%ROWTYPE;
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1kogci/how_does_this_cursor_work_oracle/
1376507990.0,1kd8vz,"MSSQL Select statement problem. Am I over-complicating this, am I missing something, or is this as hard as it seems?",TurnCoordinator,2,6


I want to only select the ITEM line of there is no MPN line.  In the case of there being an MPN line


Here is a table example


item_no	size	color	barcode_id	barcod

101	      S	        BLUE	ITEM	        101-1

101	      M	BLUE	ITEM	        101-2

101	      S 	BLUE	MPN	        101-1

101	      M	BLUE	MPN	        101-2

102	      S 	RED	ITEM	        102-1

102	      M	RED	ITEM	        102-2

102	      L	        RED	ITEM	        102-3

102	     XL	RED	ITEM	        102-4



Here is my desired result set

101	      S 	BLUE	MPN	        101-1

101	      M	BLUE	MPN	        101-2

102	      S 	RED	ITEM	        102-1

102	      M	RED	ITEM	        102-2

102	      L	        RED	ITEM	        102-3

102	     XL	RED	ITEM	        102-4



Here is my pseudocode.

SELECT * 
FROM TABLE 
WHERE barcod_id  = ‘ITEM’



",self,t5_2qp8q,1376508184.0,,,True,http://www.reddit.com/r/SQL/comments/1kd8vz/mssql_select_statement_problem_am_i/
1376216240.0,1k4zfk,"[oracle/generic] given a set of different keys from relation X, how would you determine if they shared the same attributes in another relation Y?",comfyred,3,1,http://www.reddit.com/r/SQL/comments/1k4zfk/oraclegeneric_given_a_set_of_different_keys_from/

Is it just a matter of counting the DISTINCT attributes of Y for the set

edit: i think it might be clearer to say:

If a set of rows in X share some values,False,self,t5_2qp8q,1376227744.0,,,t3_1k4zfk
1376087193.0,1k20ej,[MySQL] Help Request For Big Query Across Multiple Tables,TheBob,2,0,11,"I'm writing a small discussion forum site

  **Threads Table**  
  ThreadID INT NOT NULL AUTO_INCREMENT PRIMARY KEY
  ForumID INT
  Title VARCHAR(255)
  OPID INT
  DateCreated DATETIME  

  **Posts Table**  
  PostNum INT NOT NULL AUTO_INCREMENT PRIMARY KEY
  ThreadID INT
  AuthorID INT
  PostDate DATETIME
  Text MEDIUMTEXT  

  **Users Table**  
  UserID INT NOT NULL AUTO_INCREMENT PRIMARY KEY
  Role INT
  Username VARCHAR(32)
  Password VARCHAR(32)
  Email VARCHAR(48)
  Avatar VARCHAR(48)
  PostCount INT
  DateCreated DATE
  LoggedIn Bool
  LastLogin TIMESTAMP
  LastActivity TIMESTAMP
  Bio TEXT
  IP_Address VARCHAR(16)  

In generating a list of threads, and the last post date and last poster's user name. I have all of this except the last poster's user name. Here is the working SQL that I have so far:

SELECT Threads.ThreadID, Threads.DateCreated, Users.Username,  
(SELECT PostDate FROM Posts WHERE Posts.ThreadID = Threads.ThreadID ORDER BY PostDate DESC LIMIT 1) AS PostDate  
FROM Threads
WHERE Threads.ForumID = $_GET[f]  
AND Users.UserID = Threads.OPID LIMIT 50  

I'm having difficulty getting the last poster's user name. I can't select another field in the inner query. I've played with a second inner query, so any help here will be appreciated.
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1k20ej/mysql_help_request_for_big_query_across_multiple/
1375648068.0,1jp4gz,Why doesnt this Else statement work?,bluedemon2813,3,1,8,"ACCEPT p_1 PROMPT 'Please enter an Interger between 1 and 100:'

DECLARE
    v_rank number;
        v_input	Popular_names.rank%TYPE := '&amp;p_1';
    v_mname varchar2(20);
    v_fname varchar2(20);	
BEGIN
    SELECT rank
    INTO v_rank
    FROM Popular_names
        WHERE rank=v_input;
    IF v_input&gt;= 1 and v_input&lt;= 100 THEN
        DBMS_OUTPUT.PUT_LINE('Valid!');
    ELSE
    DBMS_OUTPUT.PUT_LINE('Invalid Number!');
END IF;
END;

WHen i enter 1 it works fine. But when i enter 101 etc it says no data availiable",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1jp4gz/why_doesnt_this_else_statement_work/
1375137545.0,1jb4df,[MS SQL] View or scalar-valued function?,mecartistronico,4,3,10,"There's a value I need to calculate for each member of my EMPLOYEES table. The value is somewhat complex and depends on several tables and views

So I could very well create a view

    CREATE VIEW lengthOfLastName AS
    select employeeID
    from EMPLOYEES

or I could also create a scalar function **lengthOfLastName(employeeID)** that returns len(lastName) for the given argument.

Any of those two can be used to populate another table/view.

Which is best?
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1jb4df/ms_sql_view_or_scalarvalued_function/
1375132505.0,1jaxke,[Oracle] sum up status,pflaumengeist,2,0,2,"I have 3 different tables with some data i want to aggregate.

TABLE 1)

| classId | class    |
|---------:|:---------|
|        1 | Spring
|        2 | Summer
|        3 | Autum
|        4 | Winter


TABLE 2)

| studentId | classId | student    |
|----------:|--------:|:-----------|
|       101 |       1 | Alex
|       102 |       1 | Brian
|       201 |       2 | Susan
|       202 |       2 | John
|       ... |     ... | ....


TABLE 3)

| studentId | assignmentId | status |
|----------:|-------------:|:-------|
|       101 |            1 | DONE
|       101 |            2 | FAILED
|       102 |            1 | DONE
|       102 |            2 | DONE
|       201 |            1 | FAILED
|       201 |            2 | FAILED
|       202 |            1 | null
|       202 |            2 | FAILED
|       ... |          ... | ...


The select result should look something like this

| class  | students | null | failed | done |
|:-------|---------:|-----:|-------:|-----:|
| Spring |        2 |    0 |      1 |    3
| Summer |        2 |    1 |      3 |    0
|    ... |      ... |  ... |    ... |  ...",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1jaxke/oracle_sum_up_status/
1373986241.0,1iezc1,SQL Server 2012: Only showing objects you have access to,Rggity,3,1,2,"I connect to a server with over 1000 schemas (or so it seems like)

I only ask because within an ODBC connection within excel

Thanks in advance!",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1iezc1/sql_server_2012_only_showing_objects_you_have/
1373891710.0,1ic3jz,Scaling A DataFrame In Javascript,snowelephant,6,3,0,,t5_2qp8q,False
1373607274.0,1i4wwc,Intro to SQL and Excel class,jdoldno7,3,1,12,"I am a graduate assistant who has been tasked with helping to create an introductory online class on SQL and Excel for people without a IS or CS background.  This class is aimed at people who would likely have an economics

The class is going to be using SQL Server since our program teaches SQL Server for other classes and the resources already exist.  My problem is finding a book with a sample database that students could use as a tutorial to help them learn concepts they could apply to  graded homework assignments using another database.  Since it is going to be an online class

Any recommendations on a book or a reputable online tutorial that would meet my requirements?

[Edit: Any book or resource needs to be relevant to SQL Server 2012 and Excel 2010 and later]",self,t5_2qp8q,1373607510.0,,,True,http://www.reddit.com/r/SQL/comments/1i4wwc/intro_to_sql_and_excel_class/
1373466469.0,1i0bku,[OBIEE]Substring Need Help,daniebanes13,3,1,3,"SUBSTRING(""COL.""Number"" 
FROM LOCATE('-'
FOR LENGTH(""COL.""Number""))

My Col.Number includes data that have a - in it such as: 
552-025
0552-003
0254A-005
1234-567
6789-101

I want to return all of the numbers Left of the - dash. The above formula should do this for me but it is returning everything Right of the dash. What is my code missing?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1i0bku/obieesubstring_need_help/
1373309281.0,1hvprq,[MS SQL] How do I determine how many CPU cores I need for my install?,wrong_profession,3,1,2,"I'm going to be upgrading our SQL 2008 Std to SQL 2012 Std and putting it on a VM. But I'm not sure how I determine how many cores I need to give the VM for it to have the best performance. I don't want to waste my money paying for SQL licenses if I don't have to. Currently we have 8 cores on our physical SQL server,self,
1372861739.0,1hkgt7,[MS SQL] Trouble with insert statement. Help appreciated.,Laughingstok,3,1,3,"I have attached a screenshot of the table in question here: http://i.imgur.com/r7PE6Av.jpg

There are 22 columns outside of the primary key (lid)

INSERT INTO Logins VALUES ('140' , '', '4/22/2013 11:51:55 AM', '4/22/2013 11:51:55 AM', 'EHS_v4_Dev', 'us_english', '1', '0', '0', '0'

I receive the following error:

Msg 213, Line 1
Column name or number of supplied values does not match table definition.

I have 22 items in the insert statement

I have no idea why this isn't working.  Any ideas?

Edit: SOLVED - I did not set the Primary Key to ""Is Identity"",False,self,t5_2qp8q,1372862778.0,,,t3_1hkgt7
1372690553.0,1hffp8,SQL Server 2008: Can I lock out a certain type of connection?,petrus2,5,3,19,"Last week

It turns out that he copied the web.config file from his internal dev server onto the production server and for some reason (probably permissions) he'd been using sa login and password in his dev environment. 

So

ApplicationName = .Net SqlClient Data Provider

LoginName = sa

Can I do this in SQL Server 2008?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1hffp8/sql_server_2008_can_i_lock_out_a_certain_type_of/
1372578102.0,1hctcr,MS-SQL String Converting,shaigb,3,1,14,"Hi All
I have a ms-sql server and a table in it that contains ip addresses that are written without dots (no octates
Also
It should be 192.168.1.2 and it's 21168192.

How Can I convert and add the dots ?

Thanks
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1hctcr/mssql_string_converting/
1372564339.0,1hcj59,What am I doing wrong? Do I need to join this table with itself?,redditaccount1975,2,0,3,"When I run this I get ALL records where Section=Totals instead of just the one matching PropID and Version ID. Here is code:

        SELECT OAOutput.LineID, OAOutput.P1,  OAOutput.PropID, OAOutput.VersionID
    FROM OAOutput
    WHERE ( ((OAOutput.Section)='Totals') OR ((OAOutput.Section) = 'Potential Revenue') AND ((OAOutput.PropID)=[Property]) AND ((OAOutput.VersionID)=[PropVersion]) )
    ORDER BY OAOutput.Section
    ",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1hcj59/what_am_i_doing_wrong_do_i_need_to_join_this/
1372453080.0,1h9tk0,[MS SQL] Linked Server timeouts Exec vs sp_executesql,sergcontrol,7,2,1,"Does anyone know why is it that if you have a linked server query that times out (for example due to a locked table),self,
1372177595.0,1h1nc8,[MySQL] Newb question about storing aggregate values in tables and keeping integrity,lpso,4,2,4,"Hi all

I'm creating a database that stores the details about scores that every player in the database is given. I have a table for Players, a table specifying how well a given player did on a certain task, a table specifying how well a given player did on a certain category, and a table specifying which category every task is in. My question is, I could get rid of the table specifying how well each player did on a certain Category and calculate that on each query, but I would rather store that for easy access. How can I make sure that a category score for a player is never incorrect? Is there some way to say in SQL that a column should be auto-generated to be an aggregate function somehow?",,self,,
1371184086.0,1gbhpr,[MS SQL] Formatting DateDiff to DD:HH:MM,270,2,0,3,"Hello
I am working on a query for a hospital. They need to show the time elapsed since a person was admitted. So I came up with the following forumla (Note: The server that MSSQL is stored on is on the east coast
    
    DATEDIFF(HH,-7,sysutcdatetime())) As Elapsed_Time

The only problem is
Let me know if any more info is required.
Thanks guys",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1gbhpr/ms_sql_formatting_datediff_to_ddhhmm/
1370954870.0,1g48d3,Best way to document scripts?,fahizzled,3,1,9,"Hi there

I inherited a large collection of SQL scripts for work,,False,self,t5_2qp8q,False,,True
1370901498.0,1g2phy,[MS SQL] Need advice on how to handle illogical commission structures for our sales associates,VictimOfTheKillers,3,1,8,"This question has been plaguing me for a few weeks and my lack of database knowledge hasn't been helpful. Basically

Now

If you sold $100k worth of products

I'm thinking that I'll have to run a script every month to calculate these. The solution that I came up is to create an XML column on our SalesAssociates table called ""CommissionsLogic"". The XML would look like:

    &lt;ROOT&gt;
        &lt;Commission Lower=""0"" Upper=""100000"" Pct="".05"" /&gt;
        &lt;Commission Lower=""100001"" Upper=""150000"" Pct="".10"" /&gt;
        &lt;Commission Lower=""150001"" Upper=""200000"" Pct="".12"" /&gt;
        &lt;Commission Lower=""200000"" Upper="""" Pct="".15"" /&gt;
    &lt;/ROOT&gt;

Then

    SELECT  @Output = ( SELECT  D.element.value('@Pct'
                    FROM    dbo.SalesAssociates AS sa
                            CROSS APPLY CommissionLogic.nodes('/ROOT/Commission')
                            AS D ( element )
                    WHERE   UserID = @SalesAssociateID
                            AND ( D.element.value('@Lower'
                                    AND D.element.value('@Upper'
                                                        'MONEY') &gt; @TotalSales
                                )
                    )

And

My questions are: 

* Does anyone see anything absolutely crazy about this implementation?
* Any recommendations for an alternative?
* Is there anything that I should consider doing to make improvements or to make it more scalable?

I sincerely appreciate your time and thoughts...

Thanks
Andrew",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1g2phy/ms_sql_need_advice_on_how_to_handle_illogical/
1370550479.0,1ftcnc,[MS SQL] Do a count based on column values,twonx,2,0,3,"So I got a table like this:

|ID | Product |
:--|:-
1|A
2|B
3|A
3|B
4|A
4|B
5|B

How can I have a create a table that displays the distinct list of IDs and a count of Product A,False,self,t5_2qp8q,False,,,t3_1ftcnc
1370460427.0,1fqo41,Am I in over my head? Access and SQL,jobhunt222,4,2,33,"i got a job where the job listing wanted someone with knowledge of SQL.  I self taught myself SQL about 2 months ago and can do all the basics with ease. But on more complex queries

On the interview, forms, reports, and creating macros.

so

",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1fqo41/am_i_in_over_my_head_access_and_sql/
1370388799.0,1fop80,[MS SQL] MIN MAX CASE Statment,tedistkrieg,3,1,5,"I have this script that returns Room Reservation Arrivals for the week.  Some people have more than one reservation during that time in different room types with different rankings. 1 being the best.
    
    For example (columns are playerid
    name,roomtype,roomrank):
    1234|John Smith|06-04-2013|06-06-2013|Mansion|1
    1234|John Smith|06-04-2013|06-06-2013|Main Tower|4
    1234|John Smith|06-03-2013|06-06-2013|Main Tower|6
    5465|Jenny Andrews|06-05-2013|06-07-2013|SkyLoft|2
    etc...

What I am trying to do is return one result for each person with the best room type so I want to turn the above into
    
    1234|John Smith|06-04-2013|06-06-2013|Mansion|1
    5465|Jenny Andrews|06-05-2013|06-07-2013|Skyloft|2

I have been able to get the best room type using

    SELECT count(playerid) as    
    NumofRoom,
    firstname,min(roomrank) as RoomRank
    FROM TABLE  

However
    
    2|1234|John Smith|06-04-2013|06-06-2013|Mansion|1
    1|1234|John Smith|06-03-2013|06-06-2013|Main Tower|6


What is the best way to return just one result for each person with the best room type

",self,t5_2qp8q,1370390938.0,,,True,http://www.reddit.com/r/SQL/comments/1fop80/ms_sql_min_max_case_statment/
1370360894.0,1fno0l,MSSQL - Clustering Gotchas,pmpjr6465,5,3,6,"Hi

I'm getting ready to build two, anyone got any gotchas they can throw at me?

Thanks",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1fno0l/mssql_clustering_gotchas/
1370291133.0,1flqvi,"[MS SQL] SSRS problem with a report parameter, please help",hi_lampworking,5,3,http://www.reddit.com/r/SQL/comments/1flqvi/ms_sql_ssrs_problem_with_a_report_parameter/

Hi All!
I'm working on a report that displays a bunch of results where each row containins a ""Technician ID number"" 

My primary dataset has a **where table.user2=@techID**

My second dataset (for the parameter) is constructed like:
**select '&lt;ALL&gt;' AS name**
**UNION**
**SELECT name FROM table**
**ORDER BY name**

and the actual parameter is configured to pull from the second dataset ""name"" field 


The current results are that the name parameter does correctly populate and selecting any individual name produces the right results but the &lt;ALL&gt; option is broken. When I try to run &lt;ALL&gt; it just pulls blank results with no errors.

Any thoughts on how to get &lt;ALL&gt; to work?



",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1flqvi/ms_sql_ssrs_problem_with_a_report_parameter/
1369933891.0,1fci3h,[MSSQL] Querying/grouping based on first part of contents of a varchar column,The_Ombudsman,2,0,5,"In the table(s) I'm querying on

With my current query syntax

    domain.com   8
    domain.com   2
    domain.com   3

where each of those record's ""referrer"" value starts with ""domain.com/"" but has different URL variables attached for each returned row (and different total counts of the full referrer string). I'm doing a LEFT() on the position of the slash to return just the domain.

What I'd like is to craft the syntax to do the extra job of combining all these rows based on the common values left of the first slash position

    domain.com   13
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1fci3h/mssql_queryinggrouping_based_on_first_part_of/
1369412729.0,1ez8bk,Is this an appropriate book for me to learn SQL?,wantolearn81,3,1,17,"I learn best from books

I have limited use of SQL in Access and want to increase my knowledge.

Thinking of buying SQL cookbook by anthony morelii

would this be useful or have alot of stuff not applicable to access?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1ez8bk/is_this_an_appropriate_book_for_me_to_learn_sql/
1369319907.0,1ewl8p,Help me combine these 3 queries into one,fa2424,3,1,6,"I have 2 tables.  

Table A- Company( A or B)

Table B(has company C information)- Product #

I want to have my columns look like this (Product #, Company C price)

I tried this and it did not work because unions need to have matching columns.  Any other ideas?

select Product #
from table A
where company=A
union
Select Product #
from table A
where company=B
union
select product #
from table B
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1ewl8p/help_me_combine_these_3_queries_into_one/
1369241488.0,1eudk1,"[tSQL]Wondering why I am getting ""Conversion failed when converting date and/or time from character string""",randomperson24,2,0,4,"I am not sure why I am getting this error as I did the exact same syntax on another report and it is fine.  The data is even being pulled from the same table.  Any ideas?
	
SELECT
		CONVERT(datetime
			SUBSTRING(#Client.Birthdate
			RIGHT(#Client.Birthdate
			#Client.Client_ID
	INTO #Client_Birthdate
	FROM #Client
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1eudk1/tsqlwondering_why_i_am_getting_conversion_failed/
1368776182.0,1ei8af,System 21 / JBA / AS400 SQL question,,3,1,6,"Hello everyone
I'm brand new to this sub Reddit and relatively new to SQL as well. In the office i work in the last programer left and i no longer have anyone to ask questions regarding my musings in SQL. We use both AS400 (aka JBA aka system 21) and Oracle depending on the company we are accounting for (im an accountant). In my SQL code for JBA i have a WHERE NOT clause. In the said WHERE NOT clause I want SQL not to return a record if all of the fields are NULL. When i practice at home in Access i can accomplish this with the clause WHERE NOT ( cl1 = """" AND cl2 = """" AND cl3 = """"). In MS Access this will return a record if any of the cl fields contain non NULL data - this makes sense to me. But in AS400 to get the same results i have to use the following clause:
WHERE NOT ( cl1 = 0.00 OR cl2 = 0.00 OR cl3 = 0.00). To me the Access syntax use of AND makes sense but the AS400 use of OR instead of AND makes my mind go into a uncontrolled seizure. Why why why is the syntax so different in the so called standardized SQL. I'm just assuming there is a very good reason my companies developing a DBMS don't follow standard SQL syntax. Sorry in advance if my noob question through you into a rage ;p
but i am genuinely curious. ",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1ei8af/system_21_jba_as400_sql_question/
1368733891.0,1egyap,MS SQL Server Update Issue,Kazoli,2,0,7,"I am updating one record in my table with a simple update, when I try to query something in that table after the update,
1368478860.0,1e9oyf,[MySQL] Database for 2014 world cup in soccer,hesterbest,3,1,7,"I'm working on a personal project where I'd like to keep track of games and standings in next years world cup in soccer. I want to do this in form of a web-site. I want the web-site to be able to do the following:

* Display the group standings (A-H)
* Display the group matches
* Display the match-detail of a match: goal scorers, extra-time, penalty shootout, venue.
* Display the squad of each team (Not the formation or starting 11
* Display the knockout stage bracket.

There are a total of 64 matches played in the world cup

Since I did something similar for the European Championship in 2012 I have a basic idea how to build this. However

[http://pastebin.com/jzGzZKBR](http://pastebin.com/jzGzZKBR)

I have the following tables:

* teams
* players
* venues
* matches
* goals (half = 1st half, 2nd extra time or shootout. Possibly make enum here)
* cards (half = 1st half, 2nd extra time or shootout. Possibly make enum here)
* standings

I have the following view:

* results (this view gives me the result of matches).

I query the results-view to populate the standings table after a match has been completed.

Now these tables seems to cater to my needs. Do any of you have any suggestions to improvements? Also

Edit: Changed to get better formating.

Edit: I do not want the database to support multiple tournaments,False,self,t5_2qp8q,False,,,t3_1e9oyf
1368302161.0,1e57j9,[ACCESS] Union is acting weird. Any help appreciated!,arvi1000,2,0,2,"Hi all. Something weird is happening with UNION.

-I have two tables with the same fields: [id, weight]

-I want to collapse the tables and store as a third table

    insert into EdgeTemp3
    select d1
    (select d1
    select d1
    group by d1

but the sum of the 'weight' field in table 3 != the sums of that field in tables 1 and 2.  When I run:

    SELECT sum(weight) from EdgeTemp1 union
    SELECT sum(weight) from EdgeTemp2 union
    SELECT sum(weight) from EdgeTemp3

...I get:

    790
    1
    1

Table 3 is 2% smaller than 1 + 2, I don't think. Thanks!",,False,self,t5_2qp8q,False,,
1368126702.0,1e0ox3,Targeting specific parts in a row [tSQL],randomperson24,2,0,5,"Is there a way to split up addresses so that I only get specific parts in a column?  The issue is some of the lengths of the addresses are different and I don’t know how to grab certain parts if the character length varies.  For example, and St and St in a different column.  Is this possible?",t5_2qp8q
1368117127.0,1e0cbs,Basic question. new to sql,noob2828,4,3,18,"My query looks like this Select Distinct Company
From Master_table
Where product &lt;&gt; '0'

I want a list of companies that sell products through us.  I only want a company to be returned ONE time. 

However

How can i change this query to fix this?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1e0cbs/basic_question_new_to_sql/
1368025104.0,1dxnht,Need help loading data into a table with a recursive FK,laurenza,2,0,2,"I have a stored proc that inserts data into a table.  One of the fields is a recursive foreign key - it references another record in the same table.  When I run my statement the first time

Is there a way to have this field populated during the first pass?  The records are in the correct order such that records that are trying to reference other records come after those that they are trying to reference.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1dxnht/need_help_loading_data_into_a_table_with_a/
1367947291.0,1dvfhw,[MS SQL] Need help pulling headers from my query WITH the data.,yuckypants,3,1,12,"I've been tasked with inserting headers into sql query results. The catch is

Here's my code so far: 

    select 
          i.COMPANY
          i.ITEM
          li.ON_HAND_QTY
          li.ALLOCATED_QTY
          li.SUSPENSE_QTY
          CASE 
                WHEN li.ON_HAND_QTY - li.ALLOCATED_QTY - isnull(sd.total_qty 
                ELSE li.ON_HAND_QTY - li.ALLOCATED_QTY - isnull(sd.total_qty 
          END AVAILABLE_QTY
          li.TOTAL_COST
          li.TOTAL_VALUE
          i.USER_DEF3
          case when li.ON_HAND_QTY - li.ALLOCATED_QTY - isnull(sd.total_qty 
    from (
          select li.ITEM, SUM(ALLOCATED_QTY) ALLOCATED_QTY, SUM(SUSPENSE_QTY) SUSPENSE_QTY, SUM(TOTAL_COST) TOTAL_COST, SUM(TOTAL_VALUE) TOTAL_VALUE
          from LOCATION_INVENTORY li inner join LOCATION l
                on li.LOCATION = l.LOCATION
                and li.warehouse = l.warehouse
          inner join GENERIC_CONFIG_DETAIL Loc_Class
                on Loc_Class.IDENTIFIER = l.LOCATION_CLASS
                and RECORD_TYPE = 'LOCCLASS'
          where Loc_Class.SYS1VALUE = 'Y'
          and li.COMPANY = '000000201140'
          group by li.ITEM
    ) li
    inner join ITEM i
          on li.ITEM = i.ITEM
          and ISNULL(li.COMPANY
    left outer join (
          select ITEM
          from SHIPMENT_DETAIL
          where STATUS1 = 100
          group by ITEM
    ) sd
          on li.ITEM = sd.ITEM
          and isnull(li.COMPANY
    --group by i.COMPANY
    order by i.COMPANY
    

This is what I need to add: 

    SELECT COLUMN_NAME
    FROM INFORMATION_SCHEMA.COLUMNS
    WHERE TABLE_NAME = 'TableNameGoesHere'
    ORDER BY ORDINAL_POSITION

I'm not entirely certain how/where to add this though. In fact

**EDIT** Maybe this *isn't* what I need to add. I need to append the columns to the data

I found this [here](http://stackoverflow.com/questions/4964162/how-to-add-table-column-headings-to-sql-select-statement)

Select FirstName

 from (

    select Sorter = 1

    union all

    select 0

 order by Sorter,False,self,t5_2qp8q,1367948083.0,,,t3_1dvfhw
1367751313.0,1dq67n,Having a really tough time with EQUI joins using the same table [Oracle],Cassiop,2,0,2,"Hey all

I'm stuck on a problem from my teacher
http://i.imgur.com/gFzsATs.png

as you can see there are 3 manager ids.
each employee has an assigned manager.

What my teacher wants is to display 
Employee name
using an EQUI join.

This is all using the same table.
Ive been at this problem for hours and cannot figure this out.
Is this possible using the same table?

Any tips help!

Thank you!",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1dq67n/having_a_really_tough_time_with_equi_joins_using/
1367447761.0,1dig4t,2 primary keys to one foreign key - query 2 separate values?,airtrixxx1080,3,1,4,"Table 1:
Contains 1) Origin vendor code and 2) Destination vendor code. This table does *not* provide vendor names

Table 2:
Contains vendor name based on a vendor code (regardless of whether it's an origin or destination vendor)

Currently, 2) the origin vendor **name**, and 3) the destination vendor **code**. I would like to add the *destination vendor name* to this report, which would also pull from Table 2.

Is this possible?

",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1dig4t/2_primary_keys_to_one_foreign_key_query_2/
1367426748.0,1dhnkd,problem using variables,whoisearth,4,2,8,"Can someone let me know what I'm doing wrong here?

The field I'm trying to use the variable in is TEXT if it matters.

    DECLARE @parentID varchar(7)
    SET @parentID = (SELECT jobrun_id FROM jobrun WHERE jobrun_params LIKE '%equity_warrant_euro.dif%'
    AND jobrun_proddt = '2013-04-29' AND CAST(jobrun_stachgtm As DATE) = '2013-04-29'
    AND jobrun_prntid IS NULL)
    SELECT jobmst_name, DATEDIFF (ss,jobrun_launchtm, jobrun_lstchgtm) TidDuraTime, CAST (jobrun_lstchgtm As TIME) CompTime FROM jobrun
    JOIN jobmst ON (jobrun.jobmst_id = jobmst.jobmst_id)
    WHERE jobrun_prntid = (SELECT jobrun_id from jobrun WHERE jobrun_prntid = (
    SELECT jobrun_id from jobrun WHERE CONVERT(varchar

I know the variable is returning the value I want

Alternatively

UPDATE - 

So I must have been brainfarting I got it to work thanks to the help of you guys :)  But it doesn't like that I'm trying to do it as a 3rd UNION (see below).  If I run everything after **DECLARE** on it's own it's fine.  As soon as I try to run the whole thing together it craps out.

    SELECT jobmst_name, DATEDIFF (ss,jobrun_launchtm, jobrun_lstchgtm) TidDuraTime, CAST (jobrun_lstchgtm As TIME) CompTime FROM jobrun
    JOIN jobmst ON (jobrun.jobmst_id = jobmst.jobmst_id)
    WHERE jobmst.jobmst_id = (SELECT jobmst_id FROM jobmst WHERE jobmst_type = 6
    AND jobmst_prntid = (SELECT jobmst_id FROM jobmst WHERE jobmst_name LIKE '%FTP%'
    AND jobmst_prntid = (SELECT jobmst_id FROM jobmst JOIN jobdtl ON jobmst.jobmst_id = jobdtl.jobdtl_id WHERE jobdtl_params LIKE '%equity_warrant_euro.dif%'
    AND jobmst_type = 1 AND jobmst_active = 'Y')))
    AND jobrun_status = 101 AND jobrun_duration IS NOT NULL AND jobrun_proddt = '2013-04-29'
    UNION
    SELECT jobmst_name, DATEDIFF (ss,jobrun_launchtm, jobrun_lstchgtm) TidDuraTime, CAST (jobrun_lstchgtm As TIME) CompTime FROM jobrun
    JOIN jobmst ON (jobrun.jobmst_id = jobmst.jobmst_id)
    WHERE jobrun_prntid = (
    SELECT jobrun_id FROM jobrun WHERE jobrun_prntid = (
    SELECT jobrun_id FROM jobrun WHERE jobrun_params LIKE '%equity_warrant_euro.dif%'
    AND jobrun_proddt = '2013-04-29' AND CAST(jobrun_stachgtm As DATE) = '2013-04-29'
    AND jobrun_prntid IS NULL
    ))
    UNION
    DECLARE @parentID varchar(7)
    SET @parentID = (SELECT jobrun_id FROM jobrun WHERE jobrun_params LIKE '%equity_warrant_euro.dif%'
    AND jobrun_proddt = '2013-04-29' AND CAST(jobrun_stachgtm As DATE) = '2013-04-29'
    AND jobrun_prntid IS NULL)
    SELECT jobmst_name, DATEDIFF (ss,jobrun_launchtm, jobrun_lstchgtm) TidDuraTime, CAST (jobrun_lstchgtm As TIME) CompTime FROM jobrun
    JOIN jobmst ON (jobrun.jobmst_id = jobmst.jobmst_id)
    WHERE jobrun_prntid = (SELECT jobrun_id from jobrun WHERE jobrun_prntid = (
    SELECT jobrun_id from jobrun WHERE jobrun_params LIKE '%' + @parentID + '%'))

EDIT _ FINAL - 

I moved the DECLARE to the beginning and did an order by jobmst_name at the end and we're all good!

Thanks guys!

",self,t5_2qp8q,1367449910.0,,,True,http://www.reddit.com/r/SQL/comments/1dhnkd/problem_using_variables/
1367424307.0,1dhkgj,Multiple SELECTs in loop breaking up query (T-SQL),zombiedada,2,0,2,"I'm using a WHILE loop to increment a time variable (it's for school terms), suggestions

http://pastebin.com/TxAvRagd",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1dhkgj/multiple_selects_in_loop_breaking_up_query_tsql/
1367340662.0,1df55x,[MS SQL] Replication failing on one table. Weird.,firsttbrocade,2,0,6,"I have replication occurring for a database and one of the tables is not being replicated and I am unsure why. Not only is it not replicating the data it is dropping the table all together. This has worked for several years and the issue just suddenly popped up.

I have tried to reinitialize the subscription with a new snapshot and that does not work. I have also tried creating the table again and once it comes time to replicate the data it drops the table again.

I have also tried recreating the entire subscription from scratch to no avail. 

Any thoughts as to what to check here,False,self,t5_2qp8q,1367342084.0,,,t3_1df55x
1367240750.0,1dc2qz,[SQL] Taking an introductory database class and could use some help on a final project.,komebeaux,4,2,6,"Ok
I was provided an existing SQL database that I am running in XAMP. I have a list of tasks I need to run on this database. 

This is the first question of 12 total, I struggle with this stuff. I want to understand it better, however, and have had difficulty getting explanations from my instructor.   

So

Create a new table that uses the following criteria: 
*column
*type
*length
*decimal places
*nulls allowed?
*description
I am ok with this one for the most part,False,self,t5_2qp8q,False,,,t3_1dc2qz
1366998848.0,1d611b,[TSQL]Creating Dummy Values in Table,randomperson24,2,0,3,Currently what I have is a table like [this](http://www.freeimagehosting.net/dkz79).  It contains a date if the letter occurred during that particular month.  What I need is something like [this](http://www.freeimagehosting.net/hojfn).  Where there is a letter for every possible date.  I also have a table with [all possible letters](http://www.freeimagehosting.net/qpeh2) and another table with [all possible dates](http://www.freeimagehosting.net/fc6uw).  What I am trying to create is [another table](http://www.freeimagehosting.net/hojfn) with dummy values so if an alphabet does not appear in a particular month; it would still have a possible row for each alphabet and date like this.  Let me know if this doesn’t make sense because I was trying to make this as simple as possible.,t5_2qp8q,True
1366603792.0,1cuep0,Remote bulk insert,RshAndRoulette,2,0,6,"I'm working on a project for a class that requires me to be able to import a .csv file to my university's server. I do not have access to the server itself,,False
1366317540.0,1cmp6a,Learning SQL can you help me debug?,BlameTheAirForGossip,2,0,4,"I am learning SQL and cannot figure out the error of my text. I am getting Msg 102

Create Table	CUST_INV (

	Inv#		INT		NOT NULL

	CustID		INT		NOT NULL

	DateIn		DateTime	NOT NULL

	DateOut		DateTime	NULL

	Subtotal	Numeric(8

	Tax		Numeric(8

	Total		Numeric(8

	Constraint	CUST_INV_PK			Primary Key(Inv#)

	Constraint	CUST_INV_Cust_FK	Foreign Key(CustID)

	References	CUST(CustID)		ON Update No Action

									ON Delete No Action;

Alter Table INV
	Drop Constraint INV_CUST_FK;


Alter Table ITEM
	Drop Constraint ITEM_INV_FK;


Alter Table ITEM
	Add Constraint ITEM_CUST_INV_FK		Foreign Key (Inv#)

	References CUST_INV(Inv#)

	ON Update Cascade

	ON Delete Cascade;
	
Insert Into CUST_INV (Inv#, DateOut, Subtotal, Tax, Total)

	Select Inv#, DateOut, Subtotal, Tax, Total

	From INV;


Drop Table INV;

",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1cmp6a/learning_sql_can_you_help_me_debug/
1365093281.0,1bo3tr,[Oracle] Can anyone help with this max function?,crustang,2,0,7,"I'm trying to find an elegant way to do this.. I have a query with 4 columns

Here's what I have so far


    SELECT 
      COMP_CODE
      QTY_BKD_PROF_CODE
      SKU_CODE
      MAX(QTY_BKD_PROF_LEV_NUM) AS MAX_INT
    FROM 
      M_QTY_BKD_PROF_D
    GROUP BY 
      COMP_CODE
      QTY_BKD_PROF_CODE
      SKU_CODE;

",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1bo3tr/oracle_can_anyone_help_with_this_max_function/
1364357188.0,1b3b1e,sQL dETAILS Tutorials,imryadav,3,1,0,,t5_2qp8q,False
1364251202.0,1b04p6,[Oracle]Trying to connect using sqlplus with a username that has brackets fails,listix,2,0,7,"Hi everyone.

I am trying to connect to a database where the username is like:

user[abc]

But when I try to connect using sqlplus like this:

    sqlplus user[abc]@database

and then put the password it says:

ORA-01017: invalid username/password; logon denied

I have connected to that same database using sqldeveloper with that username with no issue. The password contains a . but no other special character. I have another user without the stuff inside the brackets that works fine.

    sqlplus user@database

I put the password(which has a . too) and it works fine. Do I have to escape some character? I tried with \ and "" but to no avail. Its getting on my nerves. What am I doing wrong?

Thank you in advance.


EDIT: For future reference,False,self,t5_2qp8q,1364314664.0,,,t3_1b04p6
1363136981.0,1a6pmb,[MS SQL] Help with SQL Server Maintenance Plan Email Report,Narusa,2,0,3,"So I followed the instructions listed [here](https://support.quest.com/SolutionDetail.aspx?id=SOLSL4092) on how to create a SQL maintenance plan. 

I receive the email but it is a wall of text which contains the commands used (information I don't care about really). All I need the email to show is that the job was a success. 

Are there any settings I can change or is there a simpler way with something like power shell?

Thank you!

EDIT: I added a copy of the emailed reports I receive [here](http://pastebin.com/fi9tEKLt) on pastebin.",self,t5_2qp8q,1363148175.0,,,True,http://www.reddit.com/r/SQL/comments/1a6pmb/ms_sql_help_with_sql_server_maintenance_plan/
1362450742.0,19oiep,"How to Join on a ""Distinct Selection"" or Select values before the ""Distinct Selection"" ",2MyLou,4,2,7,"The query below works but I would like to ideally have Step.ST_TEST_ID as the first column in the query. I've also tried joining to other tables with no luck. I know this should be simple
   
   
  
    SELECT
          DISTINCT Step.ST_RUN_ID as 'Run Id'
          Step.ST_TEST_ID as 'Test ID'

    FROM STEP

    GROUP BY ST_RUN_ID,False,self,t5_2qp8q,False,,,t3_19oiep
1360351865.0,185c7j,[MS SQL 2008] Upload files on schedule,Fritz_Meister,2,0,11,"Up until now, of a few different formats

Please provide advice on the best practice/recommended action for uploading files to MS SQL 2008. I will be getting these files via FTP from another server on a routine schedule and need to upload the files to the database around that time.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/185c7j/ms_sql_2008_upload_files_on_schedule/
1360149277.0,17zsfn,Cannot connect to server,Stalemate9,5,4,16,"Hi I am trying to learn SQL and have installed SQL Express 2008 but when I try to connect I get the following message



",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/17zsfn/cannot_connect_to_server/
1359919554.0,17tizc,"[SQLite] How to call up DB entries, and open the corresponding folder in Windows Explorer?",featheredtar,2,0,http://www.reddit.com/r/SQL/comments/17tizc/sqlite_how_to_call_up_db_entries_and_open_the/

This is to find time lapse footage from a complex database spanning multiple hard drives,False,self,t5_2qp8q,False,,,t3_17tizc
1359672696.0,17npbq,How to easily export a .csv file for each date in a record?,AlkalineDuck,2,0,3,"I'm still fairly new to SQL

Basically we have a record going back about a year

I've figured out how to iterate over the days and do a query for each day

I'm using MS SQL Server management studio

Thanks!",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/17npbq/how_to_easily_export_a_csv_file_for_each_date_in/
1359533898.0,17jw4n,Combining multiple count queries with varying constraints,boiling_penis,3,1,10,"So I have four queries I have to run

     select count(METRIC) from TABLE where date='2013-01-04' and METRIC&gt;=10000000;
     select count(METRIC) from TABLE where date='2013-01-04' and METRIC&lt;10000000 and METRIC&gt;=5000000;
     select count(METRIC) from TABLE where date='2013-01-04' and METRIC&lt;5000000 and METRIC&gt;=1000000;
     select count(METRIC) from TABLE where date='2013-01-04' and METRIC&lt;1000000 and METRIC&gt;=500000;

and then again

Is there a single query I can run which will return these four values like

       -----------
       | first count |
       ---------
       | second count |
       -----------
       | third |
       ---------
       | four |
       ---------
       | first sum |
       -------------
          etc.

?",self,t5_2qp8q,1359534472.0,,,True,http://www.reddit.com/r/SQL/comments/17jw4n/combining_multiple_count_queries_with_varying/
1359144120.0,179up2,[Oracle] - Question about error handling - known errors and Exception vs other methods,just_dig_in_work,2,0,7,"Given this:

    CREATE TABLE pair
    (

        pair_id   NUMBER CONSTRAINT p_pair_id_nn NOT NULL
        name      VARCHAR2 (64) CONSTRAINT p_name_nn NOT NULL
        VALUE     VARCHAR2 (64) CONSTRAINT p_value_nn NOT NULL

    );


    CREATE INDEX pk_pair_id_idx
    ON pair (pair_id);


    ALTER TABLE pair 
    ADD CONSTRAINT pk_pair_id 
    PRIMARY KEY (pair_id)
    USING INDEX pk_pair_id_idx;


    ALTER TABLE pair 
    ADD CONSTRAINT p_name_value_uniq 
    UNIQUE (name


    CREATE SEQUENCE seq_pair_id
    START WITH 1
    INCREMENT BY 1;



    CREATE OR REPLACE PROCEDURE i_pair2 (
        name_     IN     VARCHAR2
        value_    IN     VARCHAR2
        result_      OUT NUMBER)
    IS
        v_pair_id    NUMBER;

        CURSOR pair_cur
        IS
        SELECT COUNT (*)
        FROM pair
        WHERE name = name_ AND VALUE = value_;

        pair_count   NUMBER;
    BEGIN
        
        OPEN pair_cur;

        FETCH pair_cur INTO pair_count;

        CLOSE pair_cur;

        IF pair_count = 1
        THEN
            SELECT pair_id
            INTO v_pair_id
            FROM pair
           WHERE name = name_ AND VALUE = value_;
       ELSIF pair_count = 0
       THEN
           INSERT INTO pair
           VALUES (seq_pair_id.NEXTVAL
           RETURNING pair_id
           INTO v_pair_id;
        END IF;

        result_ := v_pair_id;
    END;


    CREATE OR REPLACE PROCEDURE i_pair1 (
        name_     IN     VARCHAR2
        value_    IN     VARCHAR2
        result_      OUT NUMBER)
    IS
        v_pair_id   NUMBER;
    BEGIN
         SELECT pair_id
         INTO v_pair_id
         FROM pair
         WHERE name = name_ AND VALUE = value_;

        result_ := v_pair_id;
     EXCEPTION
    WHEN NO_DATA_FOUND
    THEN
          SELECT seq_pair_id.NEXTVAL INTO v_pair_id FROM DUAL;

          INSERT INTO pair
          VALUES (v_pair_id
          RETURNING pair_id
          INTO result_;
    END;

    DECLARE
        result_   NUMBER;
    BEGIN
        i_pair1 ('name1'
        DBMS_OUTPUT.put_line ('returned ' || result_);
        i_pair2 ('name2'
        DBMS_OUTPUT.put_line ('returned ' || result_);
        i_pair1 ('name3'
        DBMS_OUTPUT.put_line ('returned ' || result_);
        i_pair2 ('name4'
        DBMS_OUTPUT.put_line ('returned ' || result_);
        i_pair1 ('name5'
        DBMS_OUTPUT.put_line ('returned ' || result_);
        i_pair2 ('name6'
        DBMS_OUTPUT.put_line ('returned ' || result_);

        i_pair2 ('name8'
        DBMS_OUTPUT.put_line ('returned ' || result_);
    END;



Is I_PAIR1 better or is I_PAIR2 better?

I have taken over some database development duties and the previous developer has some procedures written in the style of I_PAIR1. I have attempted to follow this pattern but one of my DBA's has cautioned me against this and prefers something after the style of I_PAIR2. If the precedent has been set with I_PAIR1 would there be benefit to switch to the other style

It seems odd to me that using named exceptions would be bad or wrong. It also seems odd to me to try to figure out a way to avoid using standard exception handling. But

Can anyone offer advice or an opinion on this?

tl;dr - Is it better to use standard exception handling or figure out ways to circumvent it and handle known exceptions without referencing them in the Exception block?

Edit1: formatting didn't copy/paste well...",self,t5_2qp8q,1359144754.0,,,True,http://www.reddit.com/r/SQL/comments/179up2/oracle_question_about_error_handling_known_errors/
1358438042.0,16r8ac,[MS SQL] Help running batch file when current date equals date in a table,andyfhx,2,0,9,"I'm trying to modify a store procedure to not run a batch file if the current date is equal to dates in a certain table and if the current date is not equal  to the dates in the table

I'm rather new SQL and I'm not sure where to really start on this one. Could you guys get me started?

Thanks in advance!",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/16r8ac/ms_sql_help_running_batch_file_when_current_date/
1357929728.0,16e3yz,[MSSQL]: Mapping Table Schema Example?,mariocatch,2,0,1,"Does anyone have any example of a very simple 2 column mapping schema?

IE: Assume I have 2 tables
I'm trying to create a 3rd table that can map 2 rows from the other 2 tables together.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/16e3yz/mssql_mapping_table_schema_example/
1357859732.0,16cdsz,"[Oracle] I am having trouble connecting to Oracle behind a firewall. 1521 is fine and the connections are coming in, but the random out is blocked. I have tried USE_SHARED_SOCKET but it still won't work. Any ideas?",SonOfZork,3,1,http://www.reddit.com/r/SQL/comments/16cdsz/oracle_i_am_having_trouble_connecting_to_oracle/,self,
1357676747.0,167akz,[Oracle]Update values where the field is NULL,borensoren,2,0,12,"So I have a list I matched and I'm trying to add the values that I found to an existing table

    UPDATE JM_TEMP_010713 A SET A.NPI = 
        (
            SELECT B.NPI FROM JM_TEMP_010713_NPINA B
            WHERE A.UNIQUEID = B.UNIQUEID
            AND A.NPI IS NULL
        ) ",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/167akz/oracleupdate_values_where_the_field_is_null/
1357505748.0,162tck,[MySQL] Inner Join Help,Jeklah,2,0,11,"Ok
Basically I'm trying to do a simple join and it's not working the way it should be.

I have it kind of working. The syntax is correct it's just not working as expected.

    SELECT * 
    FROM sales sa
    INNER JOIN stock st ON st.StockCode = sa.StockCode
    WHERE st.SuppName =  'Name 1'

This works and returns what I thought it would.

    SELECT * 
    FROM sales sa
    INNER JOIN stock st ON st.StockCode = sa.StockCode
    WHERE st.SuppName =  'Name 2'

This doesn't work and I've been through the data multiple times
Is there a reason this could be happening or is it definitely the data? Am I just losing my sight.

Thanks everyone.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/162tck/mysql_inner_join_help/
1356578012.0,15i00t,[ANSI SQL] Pagination,cfv,3,1,8,"Hi all!

So

Now,,False,self,t5_2qp8q,False,,True
1356014149.0,1562h6,Looking for Financal and Medical Data Information,markpelly,2,0,0,"I recently started a new position

Almost like some sort of crash course.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1562h6/looking_for_financal_and_medical_data_information/
1354892335.0,14g1zz,Need assistance deleting data from one table when it exists in another table. Could not find the answer on IBM's page.,,3,1,13,,t5_2qp8q,False
1354656273.0,14a6i9,[Oracle] Pulling members of 2 tables if all applicable records meet specific criteria.,el_monstruo,2,0,11,"I have two tables here: [TABLES](http://i.imgur.com/KYrGi.png)

What I want to do is write a script that pulls any ID from table one that has all reference numbers with a RE or RW status that have matching reference numbers on table 2 with status that are not RE or RW in the same years.  So based on the provided tables

I know how to combine the two tables but I am not sure I am combining them in a way that can get me the data I want.

Any suggestions?

",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/14a6i9/oracle_pulling_members_of_2_tables_if_all/
1354630733.0,149g46,An Introduction to SQL - Codular,michaelwr9052,2,0,1,,t5_2qp8q,False
1354163145.0,13z60o,[MS Access SQL] Help writing a query,thePersonCSC,3,1,2,"Given a set of tables in Access:

* Client
 * ID
 * first_name
 * last_name
 * middle_initial
* Phone_Numbers
 * ID
 * client_id
 * phone_number
 * type
* Assigned_Numbers
 * ID
 * client_id
 * phone_number
 * extension
		
If I want to select a query that contains the following information about every client:
	
* Client.first_name
* Client.last_name
* Client.middle_initial
* One phone_number where type = ""home"" (null for this cell otherwise)
* One phone_number where type = ""cell"" (null for this cell otherwise)
* One assigned_number (null for this cell otherwise if it doesn't exist)
	
The relationships are:
	
* Client has many Phone_Numbers
* Client has many Assigned_Numbers
	
I want the query to select clients even if those clients don't have phone_numbers

How do I write this?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/13z60o/ms_access_sql_help_writing_a_query/
1353295909.0,13fk8o,How to Query 3 Different Tables With a Sum Function?,el_monstruo,2,0,4,"The example tables are located here: [TABLES](http://i.imgur.com/TMaHH.png)

What I want is the query to pull any people who are HERE in 2012 and have 10 or more units of Apple in either LOCAL, Jill, Jim and John would be pulled by the query.

I know how to query each table and then combine the results to get the required data but is there a way to do this in one query?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/13fk8o/how_to_query_3_different_tables_with_a_sum/
1353263595.0,13enpx, sql insert into using access (im a noob),justinsane714,2,0,5,"Maybe I am tired
It keeps giving me error message saying ""characters found after end of SQL statement."" I assume it is talking about the second INSERT INTO statement. 

INSERT INTO EMP_1 VALUES('101','G','11/8/2000','502');   
INSERT INTO EMP_1 VALUES('102','H','7/12/1989','501');",,False,self,False,t3_13enpx
1352915966.0,136wab,Oracle: Do I need to know programming?,zaciroth,2,0,6,"I'm looking at having to take a Oracle Database class this next semester. My school has a prerequisite on the class that says it needs me to have taken at least Intro to Programming. It is the only class open online this semester and my professor said she would wave me in. However

A study of the structure of data bases and the techniques for managing data bases. Competencies in the use of an existing data base management system will be treated. These competencies will include creating, report generation and SQL. Prerequisite(s): CPSC 1230 or equivalent As required
3 hours lecture / 2 hours laboratory

The 1230 class is an intro to programming class (usually taught in Visual Basic) 

Thanks guys",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/136wab/oracle_do_i_need_to_know_programming/
1352749312.0,132t77,Query,Team_Rocket,3,1,7,"Why does this method return 0 results

where (DateTimeHistory &gt; (SELECT DATEADD(d, getdate()),0)))
AND (DateTimeHistory &lt; (SELECT DATEADD(d, getdate()),0)))

Versus this method:

where DateTimeHistory &gt; '2012-11-12 00:00'
AND DateTimeHistory &lt; '2012-11-13 00:00'

",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/132t77/query/
1352414028.0,12vqcx,Count records by month between two dates.,Bandude,2,0,15,"Having trouble with this one and can't find any good examples on the web.


I have 2 dates 'Eff Date' and 'Term Date'. 

(term can be null which would indicate the record is active)


I need to count how many historical effective members there were per month given a date range.



**DATA**

| ID   | Eff Date    | Term Date   |
|:-----------|:------------|:------------|
| 1|5/1/2011|&lt;null&gt;
| 2 |5/1/2011|3/1/2012 
| 3|5/1/2011|2/1/2012

I want a count of active members for Jan



**Expected Results**

| Month   | Active member count
|:-----------|:------------
| JAN|3
| FEB|2
| MAR|1

Any help would be appreciated.

I'm using a [bastardized](http://documentation.softwareag.com/adabas/cxx1101/intro/introover.htm) version of SQL but you can provide your solution via your preferred platform 
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/12vqcx/count_records_by_month_between_two_dates/
1352341321.0,12u2ej,Invalid Data Object when trying to load table,simkessy,3,1,5,"I used Forward Engineer plugin for Visio to convert and ERD Diagram into SQL. This created the tables

Here's a screenshot: http://imgur.com/vE3zC",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/12u2ej/invalid_data_object_when_trying_to_load_table/
1351697322.0,12ehgy,Scheduled an SQL Event with your MySQL Server,UberEmetophobic,3,1,0,,t5_2qp8q,False
1351545805.0,12arf7,ER Diagram for a Phonecall [INNODB],bpmn,2,0,3,"I am trying to develop a phonecall database, however it falls apart when I imagine 3-way calling.",t5_2qp8q
1351199203.0,12354c,"[MSSQL] my weekend-project: SQL Extractor; Track 
your views/storedprocs/... in your git/hg/...",1,5,http://www.reddit.com/r/SQL/comments/12354c/mssql_my_weekendproject_sql_extractor_track_your/,,,False,t5_2qp8q,False
1351111614.0,120yo6,[TSQL] Newly minted SQL Admin needs help. ,e13ct,3,1,12,"Hey everybody

What kind of resources would you suggest to get a working knowledge of Sql as fast as possible??? 

I have a book from Sybex, but I am having trouble applying what I know to our environment. 

TL;DR New Sql admin needs help with SQL and Academic ERP systems. 

Thanks. ",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/120yo6/tsql_newly_minted_sql_admin_needs_help/
1350660596.0,11r1h7,Subselect statements to avoid using temp tables?  Is this possible?,,3,1,6,"In Access

SELECT qry00.”columnA”

How could I do this in SQL?  Could I do a subselect statement such as 

SELECT columnA
FROM (SELECT columnA

?  I would be hoping to select only the criteria from the inner-substatement in the outer select statement.    I don’t have to do it this way; I am just interesting in the idea of not putting data into temp tables to run more smoothly.
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/11r1h7/subselect_statements_to_avoid_using_temp_tables/
1350361798.0,11jzei,How can I manage an event over many rows? [Vertica],cptwngr,3,1,3,"I store data from a JMS output and it has a composite key of 4 fields and about 20 others. 

class, timestamp 

As an instance of this event lives

Are there any techniques I could use to better manage this data? I think this sounds like a time series,False,self,t5_2qp8q,False,,,t3_11jzei
1350308050.0,11id80,"Just Released: ElSql, a Standalone Java Library for Managing SQL",soi_la,2,0,http://www.reddit.com/r/SQL/comments/11id80/just_released_elsql_a_standalone_java_library_for/,http://c.thumbs.redditmedia.com/GcZ6zkgXjuGBxTXt.jpg,
1349966595.0,11b70p,[MSSQL] Easy Transact SQL Problem. ,Orwell84,3,1,18,"I don't usally do too much transact SQL coding

I'm trying to get the **PO2_PurchaseOrderEntryLine.UnitCost** column to show up in the table **Open PO Report**. I know I need to add some sort of relational statement torwards the end of of the script

-------------------------------

    SELECT     CASE PO2_PurchaseOrderEntryLine.ProductLine WHEN '0001' THEN 'LOBSTER' WHEN '0002' THEN 'LOBSTER' WHEN '0003' THEN 'LOBSTER' WHEN '0004' THEN 'LOBSTER'
                       WHEN '0005' THEN 'LOBSTER' WHEN '0006' THEN 'LOBSTER' WHEN '0007' THEN 'LOBSTER' WHEN '0008' THEN 'LOBSTER' WHEN '0009' THEN 'LOBSTER' WHEN
                       '0010' THEN 'LOBSTER' WHEN '0011' THEN 'LOBSTER' WHEN '0014' THEN 'LOBSTER' WHEN '0015' THEN 'LOBSTER' WHEN '0103' THEN 'CRAB' WHEN '0113' THEN
                       'CRAB' WHEN '0105' THEN 'CRAB' WHEN '0114' THEN 'CRAB' WHEN '0120' THEN 'CRAB' WHEN '0100' THEN 'CRAB' WHEN '0101' THEN 'CRAB' WHEN '0108' THEN
                       'CRAB' WHEN '0110' THEN 'CRAB' WHEN '0111' THEN 'CRAB' WHEN '0118' THEN 'CRAB' WHEN '0122' THEN 'SHRIMP' WHEN '0126' THEN 'SHRIMP' WHEN '0127' THEN
                       'KING CRAB' WHEN '0128' THEN 'ARGENTINE CRAB' WHEN '0130' THEN 'PACKAGING' ELSE 'OTHER' END AS Category
                      ci_udt_subcategory.UDF_SUBCATEGORY_DES AS SubCategory
                      PO1_PurchaseOrderEntryHeader.MasterRepeatingPOOrSO AS [Mast PO]
                      PO1_PurchaseOrderEntryHeader.OnHold AS [Hold?]
                      PO1_PurchaseOrderEntryHeader.RequiredExpireDate AS ETA
                      PO2_PurchaseOrderEntryLine.WarehouseCode AS Whse, 
                      PO_95_UDF_PurchaseOrderLines.Pbrand AS Brand
                      PO2_PurchaseOrderEntryLine.UMConversionFactor AS [U/M]
                      PO2_PurchaseOrderEntryLine.UMConversionFactor * PO2_PurchaseOrderEntryLine.QtyOrdered AS [Lbs/Kgs]
                      PO2_PurchaseOrderEntryLine.QtyReceived AS Received, 
                      PO2_PurchaseOrderEntryLine.UnitCost) AS Cost
                      AS [Cost/Unit]
    INTO [Open PO Report]
    FROM         ci_udt_category INNER JOIN
                      ci_item ON ci_udt_category.UDF_CATEGORY_CODE = ci_item.UDF_CATEGORY INNER JOIN
                      ci_udt_subcategory ON ci_item.UDF_SUBCAT = ci_udt_subcategory.UDF_SUBCATEGORY_CODE RIGHT OUTER JOIN
                      PO2_PurchaseOrderEntryLine AS PO2_PurchaseOrderEntryLine INNER JOIN
                      PO1_PurchaseOrderEntryHeader AS PO1_PurchaseOrderEntryHeader ON 
                      PO2_PurchaseOrderEntryLine.PurchaseOrderNumber = PO1_PurchaseOrderEntryHeader.PurchaseOrderNumber INNER JOIN
                      PO_95_UDF_PurchaseOrderLines AS PO_95_UDF_PurchaseOrderLines ON 
                      PO2_PurchaseOrderEntryLine.LineIndex = PO_95_UDF_PurchaseOrderLines.LineIndex AND 
                      PO2_PurchaseOrderEntryLine.PurchaseOrderNumber = PO_95_UDF_PurchaseOrderLines.PurchaseOrderNumber AND 
                      PO1_PurchaseOrderEntryHeader.PurchaseOrderNumber = PO_95_UDF_PurchaseOrderLines.PurchaseOrderNumber ON 
                      ci_item.ItemCode = PO2_PurchaseOrderEntryLine.ItemNumber
    WHERE     (PO1_PurchaseOrderEntryHeader.PurchaseOrderDate &gt;= GETDATE() - 31) AND (PO1_PurchaseOrderEntryHeader.PurchaseOrderDate &lt;= GETDATE())
    ORDER BY [PO Date]",self,t5_2qp8q,1349966858.0,,,True,http://www.reddit.com/r/SQL/comments/11b70p/mssql_easy_transact_sql_problem/
1349549302.0,111vzq,[MSSQL] Replication alternatives for 2008R2/2012 Express,jersully,2,0,15,"I'm a longtime Windows SysAdmin with not much SQL experience.  What synchronization options do I have other than replication for 2-4GB database synchronization over broadband?  DB changes are made manually by users keying information into our application front-end.

Google tells me there are other options

**Edit:**  hello_josh (Hi Josh!) may have hit upon the answer.  It's not tested yet so I may be jumping the gun.  

&gt;Just doule checked - If you have one SQL Server Std edition as the publisher your satellites can merge replicate as subscriber with Express Edition.    &lt;snip&gt; Merge is two way.

This would mean that I only need to upgrade 6 of my sites and the 24 customers involved in this could stay on Express.  We recently prodded them all into upgrading to 2008 R2 Express to get everyone on the same version,False,self,t5_2qp8q,1349636960.0,,,t3_111vzq
1348805272.0,10lqfc,[MSSQL] Select from linked server to local server causing waits on both sides,pluckythewhale,4,2,4,"The queries in question are here: http://pastie.org/4833351

Run individually

Run as a group

Can anyone here point me in the direction of how I can both diagnose and fix this?

Thanks in advance. My apologies if I've (most likely) left out a key detail.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/10lqfc/mssql_select_from_linked_server_to_local_server/
1348802068.0,10lnfk,Hello r/SQL! I'd like to ask you guys for suggestions for an application that I can make to show my SQL skills to a potential employer?,maicull,5,3,3,"I have a couple of days to develope the app. I mainly work with Java but know my way fairly well with other popular languages (C#

The position is for a graduate analyst programmer and the company mainly developes utilities billing softwares.

I suppose the obvious choice is to try and develope a simple utilities billing app

Thank you,False,self,t5_2qp8q,False,,,t3_10lnfk
1348580811.0,10g6b9,[SQLITE] Trying to create list from two tables. Not sure if possible. (Hope it isnt taboo to post my own link from SO),docular,6,4,2,,t5_2qp8q,False
1348522822.0,10ewqb,Sysadmin by day needing help with a DBA problem : SQLServer (xpost from /r/sqlserver),burkhalp74,4,2,2,,t5_2qp8q,False
1348150326.0,106xmf,[MS SQL 2k] Returning 1 record from a multiple record query.,Smotpoker,3,1,15,"I'm trying to add a column for ""shipping date"" to an existing query. Each returned line is an item sale on an invoice. The shipment tracking details (std) table can only join to the invoice

    SELECT
	invoices.order_no,
	INVHIST.QTY_STK
	invoices.order_date
	addressB.street_address
	addressB.state
	addressS.street_address
	addressS.state
	items.descript
	invoices.date_fld
	CASE cust.custclass 
		WHEN 'WHSL' THEN 
			CASE addressB.CUSTCHAR6 
				WHEN 'Small Medium' THEN 'SMB' 
				WHEN 'Large' THEN 'LB' 
				Else 'LOCAL' 
			End 
		Else 'RETAIL' 
	End
    FROM
	X_INVOIC
    INNER  	
	JOIN
		INVOICES ON INVOICES.ORDER_NO = X_INVOIC.ORDER_NO AND INVOICES.STATUS = X_INVOIC.STATUS
	JOIN 
		ITEMS ON ITEMS.ITEMNO = X_INVOIC.ITEM_CODE
	JOIN
		ADDRESS ADDRESSS ON ADDRESSS.ADDR_CODE = INVOICES.SHIP_CODE AND ADDRESSS.CUST_CODE = INVOICES.CUST_CODE 
 	JOIN
		ADDRESS ADDRESSB ON ADDRESSB.ADDR_CODE = INVOICES.BILL_CODE
 	JOIN
		CUST ON CUST.CUST_CODE = INVOICES.CUST_CODE AND CUST.CUST_CODE = ADDRESSS.CUST_CODE
	JOIN
		INVHIST ON INVHIST.ITEMNO = X_INVOIC.ITEM_CODE AND INVHIST.DOC_NO = INVOICES.ORDER_NO 
        AND INVHIST.DOC_TYPE = INVOICES.STATUS
    JOIN
		SHIPMENT_TRACKING_DETAILS STD ON STD.DOCNUM = X_INVOIC.ORDER_NO AND STD.DOC_TYPE = INVOICES.STATUS


    WHERE
	items.serialize = 'F'
	AND invoices.status = '9'
	AND (invoices.shipped ='F')
   	AND (x_invoic.qty_ship &gt;= 1)   
	AND (invoices.order_date
	
    -- Date Range
	
	Between
	{ts '2012-09-01 00:00:00'} And {ts '2012-09-07 00:00:00'})
	AND (invoices.order_date is not null)
	AND
	(items.category IN ('11111','44444'))
	
	
    Order BY
	x_invoic.order_no


The **std.delivery_date** will return multiple rows
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/106xmf/ms_sql_2k_returning_1_record_from_a_multiple/
1347886003.0,100pwi,Junior-level SQL programming?,ricankng787,2,0,2,"x-post (/r/learnprogramming)

Good morning everyone

I'm currently in a temporary help desk position at a educational non-profit and they are opening up a ""technical and software specialist"" position.

I'm very interested in the position. Part of the job description cites knowledge in SQL, and ""experience in data communications and an understanding of the Internet and web-based applications are highly preferred."" I am curious as to what skills a ""junior-level SQL programmer"" should have.

All of my SQL knowledge has been text-book and online resources. I am very confident in my ability to learn any proprietary software that they may use or support. I am just a bit hesitant whether my non-professional

Can anyone recommend some ""junior-level"" work, if anyone could point me in the right direction on how to implement self-teaching into a resume? Forgive me if this is the wrong subreddit!

Thanks a lot everyone!

TL;DR: What is junior-level SQL programming? Any good resources on that level? Also,,False,self,t5_2qp8q,False,,True
1347821153.0,zzcm0,MYSQL - Insert and multiple update query troubles,maxhatcher,3,1,5,"When I try to run this

-- Moves leads from Table_One that have been processed one round to Table_Two.
INSERT INTO Database_Two.Table_Two
    SELECT * FROM Database_One.Table_One
    WHERE `ID` &gt;= '465540' AND (`ASK_RESPONSE_CODE` = 'Failed' OR `ANSWER_RESPONSE_CODE` IN  ('LOW_PRICE'
-- Update Database_Two.Table_Two so it can run again.
UPDATE Database_Two.Table_Two
    SET `ASK_IS_PROCESSED` = '0', `ASK_ID` = '', `ANSWER_RESPONSE_CODE` = '', `ANSWER_ID` = '', `PRICE` = '0.00'
    WHERE `ID` &gt;= '465540' AND (`ASK_RESPONSE_CODE` = 'Failed' OR `ANSWER_RESPONSE_CODE` IN  ('LOW_PRICE'
-- Update Table_One to mark they were copied.
UPDATE Database_One.Table_One
    SET `COPIED` = 'Y'
    WHERE `ID` &gt;= '465540' AND (`ASK_RESPONSE_CODE` = 'Failed' OR `ANSWER_RESPONSE_CODE` IN  ('LOW_PRICE'

I was trying to replicate something like this [this](http://stackoverflow.com/questions/8998580/insert-the-data-from-old-table-to-new-table-id-from-new-table-and-update-for-th) but I don't 'think' I need all those crazy helper variables. So I came up with the code above. 

I basically want to move table data from one database to another database and update both tables so I know they were copied and so I can send out the data again from the second database. 

From what I understand this is probably a not very efficient way to do this but I turn Right at the JOIN left statement so I this is the best I can come up with and still understand what's going on. I know I shouldn't be allowed near the database,False,self,t5_2qp8q,False,,,t3_zzcm0
1347553483.0,zttt6,Firebird 2.5.2 Release Candidate is Available,mariuz,3,1,0,,t5_2qp8q,False
1347394869.0,zq6dp,MS SQL My simple query returns counts to high.,sqlta,7,5,6,"Table sales is
Salesperson
SaleID
WeekNumber
ProductID    

Select a.salesperson

from sales a

where a.weeknumber = 1

and b.weeknumber = 2

and  a.salesperson = b.salesperson

group by a.salesperson

Table only holds 2 weeks worth of data.

I need to return 1 row for each salesperson with both of their weeks sales summed. Unfortunately my totals are way high.
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/zq6dp/ms_sql_my_simple_query_returns_counts_to_high/
1346275269.0,z1h7j,Small date time without seconds?,sh33ts,3,1,5,"I have a field in a table that is the smalldatetime data type. I need it to show up in my table (I view and edit and all in a Qt program) without the seconds. If anyone knows how to do this please let me know.

Also I've never done much with SQL so if I need to do some SQL statement stuff please tell me where to put it because I have no idea",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/z1h7j/small_date_time_without_seconds/
1346130796.0,yy3wo,How can I create a requirement for users to input a value that will be applied to the select statement in TSQL?,,3,1,6,"I'm creating a tool with an Access interface that runs off of SQL.  I would like a query to ask a user for a value which will be applied to the select statement they are running.  Specifically to create a view as: 
 
CREATE VIEW delinq_report.VI&lt;userinput required here&gt;I
AS
SELECT *
FROM delinq_report.""Delinquent Scanners in Edata""
WHERE Protocol LIKE '&lt;userinput required here&gt;%'
 
An example final output of the code is:
 
CREATE VIEW delinq_report.VI0448I
AS
SELECT *
FROM delinq_report.""Delinquent Scanners in Edata""
WHERE Protocol LIKE '0448%'
 
So the user would basically input 0448 and it would be applied to the statement.
 
Any ideas?
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/yy3wo/how_can_i_create_a_requirement_for_users_to_input/
1346043349.0,yw1gu,Any help with a function?,jjzaus,4,2,5,"I cannot figure out what mistake I am making here. I need a function that searches a database for a partial name and returns the ID for that person. I'd appreciate a hand with the syntax and have posted the function underneath. It is not complete

CREATE OR REPLACE FUNCTION A1_GUEST_NAME_EXISTS  
  (p_guest_name IN OUT A1_guests.guest_name%TYPE)
RETURN NUMBER AS 
  v_guest_name A1_guests.guest_name%TYPE;
  v_guest_id A1_guests.guest_id%TYPE;
  CURSOR c_guest IS
  SELECT guest_name
  WHERE guest_name LIKE p_guest_name;
  v_guest c_guest%ROWTYPE;
BEGIN
  OPEN c_guest;
    FETCH c_guest INTO v_guest;
      IF c_guest%NOTFOUND THEN
         v_guest_id := 0;
      END IF;
      
  RETURN v_guest_id;
END A1_GUEST_NAME_EXISTS;",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/yw1gu/any_help_with_a_function/
1343933256.0,xkrxu,[Oracle] Matching chars not equivalent?,Almace,2,0,17,"I'm attempting to join two tables on a column both defined as char(8). However, and return something that looks like this:

    0 00101 00103
    1 00301 00301
    3 00202 00202

Where the first column is an ID

I've added a third column as such:

       case
            when trim ( cast ( VALUE_1 as char(8) ) ) = cast ( VALUE_2 as char(8) ) then 'true'
            else 'false'
       end MATCH

which constantly returns false as well. What is wrong exactly,False,self,t5_2qp8q,1343933471.0,,,t3_xkrxu
1343778028.0,xh603,[MS SQL] (generic T-SQL question) nesting SELECT?,ImHighCurrently,3,1,15,"I'm getting spanked by a SQL problem.  Can anyone save my bacon?

Take a look at the following 2 tables:


    |tblHumans
    |---------|
    | HumanID | PK (ONE to MANY to TABLE2.HumanID) 
    |---------|
    | 1       |
    | 2       |
    | 3       |
    |---------|


    |tblHumanColors
    | HAS NO PK.  HumanID + DAYofWEEK Will always be unique
    |-----------------------------|
    |COLORS | HumanID | DAYofWEEK |
    |-----------------------------|
    | RED   | 1       | 1         |
    | BLUE  | 1       | 2         |
    | RED   | 2       | 1         |
    | YELLOW| 3       | 1         |
    | PINK  | 3       | 3         |
    | PINK  | 3       | 7         |
    |-----------------------------|


 
tblHumans is my 'primary' table.  I have a large query with JOINS to 5 tables other than tblHumanColors.

Part of this query I need 7 fields (1 for each day of the week).  I'm trying to return the COLORS for each HUMAN for each DAYofWEEK

So the result should look like this:

    |ResultTable
    |-------------------------------------------------------|
    | HumanID  | ColorForDay1 | ColorForDay2 | ColorForDay3 | (...through Day7)
    |-------------------------------------------------------|
    | 1        | RED          | BLUE         |              |
    | 2        | RED          |              |              |
    | 3        | YELLOW       |              | PINK         | 
    |-------------------------------------------------------|

The trick is that ***this ResultTable is just a small part of a larger table.***

I tried nesting a SELECT statement inside the larger query but I get multiple rows (I was hoping it would pass the tblHumans.HumanID into the nested Select

    SELECT tblHumans.AField
    
    
    
    
       INNER JOIN tblHumans ON tblHumans.HumanID = tblHumanColors.HumanID
       WHERE DayofWeek = 1)
    
       INNER JOIN tblHumans ON tblHumans.HumanID = tblHumanColors.HumanID
       WHERE DayofWeek = 2)
    ...


I tried using a variable (DECLARE &amp; SET) but I can't seem to get it to SET inside the main SELECT statement.  I guess you have to use them outside the SELECT(?)

This one has me feeling extra derpy.  Can anyone point me in the right direction?

-Preemptive thank you very much",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/xh603/ms_sql_generic_tsql_question_nesting_select/
1343154649.0,x33cu,[MS SQL] Database engine lost after SP3,Icetime58,3,1,48,"I recently went from MS SQL Server RTM to SP3 and now my database engine is missing. Before I could just log in with (local) for server name and use Windows Authentication. But after installing SP3 I can't do this anymore. I get the following error: 

Cannot connect to (local).
-&gt; Login failed for user 'UserName'. (Microsoft SQL Server
Severity: 14
State: 1
Line Number: 65536

All of my Google results have been telling me to ensure the authentication mode is in SQL and Windows authentication. However

**Edit**: I found the error logs and they show this at the end.

2012-07-24 10:43:26.43 Logon       Login failed for user 'UserName'. Reason: Token-based server access validation failed with an infrastructure error. Check for previous errors. [CLIENT: &lt;local machine&gt;]
2012-07-24 10:43:28.74 Logon       Error: 18456

**Edit 2**: Sorry about that. I should of been more descriptive. I am running MS SQL Server 2008 Standard SP3 on Windows Server 2008 R2 64-bit virtual machine using VMware. 

**Edit 3**: I have turned off UAC and ensured that my user is set to administrator under control panel -&gt; user accounts. I am now in the process of finding out how to uninstall SP3 and see if this gets me anywhere. 

**Edit 4**: I have followed the steps in the blog below and I am still unable to login to my default instance. I am getting the error:

Cannot connect to (local).

A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: Named Pipers Provider

http://beyondrelational.com/modules/2/blogs/115/posts/11143/how-to-access-a-newly-installed-sql-server-2008-r2-instance-if-you-do-not-know-the-login-and-passwor.aspx

**Edit 5**: Here is my current error log http://pastebin.com/25pUSCYa",self,t5_2qp8q,1343234155.0,,,True,http://www.reddit.com/r/SQL/comments/x33cu/ms_sql_database_engine_lost_after_sp3/
1342712132.0,wtkc8,"Upgraded our server from SQL 2000 to 2008, and now some stuff is broken. Any tips?",lolajoan,5,3,http://www.reddit.com/r/SQL/comments/wtkc8/upgraded_our_server_from_sql_2000_to_2008_and_now/, then the word minutes. So

    case ""2"":
    $query .= "" and (cast(SUBSTRING(V.fPlaytime,V.fPlaytime)-1) as smallint(2)) &lt; 15) 
    and (cast(SUBSTRING(V.fPlaytime,V.fPlaytime)-1) as smallint(2)) &gt; 10)"";

So that should return videos with playtimes from 10-15 minutes. I went through a bunch of documentation to try to figure out what the problem is and it all looks okay to me.

Can you give me any ideas on where to poke to find the hole? Thanks!",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/wtkc8/upgraded_our_server_from_sql_2000_to_2008_and_now/
1342639190.0,wrws3,SQLite or Alternative for Java?,CompEngCraft,8,5,2,"For work I have been asked to try and use a more portable code model (pretty much extract and run type deal) for a piece of software that heavily uses databases.

I have only ever really worked with server DBMS systems and connect using JDBC

Problem is I am stuck with Java

Help?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/wrws3/sqlite_or_alternative_for_java/
1341708838.0,w79rn,[SQLite] How best to set up a DB for song metadata?,TankorSmash,7,5,16,"I'm very new to DBM

**I've got the following data so far: `filepath`

I'm reading about the fundamentals [here](http://www.deeptraining.com/litwin/dbdesign/FundamentalsOfRelationalDatabaseDesign.aspx)",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/w79rn/sqlite_how_best_to_set_up_a_db_for_song_metadata/
1341192390.0,vwijf,Business Analyst SQL interview questions?,loki0wn,6,4,3,"I have a second interview this week for a Business Analyst position at a company. I don't believe that there will be a lot of DDL type questions, how would you do this?

I began to over engineer the problems and doing stupid shit like inner joins where only it only needed to be select date,,False,self,t5_2qp8q,False,,True
1340218806.0,vcbd6,[MS SQL] Is there a known solution to recreate Excel's INDIRECT()?,frescani,2,0,4,"I also posted this in /r/SQLServer..

I'm sure this is a total newbie question, if 'z', etc...

As an alternative approach to storing in a table,False,self,t5_2qp8q,False,,,t3_vcbd6
1340032674.0,v86d3,[MSSQL] Returned value contains a newline character?,wsnich,2,0,7,"I'm having trouble with a query that returns values from a free form text field that contains a special character

Example:
My result should be this

""Maximum container weight is 99ozs per 99 oz container.  99 oz On Call as requested""

Except it gives me the result in the export as:

""Maximum container weight is 99ozs per 99 oz container.  ""

""99 oz On Call as requested""

Is there anything I can do to fix this?",self,t5_2qp8q,1340033759.0,,,True,http://www.reddit.com/r/SQL/comments/v86d3/mssql_returned_value_contains_a_newline_character/
1339522835.0,uy9as,Altering data type for specific cells SQL,,2,0,4,I am trying to alter the data types for specific cells in a column.  The column is currently text.  I need to change the ones with actual dates to a date and time format and keep the ones labeled as 'current' or 'No data received' as text.  Any ideas?,t5_2qp8q,True
1339173001.0,urrnz,[MS SQL] Natural keys vs artificial keys in this case?,,4,2,11,"I am trying to design a database system for a website. In the past, not null, using natural keys for the tables. For example

**Artificial Keys**

    LocationCountries
        Columns
            CountryID - int, auto_increment
            CountryName - varchar(255)
            CountryNameSlug - char(2)
        Indices
            CountryID - Primary Key
            CountryName - Unique
            Slug - Unique - CountryNameSlug
    
    LocationSubdivisions
        Columns
            SubdivisionID - int, auto_increment
            CountryID - int
            SubdivisionName - varchar(255)
            SubdivisionNameSlug - varchar(255)
        Indices
            SubdivisionID - Primary Key
            CountryID - Foreign Key - CountryID =&gt; LocationCountries(CountryID)
            Slug - Unique =&gt; CountryID
    
    LocationCities
        Columns
            CityID - int, auto_increment
            SubdivisionID - int
            CityName - varchar(255)
            CityNameSlug - varchar(255)
        Indices
            CityID - Primary Key
            SubdivisionID - Foreign Key - SubdivisionID =&gt; LocationSubdivisions(SubdivisionID)
            Slug - Unique - SubdivisionID

*OR*

**Natural Keys**

    LocationCountries
        Columns
            CountryCode - char(2)
            CountryName - varchar(255)
        Indices
            CountryID - Primary Key - CountryCode
            CountryName - Unique
    
    LocationSubdivisions
        Columns
            SubdivisionCode - char(3)
            CountryCode - int
            SubdivisionName - varchar(255)
            SubdivisionNameSlug - varchar(255)
        Indices
            SubdivisionID - Primary Key - SubdivisionCode
            CountryID - Foreign Key - CountryCode =&gt; LocationCountries(CountryCode)
            Slug - Unique - CountryCode
    
    LocationCities
        Columns
            CityNameSlug - varchar(255)
            SubdivisionCode - char(3)
            CountryCode - char(2)
            CityName - varchar(255)
        Indices
            CityID - Primary Key - CityNameSlug
            SubdivisionID - Foreign Key - (SubdivisionCode

By the way

 * site.com/us
 * site.com/us/california
 * site.com/us/california/los_angeles

As you can probably tell,,False,self,t5_2qp8q,1339174618.0,,True
1339062496.0,upk4r,Restoring from corrupt .bak file,YesMrBossMan,2,0,6,"So I need to restore a database backup from a .bak file. I have the latest backup and it's working but management is under the impression that there is other info on the old corrupted .bak file.

I have tried the following:
1- RESTORE DATABASE dbname FROM DISK='pathtodisk.bak' WITH RECOVERY

2- RESTORE DATABASE dbname DEOM DISK='pathtodisk.bak' WITH FILE=1

3- Restoring from GUI

4- Currently attempting: RESTORE DATABASE dbname FROM DISK='pathtodisk.bak' WITH FILE=1, STATS=10

On all the above(excluding 4

The DB is 280GB in size
There is no disc space issue.

Is there anything else that I can attempt to run in order to restore the corrupted DB?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/upk4r/restoring_from_corrupt_bak_file/
1339056144.0,uphk1,[Oracle] Can someone suggest if there is any alternate way for this sql? ,1581947,2,0,5,"Sql
select name and marks of the student who got max marks in maths in below tables

Table: student
Columns: roll_no

Table: result 
Columns: roll_no

I think below should work

select student.name
from student
where student.roll_no = result.roll_no
and result.subj= ""maths""
and result.marks = (select max(marks) from result where subj = ""maths"")

I am trying to find out if there is any other way of doing this without the sub query.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/uphk1/oracle_can_someone_suggest_if_there_is_any/
1338922827.0,umigh,[Oracle] grouping redundant output of certain columns,sizzleplatter,2,0,7,"Thanks for any help. Basically I'm trying to group the output of only the first three columns in the output below so that the report is cleaner and easier to read.  Basically I'd like to have header for each person and each product listed individually.  Is it possible to do something like this in a single select statement?


[example output](http://i.imgur.com/il2Pw.png)

query:
SELECT 
    p.id
    p.name
	p.city
	o.product
	o.amount
from p left join o on p.id = o.person_id
where o.amount &gt; 0;

",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/umigh/oracle_grouping_redundant_output_of_certain/
1338887800.0,ulu5n,top 25 list not showing all users and wrong scores,johanm,2,0,7,"hi guys
im in a very deep bucket of f***** with a client. 
They're running a sales competition (with some big prizes) and this top 25 list I've written is showing the wrong results.

users arent showing that should be pretty far up on the list. 
any idea what the issue could be?

SELECT u.fname
FROM comp_sale s
WHERE s.prod_id = p.product_id 
AND s.sale_id = u.wp_id 
GROUP BY lname 
ORDER BY points DESC limit 25",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/ulu5n/top_25_list_not_showing_all_users_and_wrong_scores/
1338570670.0,ufuv4,"""Order by"" and WinLatin1 encoding",,2,0,1,"Hello

I am running into a small issue on Postgre 8.4 in the US. When doing an order by on results, will show up at the end of the results, rather than with the E's, as should happen. Has anyone ever come across this issue and found a fix?

Thanks",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/ufuv4/order_by_and_winlatin1_encoding/
1337570859.0,twyvl,Learning SQL on my PC - Connection Issues,MongrelNymph,2,0,6,"I am trying to teach myself SQL on my new PC. I downloaded Microsoft SQL Server 2012 and installed but now I'm stuck. I am using Windows Authentication

TITLE: Connect to Server
------------------------------

Cannot connect to localhost.

------------------------------
ADDITIONAL INFORMATION:

A network-related or instance-specific error occurred while establishing a connection to SQL Server. The server was not found or was not accessible. Verify that the instance name is correct and that SQL Server is configured to allow remote connections. (provider: Named Pipes Provider

For help

I have most likely neglected to do some simple step but as I am a ultra-noob I do not know what I missed. Do I need to something to my PC to get it to act as a server first? Do I need to do something in Windows so it knows I'm an administrator?  The fields are greyed out
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/twyvl/learning_sql_on_my_pc_connection_issues/
1336730515.0,thz18,It possible to execute this in one sql statement?,juwking,3,1,6,"So I Got two sql statement for SSRS. One just gets the data.



    SELECT Type, Adress1, Adress2, Amount, Date, CASE WHEN Type = '1' THEN 'Refund' ELSE 'Payment' END AS TypeName
FROM            Transactions
WHERE        (Date &lt; @DateTo) AND (Date &gt; @DateFrom) AND (FirstName LIKE '%' + @FirstName + '%')AND(LastName LIKE '%' + @LastName + '%')



This sums the amounts



    SELECT        refund.value - payment.value AS Total
FROM            (SELECT        SUM(Amount) AS value
                          FROM            Transactions
                          WHERE        (Type = 0) AND (Date &lt; @DateTo) AND (Date &gt; @DateFrom) AND (FirstName LIKE '%' + @FirstName + '%') AND (LastName LIKE '%' + @LastName + '%')) 
                         AS refund CROSS JOIN
                             (SELECT        SUM(Amount) AS value
                               FROM            Transactions AS Transactions_1
                               WHERE        (Type = 1) AND (Date &lt; @DateTo) AND (Date &gt; @DateFrom) AND (FirstName LIKE '%' + @FirstName + '%') AND (LastName LIKE '%' + @LastName + '%'))
                          AS payment

Is it posible to combine those two?
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/thz18/it_possible_to_execute_this_in_one_sql_statement/
1336099529.0,t681e,Help passing/sharing information between an Orders table and a Order Details table,AlreadyGone45,5,3,3,"Hello everyone

I'm working on a simple DB project and was looking for some help if possible. I am building a database for a fictioonal bookstore and two of the tables are:

Orders
(TransactionID
CustomerID
StaffID
Qty
Price
Date)

Order Details Order_details
(OrderID
TransactionID
BookID
Qty)

Basically each transaction can have multiple order details (what books did they buy and how many of them?)

I have been adding rows and doing the math by hand to make sure the price and quantity makes sense between the two tables (the price of each book is in another table). 

My question is

Hopefully that made sense...



",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/t681e/help_passingsharing_information_between_an_orders/
1336008894.0,t4cf2,Is SQL dba right for me?,hiGooGee,3,1,15,"Hello reddit,False,
1335728420.0,syizg,[MS SQL] Help compare dates using only month and year in separate columns,noatm,3,1,7,"I have a list of credit cards and their expiration month and year are in two separate columns. I need to get those credit cards that have already expired. This is what I've come up with but for some reason

select * from Sales.CreditCard
where ExpYear &lt;= year(GETDATE())
or (ExpYear &lt;= Year(GETDATE())
and ExpMonth &lt; MONTH(GETDATE()))
order by ExpYear desc,False,self,t5_2qp8q,False,,,t3_syizg
1335569685.0,sw2jf,Anyone know of a good physical book on cursors or at least one that covers them well and in-depth?,,2,0,4,,t5_2qp8q,True
1335370831.0,srxvm,[MySQL] Need a little help with a join,YoureAFuckingTowel,2,0,3,"Here's the scenario: I'm building a webpage in PHP/MySQL where a user will select their site

Basically
    SELECT item_id FROM items; 
    /* If there are ten items
    SELECT * FROM junction WHERE site_id = '5'; 
    /* let's say it returns 1

To produce a result similar to this:

&gt;item_id  |  Available

&gt;--------+----------

&gt;1&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;|&amp;nbsp;&amp;nbsp;&amp;nbsp;**true**

&gt;2&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;|&amp;nbsp;&amp;nbsp;&amp;nbsp;false

&gt;3&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;|&amp;nbsp;&amp;nbsp;&amp;nbsp;**true**

&gt;4&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;|&amp;nbsp;&amp;nbsp;&amp;nbsp;false

&gt;5&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;|&amp;nbsp;&amp;nbsp;&amp;nbsp;false

&gt;6&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;|&amp;nbsp;&amp;nbsp;&amp;nbsp;false

&gt;7&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;|&amp;nbsp;&amp;nbsp;&amp;nbsp;**true**

&gt;8&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;|&amp;nbsp;&amp;nbsp;&amp;nbsp;false

&gt;9&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;|&amp;nbsp;&amp;nbsp;&amp;nbsp;false

&gt;10&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;|&amp;nbsp;&amp;nbsp;&amp;nbsp;false


It doesn't have to necessarily be a boolean

All the items that are not available to the site will be generated as hidden fields in the order form.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/srxvm/mysql_need_a_little_help_with_a_join/
1334942292.0,sjyfj,Need help with using getdate(),,2,0,5,"select * into DelinquentFacilities from All_Forms where column1 &gt;= (getdate()-90) column2 &gt;= (getdate()-90) 

Table All_Forms with columns FacilityID(numeric)

The All_Forms table contains the most recent date received for Form1 in column Form1 and the most recent data received for Form2 in column Form2 for a particular facility.  I am trying to create a query which will return the facilityID if values for Form1 or Form2 is past 90 days of todays date with getdate.  I would like to return NULLs for the other correpsonding column

I am unsure of what exactly I am returning at the moment.  Any idea in order to correct my statement above?
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/sjyfj/need_help_with_using_getdate/
1334794660.0,sgya8,[Oracle] SELECT INTO from Multiple tables,tinydan,2,0,6,"Hey,False,
1334721040.0,sfge1,[SQL in Access] SQL noob here looking for help with simple query,loeras,2,0,17,"Hey all

I have a table named BCS. It has a bunch of different columns but I am trying to get information from two of them. I need the minimum value from a column labeled HPTS and I need the corresponding value from the column labeled Team.

I know how to get the minimum value already.

SELECT MIN (HPTS)
FROM BCS 

This only shows me the value itself though

Thank you for your help in advance!",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/sfge1/sql_in_access_sql_noob_here_looking_for_help_with/
1334270400.0,s6y69,[Oracle] Rights needed for PL/SQL development?,Hacto,2,0,2,"What rights do I need my DBA to grant so I can work on things such as Functions,False,
1334095251.0,s399h,"Quick question regarding permissions and ""Scalar-Valued Functions""",Kendro_Boudrizmo,2,0,0,"We have a user who has read/write permissions to a specific DB in SQL 2008 R2. He can usually do everything he needs with read/write but now he's saying he cant access 

""Programmability

My question:  Does anyone know what the minimum permissions hell needs for this are? I'm trying to avoid making him dbowner unless necessary.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/s399h/quick_question_regarding_permissions_and/
1333983769.0,s0unj,[MS SQL] Automating Query for End User,Smotpoker,2,0,2,"Using MS SQL 2000. What would be the best way for an end user to run a SQL Query that requires their input?

I have the query written. There are a couple date fields and a customer name field I would have to prompt the end user for.

Would just setting up some kind of pivot table in Excel be the easiest way to do this or would I be better off using a stored procedure and programming a gui? ( I have visual studio 11 beta

Data is all read-only

    '' AS 'Rebate Currency'

that are just used to format the data correctly.

I would rather not have my end user accessing the server directly and I don't want to have to run his reports for him every month.

End result needs to be output to csv or Excel.",self,t5_2qp8q,True,,,True,http://www.reddit.com/r/SQL/comments/s0unj/ms_sql_automating_query_for_end_user/
1332876904.0,rgan5,[MySQL] Newbie...need help loading an .sql file.,ExplosiveHippo,3,1,6,"Hi

This is the query I'm entering: . Lance's HD/Users/lancealaughlin/Desktop/PE5.sql;

I'm using a mac and the file is on my desktop. I've tried searching online but haven't had much luck.

I'd really appreciate any help! Trying to get moving on this!
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/rgan5/mysql_newbieneed_help_loading_an_sql_file/
1332872052.0,rg6cq,Selecting XML (Serialised c# object),mogawowo,2,0,9,"(MS SQL 2008)

I have a serialised object that looks like this in table  'sessions'  column 'serialisedobjects' :

&lt;ApplicationLicence ApplicationCode=""CoreApp"" NumberOfSeats=""10"" NumberOfTransactions=""1000444"" LicenceByToken=""true"" /&gt;

I want to return 

Appcode   NoOfSeats  NoOfTransactions  LicenceBytokens  with the node values eg Appcode = CoreApp


How would i accomplish this i have tried numerous methods but cant get anything to work in sql2008  :( any help from you SQL gurus would be appreciated!",self,t5_2qp8q,True,,,True,http://www.reddit.com/r/SQL/comments/rg6cq/selecting_xml_serialised_c_object/
1332731786.0,rdnc8,[MS SQL] I just can't get around understanding these 2 concepts. Appreciated if anyone can?,moc_tidder,2,0,3,"1: Recursion CTE 

2: Row number() over partition 

I understand the concept
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/rdnc8/ms_sql_i_just_cant_get_around_understanding_these/
1332434444.0,r8k1b,Self teaching SQL is there anything out there that lets you get hands on exp?,Beastarino,2,0,3,"I've gone through alot of the online stuff w3schools,self,
1332250958.0,r51ro,[SQL MS Access]  Comparing two fields on 4 tables,KingZing,2,0,3,"I think I'm on the right track but I am unable to get the particulars down.  
I tried to do a nested IIF statement but it was not working.

The criteria I am trying to establish are:

* [A,orD]Security = [A,B,C,orD]Security **AND** 
* [A,orD] Universal_system &lt;&gt; [A,B,C,orD]Universal_system **OR** 
* [A,orD]Universal_fund &lt;&gt; [A,B,C,orD]Universal_fund 


I am trying to find results for when the Security is the same
Ideally, I want to be able to see every time Security is present so I can compare.

4 Tables:

[TableA][TableB][TableC][TableD]

* System
* Fund
* Security
* Universal_system
* Universal_fund


Thanks again for the help.  You guys have really been great in guiding me in previous questions.",self,t5_2qp8q,True,,,True,http://www.reddit.com/r/SQL/comments/r51ro/sql_ms_access_comparing_two_fields_on_4_tables/
1332221716.0,r4pq0,[MySQL] How do I update multiple fields so empty field content is moved to the logically last columns?,C_IsForCookie,2,0,4,"I copy/pasted the title from [this page](http://stackoverflow.com/questions/5107563/sql-how-to-update-multiple-fields-so-empty-field-content-is-moved-to-the-logica) whose OP has the same problem as me. Figured the title was a perfect description so I used it. I unfortunately couldn't find anything there to help me despite the suggestions

Basically I'm making a Netflix-esque queue on a website. I currently have 5 columns (in an SQL table,2,4,&amp;5 are populated, a newly added title would be populated in field 3 instead of at the end. For this reason, I'd like a string of code which I could implement (the entire site is PHP and I plan to implement some jQuery) which would shift the data over so new titles will populate the end of the list instead of a random middle field.

Any suggestions on how I could do this? Or even an alternative method of storing the data which may provide a workaround?

Thanks!

EDIT: Just thought that I could do:

    if($queues[q1] = 0){UPDATE 'q1' = 'q2 IN queues WHERE ID = '$id'; UPDATE 'q2' = '0' IN queues WHERE ID = '$id';}

and do it 50 times, especially if the user has a relatively empty queue.",,False,self,t5_2qp8q,True,,
1332212582.0,r4iwx,I honestly wished I knew about Rollback and Commit.....,aboxofrice,2,0,4,"Today in the heat of some craziness I did an update statement and ended up losing another hour of work. I ended up not only disabling one district but all districts......Moral of the story

BEGIN TRAN
update table set BitField1=1

ROLLBACK 
COMMIT TRAN
 ",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/r4iwx/i_honestly_wished_i_knew_about_rollback_and_commit/
1331856326.0,qylk4,[MySQL] Nested WHERE IN Query Help / Avoidance,bear_karpov,3,1,8,"My application is drastically different than this (has nothing to do with any type of class / school etc)
  
Assume we have a table, a new row is created (example table below).  
  
  
-----------------------------  
  
  
CLASS  |  UID  
\\\\\\\\\\\\\\\\\\\\\\\\\\\  
ENG    |  ABC  
ENG    |  XYZ  
MATH   |  XYZ  
CHEM   |  ABC  
  
  
----------------------------  
  
  
To access this information I am using a nested SELECT WHERE IN Query and find it to be extremely inefficient when I try to query for more than 2 classes (If I try to match say 6 classes it becomes close to useable.)  
  
My table currently has 7.5 mil rows and will likely expand by at least 1 magnitude.  
  
Can you please suggest a rewrite on my query below to make it more efficient?  OR
  
(Side note
  
  
------------------------  
  
  
THE QUERY  
  
  
    SELECT UID  
    FROM ITEMS  
    WHERE CLASS = 'ENG'  
    AND UID  
    IN (  
  
      SELECT UID FROM ITEMS  
      WHERE CLASS = 'MATCH'  
      AND UID  
      IN (  
  
        SELECT UID FROM ITEMS  
        WHERE CLASS = 'SCI'  
        AND UID  
        IN (  
  
          SELECT UID FROM ITEMS  
          WHERE CLASS = 'CHEM'  
  
          )  
        )  
      )  
  
    GROUP BY UID  
    LIMIT 100  
  
  
--------------------
   
  
A query like this will return a list of users enrolled in all four of those classes.  
  
Thanks a ton!",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/qylk4/mysql_nested_where_in_query_help_avoidance/
1331736444.0,qw7pp,Common MySQL Queries,Andrey_Karpov_N,2,0,1,,t5_2qp8q,False
1330787581.0,qfxti,[MS SQL] Group By + ROLLUP question,o1o1197o,2,0,4,"I am working my way through the group by

---

**Basic rollup:**

	select CustomerName
	from orders
	group by customername
	with rollup

	CustomerName	OrderID	Amount
    ------------	-------	------
	Jacob			1		305.00
	Jacob			2		487.50
	Jacob			NULL	792.50
	Mike			1		119.00
	Mike			NULL	119.00
	NULL			NULL	911.50

---

**Grouping values:**
I understand that grouping(col) returns 1 if the column is aggregated and 0 if its not. So I wrote this to get some visual understanding. Ok it is fine until here.

	select grouping(CustomerName)
	from orders
	group by customername
	with rollup

	gcn	goi	Amount
    --- --- ------
	0	0	305.00
	0	0	487.50
	0	1	792.50
	0	0	119.00
	0	1	119.00
	1	1	911.50

---
Here is how I the **sub and grand totals** are being printed. 

	select
	case
	    when grouping(CustomerName) = 1 then 'Grand Total'
	    when grouping(OrderID) = 1 then ''
	    else CustomerName
	end as CustomerName
	case
	    when grouping(CustomerName) = 1 then ''
	    when grouping(OrderID) = 1 then 'Customer Total'
	    else cast(OrderID as varchar)
	end as OrderID
	sum(quantity*pricepercase) as Amount
	from orders
	group by CustomerName
	with rollup

	CustomerName	OrderID	Amount
	------------	-------	------
	Jacob			1		305.00
	Jacob			2		487.50
			Customer Total	792.50
	Mike			1		119.00
			Customer Total	119.00
	Grand Total				911.50

---

**Edit** *removed my old question as it was confusing. rephrasing the question:*

Can someone please help me understand how the `Customer Total` and `Grand Total` were displayed where it was necessary? If possible please provide a step by step analysis of how to arrive at the result.",self,t5_2qp8q,True,,,True,http://www.reddit.com/r/SQL/comments/qfxti/ms_sql_group_by_rollup_question/
1330389896.0,q8x7r,Access 2007 - Noob Question about Queries ,RuchW,3,1,7,"Sorry about the newbie question
Each of those assets has a monetary value. How can I sum up the total monetary value of all the assets for each facility? Basically

Hope that makes sense.

Thanks",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/q8x7r/access_2007_noob_question_about_queries/
1330210871.0,q5zbk,[Oracle] Simple Question...,MandMOnster,2,0,5,"I can not figure out they want me to show:

List all staff and provide a total of salary (table:staff)
(inside staff is STAFFID

Do they want me to list all the IDs and the total salary of all?
or they mean just the count of IDs and total of salary?


Please help",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/q5zbk/oracle_simple_question/
1328769945.0,phih8,How to manually synchronize replication subscriptions by using backup or restore,cjusti,3,1,0,,t5_2qp8q,False
1328745981.0,ph19t,[MSSQL] Triggers. Need ideas to overcome drop table issue.,ramse,3,1,4,"I have a problem. I work with a program that

One problem that we see weekly, copying the details out, dismount and remount live database then copying details back in. That is very tedious and a pain.

I've made SQL triggers on all tables that are ""INSTEAD OF DELETE"" and it takes the record from the live table and moves it to a deletion database which has the exact same tables just without data. And now I'm able to

That is all fine and dandy, I was reading up on DDL triggers at the database level as ALTER_TABLE attempting to figure out my problem.

My real headache begins now. I've learned, recreate it with the new column and then move everything back. I've learned this is done because at the enterprise level, you do not want to be editing a live table without a backup, so you move the data, make the table and make sure it went through fine then move everything back in.

Well that is causing problems

I'm at a loss of what to do now. Is it possible to have a trigger create a trigger within itself? Such as,,False,self,t5_2qp8q,False,,True
1328709288.0,pg81b,Microsoft SQL Server 2012 Features,luismiguel982,2,0,3,,t5_2qp8q,False
1328391448.0,pb1z2,Evaluating where clauses in a view,PierceClayton,3,1,3,"I probably should know this...

When applying a where clause to a view

Put another way,False,self,t5_2qp8q,False,,,t3_pb1z2
1328001412.0,p4db8,"InfoQ: Q&amp;A with Jiri Cincura of the Firebird Database Project about the ADO.NET provider , ORM , SQL Server compact limitations",mariuz,3,0,False,
1327496751.0,ovzyc,SQL Newbie: Some help on solving a problem?,SuperFlyChris,3,1,14,"Good morning all

I am not sure if SQL is the answer but I hope you might know...

I work in construction and we constantly receive new versions of drawings, i.e. Revision 1 and each will have a Revision Date. 

I would like it so that when a new file came through (normally in pdf form) it would be stored in a database with its name

As I say

Thanks in advance!
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/ovzyc/sql_newbie_some_help_on_solving_a_problem/
1325436227.0,nynqe,Official FirebirdSQL video channel launched,mariuz,2,0,0,,t5_2qp8q,False
1324071121.0,nfmd5,SQL 2008... How do you disable the type ahead feature in the query window? This is driving me crazy!!!,DonMegaTron,5,5,10,,t5_2qp8q,True
1323190584.0,n2npg,SQL Max,Opetich,4,2,6,"Hi

i was trying to find the most studied disease

    select  name 
    	select d.name  name
    	from disease d
    	where d.did =s.did and s.iid=i.iid and i.cidade like 'London'   
    	group by name)    

    
when i was looking at the data there should be a draw between 2

Edit: yes its homework,,False,self,t5_2qp8q,True,,True
1320857549.0,m68wd,Allow all users access to Views created by other users,ClearPepsi,2,0,3,We recently migrated from SQL 2000 to SQL 2008 and am now having issues with views migrated from the old server. On the new server all users have been recreated with the same permissions but when a user logs in they are not able to see Views created by other users that they would have been able to access on our old server. Any ideas?,t5_2qp8q,True
1320164578.0,lwjuf,Firebird SQL Trace Manager V2.0.0 released,mariuz,3,1,0,,t5_2qp8q,False
1318493651.0,lambt,How to reclaim disk space from sqlite3 database once you have dropped huge data/table/index etc. ?,,2,0,0,"For reclaiming one can use ""vacuum"" command. This command copies the whole relevant data from db  to a temporary-db. And cleans-up original-db and renames this temporary.
Its a slow command. But reduces the fragmentation in database.

Anyone knows a better idea ?? May be by way of some sqlite3-extension ?
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/lambt/how_to_reclaim_disk_space_from_sqlite3_database/
1318439618.0,l9qyd,sqlite3 database performance analysis with and without indexes,,2,0,1,,t5_2qp8q,False
1317763470.0,l0yal,Firebird SQL 2.5.1 is released ,mariuz,2,0,0,,t5_2qp8q,False
1317349334.0,kw0bf,Tricky query sorting and grouping at the same time ,Tu_Amigo,2,0,10,"Having trouble writing a query which seems to be getting longer and more complicated the more I look at it.

I've got two tables:

    ANIMAL                        ANIMAL_FOOD
    A_ID   AnimalName             F_ID   FoodName      Purchase_Date   A_ID
    ------------------            ------------------------------------------
     1       Dog                   1     DogBix         2011-11-27       1         
     2       Cat                   2     Tuna           2011-11-11       2
     3       Rabbit                3     Bones          2012-06-08       1
     4       Bird                  4     CatBix         2010-06-04       2  
                                   5     Bird Seed      2011-12-12       4
                                   6     Carrots        2011-05-04       3
                                   7     Pedigree Chum  2011-02-08       1
                                   8     Rabbit Mix     2011-09-02       3


And I want to have the following output in this order:
   
    AnimalName   FoodName      Purchase_Date
    ----------------------------------------
    Cat          Tuna           2011-11-11
    Cat          CatBix         2010-06-04

    Dog          DogBix         2011-11-27
    Dog          Bones          2012-06-08
    Dog          Pedigree Chum  2011-02-08

    Bird         Bird Seed      2011-12-12

    Rabbit       Rabbit Mix     2011-09-02
    Rabbit       Carrots        2011-05-04

I am finding the closest purchase date coming up (in the future) then listing the rest of that animal's foods - first the future ones in order of the closest to today's date
So sort of in this order:

* Tomorrow
* Next week
* Next month
* Yesterday
* Last week 


The animals are grouped together then their individual dates are ordered.

If any one has any ideas they would be really valued.",self,t5_2qp8q,True,,,True,http://www.reddit.com/r/SQL/comments/kw0bf/tricky_query_sorting_and_grouping_at_the_same_time/
1316089254.0,kgfrt,Query Optimization Challenge!,Sotall,4,2,11,"Help! 

Given a table with the following fields and records:

    A B C
    1 1 3
    2 1 2 
    3 2 3
    4 2 1
    5 3 1
    6 3 2

Now

    A B C 
    1 1 3
    3 2 3 

Basically

Now, possibly by utilizing a temporary table or two.  Oh, this is Oracle, by the way. 

Thoughts? ",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/kgfrt/query_optimization_challenge/
1315425245.0,k7xs9,"Dealing with ""Divide by Zero"" errors in queries",JCollierDavis,2,0,8,"The statement below works just fine

    (SUM (CASE WHEN (wo_age &lt;= '30' AND ipd BETWEEN '01' AND '03' AND prj = '9GQ') THEN 1 ELSE 0 END)) / (SUM (CASE WHEN (ipd BETWEEN '01' AND '03' AND prj = '9GQ') THEN 1 ELSE 0 END)) reset_mpd1

However, I decided to add an IF to make the query still run.  Here's my attempt

    IF	(COUNT(CASE WHEN (wo_age &lt;= '90' AND ipd BETWEEN '09' AND '15' AND prj = '9GQ'))) = '0' THEN 'ZERO' ELSE	((SUM (CASE WHEN (wo_age &lt;= '90' AND ipd BETWEEN '09' AND '15' AND prj = '9GQ') THEN 1 ELSE 0 END)) / (SUM (CASE WHEN (ipd BETWEEN '09' AND '15' AND prj = '9GQ') THEN 1 ELSE 0 END))) END IF reset_mpd3

That also gives me a missing keyword error. This is the first IF I've ever used so there must be something missing that I don't see.
I've never used an IF before,False,self,t5_2qp8q,False,,,t3_k7xs9
1313864657.0,jp07i,QUERY HELP: Returning all values in another table that matches one linked value in another,Tu_Amigo,3,1,3,"Sorry the title is a bit convoluted! Also posted this in r/mysql.

I've had a little search everywhere but I'm not sure I'm wording it right to get any results or if what I want to do is even possible...

Basically I want to return all values in a table that match a value in another.

[http://i.imgur.com/QVmPL.png](http://i.imgur.com/QVmPL.png)

The image probably explains it better- if I search for the model of a car say ""Mustang"" I want to return every other model that is a Ford too.

Any one have any ideas?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/jp07i/query_help_returning_all_values_in_another_table/
1312922366.0,jduz1,Firebird 2.5.1 RC1 will probably be released until next weekend. (firebirdnews.org),mariuz,3,1,0,,t5_2qp8q,False
1312714282.0,jbh89,Firebird for database experts: Indices. “Must read” articles series,mariuz,2,0,0,,t5_2qp8q,False
1307324071.0,hshru,Can some one explain simply what log_reuse_wait does in conjunction with recovery mode: full or simple?,markdavidboyd,4,2,2,"I have never properly understood it

I have a DB i am meant to support with log_reuse_wait: 0 (nothing) and the recovery mode set to FULL

Is it bad when the transaction log fills up with these settings? I can't get my head around whether the alerts about the trans log being full are bad or not. 

Any explanation as to how this works would be appreciated

Regards Me !",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/hshru/can_some_one_explain_simply_what_log_reuse_wait/
1305655942.0,hdjk3,"I feel this should be an easy query, but without proper caffeine supply, it's not.",Kinsbane,4,11, the queries I'm trying are not working. This is not homework!

At my company

So

**monitorings**

mid, stamp

**switches**

sid

Now, and the far_sid being another switch. These two fields are populated using the sid field from the switches table. These two fields can either have different sid's or the same sid.

What the software dev wanted was to return the *names* of the switches for the near_sid and far_sid fields

Many attempts to do sub-queries and joins have fallen flat. The developer I think came up with a workaround (involving another table)

Thank you!
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/hdjk3/i_feel_this_should_be_an_easy_query_but_without/
1304954859.0,h7dwi,How to list all columns in report?,ignathius,2,0,5,"Hello. I'm extremly new to SQL and SSRS

What i'm trying to do

Parameter     ID

A                 1

A                 2

B                 3

B                 4


what i need is:

Parameter     ID

A                1

B                3


I'm thinking i may need a function in the report to get this to work right,False,self,t5_2qp8q,False,,,t3_h7dwi
1304629912.0,h5454,Tough one... Creating a 'feature-matrix' like table from many-to-many data?,synt4xtician,3,1,4,"Say I have 2 tables

Can anybody come up with a way

I have examined PIVOT and have been unable to make that work.

Edit: Not sure if it was obvious, columns, and associations are changing all the time.",,False,self,t5_2qp8q,,http://www.reddit.com/r/SQL/comments/h5454/tough_one_creating_a_featurematrix_like_table/
1304219986.0,h1711,Alternative to SQLServer's create index ... include ... syntax in other DBs,behrangsa,3,1,7,"Looks like SQLServer is the only RDBMS that supports the include ... clause in the create index statements. What are the downsides of using create index (col1, col2) include (col3,self
1303950466.0,gyvj5,What convention do you follow for the order of columns in a table?,behrangsa,3,1,3,"I usually start with the primary keys of the table

How do you usually order the columns in your tables and what do you think about the convention I am following?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/gyvj5/what_convention_do_you_follow_for_the_order_of/
1303746801.0,gx1zk,Looking for common strings: SQL Oracle,tweaked540,2,0,3,"Does anyone here know how to look up a table and only pull back

dog, cat, mouse, rat, dog, cat, dog, turtle

I want the result to be: 
dog, mouse, rat, elephant, turtle...

I know I could just do a select * and let PHP do the math and processing for the output,False,self,t5_2qp8q,False,,,t3_gx1zk
1302192598.0,gktmj,Is there a way to sum multiple rows based on unix schedtime?,skyjump5,2,0,6,"So I've got a large dataset with data points taken at 5 minute intervals.  Each point consists of a unix schedtime stamp and a measurement.  I'd like to sum these data points so they represent 30 minute intervals.  

Rather than just summing blocks of 6 consecutive points

Thanks!",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/gktmj/is_there_a_way_to_sum_multiple_rows_based_on_unix/
1301409902.0,gdydz,help with converting to date time format!,spriteburn,3,1,8,"i am using Rational Quality Manager

please could somebody help?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/gdydz/help_with_converting_to_date_time_format/
1300756911.0,g8lj7,Help please - Need to select in a select with group by's etc,cyberwired,2,0,5,"Sorry title is confusing


I have two tables: scheme.slcustm and scheme.slitemm

slcustm is basically a listing of customers with name, sales person etc


slitemm is a list of invoices with customer name


What I have so far is the following:

    SELECT     c.name, c.analysis_codes2, sum(i.currency_amount) AS currency_amount
    FROM         scheme.slcustm AS c RIGHT OUTER JOIN
                      scheme.slitemm AS i ON c.customer = i.customer
    WHERE     (i.open_indicator = 'O')
    GROUP BY c.name, c.analysis_codes2
    ORDER BY c.name ASC

This gives me a list of the customers with their account number


Heres the tricky part:

I want to list the total amount of invoices owing in this month


I'm guessing I need to do something in the chosen fields I'm selecting and put selects inside that where the date is something and sum the currency amount....yeah this is where I get confused? Can someone lead the way a bit here?
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/g8lj7/help_please_need_to_select_in_a_select_with_group/
1300750414.0,g8izw,Trying to reverse engineer a trainwreck...,,2,0,8,"Hey guys

So basically - I've got limited knowledge of PHP/SQL

I'd like to know how I can ""view"" the SQL DB our site uses and be able to make changes to it. My end goal is to have a separate site use this DB (sister sites) instead of having to make the same changes twice.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/g8izw/trying_to_reverse_engineer_a_trainwreck/
1299386188.0,fy8zr,Requesting SQL Zoo Neeps Database Help,moebaca,2,0,3,"Hello ladies and gentlemen of /r/SQL! I come to ask a favor of any member who is looking for a quick challange to both a) test their SQL query skills; and b) help me with an assignment that is way over my head. 

On SQL Zoo problems 11 through 15 in the Neeps Database are completely out of my league. If anyone could hammer out these few queries and help a SQL novice out.. it would be so ridiculously appreciated by me that there isn't a measurement to ascribe it with.

The links to the problem are at: http://sqlzoo.net/a1d.htm

and the reference material is at : http://sqlzoo.net/a1.htm

Any help would be appreciated.. Thanks so much!",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/fy8zr/requesting_sql_zoo_neeps_database_help/
1297963160.0,fnb2k,"SQL Report Builder 3.0...Is it possible to return to the ""Wizard"" once you build the report?",DREWLONESTAR,2,0,1,I'm new to building these reports and returning to the Wizard would really help.  Anyone know if this is possible?,t5_2qp8q,True
1296766285.0,feqns,Please help with my query,Patti234,3,1,4,"Hello.  I am a first-time poster to this thread

Here is the query I need help fixing:


select r.remittance_id,r.COLLECTED_AMT, r.paid_dt  


from remittance r

where rh.REMITTANCE_STATUS_CD = 11

and rh.REMITTANCE_TYPE_CD = r.REMITTANCE_TYPE_CD

and rh.REMITTANCE_ID = r.REMITTANCE_ID

and rh.REMITTANCE_SEQUENCE_NO = r.REMITTANCE_SEQUENCE_NO

and r.REMITTANCE_STATUS_CD = 11


Additional Info: remittance_id
-	The Remittance table only has one record for each receipt.  The Remittance History table has multiple records for each receipt

The query currently returns: multiple rows for the same receipt, then Reserved (11) again, etc.  So every time there is an 11 entry, I get that many rows returned by the query above.

Problem: I want all the remittances returned by this query
",self,t5_2qp8q,True,,,True,http://www.reddit.com/r/SQL/comments/feqns/please_help_with_my_query/
1296763792.0,fepqi,Firebird 2.1.4 Release Candidate ready to test,mariuz,2,0,0,,t5_2qp8q,False
1296675736.0,fe011,How do I prevent Reporting Services from reformatting a query,sqldev34,2,0,4,"After reformatting an SQL query powering a report in BIDS so it is more readable, including comments. 

This is a problem we've been having for a while

I expect this is some sort of query optimization, the speed increase isn't a great benefit.

Does anyone know how to prevent BIDS/Reporting Services from reformatting a query?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/fe011/how_do_i_prevent_reporting_services_from/
1296491079.0,fcg52,Is there a way to stop a plus sign (+) changing to an ampersand (&amp;) when exporting from SQL Server Reporting Services to Excel?,UNHDude,2,0,2,"I have a column header that is ""89+"" in my report


It exports to PDF fine.


Does anyone have any tips for a workaround,False,self,t5_2qp8q,False,,,t3_fcg52
1296139624.0,fa1r8,help with this query please.,lostinsql,2,0,5,"I have a table, and all others are set to 1.

How could I write a query to display any deviceid that has no rows where the value for 'usedtoaccessdevice' is 0?

Thanks in advance... I hope that his forum is an appropriate place for this question.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/fa1r8/help_with_this_query_please/
1295858285.0,f7yqa,SQL Perl/PL Overview,addisonchristopher,3,1,0,,t5_2qp8q,False
1295085947.0,f2r2l,Select and join two tables then update field if a single match,cyberwired,2,0,3,"Hoping someone can help me out here to make this a little easier


Basically I have taken over a system based on PHP and MYSQL and the previous person has decided not to link tables based on a unique ID but the name.


So here is what I have:


Table furniture_sets

Fields: id, component_name



Table components

Fields: id


I've added component_id to link components.id to the correct field in furniture_sets and I need to populate this with the correct id


Problem comes about when two components have the same name and two different furniture sets reference that name and one ends up with the incorrect details or ends up showing two components


so what I'm thinking is something that will do select all those fields from both tables where sku_name=sku_name and component_name=component_name then update the furniture_sets.component_id with corresponding component.id


Is this possible in just SQL?


I know in PHP I can just do a select and join then for each record do an update on the component_id field but I'd really like to know if this can be done in pure SQL and learn how!


Thanks for your help :)
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/f2r2l/select_and_join_two_tables_then_update_field_if_a/
1292806155.0,eoiqt,Setting up IBM DB2 database for IBM Systems Director 6.2: Best practices on how to setup a DB2 database as Systems Director's data repository,davidreiss666,2,0,0,,t5_2qp8q,False
1292435219.0,embow,Noob trying to get a connection,ringringbananaphone,2,0,3,"Hi reddit

I'm trying to get a database set up so that I can connect to it with PHP. The mysql server and the webserver are located on the same machine. 

I've got mysql running so that I can log into it from the command line.

I also have this test page


&lt;html&gt;
&lt;head&gt;
&lt;title&gt; Test Database page &lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;

&lt;?php
$dbhost = 'localhost';
$dbuser = 'user';
$dbpass = 'password';

mysql_connect($dbhost
?&gt;

&lt;/body&gt;
&lt;/html&gt;


The html generated by this when I try to connect via the browser is:

&lt;html&gt; 
&lt;head&gt; 
&lt;title&gt; Test Database page &lt;/title&gt; 
&lt;/head&gt; 
&lt;body&gt; 

note that the final body and html tags don't get printed.

For the sake of troubleshooting I've turned iptables off. 

I'm just curious if there is some common mistake I'm making with the set up. Everything I read suggests that this should be easy. 

Thanks",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/embow/noob_trying_to_get_a_connection/
1291052549.0,edez9,Glossary of Database Terms,,4,2,0,,t5_2qp8q,False
1290159197.0,e8krt,Could someone help me with a Scar UDF in MS SQL 2K5?,adamnmcc,2,0,1,"Hi everyone

i've posted this ins r/rlearnprogramming too

i've been tasked with moving creating a system in work and need to design a UDF that calculates the earned premium in insurance. 

the formula should be:

    if the experience date &gt; return date
        premium earned = 100%
    if the experience date &gt; issue date and &lt; outward travel date
        premium earned = 20% / (datediff(experiencedate
    if the experience date is &gt; outward travel date and &lt; return date
        premium earned = 20% + (80% / (datediff(issuedate

heres what i've got so far

====================================================

    USE [ATIUnderwriting]
    GO

    SET ANSI_NULLS ON
    GO
    
    SET QUOTED_IDENTIFIER ON
    GO
    -- =============================================
    -- Author:		Adam McCartney
    -- Create date: 18/11/2010
    -- Description:	calculate earned premium function
    -- =============================================
    ALTER FUNCTION [dbo].[fnEarnedPremium]
    (	
    	-- Add the parameters for the function here
        	@issuedate datetime
    	@outdate datetime
    	@returndate datetime
    	@experiencedate datetime
    	@pretripearnings decimal(10
    	@premium decimal(10
    )
    RETURNS decimal(10
    AS
    
    begin

    declare @earnedpremium decimal(10
    declare @tripearnings decimal(10
    --declare @tripearningsperc decimal(10
    --declare @ptep decimal(10
    declare @datediff decimal(10



    if datediff(day
    	set @Earnedpremium = @premium
    else if datediff(day, @issuedate, @outdate)
    	set @earnedpremium = @premium * (@pretripearnings / datediff(day
    Else 
    	set @earnedpremium = @premium * (@pretripearnings + (@tripearnings / datediff(day

		

    RETURN @earnedpremium 

    end

====================================================

any help would be fantastic.. i'm very new to programming. i now how to structure it but the syntax eludes me.. 

Many Thanks in Advance. ",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/e8krt/could_someone_help_me_with_a_scar_udf_in_ms_sql/
1290111278.0,e89t3,Trying to accomplish something that might not be possible via joins...,frustrated_dev,2,0,6,"So basically

HeaderID | Username | Question | Answer
------ | ------ | ------ | ------
123  |  user1  |   date? | $2010-18-11
123  |  user1  |   name? | $user one

Now what I want to do is append each row with the date. No hassle with the first row

To give an idea of the (bad) design

    SELECT h.ID, a.Answer
    FROM tblHeader h
    INNER JOIN tblAnswer a on h.ID = a.HeaderID
    INNER JOIN tblQuestion q on q.ID = a.QuestionID

I think it might be easier to just go ahead and use a temporary table and work on that but I'd like some second opinions first. Any ideas?

edit: damn table formatting got me.

edit 2: thanks to shaara for suggesting this query

    SELECT h.ID, a.Answer, foo.MyDate
    FROM tblHeader h
    INNER JOIN tblAnswer a on h.ID = a.HeaderID
    INNER JOIN tblQuestion q on q.ID = a.QuestionID
    JOIN (
        SELECT HeaderID
    ) foo ON foo.HeaderID=h.ID

Works perfectly! And yes,False,self,t5_2qp8q,True,,,t3_e89t3
1289948691.0,e77s9,Getting -5 continually when using SUM(),toxicityj,3,1,14,"I've got a database full of lovely numbers in a column that I'm trying to add up. I'm still new to PHP/SQL so I spend half the day googling for that solution. Well for some reason it just keeps outputting -5 and the sum no matter what the numbers are that it's given.

I'm pretty sure my code is correct

SELECT SUM($year_select) AS Totals FROM agglomeration_growth_rate WHERE Country = $region_select
Any ideas?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/e77s9/getting_5_continually_when_using_sum/
1284149340.0,dc8c3,After moving from 5.0 to 5.1 using a database dump...,NWLierly,3,1,2,"I get these errors on startup;

100910 11:48:06 [ERROR] Column count of mysql.db is wrong. Expected 22
100910 11:48:06 [ERROR] mysql.user has no `Event_priv` column at position 29
100910 11:48:06 [ERROR] Event Scheduler: An error occurred when initializing system tables. Disabling the Event Scheduler.

I can't connect using anything but the built in admin account,False,self,t5_2qp8q,False,,,t3_dc8c3
1282824228.0,d5ofh,"Is there a way to make this query quicker, please?",Antagony,2,0,http://www.reddit.com/r/SQL/comments/d5ofh/is_there_a_way_to_make_this_query_quicker_please/

This is the general structure of the application generated query:

    SELECT [fields] 
    FROM qryMailMerge 
    WHERE Booking_Ref IN(
        SELECT MAX(Booking_Ref) 
        FROM qryMailMerge 
        WHERE [criteria]
        GROUP BY ID)
    ORDER BY [field]


In case it isn't obvious


I'm sure there must be a way to make this quicker,False,self,t5_2qp8q,False,,,t3_d5ofh
1282174111.0,d2sa7,New sql injection attacks snags Apple in a wide net,amaxen,2,0,0,,t5_2qp8q,False
1281492406.0,czr0k,Need some SQL Advice please.,lazylion_ca,2,0,11,"Does the following look correct? Is there a better way to do it?  
  
---------
   
SELECT tinvent.lId, tinvbyln.dInStock, tinvprc.dPrice, tinvbyln.dLastCost

FROM (tinvent INNER JOIN tinvbyln ON tinvent.lId = tinvbyln.lInventId) INNER JOIN tinvprc ON tinvent.lId = tinvprc.lInventId AND tinvprc.lPrcListId=1;  
  
---------
  
I imported our Simply Accounting 2010 MySQL database into MS Access 2003 so that I could play around with it with out messing anything up.  
  
It appears to return the results that I want (a basic price list) but I'm not sure if I should be using the AND or if I should use a WHERE for the last bit.

3 tables. The third table (tinvprc) has 3 entries for each item in table1. tinvprc.lPrcListId=1 or 2 or 3.
  
1 would mean normal price  
2 is discounted price  
3 is super discounted price ( or inflated place I guess)  
  
For this query
  
All suggestions welcome
  
Thanks in advance.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/czr0k/need_some_sql_advice_please/
1281039046.0,cxubs,"Joining on Multiple Columns, Multiple Tables",cubixy2k,3,1,http://www.reddit.com/r/SQL/comments/cxubs/joining_on_multiple_columns_multiple_tables/, and I have 3 columns which I search to find the relevant rows. As of now, and search the whole database for anything matching. Next

As you would expect, causes a bit of delay (it used to cycle though each specific criteria once per pass, but thankfully I fixed that).

I am curious if there is a way to join the 3 different tables in a single query and have it respond with all the rows matching any one of the 3 criteria tables. A left join obviously returns irrelevant rows

TLdr; I'm frustrated trying to run 3 complete joins in one query.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/cxubs/joining_on_multiple_columns_multiple_tables/
1280250167.0,cuaik,It's driving me nuts! How the hell is it not working?,lemonidas,3,1,21,"I'm trying to get the following to work but had no luck so far

&gt;UPDATE    prices
&gt;SET              dateto = '1/3/2011'
&gt;WHERE     (eof IN
&gt;                          (SELECT     eof
&gt;                           FROM          prices AS prices_1
&gt;                            WHERE      (datefrom LIKE '27/07/2010') AND (dateto LIKE '' OR
&gt;                                                   dateto IS NULL))) AND 
&gt;(datefrom NOT LIKE '27/07/2010') AND (dateto LIKE '' OR
&gt;                      dateto IS NULL)


When I run the nested select

Any ideas? (I'm definitely wrong

UPDATE: for some very strange reason

It is also noticeably faster than the loop queries, so I'll save this version, and start experimenting with the fine suggestions you gave me :)",,False,self,t5_2qp8q,,http://www.reddit.com/r/SQL/comments/cuaik/its_driving_me_nuts_how_the_hell_is_it_not_working/
1279317820.0,cqgih,Looking for a solution [insertion of different numbers of records],joehouse,2,0,2,"Hello gang

    'If
        'HAVING (((Count(BabyTable.ParentTableID)) &lt; [ParentTable.BUbbleCount]))
    'Then 
        'insert # recs = BUbbleCount into BabyTable
    'Else
        'Next record

I'm using MSSQL and Acess. The only thing I can think of is using VBA.

And I need to do this for 20k+ records in the parent table.

Many thanks!",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/cqgih/looking_for_a_solution_insertion_of_different/
1276715970.0,cfq7t,Differences between ISNULL and COALESCE,enolakardia,4,2,0,,t5_2qp8q,False
1276708337.0,cfokq,SSIS Talk; How to introduce data corruption without trying.,enolakardia,3,1,0,,t5_2qp8q,False
1276260871.0,cdxd4,Make a 100+ Server Inventory in 30 minutes - SQLServerCentral,enolakardia,5,3,4,,t5_2qp8q,False
1377011430.0,1kqjiz,[MY SQL] Silly SQLZOO question,Papadopulos,1,0,2,"The question is Identify the countries which have names including the word 'United'


I thought it was simple and put 
    SELECT name 
    FROM world 
    WHERE name = '%United%'

but that returns nothing :/",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1kqjiz/my_sql_silly_sqlzoo_question/
1377010424.0,1kqia4,[MS SQL] Changing SA passwords,26252643,2,0,9,"Hi everyone.

I am very new to SQL language and Have been given the task to change the SA passwords for multiple servers.

However since there are waay too many servers to go do this 1 by 1 it would be great if there is a way to get a quick powershell script or a MSSQL script to do this.

I understand that I can change the passwords one at a time by using SQL server Mgmt Studio however it would be great if there was a quicker method.

Please Help me with this.
Thanks in advance!",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1kqia4/ms_sql_changing_sa_passwords/
1377006969.0,1kqedw,[MySQL] Concat and Case are not working together.,enim,1,0,1,"Here is my query:

    INSERT INTO scored 
    SELECT emid
    CASE 
    WHEN em LIKE CONCAT(""%""
        ELSE 0
    END as score
    from ems;

It is giving me an error of ""subquery contains more than 1 row"" - which is true

Could anyone give any insight onto how I could make this work?

Further, and I want to add up all of the scores of matches and sum them together. So if ms.trig contains

abc
def

and it is matching on something that is abcldef,False,self,t5_2qp8q,False,,,t3_1kqedw
1376973369.0,1kpqoe,[PostgreSQL] generate_series() Tricks,shivasprogeny,3,1,0,,t5_2qp8q,False
1376931108.0,1kobsm,"My work is paying for me to go to school to become a DBA, we are learning everything in Oracle, work only uses SQL Server. Need some advice from a professional (see note).",NerdEnvy,2,6
Also
Lastly, and dev) with only about 10 total databases. Right now I am a Database Analyst I and make $19/hour. What can I expect to be paid after graduation? Thank you so much in advance!",,False,self,t5_2qp8q,False,,
1376678238.0,1ki513,Even my dog knows SQL!,RebeccaMurison,4,10,0,,t5_2qp8q,False
1376605321.0,1kg672,Trying to Calculate A Player's 'Quality of Competition',MattPfeffer,1,0,1,"Hey. So I have a player A. This player faces many different opponents

What would I have to do to calculate the average X of player A's opposition?

Know this is a tricky one,False,self,t5_2qp8q,False,,,t3_1kg672
1376503126.0,1kd1s0,Converting from T-SQL to PL/SQL using [Microsoft Visual Studio],sPIERCEn,2,1,6,"I'm using Microsoft visual studio

DECLARE @LastDayOfPreviousMonth DATETIME
DECLARE @MostRecentAsOfDate DATETIME

SET @LastDayOfPreviousMonth=DATEADD(M,GETDATE()),-1)

SELECT @MostRecentAsOfDate=MAXDATE FROM OPENQUERY(XXXX_HIST

IF @LastDayOfPreviousMonth&lt;&gt;CONVERT(char
BEGIN

RAISERROR('SOURCE.TABLE Data is not up to date'

END",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1kd1s0/converting_from_tsql_to_plsql_using_microsoft/
1376491287.0,1kcm35,Can I install both SQL Server 2008R2 express and SQL Server 2012 express on my laptop?,ergregerighe,3,4,5,"I have 2012 Express installed already and I tried installing 2008R2 Express

A network error occurred while attempting to read from the file ... SQL2008R2NativeClient.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1kcm35/can_i_install_both_sql_server_2008r2_express_and/
1376425240.0,1kauxf,Using the first 7 characters of 2 tables to match up,wolfman3127,2,1,2,"I have two tables just filled with data

I am using access as well. But I know I can use SQL within it.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1kauxf/using_the_first_7_characters_of_2_tables_to_match/
1376318668.0,1k7ix9,[TSQL] Query Help,sholder89,1,0,14,"Let me preface this by saying I am not a finance person so I've done my best to explain what was explained to me...

I have a SQL database that stores transactions for a loan company, interest due, and principle due. The database contains each transaction labelled as either a payment, principle, or fee. See below for an example. The interest is not stored in the database but can be calculated each principle payment by principle amount * .05 * daysBetween, where daysBetween is the number of days since the last principle type.

So now the hard part, however these are current loans that are still racking up interest, fees, etc. We need to see a ""picture"" of the loan in it's current state. So each payment that comes in gets applied first to whatever fees there are, then to the interest, and then to whatever principle there is. This means I can't just add them all up and subtract, I need to do it row by row.

Anyone have any ideas? I'm totally stuck

Example Data (Completely Made Up and Simplified):

    |-Amount-|-PaymentType-|---Date---|
    | 150.00 | PRINCIPLE   | 06-01-13 |
    | 125.00 | PRINCIPLE   | 06-05-13 |
    |  25.00 | PAYMENT     | 06-05-13 |
    |  35.00 | FEE         | 06-21-13 |
    | 120.00 | PRINCIPLE   | 07-02-13 |
    | 100.00 | PAYMENT     | 07-15-13 |
    |  35.00 | FEE         | 07-21-13 |
    |---------------------------------|",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1k7ix9/tsql_query_help/
1376092047.0,1k25ul,Need help with sql - original title I know ;),davodeth,4,5,4,"Hi

So I'm working with some php and sql and am trying to output multiple posts by users. I have encountered a problem where it will bring up the first entry repeated as many times as posts I have.

eg. I have 3 posts by users it brings up

post 1

post 1
 
post 1

where I want it to bring up 
post 1

post 2

post 3


if more people make more posts

I'm only learning php and sql at the moment so please forgive my formatting and any mistakes I have made.

     $sql = mysql_query(""SELECT post_id, post_description, post_info, post_date FROM posts"");
    $row = mysql_fetch_array($sql);
    $post_id = $row['post_id'];
    $post_user = $row['post_user'];
    $post_title = $row['post_title'];
    $post_description = $row['post_description'];
    $post_info = $row['post_info'];
    $post_date = $row['post_date'];
    ?&gt;
    &lt;?php do {
    ?&gt;
    &lt;article&gt;
    &lt;h2&gt;
    &lt;?php echo  $post_title; 
    ?&gt;
    &lt;/h2&gt;
    &lt;?php echo $post_description;
    	echo $post_info;
    	echo 'Posted by '.$post_user.' on '.$post_date;
    ?&gt;
    &lt;?php } while ($row = mysql_fetch_array($sql)); 
    ?&gt;
    &lt;/article&gt;  ",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1k25ul/need_help_with_sql_original_title_i_know/
1375882731.0,1jvrmg,[ORACLE]Joining Multiple Group-By statements,borensoren,1,1,2,"So

    UNIQUEID    EMAIL                            SPECIALTY    DECILE
    --------------------------------------------------------
    103702      redacted@fakeemail.com    NEUROLOGY    10
    113744      dev@null.co.uk                 NEUROLOGY    10


What I want is something like this:

    SPECIALTY  COUNT(DECILE 1)  COUNT(DECILE 2)
    -----------------------------------------------
    NEUROLOGY 400                     500

The only way I can think to do this is a long string of join statements on SPECIALTY like this:

    SELECT A.CLI_SPEC
    (select cli_spec
    from JM_MR_20130807
    where have_email is not null
    and MS_DECILE = '1'
    or email is not null
    and MS_DECILE = '1'
    group by cli_spec
    order by count(menum10) desc) a 
    join 
    (select CLI_SPEC
    from JM_MR_20130807
    where have_email is not null
    and MS_DECILE = '2'
    OR email is not null
    and MS_DECILE = '2'
    group by cli_spec) B
    on a.cli_spec = b.cli_spec

all the way through decile 10.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1jvrmg/oraclejoining_multiple_groupby_statements/
1375281166.0,1jf83p,My query isn't running with all my WHERE statements,whoisearth,4,6,8,"To avoid more people providing input I found a simpler way to get what I want and then running the scalar values after just on the temp table. :)

To get to the gist I have a query pulling data between 2 sets which works fine up until a point.

My where is as follows - 

    WHERE (trgtskrun_crtdt &lt; @nextTime
        AND trgtskrun_crtdt &gt; @lowerTime)
		AND ((trgmst_id = 1475 AND tskmst_id = 1578) OR (trgmst_id = 1476 AND tskmst_id = 1579))

It has no problem with the first part of the where, etc. etc. but it only ever pulls the 1475/1578 values.  UNLESS - 

I do it this way - 

    WHERE (trgtskrun_crtdt &lt; @nextTime
        AND trgtskrun_crtdt &gt; @lowerTime)
		AND (trgmst_id = 1475 AND tskmst_id = 1578) OR (trgmst_id = 1476 AND tskmst_id = 1579)

but then it gets effed up and it is pulling 159 instances of the same value (I'm dumping the results of the query into a temp table.

I've tried setting a DISTINCT on the value but it won't let me it complains with the following - 

Msg 421, Line 21
The text data type cannot be selected as DISTINCT because it is not comparable.

even though the value I'm trying to do a distinct on is an INT (I am copying over a text column too which it's duplicating 159 times as well)

this make sense?",self,t5_2qp8q,1375283161.0,,,True,http://www.reddit.com/r/SQL/comments/1jf83p/my_query_isnt_running_with_all_my_where_statements/
1375280322.0,1jf74g,[MS SQL] Balancing Of Record Assignments,NakedLoki,2,1,5,"So I've got a table that has rows inserted into it each day that has assignment column (we'll call it PersonAssigned) which can either have the login assigned to that record that day or is blank.  

What I want to do is fill in the blank PersonAssigned and assign from a list of logins evenly but I want to take into account the records that the login might have already had filled in.

Example 
bob - 5 records for today 
nick - 3 records for today 
joe -  0 records for today

5 blank records.  I want 4 records to go to joe and one record to go to nick.  I know how to do this using cursors and loops but I feel like I should be able to use NTILE but I haven't really used it in the past.  ",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1jf74g/ms_sql_balancing_of_record_assignments/
1375190812.0,1jchn9,[MySQL] Select sales column twice - current year and last year,gezza07,1,1,7,"My table is sorted as [sales]

[LYsales] being the sales from the same day 365 days ago. Is this possible to perform in SQL?

Thank you for your assistance.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1jchn9/mysql_select_sales_column_twice_current_year_and/
1374818317.0,1j2yfl,I have a workplace full of computers. I want to write all their software into a database and then be able to query later so I can see how many PC's I have Office installed on (for example). How?,misterpotatomato,2,1,7,"Hi all

So

I've modified an audit tool that used to write all our stuff out to a CSV file and now its writing to a MSSQL database.  Now

So

Database: db_softwareaudit
Tables:
PC11111111
PC22222222
PC33333333
PC44444444
(...and so on and so forth. We have about 2000 PC's or so
Columns: SoftwareName (thats it for now)

So, and then when the user goes to a asp net web page, selects the software from a web page, a SQL operation will happen that will find how many PC's that piece of software is installed on, as well as their asset numbers etc.

I'm sorry if this isn't making much sense.  I'm a noob to SQL and I am only here out of neccesity. Please be kind :)",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1j2yfl/i_have_a_workplace_full_of_computers_i_want_to/
1374628649.0,1ixbo3,[Oracle] How do I run a 2nd query only if the first returns no rows.,shanegerous,1,0,3,"I have a production table that updates every 30 minutes

My problem is that sometimes the update takes 8 minutes or so and my query will return no rows

Is there a function or just simple exists statement that I can use to accomplish this? Thanks!",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1ixbo3/oracle_how_do_i_run_a_2nd_query_only_if_the_first/
1374614239.0,1iwtf3,Help creating an EER or ERD with MySQL Workbench,valen089,1,0,2,"I'm trying to reverse engineer the EER or ERD for a database. I have been given an SQL script and the tables,self,
1374270016.0,1inqcr,Help with [MS SQL] query,not_a_sql_expert,3,2,4,"Simply put

I'm sorry if the formatting comes out wonky.

An old admin fancied himself a SQL guru and left me with little gems like the following.

I know there has to be an easier way to do this



    SELECT Employee.EmpId, Employee.PayGrpId, PRTran.TranAmt AS ""Net Pay"", Employee.StdUnitRate as ""Rate"" ,
    (SELECT sum(RptEarnSubjDed)  FROM PRTran b WHERE (PRTran.TranDate=b.TranDate AND (PRTran.EmpId=b.EmpId AND EarnDedId='401K'))) AS ""Gross Wages""
    (SELECT SUM(Qty) FROM PRTran c WHERE PRTran.TranDate=c.TranDate AND PRTran.EmpId=c.EmpId) as ""Hours""
    (SELECT SUM(Qty) FROM PRTran d WHERE PRTran.TranDate=d.TranDate AND PRTran.EmpId=d.EmpId AND EarnDedId='OT') AS ""OT Hours""
    (SELECT SUM(Qty) FROM PRTran e WHERE PRTran.TranDate=e.TranDate AND PRTran.EmpId=e.EmpId AND EarnDedId='OT') * Employee.StdUnitRate / 2 as ""OT Extra $""
    (Select ROUND((SELECT SUM(Qty) FROM PRTran d WHERE PRTran.TranDate=d.TranDate AND PRTran.EmpId=d.EmpId AND EarnDedId='OT') / (SELECT SUM(Qty) FROM PRTran c WHERE PRTran.TranDate=c.TranDate AND PRTran.EmpId=c.EmpId)
    FROM BLANKED.dbo.Employee Employee
    WHERE (PRTran.EmpId = Employee.EmpId) AND (PRTran.TranDate='2013-07-16 00:00:00' AND PRTran.TranDesc='Net Pay')
    ORDER BY Employee.Department,False,self,t5_2qp8q,False,,,t3_1inqcr
1374085832.0,1ii3hp,[MSACCESS] Newbie help... Find common element in AT LEAST 3/5 tables,zombieraptors,2,1,2,"Hi all -- I'm just learning to deal with microsoft access and am sorta figuring it out as I go. I've googled

I have 5 tables of data.  Is there a way to find common elements that occur in at least 3 out of 5 of those tables?  I know how to find common elements between two tables

Thanks!",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1ii3hp/msaccess_newbie_help_find_common_element_in_at/
1373816672.0,1ia2we,[Oracle] Sum two columns from different tables,falcorethedog,3,2,5,"What I need to do is calculate percent change from two tables. I want to sum the result of these two queries and then divide by the sum of the first. 

    SELECT Sum(Sales.Sales) AS SumOfSales_04
    FROM Sales INNER JOIN Orders ON Sales.orderNumber = Orders.orderNumber
    WHERE (((Orders.orderDate) Between '1-Jan-2004' AND '31-Dec-2004')) 

    SELECT Sum(Sales.Sales) AS SumOfSales_03
    FROM Sales INNER JOIN Orders ON Sales.orderNumber = Orders.orderNumber
    WHERE (((Orders.orderDate) Between '1-Jan-2003' AND '31-Dec-2003'));",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1ia2we/oracle_sum_two_columns_from_different_tables/
1373633733.0,1i5er6,Drop user cascade and dump files,s1mpd1ddy,3,2,4,"Oracle 11g running on 64 bit windows server 2008

Does drop user cascade effect the dump file that contains that user ? 

Reason I'm asking is... I exported a dump file with 4 users/schemas (I'm still confused on what is what)

I then dropped cascade those users/schemas .


When I went to import the dump file in the same database

Any help?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1i5er6/drop_user_cascade_and_dump_files/
1373492946.0,1i1cka,[MS SQL] Help with query comparing two tables and updating a field.,OliverTw1st,2,1,5,"I'm a SQL novice but I have been tasked with writing a script for a small project. I have a table of records (data_tbl) with one field listing an account numbers (acct_no) and another field with security access (secure) flag (Y if it should be secure,self,
1373485606.0,1i11xx,[MS SQL]Checking that each character in a string is valid without looping/cursor,NakedLoki,2,1,12,"So we have a list of VALID characters that can be allowed in a string (email).    So you can't do email like (list of valid characters) because the email could be ""bobb╙@gmail.com"" and it would say it's correct even tough it's got that weird character in there.  

Trying to find a way without cursor/looping but that may be the only way.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1i11xx/ms_sqlchecking_that_each_character_in_a_string_is/
1373229987.0,1htjy4,[MySQL] Looking for some help with joined table inheritance and 'unknown' types / discriminator,Kerry350,1,0,3,"Hi

So I can't divulge the exact details due to the project, image_item, video_item and so on. In terms of the inheritance I'm going to (or want) to use joined table / table per class inheritance. Like that of the Hibernate ORM for Java or SQL Alchemy for Python (http://docs.sqlalchemy.org/en/latest/orm/inheritance.html). I understand how this works on it's own, and would want to store a 'type' in the base class table and map it's ID to the ID within the sub class tables (with a foreign key also) and perform a join to get the necessary data. I understand how the queries would work etc, that is until I need to get all of the items belonging to a 'container'. Reason being it can hold lots of items, all of varying types, at the time of the query I need to know how I can dynamically handle the type - or if this is even possible at all. 

I.e. one of the common examples is the 'employee' base and 'managers' or 'worker' sub types. Getting all managers or workers is nice and easy as you have the table name to join to within the join operation. But I won't know what table name I'm joining on (LEFT OUTER JOIN &lt;type&gt;) other than type coming from the base tables type column. Can I use this result in the query somehow? But

So could someone tell me how to do this? Or if I'm just pursuing it wrong / overcomplicating / undercomplicating / being stupid point me in the right direction? Thanks!",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1htjy4/mysql_looking_for_some_help_with_joined_table/
1373050551.0,1hpemr,[MSSQL] Query help needed,whoisearth,3,2,7,"I've got a complex one here.  I basically have the following Table - 

ITEM             Time

2                  12:34

1                  12:15

1                  12:07

1                  12:03

1                  11:23

2                  11:10

1                  11:05

1                  10:59

2                  10:46

1                  10:43

1                  10:23

1                  10:10

2                  10:07

1                  10:01

2                  09:52

I basically want to select the COUNT(ITEM) for 1 when it's between ITEM 2.  So at the top of the table above running a query I want to see it return 4 as ITEM 1 appears 4 times between the 2 ITEM 2 listings.  Problem is the time is always dynamic.

How would I go about doing this?

edit - as this seems to either be stumping you all,,False,self,t5_2qp8q,1373079025.0,,True
1372709529.0,1hg562,[MSAccess] Count fields then set as percentage,Krainz,2,1,15,"Hello

I have a yes/no field for each entry in the table. I'd like the report to have a field that would sum up the amount of each field that has ""yes"" and then divide it by the total of fields

Like 8 entries, 50%. 10 entries, 2 yes, 8 no, 80%.

Is that possible?

Access 2010 btw",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1hg562/msaccess_count_fields_then_set_as_percentage/
1372703456.0,1hfwku,[Oracle] Selecting values that are different than the previous entry,Deanicus,2,1,5,"I've tried looking online for a solution but maybe I'm not phrasing my request very well in the search engine...

I'm trying to flag each time stamp in a column when a datum changes within a date range.  To further clarify, ignore.  Any help with the syntax for this would be appreciated.",,False,self,t5_2qp8q,False,,
1372344394.0,1h6iee,Sparse matrix multiplication using SQL,mindprince,2,1,2,,t5_2qp8q,False
1372260234.0,1h420r,I do not understand how a cross tab query would help me find in this situation. thoughts?,q14802,2,1,3,"I was given an assignment at work. 

""Compare 6/25/2013 Revenue Table with the Historical Revenue table""

The goal of this comparision is to find  the instances in which the Customer ID  belongs to a different group or a different Contract ID.

My boss told me to run a cross tab query.  I thought cross tab queries just summarize data,False,self,t5_2qp8q,False,,,t3_1h420r
1372191166.0,1h260c,[MS SQL] Running SQL Integration Services service as Local System as opposed to NetworkService. Problem?,ElCriadorDePollos,1,0,2,"I am wondering what the implications of running this service as local system instead of networkservice and if this would cause problems.

Currently the service won't start using the network service account but will as local system. Wondering if this can be a stopgap while the larger problem is investigated.

SQL Server 2005 on Server 2003.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1h260c/ms_sql_running_sql_integration_services_service/
1371839107.0,1gt536,[MS SQL] Restoring with NORECOVERY...,misseff,3,2,2,"I just restored two databases from full backups with NORECOVERY ahead of a migration tonight,,False
1371750625.0,1gqnor,How can I do this in SQL?,loct99,1,0,1,"Table2013- company name
Table2012- company name


I want to find all instances where the employee I'd has a different company in the two tables. In excell I'd just do a vlookup and the a true false statement .  But I can't export tanles this big
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1gqnor/how_can_i_do_this_in_sql/
1371496223.0,1gj7n2,[MySQL] Newcomer attempting to BULK INSERT a text file into table.,UnagiandRoe,2,1,17,"Hello, but I'm trying to import a large text file with all of my statements and data rather than typing it all in the command line.

In my research, I can't get it to work. My data values are comma delimited within the text file.

BULK INSERT 'table name' FROM 'Directory Path' WITH (FIELDTERMINATOR = '

I am receiving a syntax error. Am I approaching the text file import in the right way?

Thanks!",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1gj7n2/mysql_newcomer_attempting_to_bulk_insert_a_text/
1371492305.0,1gj29i,[SQL Server] Error converting varchar value to int when attempting to convert a comma-delimited string into a table,delugio,1,0,3,"The end goal of the udf below is to allow a user to type in custom parameter values to generate a report in SSRS. This is slightly modified from an example I found at http://www.codeproject.com/Tips/584680/Using-comma-separated-value-parameter-strings-in-S

    CREATE FUNCTION [dbo].[CSVToTable] (@InStr VARCHAR(MAX))
    RETURNS @TempTab TABLE
       ([Name] VARCHAR(200))
    AS
    BEGIN
        SET @InStr = REPLACE(@InStr + ',,', ',')
        DECLARE @SP INT
    DECLARE @VALUE VARCHAR(1000)
    WHILE PATINDEX('%
    BEGIN
       SELECT  @SP = PATINDEX('%
       SELECT  @VALUE = LEFT(@INSTR 
       SELECT  @INSTR = STUFF(@INSTR, '')
       INSERT INTO @TempTab([Name]) VALUES (@VALUE)
    END
        RETURN
    END
    GO

    DECLARE @LIST VARCHAR(200)
    SET @LIST = 'a'
    SELECT * FROM dbo.CSVToTable(@LIST)

NOTE: when i simply initialize LIST as '', 0. If I set list equal to a string such as '10,5,99,...' the udf works fine
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1gj29i/sql_server_error_converting_varchar_value_to_int/
1371304366.0,1gedtv,[MS Access] Basic SQL query help.,Shalaiyn,1,0,5,"I'm asking on behalf of a friend who can't get into Reddit right now:

""Hey guys

I need to sort out Author
and grouping all of that by Authors.

Heres the picture what im working with - http://i.imgur.com/0qW0HDc.png

and heres what i have so far but it creates multiple entries as seen here - http://i.imgur.com/OPXFxpP.png

SQL i have so far:

SELECT Authors.Author
FROM Titles INNER JOIN (Authors INNER JOIN [Title Author] ON Authors.[Au_ID] = [Title Author].[Au_ID]) ON Titles.[ISBN] = [Title Author].[ISBN]

but this is wrong as it creates multiple entries :(""

",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1gedtv/ms_access_basic_sql_query_help/
1371138976.0,1g9vmh,MSSQL query2 using results of query1,whoisearth,1,0,24,"So I have a query where I want to find the value of a table.  I have the query successful and it pulls around 10 - 20 lines of info.

I then want to do a query taking the results of 1 of the columns of that table and run another query for each result of the 10 - 20 lines.

How would I go about doing this?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1g9vmh/mssql_query2_using_results_of_query1/
1370790546.0,1fzf01,[MS Access 2010] Copying and updating multiple records at once,Krainz,3,2,8,"Hi guys

I have this database I'm working on, which are the same for all projects: http://i.imgur.com/cNzIzip.jpg

To make my job easier

It is very important to me because I'm going to have to do that for nearly 20 projects

So,False,self,t5_2qp8q,False,,,t3_1fzf01
1370602312.0,1fus3h,[MySQL] Need a little help here,Sexyfish69,2,1,4,"I'm going to make a ""combine elements"" game where one register as an user and then gets a starting pack with different objects (wood x5
I've got a table named Items and a table named Users.
The Items table got the columns: 'item_id' and 'name'
In the Users table i've got 'user_id'

How can I create a relationship so that I can store which one of the elements the player owns and how many of it?
Am I supposed to make a table with each element at it's own column and each player at its own row,False,self,t5_2qp8q,False,,,t3_1fus3h
1370524300.0,1fsdfb,super simple error I keep getting,428reo,1,0,5,"I need to use two NOT statements.

For example

Select Client Number
From Table A
Where Group not 70 or not 14 and report_date between 5/1/2013 and 5/31/2013


it returns both 70 and 14 groups when i do this",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1fsdfb/super_simple_error_i_keep_getting/
1370154994.0,1fib2v,What are some one-to-many examples of two tables I can practice creating by writing queries?,Liger86,1,0,6,My brain is fried and I can't think of that many but I need to practice to remember syntax better.,t5_2qp8q,True
1370115779.0,1fh8zv,"[mssql] I've ran a lot of queries against master database, how do I roll back them all?",Liger86,1,0,http://www.reddit.com/r/SQL/comments/1fh8zv/mssql_ive_ran_a_lot_of_queries_against_master/,self,
1369868410.0,1fat70,DateDiff returns zero,PichardRryor,1,0,9,"Hi everyone
I'm calculating the difference btw two dates
I'm writing the following: 
Datediff(d
But its returning zero.
I've swapped places of the columns
Any ideas? ",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1fat70/datediff_returns_zero/
1369708506.0,1f6bzf,"Microsoft SQL Server 2005 Express: Using sqlcmd, is it possible to add a formula to a field?",TipOfTheSpear,2,1,http://www.reddit.com/r/SQL/comments/1f6bzf/microsoft_sql_server_2005_express_using_sqlcmd_is/

For whatever reason, however, own the database, so anything can be done via sqlcmd. 

I don't know enough about it to know if it's even possible,,False,self,t5_2qp8q,False,,True
1369704744.0,1f67py,Question about joins,shif,1,0,18,"I taught sql mysql and i've never used the inner

    CREATE TABLE product (
      id    serial
      brand int
      type  int
      name  text
    );
    
    CREATE TABLE brands (
      id    serial
      name  text
    );
    
    CREATE TABLE types (
      id    serial
      name  text
    );

if i wanted to get the results of a product with the name of the brand and the name of the type i would do

    SELECT p.name
    FROM product p
    WHERE brand = b.id AND type = t.id;

Am i supposed to be using joins for this?

im currently clueless on how joins work
",self,t5_2qp8q,1369707765.0,,,True,http://www.reddit.com/r/SQL/comments/1f67py/question_about_joins/
1369326094.0,1ewsm8,SQL cluster fail over question!!!,Justinjaw,1,0,1,does anyone know if adding CPU / memory to a 2 node SQL cluster will break it?,t5_2qp8q,True
1369004455.0,1enpyd,SQL question - joining two tables with some NULL values (see text for details),ReidWings,1,0,11,"Hi

I have a medical record system that links to patient documents and has an identifier for each data point for the patient document all stored in different tables.  I want to link them to make a table for each patient of all their documents.  Each document is listed more than once to give the different variables related to it

I'll simplify to the example:

I've created this table by using multiple inner joins:

DocumentID------Patient -------- DocumentField-------Data------ImageType

1 ----------------- Smith--------MedicalRecord--------223-------- Photo

1 ----------------- NULL -------- Date of Service --------1/23/12 -------- Photo

1 ----------------- NULL-------- InsuranceType -----------2 -------- Photo

2 ----------------- Johnson-------- MedicalRecord --------239  -------- HistoryForm

2 ----------------- NULL--------Date of Service--------4/11/13 -------- HistoryForm

2 ----------------- NULL -------- InsuranceType ------  2  -------- HistoryForm

3 ----------------- Davis -------- MedicalRecord ------ 837  -------- HIPPA

3 ----------------- NULL-------- Date of Service ------ 2/13/12--------HIPPA

3 ----------------- NULL --------  InsuranceType ------  2 -------- HIPPA

I want to have a table that lists:

DocumentID    --------   Patient      --------     DocumentField    --------   Data   --------    ImageType

1  ----------------  Smith  --------  Date of Service--------  1/23/12 --------   Photo

2  ---------------  Johnson  --------  Date of Service   --------4/11/13  --------  HistoryForm

3 ----------------- Davis --------   Date of Service -------- 2/13/12  -------- HIPPA

AND then I want to be able to filter it down by individual patients.  The reason I can't do that now is as you can see in my first table

Any guidance on how to do this would be VERY appreciated!!

Thanks!",self,t5_2qp8q,1369004884.0,,,True,http://www.reddit.com/r/SQL/comments/1enpyd/sql_question_joining_two_tables_with_some_null/
1368783431.0,1eibxq,Visual SQL designer?,Penetal,1,0,2,"Hey I suck at SQL

I have tried mysql workbench

Is there a good option for beginners that run under Linux/debian? 

What are your favorite tools that can export to mysql and sqlite?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1eibxq/visual_sql_designer/
1368650793.0,1een29,What [MS SQL] or [Oracle] Certifications are worth getting?,NakedLoki,1,0,2,I've done some searching but I can never really tell what's worth getting and what's some no name website trying to make money.  Anyone have any recommendations?,t5_2qp8q,True
1368636030.0,1ee31k,"[MS JET SQL] ""Join Expression Not supported?"" help me fix this in ONE SINGLE QUERY PLEASE!",jesusw00t,1,0,16,"MY CODE (Im using MS Access 2000 with JET Database engine)

    SELECT Members.First_Name + ' ' + Members.Last_Name AS Member, Friends.Friend_E_Mail) AS E_Mail, Members.First_Name AS Name 

    FROM ((Members LEFT OUTER JOIN Friends ON Members.E_Mail = Friends.My_E_Mail AND   Friends.Friend_E_Mail = ?) 

    LEFT OUTER JOIN Friends Friends_1 ON Members.E_Mail = Friends.Friend_E_Mail AND Friends.My_E_Mail = ?)




My Tables
    Members(all VARCHAR)     SOME DATA
    First_Name               Alester Jude Carl Jones
    Last_Name                A       B    C    J
    
    FRIENDS(ALL VARCHAR)
    My_E_Mail               Alester@lam.com Alester@lam.com  Alester@lam.com
    Friend_E_Mail           jude@lam.com    carl@lam.com   jones@lam.com

   ***NOTE Friends Table ALLOWS duplicates so jude can be on my_E_Mail but CAN NOT add alester because they are already friends.


Desired Output if (""?"" in above query is: jones@lam.com)

    +--------------+-----------+------------+
    |Member        |E_Mail     |  Name      |
    +---------------------------------------+
     Alester A   Alester@lam.com  Alester




Desired Output if(""?"" in above query is: Alester@lam.com)

    +--------------+-----------+------------+
    |Member        |E_Mail     |  Name      |
    +---------------------------------------+
     Jude B        jude@lam.com  Jude
     carl C        carl@lam.com  Carl
     Jones J       jones@lam.com Jones

PS the ""?"" are query string parameters that im passing in the ""?"" i know that works fine. 
 

MY QUESTION IS : i keep getting this error ""Join Expression not Supported"" 

is their a work around query i can use without using a stored procedure or using multiple queries since this needs to be ONE SINGLE QUERY!?

Thanks.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1ee31k/ms_jet_sql_join_expression_not_supported_help_me/
1368559188.0,1ebzq9,[JET SQL] help me with this SQL statment access 2000,jesusw00t,1,0,3,"this Query Dose NOT work in Access 2000

    SELECT (Members.First_Name + "" "" + Members.Last_Name)AS Member
    (
    (SELECT Friend_E_Mail
    FROM    Friends
    WHERE My_E_Mail = ? and Friend_E_Mail &lt;&gt; ?
    UNION ALL
    SELECT My_E_Mail
    FROM  Friends
    WHERE  Friend_E_Mail = ?and My_E_Mail &lt;&gt; ?)) AS E_Mail
    (Members.First_Name) AS Name

    FROM Members

 Sample Tables
   
    Members(all VARCHAR)     SOME DATA
    First_Name               Alester Jude Carl Jones
    Last_Name                A       B    C    J
    
    FRIENDS(ALL VARCHAR)
    My_E_Mail               Alester@lam.com Alester@lam.com   Alester@lam.com
    Friend_E_Mail            jude@lam.com carl@lam.com jones@lam.com


Desired Output if(""?"" in above query is: jones@lam.com)

    +--------------+-----------+------------+
    |Member        |E_Mail     |  Name      |
    +---------------------------------------+
     Alester A   Alester@lam.com  Alester




Desired Output if(""?"" in above query is: Alester@lam.com)

    +--------------+-----------+------------+
    |Member        |E_Mail     |  Name      |
    +---------------------------------------+
     Jude B        jude@lam.com  Jude
     carl C        carl@lam.com  Carl
     Jones J       jones@lam.com Jones
PS the ""?"" are query string parameters that im passing in the ""?"" i know that works fine. 
 

MY QUESTION IS : i keep getting this error ""Operation Not Allowed in Sub Query"" is their a work around query i can use without using a stored procedure?

Thanks.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1ebzq9/jet_sql_help_me_with_this_sql_statment_access_2000/
1368543065.0,1ebemd,[HeidiSQL/Python+MySQLdb] How to join prices from one table into another table for specific dates?,ridetherhombus,1,0,2,"I'm pretty new to SQL. I need to take data from one table and add it to another table based on the date and then multiply the price by the amount purchased. The first table is very small compared to the second.

**Table 1: year, price**

**Table 2: customer, day, amount**

I'm trying to get to...

**Table 2: customer, day, amount, price, amount*price**",,False,t5_2qp8q,True
1368195688.0,1e2iin,[MSSQL] Is it possible to apply a Mask to add leading zeros?,Groty,2,1,5,"I have a rather large dataset loaded into a new table.  First time working with this new set.  It was pulled out of SAS then imported into MSSQL.  The problem I have is that our Customer Account Numbers are 11 digit numerics. I have them stored as varchar's because of leading zeros.  Unfortunately

Is there a way to Mask the Customer Account Number within the query,,False,self,t5_2qp8q,False,,True
1368041163.0,1dy7wk,"I want to make 80 tables into one effectively, and can't figure it out. Need help.",Terzelius,2,1,http://www.reddit.com/r/SQL/comments/1dy7wk/i_want_to_make_80_tables_into_one_effectively_and/

I have 80 similar tables. They all have the same columns

I know I can just do INSERT INTO for each table

I'm working in Postgres.
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1dy7wk/i_want_to_make_80_tables_into_one_effectively_and/
1367945629.0,1dvdc1,[PostgreSQL] Implementing Tagging with Arrays,netghost,1,0,0,,t5_2qp8q,False
1367345940.0,1dfcb4,Still learning SQL if you dont mind sparing knowledge please help.,BlameTheAirForGossip,1,0,8,"I am working on homework and I am confused as to what it is asking me to do. The problem states:

5)	Rename the SaleBuyerID field in the SALE table to SaleCustID.  This code is not covered in the book but you should simply substitute the actual names into the code below.  Substitute the actual table for TABLE and the actual field for Field.  The first ‘TABLE.field’ will be the name of the table and old field and the second ‘Field’ will be the name of the new field.  Everything else must stay the same.   (1 pt)

sp_RENAME 'TABLE.Field'

What is placed in the Column Field? I am assuming SALE.SaleBuyerId=TABLE.Field and the SaleCustId=Feild but what is Column?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1dfcb4/still_learning_sql_if_you_dont_mind_sparing/
1366595344.0,1cu4ty,[MS SQL] I don't know what this error means,rossi1592,2,1,8,"I keep getting an error when ever I try and try and do an insert statement. I know it has to do with the Foreign Key but don't know how to fix it. 

Error: http://i.imgur.com/oGhWB06.jpg ",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1cu4ty/ms_sql_i_dont_know_what_this_error_means/
1366377858.0,1cobmp,How DO you normalize an existing database?,DerManiac,2,1,16,"This may sound like a silly question

I know normalization. I know how to design and create a normalized database. I've been recently given 7 excel sheets with about 10

First thing I did was examine the data and create an EER diagram of how I imagined the final database should look like (in th 5NF). Luckily the data I got was already in the 1NF

But.. how do I bring this data into the 2NF or 3NF - into the format I designed before? Are there any tools that can help me do that? In other words: How do I import this unnormalized data into my normalized database?

The main question basically is: Do I really have to do that all by hand? Or is there some kind of tool that let's me ""map"" the data onto my normalized scheme? Or maybe someone just knows some small tipps or tricks that can make the job a little bit less tedious?

**TL;DR:** How to convert existing data into a normalized form without doing it all by hand?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1cobmp/how_do_you_normalize_an_existing_database/
1366335305.0,1cne79,Succinct list of what doesn't work with Merge Replication,jersully,3,2,1,"I'm a sysadmin

We write and sell software which is specific to our industry and a front-end to SQL data. I've already explained to our software support folks that they need to prepare themselves to re-think all their SQL scripts.

For their sake, but my Google Fu failed me.

I promise I'm not a complete idiot,False,self,t5_2qp8q,False,,,t3_1cne79
1366305103.0,1cm79w,Why does UNION ALL seem to wait for both queries to finish before start streaming rows?,ysangkok,1,0,0,,t5_2qp8q,False
1366149398.0,1chn9l,how do I fix the syntax here?,helpprogram2,4,3,2,"    create table temp
    
    
    Select title
    From book
    Where book.bookcode = inventory.bookcode AND
    book.publishercode = @publishcode
    Group by book.title
     
    
    set @Booktitle = 
    (select title 
    From temp
    Where BigSum = (Select max(BigSum)
                   From temp))",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1chn9l/how_do_i_fix_the_syntax_here/
1366045992.0,1cee6k,[MS SQL] Help Inserting a File into the database,dobby_resurrected,1,0,3,"I have searched a lot of places but I cannot get this done. 

My client has a database where files are stored in the database as varbinary(max). I can't seem to convert my file into varbinary(max) to insert into the db.

I am using php to read the file. Here is my code:

    $fp = fopen ($file_data
    $file_content = fread($fp
    fclose($fp);
       
    $insert=""INSERT INTO table(file_data) 
        VALUES('CONVERT(varbinary(max)
    $res = mssql_query($insert
    ",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1cee6k/ms_sql_help_inserting_a_file_into_the_database/
1365598304.0,1c25ho,"[MS SQL] Breaking a MSSQL Cluster, suggestions / pitfalls?",stalinusmc,2,1,http://www.reddit.com/r/SQL/comments/1c25ho/ms_sql_breaking_a_mssql_cluster_suggestions/

We currently have a SQL cluster in a physical environment, to better manage. We currently have one node controlling the file aspect, and another node controlling the database. From what I gather, typically both nodes usually share these roles, ours do not. We need to have them retain the same server names (if it is possible) to minimize impact to the rest of the environment. 

What is the best way of going about breaking them out? Should we build whole new servers

I have done some googling, would those jobs transfer as well?

http://itknowledgeexchange.techtarget.com/itanswers/how-to-move-sql-server-clustered-instance-to-a-seperate-stand-alone-server/

http://social.msdn.microsoft.com/Forums/en-US/sqlsetupandupgrade/thread/5e3da872-4eb4-4a5b-857e-b46e9d3802b5

I apologize for the rambling,,False,self,t5_2qp8q,False,,True
1365098181.0,1boana,Why MySQL Performance at Low Concurrency is Important,strangeloops,2,1,0,,t5_2qp8q,False
1365004732.0,1ble6o,[Oracle] Selecting a variable column based on the value in a different table,automounter,2,1,9,"I apologize up front for posting a question to your subredit.  I'm not asking you to do my schoolwork or anything

I am working with a turnkey solution where the schema is what it is.  I have also changed the actual table and column names to make it more readable.

In the case I am working with, ""value3""...  Then there is a 3rd table that consists of what each column represents.

    MAINDATA
    	MAINID
    	USERNAME
    	METARECORDID
    METAATTRIBUTESRECORD
    	METARECORDID
    	VALUE14 (i.e. ""42101"")
    	VALUE20 (i.e. ""XYZ123"")
    METAATTRIBUTEDEFINITION
    	NAME (i.e. ""Zip Code"" or ""License Plate"")
    	COLUMNID (i.e. ""14"" or ""20"")
    
So

This could be achieved programmatically

Anyone tips or references on how to do this would be greatly appreciated.",self,t5_2qp8q,1365007406.0,,,True,http://www.reddit.com/r/SQL/comments/1ble6o/oracle_selecting_a_variable_column_based_on_the/
1364933478.0,1bjd7u,SQL *Plus Function,varnecr,2,1,2,"Is there a reason why my system account is not listed when I try and generate the listing of users assigned the sqlplus function? I'm using the query ""select * from product_profile""",t5_2qp8q,True
1364859048.0,1bh0a1,Biggest SQL Disasters [infograph],udelblue,8,7,3,,t5_2qp8q,False
1364374231.0,1b3njj,[Postgres] Quick and simple index question..,hirolau,2,1,2,"Trying to optimize some quires I have got my hands on.

I see a lot of:

Create index ix1 on table(a)
Create index ix2 on table(b)
Create index ix3 on table(a

Now

Does anyone know how (if at all) much better ix3 is compared to ix1 and ix2 on a join using both a and b? Time to get some empirical data!
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1b3njj/postgres_quick_and_simple_index_question/
1364315862.0,1b1s8x,Code Management,sqldiaries,1,0,9,"My boss has asked me to look into finding some kind of ""code management"" solution for all of our SQL scripts.

Currently they all exist as simple text files either on the Department network share

We'd like something that supports NT security (so we don't have to remember yet *another* username/password)

I've never used any kind of CVS/SVN in the past (and perhaps those aren't the right terms), and I'm not sure that it would work as it appears to be mostly CLI-based, which isn't going to work for our group.

I'd love to hear what other folks are using!",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1b1s8x/code_management/
1364239463.0,1azon2,[MS SQL] Dynamic Row Filtering that is on demand,mandlebar,1,0,1,"I am a C# Web Developer with limited/moderate knowledge of MSSQL.
MS SQL 2008 R2
Our existing solution involves a single large (1 TB) database table that we are replicating to a local subscriber database for use with the web service.
We are currently using MSSQL Transactional replication with a simple row filter that only replicates rows based on a certain column. (only pull records that are linked to certain companies)

The problem is that we have a new need to be able to change the list of companies dynamically

Is there an elegant database replication/caching solution that we can use that can replicate data on demand

So for example

    A request is made to check the data of company A. 
    Company A is in list and is kept locally in the subscriber database
    A request is made for company D
    Company D is added to the row filter and replicated to the database subscriber.  
    Company D is added to the row filter list.
    Company D's data will continue to be replicated to the subscriber database for any future calls.


All of this logic would have to originate and be controlled by the subscriber side
",self,t5_2qp8q,1364239708.0,,,True,http://www.reddit.com/r/SQL/comments/1azon2/ms_sql_dynamic_row_filtering_that_is_on_demand/
1364237309.0,1azltl,[MySQL] Intermediate SQL help?,ffxpwns,2,1,8,EDIT: nevermind,t5_2qp8q,True
1364224361.0,1az5na,Calling all SQL Gods,paddyman123,2,1,5,"Having issues with SQL LOG shrinking

BACKUP LOG [SharePoint_Config_29c26fca-17b8-48c1-9704-b869932abcb6] TO DISK=’c:\backup-sql\config.bk’

Msg 102, Line 1 Incorrect syntax near '’'.

Any idea where I'm going wrong? I'm not entirely sure if you can backup logs back to the host drive? They don't use SQL so its just taking 20GB worth of space and bugging the hell outa me.

Just need to shrink it rather than delete it.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1az5na/calling_all_sql_gods/
1363884684.0,1aqoru,[MySQL] Basic database design questions,arexious,1,0,1,"I'm currently in an introductory MySQL database programming course and we have a course project in which we need to design a database for a small business.  The business rents out party supplies to local businesses as well as individual local clients.  

I'm having a couple of issues with my database structure that I was hoping some of you could help me with.  I'd like to add that we have not yet discussed creating functions, or loops.  We just recently went over normalization and basics of DB design.  We are only required to design our DB up to the third normal form. 

One of the requirements is that we must store how the customer paid, whether or not the check bounced.  Here is where I'm starting to get a bit lost.  [This](http://arexius.com/favorites/structure.jpg) is how my table structure currently looks.  As you can see my payments table contains a ""check_bounced"" boolean.  Regardless of whether someone pays using a check or not, it will still store a value for whether or not the payment check bounced.  I considered making a table to specifically store which payment_id's bounced like so:

    CREATE TABLE IF NOT EXISTS bounced_checks
    (
    payment_id    INT

    CONSTRAINT bounced_checks_fk_payments
        FOREIGN KEY (payment_id)
        REFERENCES payments (payment_id)
    );

It seems a bit odd to only store one INT on a table and not have anything in it but a foreign key.  Would this be a more efficient way of doing it


The other issue I've come across is I'm not sure where the most efficient place to store my invoice_total would be.  Either way it will have to be calculated based on how many items are being rented, and if returned late i'll have to account for that as well.  I'm assuming I'll use a procedure for the calculations, although I'm not sure yet.  Here's a sample of how the system works based on the [current database structure](http://arexius.com/favorites/structure.jpg):

    INSERT INTO general_invoices VALUES (DEFAULT, DEFAULT);
    INSERT INTO invoice_item_rental VALUES (DEFAULT, 3, 1, '2013-03-11', '2013-03-15', DEFAULT);
    UPDATE inventory SET item_quantity_out=(item_quantity_out+3) WHERE item_id=6;
    UPDATE inventory SET item_cumulative_rentals=(item_quantity_out+3) WHERE item_id=6;
    UPDATE general_invoices 
    SET invoice_total = invoice_total +
    (
    (SELECT item_quantity*(rental_return-rental_pickup) FROM invoice_item_rental WHERE invoice_item_id=1)
    *
    (SELECT item_cost FROM inventory WHERE item_id=6)
    )
    WHERE invoice_id=1;

That would create the general_invoice

Sorry for the wall of text and thanks in advance for anyone who is willing to help me out.

",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1aqoru/mysql_basic_database_design_questions/
1363877705.0,1aqgao,Help a newbie subtract sales tax from the invoice amount,Excel__,1,0,12,"[MS SQL]

Beforehand

I've got a spreadsheet that has a query that pulls the invoice amount from a table. This is DBO.a_invoice.totalship_amount

In another table

The connection between the two tables is between:

DBO.a_invoice.invoice_number

and

DBO.a_acct_trans.main_key

Where the main_key contains the invoice number the transaction relates to.

So in the query, but substract the cr_amount if the keys match.

So far

INNER JOIN DBO.a_acct_trans ON DBO.a_invoice.invoice_number = DBO.a_acct_trans.main_key

SELECT DBO.a_invoice.totalship_amount - DBO.a_acct_trans.cr_amount

But I'm getting an error saying I have a syntax error near ""FROM"" and near ""DBO""

Any way you guys can hep? Thanks again.

**EDIT** Code. I apologize if it's messy. It's not my code. I'm just trying to learn how to modify it.

    SELECT DBO.a_credit_memo.credit_memo_number 

    -DBO.a_credit_memo.credit_amount+DBO.a_credit_memo.sales_tax_amount 

    DBO.a_credit_memo.invoice_number

    DBO.a_invoice.job_no, 

    DBO.a_proj_setup_new.budget_name

    FROM DBO.a_credit_memo 

    INNER JOIN DBO.a_invoice ON DBO.a_credit_memo.invoice_number = DBO.a_invoice.invoice_number 

    INNER JOIN DBO.a_proj_setup_new ON DBO.a_invoice.project_no = DBO.a_proj_setup_new.project_no 

    INNER JOIN DBO.a_salesrep ON a_proj_setup_new.sr_proj_mgr = a_salesrep.salesrep_no 

    WHERE (((DBO.a_credit_memo.date_issued)&gt;'12/31/2012') AND (DBO.a_credit_memo.date_issued)&lt;'01/01/2014')
    UNION    

    SELECT DBO.a_invoice.invoice_number , 

    DBO.a_invoice.invoice_number, 

    DBO.a_invoice.approved,

    DBO.a_proj_setup_new.program_name   

    FROM DBO.a_invoice 

    INNER JOIN DBO.a_proj_setup_new ON DBO.a_invoice.project_no = DBO.a_proj_setup_new.project_no 

    INNER JOIN DBO.a_salesrep ON a_proj_setup_new.sr_proj_mgr = a_salesrep.salesrep_no 

    WHERE (((DBO.a_invoice.invoice_date)&gt;'12/31/2012') AND (DBO.a_invoice.invoice_date)&lt;'01/01/2014');",self,t5_2qp8q,1363879401.0,,,True,http://www.reddit.com/r/SQL/comments/1aqgao/help_a_newbie_subtract_sales_tax_from_the_invoice/
1363191425.0,1a800n,"SQL Server 2012
",6,4,http://www.reddit.com/r/SQL/comments/1a800n/sql_server_2012/,"Anything to be wary of thinking of upgrading soon.
DB is around 700GB of important non transactional data mostly used for BI purposes.

",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1a800n/sql_server_2012/
1363103323.0,1a5gz5,[MySQL] At my work we use SQL to bring up information about invoices from our server...is there any way to then mass edit information about those invoices once they are brought up or is that not possible?,aporcelaintouch,1,0,9,,t5_2qp8q,True
1363016290.0,1a3422,SSRS Help on Filtering [TSQL],chairdeskphone,1,0,3,"Is there a value in the Value field I can entered which will mean the user can select all as an option for a filter and is there a value in the Value field which can be entered which would all the user to filter for items in the column which begin with a specific letter such as “A”?  
[Example](http://postimage.org/image/imkq7nlo5/)
An example would be if there is Adam, Candy, and Will in a column.  They could either select all or filter for names beginning with A.  
FYI I could not find a SSRS forum so if there is a better place for me to post


",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1a3422/ssrs_help_on_filtering_tsql/
1362869014.0,19zrck,"[]MySQL]Query help, finding total hours worked.",Not_Hulk_Hogan,2,1,http://www.reddit.com/r/SQL/comments/19zrck/mysqlquery_help_finding_total_hours_worked/

Actually I just tried:

    Select  EmployeeNumber
    From assignment a
    Where a.EmployeeNumber = a.EmployeeNumber
    Group by a.EmployeeNumber;

and it seemingly worked? Does that make sense? I did not expect it to. ",self,t5_2qp8q,1362869346.0,,,True,http://www.reddit.com/r/SQL/comments/19zrck/mysqlquery_help_finding_total_hours_worked/
1362063677.0,19ebup,Is this Update Syntax correct - replacing nulls with 0,mmohon,2,1,7,"I'm doing:

Update table

Set Field1 = IsNull(Field1



Or should I be doing:

Update Table1

Set Field1 = Case When IsNull(Field1) Then 0 Else Field1 End",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/19ebup/is_this_update_syntax_correct_replacing_nulls/
1361568204.0,191l7a,How Does Bulk Insert work - Udating vs Appending?,mmohon,1,0,3,"I have 4 years of big files, there would be over lapping records for 3 quarters.  There is a primary key.

Will the bulk insert straight into the table ""update"" where the key is already there and ""append"" when it doesn't find a key?

Or should I bulk insert into a temp table,,False,self,t5_2qp8q,False,,True
1361553831.0,1913ox,Need help with a case statement [ms sql],tedistkrieg,1,0,5,"I have two columns MachineDescription
    

    SELECT CASE WHEN MachineTypeID='5010' 
    THEN change MachineDescription to Siberian Storm 
    ELSE md-multigame

or something like that. ",self,t5_2qp8q,1361554027.0,,,True,http://www.reddit.com/r/SQL/comments/1913ox/need_help_with_a_case_statement_ms_sql/
1360244556.0,182av0,[Oracle] First function attempt. Need help with the bugs,Cat_friendly,3,2,6,"***SOLVED/FIXED*** Thanks to CubedCodeMonkey and trane_0

I found the following function to subtract number of holidays and week days between two dates. I have tried to modify it so that I can use it in Oracle but have been unable to get past the many errors. Any help would be appreciated!  I think the problem is with declaring the temp vars.  

 

    CREATE OR REPLACE Function WeekendOrHolidaysInDateRange 

    (
    pi_StartDate  IN DATE
    pi_EndDate   IN DATE
    )
    RETURN INT
    IS v_TotalDays INT;



 
  
    v_TotalDays  INT;
    v_dayOfWeek  INT;
    v_Count  INT;
    SET v_totaldays := 0;
    BEGIN     
        
    WHILE (pi_StartDate &lt;= pi_EndDate) LOOP

        --work out what day of the week the start date is
        v_DayOfWeek := DATEPART(dw
       IF (v_dayOfWeek = 6 OR v_dayOfWeek = 7) THEN --sat or sunday
            v_TotalDays:=v_TotalDays +1;
       END IF;
        
        SELECT   count(*) AS v_Count
        FROM holidays WHERE holiday_date = pi_startDate;
        
        IF (v_Count &gt;=1) THEN
            v_TotalDays := v_TotalDays +1;
        END IF;
       pi_StartDate := DateAdd(day
        
    END LOOP;

    RETURN v_TotalDays;
    END WeekendOrHolidaysInDateRange;
",self,t5_2qp8q,1360262340.0,,,True,http://www.reddit.com/r/SQL/comments/182av0/oracle_first_function_attempt_need_help_with_the/
1360004788.0,17vq2v,Bulk Insert - Format File - issues with nulls &amp;  dbl quote text,mmohon,1,0,8,"I have big chunks of data I move around and process.  The file comes to me comma delimited

Anyways, but it can be: ,""text"",

My file goes for "",""  is there a way that SQL can get smart and determine that? ",,False,self,t5_2qp8q,False,,
1359844282.0,17rx2u,Upgrade path from MCTS 70-433,carlhunt3r,2,1,3,"Does anyone know the SQL Server 2008 to SQL Server 2012 upgrade path for microsoft certifications? I'm about to take the 70-433 exam for the second time,False,
1359619127.0,17mb6j,[MySQL] Application Error ,d4rwins_chap,1,0,1,"Im attempting to configure a server for a game I play however when attempting to modify any values for the admin panel I receive the following error 

[Application Error](http://i.imgur.com/L7e5eTq.png)

after quick googling I find no real aide in working this issue..

if you have any questions  regarding my system please let me know


thanks",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/17mb6j/mysql_application_error/
1359056539.0,177gi6,[MS SQL 2005] Help searching a value in fields with many comma delimited values,calu1986,2,1,7,"Field ""Account"" allows one numerical value to be stored in it.

Field ""Key"" allows many comma delimited number values (keys) to be stored in it. 

e.g. Key = 1

I want to select an ""Account"" that has the number ""2"" in one of the values found inside ""KEY""

Kind of like 

    select top 1 Account from TABLE where Key = '2'
(I know this query will return nothing

Is there a query/anything that would allow me to do what I just described?


**EDIT** this is not the design of the table
",self,t5_2qp8q,1359063115.0,,,True,http://www.reddit.com/r/SQL/comments/177gi6/ms_sql_2005_help_searching_a_value_in_fields_with/
1359050538.0,1778tt,"[MS SQL]Merging 2 tables, updating FKs",TL-PuLSe,1,0,http://www.reddit.com/r/SQL/comments/1778tt/ms_sqlmerging_2_tables_updating_fks/

Due to an error

We're using incremental integer Id columns as the PKs.

So

TABLE A
-------
Id    Data  
--    ----
1      a  
2      b  
3      c  

TABLE A_BAK
-------
Id    Data  
--    ----
1      z  
2      x  
3      y  

TABLE B_BAK
-------
Id    A_BAK_FKey  
--    -----------
1      1  
2      2  
3      3  

I need to insert the data in A_BAK into A, in this example, 4, 5, and 6.

TABLE A
-------
Id    Data  
--    ----
1      a  
2      b  
3      c  
4      z  
5      x  
6      y  

TABLE B
-------
Id    A_FKey  
--     ------
1        4  
2        5  
3        6  
The two ideas I'm bouncing around are using a cursor to insert into A, get the IDENT_CURRENT(A), and add that to the value of FKeys in B_BAK when inserting into B (so, FKeys = (3+1, 3+2, 3+3))

Can anyone suggest a better way? The system will be live and trying to insert into the database

Thank you!",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1778tt/ms_sqlmerging_2_tables_updating_fks/
1359046441.0,1773tj,Cumulative Update – 9 for SQL Server 2008 Service Pack 3 Is Now Available !,rohitga,1,0,0,,t5_2qp8q,False
1359034550.0,176s66,[Oracle] Constraint which tests data already in table,tk338,1,0,3,"Hi

The table I'm responsible for has to keep a record of meetings for clients who will be inserting values into it. 

Meetings cannot be scheduled at the same time. 

With relevance to time

If say for example the table had...

m_date: 05/05/2013 
s_time: 1300
e_time: 1500

...noone should be able to enter a meeting which would start or end between 1300 and 1500 on 05/05/2013.

If anyone had any ideas as to how this could be done I would be very grateful. My pseudo code-esque solution for a table constraint was:

    IF entered_m_date = col_m_date THEN
         CHECK((entered_e_time &lt; col_s_time) OR (entered_s_time &gt; col_e_time))
    END IF

I understand this probably makes very little sense

Once again I would very much appreciate any help you guys could offer. 

Thank you.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/176s66/oracle_constraint_which_tests_data_already_in/
1358976483.0,175ae4,[MS SQL08 SSRS] How to properly format a column with calculated percentage value,OK_now_what,1,0,2,"Good afternoon all

To summarize

I want to calculate percentage as (sales-cost)/sales = GM%

The expression I'm using is:
=(SUM(Fields!Sales.Value)-(Fields!NetCost.Value))/(Fields!Sales.Value)

The problem is if sales is zero and cost is &gt; 0

.... I'm not sure how to get rid of those with SSRS and replace them with zeros. 

I know how to do it in Excel
=IF(A1=0,False,self,t5_2qp8q,False,,,t3_175ae4
1358974361.0,1757g5,[MS SQL] Need help with query using joins,OrinMacGregor,1,0,4,"SQL isn't really my thing

I have 2 tables

I need to return the results from Details where the DockIDs have the same WarehouseID as a DockID that's been provided (let's just call that @provided).

Sorry if this is a very elementary operation,False,self,t5_2qp8q,False,,,t3_1757g5
1358373100.0,16pk10,[TSQL]-Need help with case statement construction,kingmikolaj,1,0,2,"Trying to convert this portion of nested if statements into a case statement. Any help would be much appreciated :)
Here is portion of nested if:

IF @isACMJob =1   
BEGIN

IF @currentjoblength &gt; @minutelimit
BEGIN
SET @minutelimit = CAST( @minutelimit as varchar(max))
SET @subj = 'ERROR: ACM Job (AutoSearch) ran for too long'
SET @imp = 'HIGH'
SET @msg = '&lt;strong&gt;&lt;span style=""color: red""&gt;&lt;strong&gt;**Client Auto Search Job ran for ' + @minutelimit + '. Client Auto Search Job ran for too long.**&lt;/span&gt;&lt;/strong&gt;'
					
END
			
ELSE(...nested loops continue)

Here is what i have in terms of case so far:

CASE WHEN 
        @isACMJob=1 
AND(not sure if i can use and) WHEN 
        @currentjoblength&gt; @minutelimit
THEN 
SET @minutelimit = CAST( @minutelimit as varchar(max))
SET @subj = 'ERROR: ACM Job (AutoSearch) ran for too long'
SET @imp = 'HIGH'
SET @msg = '&lt;strong&gt;&lt;span style=""color: red""&gt;&lt;strong&gt;**Client Auto Search Job ran for ' + @minutelimit + '. Client Auto Search Job ran for too long.**&lt;/span&gt;&lt;/strong&gt;'",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/16pk10/tsqlneed_help_with_case_statement_construction/
1358269596.0,16mjpm,[MS SQL] best way to do a delete when needing to join tables?,whoisearth,2,1,4,"[RESOLVED] - my second script did work I just hadn't tested it yet.

I figured out how to do it when I'm just joining to 1 table by doing an ""ANY"" command.  ie - 

    DELETE FROM table1
    	WHERE column_id=ANY(
    	SELECT column_id FROM table2 WHERE table1.join_id = table2.join_id AND table2.fordelete_yn = 'y')

Unfortunately I'm stuck on the following - 

    DELETE FROM table3
    	WHERE column_id=ANY(SELECT column_id FROM table1
    	JOIN table2 ON (table1.join_id = table2.join_id)
    	WHERE table2.fordelete_yn = 'y')",self,t5_2qp8q,1358272930.0,,,True,http://www.reddit.com/r/SQL/comments/16mjpm/ms_sql_best_way_to_do_a_delete_when_needing_to/
1357892941.0,16dcrm,[MS SQL] I need to group these line items so that the Values are combined. Help!,smellycooter,1,0,16,"So my code involves 4 tables which i have joined, and partid

    SELECT CAST(C.custid AS CHAR(5)) AS ""Customer ID""
	     
	     ,2)  AS ""Total Value""

    FROM Customers AS C 
    JOIN Orders AS O
    ON C.custid = O.custid
    JOIN OrderItems AS I 
    ON O.orderid  = I.orderid
    JOIN Inventory AS V
    ON I.partid = v.partid
    group by C.custid, V.price

the results are:

    Customer ID Customer Name        Total Value
    ----------- -------------------- -----------
    1           Stanwood Consulting   80.00
    1           Stanwood Consulting    7.50
    1           Stanwood Consulting   22.50
    1           Stanwood Consulting   75.00
    1           Stanwood Consulting  210.00
    2           Vallecito Industries  10.00
    2           Vallecito Industries  12.50

 and so on

I need these grouped in single totals per customer,False,self,t5_2qp8q,1357893144.0,,,t3_16dcrm
1357873408.0,16cubt,Perspectives on LedgerSMB: An awesome one-liner for PostgreSQL,einhverfr,1,0,0,,t5_2qp8q,False
1357659757.0,166qxe,[Oracle] A question about declaring columns as number,just_dig_in,1,0,4,"I have searched this subreddit and googled the internet at large and have not found an answer to this.

Which would be the best way to build a table with an id column?

create table mytable1 (
  mytable1_id number);

create table mytable2 (
  mytable2_id number(p

I have seen  both examples and have not found an indication of which would be preferred.

It seems to me a benefit of #1 would be no artificial upper bound. Whereas a benefit to #2 is a known upper bound. Is that correct? Are there any other benefits or reasons why one method would be preferred over the other?

thanks for your time!
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/166qxe/oracle_a_question_about_declaring_columns_as/
1356540605.0,15h1ek,[Oracle] to [MS SQL] table synchronization,devilized,2,1,4,"I have a MS SQL database (run by someone else) that contains data that I need to import into my own Oracle database. The table in question contains a few hundred-thousand rows

A couple of ideas I had were:

-Create a temporary table in Oracle to store the data from MSSQL

-Use a synchronization script to grab all of the data from MS SQL and use already-written PHP functions to verify/update the data row by row. I imagine this would probably take a long time and a bunch of memory. 

Any other ideas

Thanks in advance for any advice. ",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/15h1ek/oracle_to_ms_sql_table_synchronization/
1355501496.0,14uilm,Somebody please help me with my SQL extra credit assignment,Jboi23,3,2,5,"I am taking a intro to database course and even though we haven't gotten far in covering SQL my professor assigned a extra credit sql project. Im having some trouble answering some of the questions and wanted to see if this subreddit could help a brother out. 

Consider the following relational database:

branch(branch name
customer(customer id, customer city)
account(account number
depositor(customer id

1.	 Identify an appropriate primary key for each relation schema. 

**the customer id and account number form the primary key**


2.	 Identify all of the foreign keys. (5%

**Branch Name**


 
3 Give an SQL data definition of the above database (i.e.
 
4.	 Find the names of all depositors who have an account with a balance greater than $6

5.	 Find the account numbers of all joint accounts (i.e.


6.	 Find the identifiers of all customers who do not own any account (assume that customer information is kept even if customers close accounts


7.	 Find the identifiers of all depositors who have an account with a higher balance than any account (i.e.

8.	 Find the identifiers of all depositors who have accounts at all branches in the city of 'Albany'. (10%)

9. Update the balance of each account as follows. If the balance of an account is less than $100, increase the balance by 1 percent. (10%)
Find the names of all customers who do not have any account (








",self,t5_2qp8q,1355503857.0,,,True,http://www.reddit.com/r/SQL/comments/14uilm/somebody_please_help_me_with_my_sql_extra_credit/
1355242652.0,14o4qm,[Oracle] Need a second set of eyes - ORA-00936: missing expression during update,rbartlejr,2,1,15,"I'm attempting to update a field with selects from another table and concatenations. It's erroring on the first select but when I cut and select that single select it works ok. I'm fairly new to Oracle and could use a little help. Here is the update with the error:

    UPDATE
      SA_ASSET
    SET
      ASSET_DESC = TRIM(ATTRIBUTE1)
      || ' - Service Type: PW
      || TRIM
      (
        SELECT
          d.ATTRIBUTE_VALUE
        FROM
          SA_SPECIFICATION_DETAILS d
          SA_ASSET a
        WHERE
          d.SPECIFICATION_NO = a.SPECIFICATION_NO
        AND d.ATTRIBUTE_DESC = 'MANUFACTURER'
      )
      || '
      || TRIM
      (
        SELECT
          ATTRIBUTE_VALUE
        FROM
          SA_SPECIFICATION_DETAILS d
          SA_ASSET a
        WHERE
          d.SPECIFICATION_NO = a.SPECIFICATION_NO
        AND ATTRIBUTE_DESC   = 'MODEL'
      )
      || '
      || TRIM
      (
        SELECT
           ATTRIBUTE_VALUE
        FROM
          SA_SPECIFICATION_DETAILS d
          SA_ASSET a
        WHERE
          d.SPECIFICATION_NO = a.SPECIFICATION_NO
        AND ATTRIBUTE_DESC   = 'MAIN VALVE SIZE'
      )
      || '
      || TRIM
      (
        SELECT
          ATTRIBUTE_VALUE
        FROM
          SA_SPECIFICATION_DETAILS d
          SA_ASSET a
        WHERE
          d.SPECIFICATION_NO = a.SPECIFICATION_NO
        AND ATTRIBUTE_DESC   = 'YEAR MANUFACTURED'
      )
      || '
      || TRIM(SA_ASSET.STREET_NUMBER_CHAR)
      || ' '
      || TRIM(SA_ASSET.STREET_NAME)
    WHERE
      ASSET_TYPE     = 'HYDRANT'
    AND ASSET_STATUS = 'ACTIVE'
    AND UPPER(ASSET_DESC) NOT LIKE '%LOCATION:%'
    AND UPPER(ASSET_DESC) NOT LIKE '%HYDRANT%'
    AND SA_ASSET.ASSET_ID = '006130'

Error at Command Line:8 Column:5
Error report:
SQL Error: ORA-00936: missing expression
00936. 00000 -  ""missing expression""
*Cause:    
*Action:
    ",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/14o4qm/oracle_need_a_second_set_of_eyes_ora00936_missing/
1355165928.0,14m8hh,[MS SQL 2005] Update Temporary Table (Column of NULL) With Row Numbers,softball753,2,1,1,"/SQL

Essentially, column 2 is an identity(1,1) column, and column 1 is NULL from the get go.

I perform an operation that inserts data into column 3, which was NULLs up until this point, with integer row numbers.

To put is visually

    NewID       OldID (iden)      Data
    NULL        1                 Data-A
    NULL        2                 Data-B
    NULL        3                 Data-C
    NULL        4                 Data-D
    NULL        5                 Data-E
    NULL        6                 Data-F
    NULL        7                 Data-G
    NULL        8                 Data-H

I filter the data and get this:

    NewID       OldID (iden)      Data
    NULL        1                 Data-A
    NULL        2                 Data-B
    NULL        3                 Data-C
    NULL        5                 Data-E
    NULL        7                 Data-G
    NULL        8                 Data-H

This is easy. What I want is to update the table to get this:

    NewID       OldID (iden)      Data
    1           1                 Data-A
    2           2                 Data-B
    3           3                 Data-C
    4           5                 Data-E
    5           7                 Data-G
    6           8                 Data-H

I've tried all manner up updating the field using an self-JOIN and the ROW_NUMBER() function. But I can't seem to get it to work. Any advice on this? The only thing I can think of now is to create a second table, but it seems sloppy. I feel like I should be able in update the table from ""within.""

Thanks in advance for any help.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/14m8hh/ms_sql_2005_update_temporary_table_column_of_null/
1354899517.0,14g8ww,Help with REA diagram ,rembomart,1,0,1,"In given situation im having a hard time pining down events

Hart Supply Company is a wholesaler of plumbing supplies products that sells to construction companies. It carries an inventory of approximately 7, he or she is transferred to a sales agent, who takes the order. The fulfillment clerk picks the items in the order and packs them together in preparation for delivery. Orders are sometimes delivered in multiple shipments. Once the ordered items are loaded onto the truck, the billing clerk records the sale in the sales journal, prepares an invoice, and sends it to the customer, who is given 30 days to make payment. In order to reduce accounting errors, customers are not allowed to write a single check to pay off multiple invoices.  The AR clerk also receives a copy of the invoice and records it in the AR ledger. Subsequently (within 30 days), who updates (reduces) the customer’s account receivable. ",t5_2qp8q
1354827102.0,14eirp,Terrible Teacher. Need a good Youtube Tutorial,gamermonk,1,0,3,"Hey guys, I am in need of a good video tutorial / set of videos for learning SQL. Suggestions?",t5_2qp8q
1354691625.0,14b949,[WeBid] Is there any documentation on the WeBid database schema?,,4,3,0,My organization is looking to modify WeBid. We'd hate to write the documentation ourselves. (posted in both PHP and SQL),t5_2qp8q,True
1354626212.0,149daf,[Oracle] Count rows from query,Garix,3,2,8,"    select patient_t.firstname
      from patient_t
        where bed_t.bednumber=patient_t.bednumber
    and carecenter_t.carecentername='Emergency Center';

I have this query that returns a list of all patients that have been to ""Emergency Center"". How do I count those results?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/149daf/oracle_count_rows_from_query/
1354556210.0,147jii,Any recommendations for some Fuzzy Match software,borensoren,1,0,0,"So I recently lucked into a promotion

Our DBA here is of the mindset to want to ditch it all together and suggested I look into some other options...so y'all have any other options?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/147jii/any_recommendations_for_some_fuzzy_match_software/
1353712465.0,13osu0,"I need help writing a ""divide"" query in Access",percautio,1,0,8,"I'm taking my first course on info mgmt systems and am working on the final project - designing a student housing database using Microsoft Access.

Currently I'm having trouble designing a particular query. The relevant tables are UTILITY (only one column, PROPERTY_UTILITY (a gerund between a property and its offered utilities, with the columns ""PropertyID"" and ""Utility""), and USER_UTILITY (gerund between a user and their preferred utilities, with the columns ""Username"" and ""Utility"").

What I want to do with this query is show a list matching users to properties based on the utilities. In order to match, there would be a smaller circle called ""user utilities"" that is enclosed entirely in a larger circle called ""property utilities."") So the query should list every match between each user and any house that fits them.

I haven't been able to figure it out. When I asked my professor about it, so I have to work around it by doing something involving counts (I didn't quite follow what he was talking about and won't have a chance to ask again until next week).

I'm not sure I explained this very well (and if not I'll do my best to clarify)

**Tl;dr**: How do you approximate a ""divide"" in Microsoft Access?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/13osu0/i_need_help_writing_a_divide_query_in_access/
1352926462.0,1377zm,[MS SQL] Help With Recursive Table,mannheimroll,1,0,8,"I'm working with a conversion table which is, the recursive element only returns a set based on the last row

This is a mimic table I've been working with where the starting unitID is 5, but the statement is terminated due to it looping.
This is my first attempt at a Recursive table

Edit for spacing.

    
    create table #t(i_fk int null, u1_qty     float null, u2_qty float null)
    insert into #t values (1, 1, 2)
    insert into #t values (1, 3, 2)
    insert into #t values (1, 5, 3)
    insert into #t values (1, 3, 2)
    insert into #t values (1, 1, 5)
    insert into #t values (1, 1, 2)
    insert into #t values (1, 3, 2)
    insert into #t values (1, 4, 3)
    insert into #t values (1, 7, 2)

    insert into #t(i_fk, u1_qty, u2_qty)
       	(select i_fk
    			u2_fk
    			u1_fk
    			u2_qty
    			u1_qty 
    	from #t)
    
    ;with #cte(i_fk, MultFact, lvl)
    as

    (select i_fk
    		u1_fk
    		u2_fk
    		u2_qty/u1_qty
    		0
    From #t
    where u1_fk = 5

    UNION ALL

    select c.i_fk
    		c.u1_fk
    		t.u2_fk
    		c.MultFact * (t.u2_qty/t.u1_qty)
    		c.lvl+1
    From #cte as c
    join #t as t ON c.u2_fk = t.u1_fk 
    )

    select top 1 * from #cte
    where #cte.u2_fk = 7

    drop table #t",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1377zm/ms_sql_help_with_recursive_table/
1352861313.0,135rv8,Embedded Select statements within Functions?,firearmed,1,0,8,"Hi all

I have three tables: Movies
The Movies table keeps track of the movies on sale at a video store. Each record consists of a MovieID, genre, and price.

The Orders table keeps track of orders made by customers. The table consists of an OrderID, and the shipping address.

The Sales table is the link between the two and consists of OrderID, an order can be composed of several sales.

I've been asked to find the average number of DVDs sold per order. The only way I can think to do this with my current model is to take the average quantity per order, requires a nested select statement within the AVG function. Does the following snippet of SQL make sense?

SELECT AVG
	(
		(SELECT SUM(sales.quantity) 
		 FROM sales
		 WHERE sales.orderID = orders.orderID
		       AND movies.movieID = sales.movieID
		       AND movies.genre = ‘DVD’
		 GROUP BY orders.orderID)
	) AS ‘Average DVD Sales per Order’
FROM sales
WHERE ...

Thanks!
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/135rv8/embedded_select_statements_within_functions/
1352279174.0,12sf8z,Firebird 2.5.2 sub-release is available with many bugfixes,mariuz,3,2,0,,t5_2qp8q,False
1351992211.0,12lbdu,"Hi. The supervisor at my job says i should master that  ""SQL stuff"" so we can have a better grip on those websites we create with Joomla! - Any tips on where i should begin, good tutorials etc...? ",freefrompress,3,2,http://www.reddit.com/r/SQL/comments/12lbdu/hi_the_supervisor_at_my_job_says_i_should_master/,self,
1351683348.0,12e6no,SQLite - String Manipulation,myururdurmaz,2,1,0,,t5_2qp8q,False
1351285782.0,1256zm,[SQL Server] SSRS Parameter doesn't display even though the query works,BelgoCanadian,1,0,6,"I have a query to fill a report parameter:

    select distinct [Source No_] from _report_sales_master
    where [Industry] = @Industries
    and [posting date] &gt;= dateadd(year,@year)-1,'01/06/2000') 
    and  [posting date] &lt; dateadd(year,@year),'01/06/2000')
    order by [Source No_]

The query results in a list that I use to fill a multi-value report parameter.

When I run the query

When I run the report

When I remove the ""posting date"" clauses from the query

What am I missing?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/1256zm/sql_server_ssrs_parameter_doesnt_display_even/
1350593667.0,11pkhn,Can someone walk me through Transactions?,larg3-p3nis,4,3,8,"I looked at Transactions for the past few days and while I grasp the theory I'm having problems finding details on the implementation. For example the code below does not work as planned:

    START TRANSACTION;
    DELETE FROM PART WHERE Part_Code ='F';
    DELETE FROM PART WHERE Part_Code ='P';
    COMMIT; 

Even though the Part_Code 'P' does not exist the transaction will still be committed. My understanding is that the COMMIT command should be encapsulated in some conditional logic. So my question is how do I do that? 
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/11pkhn/can_someone_walk_me_through_transactions/
1350337979.0,11j8kt,How to Connect CentOS Web Server to a SQL Server,Petri_IT,1,0,0,,t5_2qp8q,False
1350000854.0,11c7vb,[MS-SQL] Any MS-SQL alternative for Netmask datatype from Postgresql?,saaadfaaace,2,1,2,"My shop supports My-SQL,False,
1349990411.0,11bwvu,Learning SQL,Wtgamerz,2,1,2,"I'm trying to make a transition from teaching to something within the IT world

I'm pretty knowledgeable with computers and most basic to intermediate programs within windows, etc. I took mainly comp sci courses in college before deciding to teach history/graphics design(photoshop). 

My real question is,,False,self,t5_2qp8q,False,,True
1349388712.0,10yl07,[Oracle] - How could I update the comment headers in objects with the build number during automated deploy from Hudson?,just_dig_in,1,0,4,"As a result of botched deploy and a 14 hour bailout operation this weekend

I am contacting old colleagues also

thanks!",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/10yl07/oracle_how_could_i_update_the_comment_headers_in/
1349358443.0,10xo53,[MSSQL] A question about use of XML schemas,taeratrin,1,0,1,"OK

1) A MSSQL database and working knowledge to pull the required data out of it.

2) A XSD file with several one-to-many relationships.

Here is what I don't have:

A working knowledge of XML.

Here's what I need:

A XML file populated with data from the database formatted according to the XSD.

My question: Is there an easy way to do this?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/10xo53/mssql_a_question_about_use_of_xml_schemas/
1349200166.0,10ts19,[MS SQL] Is it possible to create a cursor where one of the where criteria is based on local variable?,GoingHome,1,0,16,"If I declare first cursor as Select A1 from T1; and second cursor as Select col1

I'm getting Fetch_status of -1 on the fetch to the second cursor. What's the best way to go about it? See example code in comment.",self,t5_2qp8q,1349200645.0,,,True,http://www.reddit.com/r/SQL/comments/10ts19/ms_sql_is_it_possible_to_create_a_cursor_where/
1349055263.0,10qlvt,[MySql] Grouping two AVG as one field? ,omegawoot,2,1,9,"This is an example from an old homework which my professor never explained the answer to. How would one make two columns using calculated values? 

Like this:




* Display average income per-book for all award-winning books and the average income perbook for all non-award-winning books as a two-row result like this (yes and no are literals
$ replaced with values).

awardWinning | perBookIncome

___  | _____


yes         |         $$$$$


no   |  $$$$$

(Can't get the lines straight) *AwardWinning is when the book's ISBN appears in the awards category*

**EDIT. SCHEMA:**

____
     CREATE TABLE book( isbn CHAR(13) UNIQUE NOT NULL, category CHAR(20), price DECIMAL(5,2), unitssold INTEGER );
     CREATE TABLE author( isbn CHAR(13), state CHAR(2) );
     CREATE TABLE sale( isbn CHAR(13)
     CREATE TABLE award( isbn CHAR(13),False,self,t5_2qp8q,1349072789.0,,,t3_10qlvt
1349044717.0,10qbsn,Very Newb Question: Change physical width of column?,Pop-Shuvit,2,1,9,"Excuse me for the beginner question

This column is too narrow
Is this something I can fix by pressing a button within SSMS?

http://i.imgur.com/AnpLi.jpg",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/10qbsn/very_newb_question_change_physical_width_of_column/
1348882356.0,10nds9,MS sql server error,anon_610,2,1,3,"I recently started learning  ms sql and have no idea how to fix this error.  Although I set up sql express 2008 on my laptop,self,
1348784834.0,10l5ls,What is the best way to go about creating a script which switches between databases that are on the same server in SSMS [T-SQL]?  ,,1,0,12,,t5_2qp8q,True
1348239865.0,10910b,Opening a portion of a massive table in Access for querying,Deanicus,2,1,3,"I'm trying to open a massive data acquisition table off of our company server that's much too large to open the entire file,self,
1347488146.0,zsfkx,[MS SQL] Syncing Two MS SQL Servers,CaptainKirk0000,3,2,4,"I have an somewhat elaborate SQL problem that I could really use some help with. I am an electrical engineer

We use a certain engineering program that stores files in a network file folder

Here is the problem, so that it appears as if they are operating as one. Neither server should have priority, and the newest info should win. The engineering software itself cannot be changed, everything must happen on the server.

Any pointers on where to go with this? Bonus points if you can help me sync the file data as well.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/zsfkx/ms_sql_syncing_two_ms_sql_servers/
1346961509.0,zgryo,[MS SQL] Multiple Snapshot Help,Javadocs,1,0,0,"So, and the biggest database being 25GB. We'll be using pull subscriptions and will be running this at the early hours of the morning (only weekdays

My questions are the following:

* How long do the snapshot files take to initialize? How far apart should I space the initialization of the snapshot files?
* Which takes longer
* Depending on the size of each database
* Is it pretty much safe to pull data while initializing a snapshot? (for a different database

Let me know if you need any more details! Thanks in advance!",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/zgryo/ms_sql_multiple_snapshot_help/
1346930418.0,zg0qm,Is it possible to include and sql compact database in an executable windows form without having to install it?,awalkingabortion,1,0,4,"Hi all,False,
1346277618.0,z1jpb,Best equivalent to Access in open source software (specifically for Ubuntu)?,rhino0010,4,3,32,"I'm starting a class in database design and development,,False
1346157796.0,yyihs,PostgreSQL Table Inheritance w/o primary/foreign Key Problems,einhverfr,1,0,0,,t5_2qp8q,False
1346112704.0,yxlcw,[MySQL]How best to store and index similar phrases?,WiglyWorm,1,0,3,"Let's say I want to store an item in my database like ""visit Spain"". However, ""See Spain""

I am looking for an efficient way to do this. Currently my thinking has me going along these lines (simplified):

* Nouns
 * uniqueId
 * noun
 * verb [fk]

* Verbs
 * uniqueId
 * verb

* synonyms
 * uniqueId
 * verb [fk]
 * synonym


Am I off base

Edit: Apparently I don't know how to make tables...",self,t5_2qp8q,1346112891.0,,,True,http://www.reddit.com/r/SQL/comments/yxlcw/mysqlhow_best_to_store_and_index_similar_phrases/
1346099018.0,yx6n8,[MS SQL] SSRS User permissions (on the server) question,ImHighCurrently,2,1,2,"MYDOMAIN\TestUser is all setup in the SSRS permissions.

If I go into MS SQL Server Management Studio (2008 R2) | Security | Logins | and give MYDOMAIN\TestUser sysadmin permission

However if I remove sysadmin (even if I give him every permission other than sysadmin)

Does anyone have any idea what I'm doing wrong?

Big Huge Thank you in advance for being awesome.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/yx6n8/ms_sql_ssrs_user_permissions_on_the_server/
1345651027.0,yn5do,Intro to PostgreSQL as Object-Relational Database Management System (x-post from PostgreSQL),einhverfr,1,0,1,,t5_2qp8q,False
1345632870.0,ymrcq,"[xpost from MySQL] - new to this, need some help please!",reel_big_ad,1,0,http://www.reddit.com/r/SQL/comments/ymrcq/xpost_from_mysql_new_to_this_need_some_help_please/,default,
1345565969.0,yl41m,[MS SQL] DATEADD() Help,Devel89,2,1,5,"I have a website where we allow people to sign up for jobs on a certain date. We're using a dropdown list to display the next few upcoming dates and right now we enter all the dates by hand. The dates are just the upcoming Sundays of the month/year. We are wanting to use dateadd() to select the next few sundays for us so,self,
1345198814.0,ydcsm,"Guarantee that ""select id &amp; insert id"" is atomic without Transaction",RMiranda,2,1,8,"SS2005

    create procedure FOO
    	@Val varchar(50)
    	@ID bigint OUTPUT
    as
    begin
    	SET TRANSACTION ISOLATION LEVEL REPEATABLE READ;
    		Select @ID = MAX(ID)+1 from tbl
    		
    		INSERT INTO tbl (
    				[ID]
    			)
    		VALUES(	@ID
    				@Val			
    			)
    	SET TRANSACTION ISOLATION LEVEL READ COMMITTED;
    GO

I prefer not to use a transaction because this store will be called in a major transaction

So my question is,False,self,t5_2qp8q,False,,,t3_ydcsm
1344460365.0,xwi9i,[MS SQL] Recovery Model / Log truncation question,steezburgers,2,1,6,"We running MS SQL 2005.

Our backup software (Quest's NetVault FastRecover) protects our DBs in real-time via an agent that sits on the SQL server.  In order for it to properly handle snapshots the instructions for FastRecover specify that we:

* Set the Recovery Model for all DBs to 'Full'
* Disable auto-shrink
* Disable auto-truncation
* Take a full backup of the DB via MSSQLMS
* Set the 'truncation interval' on the agent

**According to their tech support all that will happen at this interval is the agent will issue a checkpoint on all the DBs.**

Problem is
http://technet.microsoft.com/en-us/library/ms189085(v=sql.90).aspx

So even though I'll have full transaction logs with current checkpoints

&gt; Do you have logs that are not getting truncated or something? 
We would think someone in your enviroment would have noticed by now if logs weren't getting truncated.
Normally we do realtime protection that includes the logs. 

I have been back and forth with him and he's convinced I'm wrong.  I'm not a SQL guru but the TechNet article seems pretty clear cut on the issue.   It wouldn't matter if we didn't have such insane growth in some of our DBs and such limited space on the transaction log volume

tl;dr

I'm just looking for somebody that can confirm or deny this statement for me:

&gt; A database using the Full recovery model only truncates it's transaction logs after a log backup.


",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/xwi9i/ms_sql_recovery_model_log_truncation_question/
1343768385.0,xgww1,Is it possible to port the mining models you created in SQL Server Analysis Services to SQL Server Reporting Services?,Mathlete86,1,0,1,"I am using the Contoso Retail Database and I am trying to make a dashboard with various reports. One thing my boss would like to see on this dashboard is the actual mining model that has been used (ex. The decision tree with mining legend if the Microsoft decision trees algorithm was used) so I am wondering if there is a way to port the model from SQL Server Management Studio or SQL Server Analysis Services into Reporting Services?

Any help is greatly appreciated. Thanks.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/xgww1/is_it_possible_to_port_the_mining_models_you/
1343717341.0,xfrun,[MS SQL][ORACLE] Multiple Replication 'streams',Kytro,1,0,0,"I'm attempting to do 1-way transactional replication from an Oracle 11g server to a Microsoft 2008 R2 server. 

I have this working using Microsoft's Oracle replication

My issue is there are sometimes large changes to some of the articles,,False,self,t5_2qp8q,False,,True
1343589592.0,xcp9d,[MS SQL] Random population smoothing? ,rikrokola,3,2,6,"So I can pull a random population from a dataset, let’s say I have 55% reds
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/xcp9d/ms_sql_random_population_smoothing/
1343233337.0,x4y72,"[Oracle] ""partition by"" question",Almace,1,0,1,"Basically

    select DATA_ID
           DATA_GROUP
           row_number() over ( partition by DATA_ID order by rownum ) GROUP_ID
           DATA_VALUE
      from DATA

that pulls information along the lines of

    00000001 01 1 Info1
    00000002 01 1 Info1
    00000002 01 2 Info2
    00000003 01 1 Info1
    00000004 01 1 Info1
    00000004 02 2 Info2

However

    00000001 01 1 Info1
    00000002 01 1 Info1
    00000002 01 1 Info2
    00000003 01 1 Info1
    00000004 01 1 Info1
    00000004 02 2 Info2

Any ideas if this is possible?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/x4y72/oracle_partition_by_question/
1342728639.0,wu2ci,Select count(distinct @var) from contacts  returns count of @var and not the value.,ramse,5,4,6,"I have this thing i'm trying to come up with.

It grabs the custom column names from the definition table and then should get a distinct count of all values from that column.

The main goal here is to find all custom columns in CONTACTS that do not have data. In the end i plan on removing the column

    count(distinct @field_name)

Always comes back as 1

    declare @i INT
    declare @field_name NVARCHAR(100)

    DECLARE emptyC2_cur CURSOR FOR 
    select FIELD_NAME from definition where DBFNAME = 'CONTACTS' order by FIELD_NAME desc

    OPEN emptyC2_cur
    FETCH NEXT FROM emptyC2_cur INTO @field_name
    WHILE @@FETCH_STATUS = 0
    	BEGIN
	
    	set @numRows = (select COUNT(distinct @field_name) from CONTACTS)
    	print @numRows
    
    	FETCH NEXT FROM emptyC2_cur INTO @field_name
    	END
    CLOSE emptyC2_cur
    DEALLOCATE emptyC2_cur

How can i stop count() from literally counting @field_name.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/wu2ci/select_countdistinct_var_from_contacts_returns/
1342657653.0,wsgn1,[Oracle] Need help getting around multiple rows on a one to many join between two tables. Need to get single row.,Doofio,5,4,3,"This may be somewhat of a n00bish question

Table A &lt;---1:M---&gt; Table B

In table A, each referring to a different Part (antenna, racks, router and gear).  I'm trying to design a report that will determine if each part has been installed or not (status of 'INS' from table B).  This all needs to be returned in a single row for each dispatch_id.

Example column Output:

Dispatch      Antenna Installed (y/n)     Racks Installed (y/n) etc..
123                      Y                                    N

Essentially
case when part = 'ANTENNA' and status = 'INS' then 'Y' else 'N'

The problem is that, it always returns four records (one for each part).  I can't guarantee that more parts won't be added to table B for a particular dispatch so I'm hesitant to just hard code some filters in there and I want to avoid having to create a view if possible.  Is there any other way to get the results I want into one single row?  Essentially, I want the query to cycle through the records and if it finds a scenario when it can produce a 'Y', then ONLY use that value.  

This may be somewhat confusing so let me know if any clarification is needed.
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/wsgn1/oracle_need_help_getting_around_multiple_rows_on/
1342200942.0,wibl5,[MS SQL] How can I return fewer rows with more data? (grouping? concat?),gadorp,4,3,13,"I've got a rather unwieldy query that reports specific data on users within a given time-frame.

An example of what a basic return for this query would be something like: (I've removed the massive amount of REPLACE functions used in the query to make the structure easier to view)


    User Name, code#, Status1, Status2, Status3, Status4, Status5, codedescription
    John Doe, ABC123, 1, null, null, null, null, null
    John Doe, ABC123, null, 1, null, null, null, null
    John Doe, ABC123, null, +, null, null, null, null
    John Doe, ABC123, null, null, 1, null, null, null
    John Doe, ABC123, null, null, null, 'Negative', null, null
    John Doe, ABC123, null, null, null, null, 'Negative', null
    John Doe, ABC123, null, null, null, null, null, null
    John Doe, ABC123, null, null, null, null, null, 713


Almost every piece of this is stored in separate rows

(I'm still pretty new to SQL


    select u.LastName+', c.CaseDate, c.CodeNum, st.Status1, st.Status2, st.Status3, st.Status4, st.InternalCode
    FROM [Case] c
    LEFT JOIN casegroup cg
        ON c.CaseId = cg.CaseId
    LEFT JOIN CaseTest st
        ON cg.CaseGroupId = st.CaseTestId
    LEFT JOIN Users u
        ON c.UserId = u.UserId
    WHERE c.FinalizedDate BETWEEN GETDATE()-30 AND GETDATE()
        AND c.CaseStatusId in (4
    ORDER BY 'User Name'


I'd really like for the example above to look like this:


    User Name, code#, Status1, Status2, Status3, Status4, Status5, CodeDesc
    John Doe, ABC123, 1, 1+, 1, 'Negative', 'Negative', 713


Where do I begin? (restructuring the database at all is absolute no-go)
",self,t5_2qp8q,1342201227.0,,,True,http://www.reddit.com/r/SQL/comments/wibl5/ms_sql_how_can_i_return_fewer_rows_with_more_data/
1341883768.0,waxgi,[MYSQL 5.5.24]  Syntax error when trying to create a Cursor in console,oceanofperceptions,4,3,0,"I am using the syntax:

DECLARE cur1 CURSOR FOR select * from items;

and the return is an error 1064(42000).

Select * from items works as expected.  I installed MYSQL using WAMP server.  I have tried this with multiple tables in my database and each time get the same error.  This is frustrating as I just do not see anything wrong with the syntax.  Any help greatly appreciated.  This is very frustrating as I can not find anything wrong with the syntax.  Any help is greatly appreciated.",self,t5_2qp8q,1341884319.0,,,True,http://www.reddit.com/r/SQL/comments/waxgi/mysql_5524_syntax_error_when_trying_to_create_a/
1341499754.0,w2tvv,[MySQL] Need help identifying botched code,Haash,5,4,7,"Hi guys

Just wondering if you could help me spot some SQL error code. I get the error:

 &gt;#1064 - You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ')' at line 13 

when entering this sql file into my PHPMyAdmin control panel DB under ""import"". Here's the current sql file

[Click to see uploaded file to pastebin](http://pastebin.com/g9s9iSTQ). (Had some trouble with the formatting.)

Thanks for the help :)

PS. Changed some of the code to censor out some information for privacy reasons.

Okay

&gt;#1136 - Column count doesn't match value count at row 1

at

&gt;INSERT INTO users
VALUES ( 1,  'admin',  '**********',  'Administrator',  'Today()',  'Today()',  '******',  'No' ) ;
",self,t5_2qp8q,1341529029.0,,,True,http://www.reddit.com/r/SQL/comments/w2tvv/mysql_need_help_identifying_botched_code/
1341094237.0,vuvx1,[MS SQL Server] Newbie SQL user with a puzzling SELECT query issue,Lovetones,6,5,7,"Hello!

So I am new to SQL as a trainee in BI and have begun learning it/teaching myself  since being given access to the company database recently. I have put together a SELECT query to pull out customer data for standard monthly reports. However

When I change Cust1

    Orders.groupCustomer  In  ( 'Cust1','Cust4' ) 

I have figured out a few things:

 - It only has an issue when at least one of the groupCustomers returns data
 - The issue does not present if I comment out the bold areas of my code (so that join is causing the issue somehow)
 - Adding an OR to the WHERE statement for a value that does not have this issue/return data makes the code run smoothly in 3secs (this is my workaround - commented out in code)

I have got it working but I would rather know why this is happening. I can't understand how adding an OR to WHERE would ever make anything run faster. Any ideas?

**TLDR; SELECT query runs indefinitely when I change values selected in 1 line of WHERE clause. Looks like a join is causing the issue. Issue is resolved by adding an OR to WHERE clause. Why?** 

**EDIT** Didn't realise bold doesn't appear in reddit's code script. Areas I said I would highlight in bold will have a * at the start of the line. Apologies for the long code - had to split into 2.",self,t5_2qp8q,1341094987.0,,,True,http://www.reddit.com/r/SQL/comments/vuvx1/ms_sql_server_newbie_sql_user_with_a_puzzling/
1341073915.0,vug7k,[MS SQL] I did an in-place upgrade from sql server 2005 standard to 2008 r2 standard and got an error at the end NEED HELP! 911!,terraburn,4,3,16,"Thanks everyone for taking the time out to help me with the issue. I apologize for not updating sooner.

I still have a job (yay).

I ended up just wiping SQL server off altogether and reinstalling it fresh and brand new.


For those who don't know

When you do a backup out of ADMS it saves everything you would need from the SQL instance allowing you to do a clean install of SQL and just restore the backup to ADMS and it will take care of the rest.

**TL;DR - Have a job still. Everything is back to normal.**",self,t5_2qp8q,1341615940.0,,,True,http://www.reddit.com/r/SQL/comments/vug7k/ms_sql_i_did_an_inplace_upgrade_from_sql_server/
1340905823.0,vr22b,Can I get some help with a left join?,ffxpwns,4,3,6,"I know this is super easy for you guys, the latter is the person following them. In comments, please let me know.  Thank you!"
1340565866.0,vj9l3,Help running [MS SQL] scripts on [Oracle] SQL Developer,i_have_a_gub,1,0,2,"I've just starting learning SQL using the beginner Joes2Pros book which is based on MS SQL.  I'm not allowed to run SQL Server Express on my work computer,,False
1340309925.0,vedhb,Query Analyzer that stores history?,jmelloy,1,0,3,"A few weeks ago I swear I saw a link to a Rails app that stored the history of everything that was executed with it for later analytics purposes.

I need to store &amp; pre-parse result sets for work,False,self,t5_2qp8q,False,,,t3_vedhb
1340201380.0,vbu6i,[MySQL] Help with DB structure (X-Post from r/MySQL),androiDoc,1,0,5,I have to make an ordering system for a local dairy where they will have a table of customers who will then have orders against their record. I'm struggling with the structure a little bit though. How do I make an order for a customer? Do I generate a new table with the appropriate values filled in for each order? ,t5_2qp8q,True
1340109807.0,v9uy5,[MS SQL] v2008 R2 Reporting Services Question: Can I have user-populated fields in a report?,OK_now_what,2,1,4,"I'm very much a self-taught SSRS novice - I have a report that I want to share via the Reporting Services website because it needs to be run on-demand

The problem is that it runs based off of a date range that is totally unpredictable. One day they might run it for 10/1/2012 - 12/1/2012 and the next time it might be 10/1/1980 - 05/13/1993 ....so you see what I'm saying.

Is there any way to give the user access (without full ""report builder"" capabilities) to populate a date-range criteria field in the report? Like a popup box to enter the date range or something like that?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/v9uy5/ms_sql_v2008_r2_reporting_services_question_can_i/
1339784704.0,v3sn5,[Oracle] Passing XML to a stored procedure,stread,3,2,6,"I've recently gotten involved with one of our products that supports both Oracle and MSSQL (whereas my ~5 years experience is all on the MSSQL side and no one else has Oracle experience or the drive to do so :) ) and as part of trying to transition it from mostly ad-hoc queries to XML utilizing stored procs.  MSSQL is no issue as XML has been in use for several years on the product I've been supporting but running into issues trying to mesh similar functionality over to Oracle.

The actual parsing of the document is pretty easy and similar to MSSQL and I've done so with anonymous blocks as well as a simple stored procedure for sanity testing.  However

I've scoured the web and I haven't really found information that seems straight forward or along the lines of what I'm hoping to accomplish whereas the document is passed to the DB along with SP call(i.e. CALL PARSEXMLTEST(xmldocument);) and the closest thing I've found looks to be having the application build the documents in chunks into a CLOB field in the DB then passing a sequence value to the SP so that it can grab the data from a table and begin to parse it from there.

TLDR; Is there a method to allow the passing of a large XML document directly to a stored procedure in Oracle?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/v3sn5/oracle_passing_xml_to_a_stored_procedure/
1339702714.0,v25lf,"[MS SQL] A service said ""Login Failed for domain\user"", and the user no longer had access to the DB.  We had network issues a couple hours earlier and the DBA is pointing to that causing the user to no longer have access.  Is that a load of bull or not?",AlexHimself,3,2,http://www.reddit.com/r/SQL/comments/v25lf/ms_sql_a_service_said_login_failed_for_domainuser/

How can the user just ""disappear"" or lose access?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/v25lf/ms_sql_a_service_said_login_failed_for_domainuser/
1339552378.0,uz1mw,[WINSQL] - Find where only 1 record exists with unique values,Sprooty,1,0,5,"Hi guys

Trying to work out an SQL to find some certain data

Employer Table
 - Employers have an **attribute** (a or b) if an employer is A AND B they will have two records

Trying to provide a list of employers  where no record exists for A but has a record for B.

My current thought (which does not work is)

select EMP_NAME

where COUNTER = 1 and **attribute** = B

GROUP BY EMP_NAME 
",self,t5_2qp8q,1339552575.0,,,True,http://www.reddit.com/r/SQL/comments/uz1mw/winsql_find_where_only_1_record_exists_with/
1339433327.0,uwcwx,SQL Dates question,petedawes,1,0,3,"I first submitted this to r/techsupport

I need to somehow get consecutive dates based off of todays date into a block of  SQL commands.

essentially it will look like this if the dates are hard coded in:



    update myDB.object set effective_date = '2012-06-11' where object_seq = 1;

    update myDB.object set effective_date = '2012-06-12' where object_seq = 2;

    update myDB.object set effective_date = '2012-06-13' where object_seq = 3;



and so on. these effective dates need to be scheduled to be updated every 5 weeks



    set a variable called date_variable to today's date somehow;

    update myDB.object set effective_date = date_variable where object_seq = 1;

    update myDB.object set effective_date = date_variable + 1 where object_seq = 2;

    update myDB.object set effective_date = date_variable + 2 where object_seq = 3;




I do not know how to create a variable using sql or how to get todays date

Anyone with any SQL proficiency's input would be greatly appreciated.

this is a sybase database
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/uwcwx/sql_dates_question/
1339086591.0,upywl,[MS SQL],ElMatadorBorracho,6,5,7,"This is going to sound completely nub

I have a situation where I need to remove double quotes and/or pipe characters from text field. I know how to search for them using:

LIKE '%""%' or '%|%' 

However I want to write an update that removes the characters from those results of my select statement. My goal is to  avoid manually updating the value to whatever it would be without those characters. As my results of the select statement would require me to write numerous simple updates.  

Any help would be appreciated and I hope this makes sense. ",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/upywl/ms_sql/
1338839856.0,ukqkk,[MSSQL] Trying to update a single table with the sum of three related rows,mcraamu,2,1,3,"I have to update many rows in a single table,3). Recently I found and deleted some duplicates where MetricID = 2 for five certain employees. Don't know or care how those were created

ScorecardTable

&gt;ScorecardID int

&gt;OrderID int

&gt;EmployeeID int

&gt;MetricID int

&gt;Date int

&gt;Money money


6717	501	50	1	20120401	$5.00

6418	501	50	2	20120401	$3.00

1628	501	50	3	20120401	$2.00

1221	501	50	4	20120401	$10.00 (correct result)

9079	502	30	2	20120415	$1

4611	502	30	3	20120415 	$1 (duplicate

4117	502	30	4	20120415	$2 (remaining bad result


Again:

* Money for MetricID = 4 is created by taking the SUM of the Money column for MetricID = (1

* Some duplicates for MetricID = 2 were deleted

* OrderID, Date, and Money are grouped and should be distinct. (There should not be more than one combination of OrderID = EmployeeID = MetricID = Date = Money). One MetricID = 4 is made for each combination, though, grouping (1,2,3)

How do I best update the Money column for MetricID = 4 for five different EmployeeIDs to make it correct? 

I was thinking something like this:

    UPDATE [dbo].[ScoreCardTable] SC1

    SET [Money] =

    (

    SELECT SUM([Money])

    FROM [dbo].[ScoreCardTable] SC2 (NOLOCK)

    WHERE [EmployeeID] IN (10,40,50)

    AND [MetricID] IN (1

    AND [Date] &gt;= 20120401 and [Date] &lt;= 20120601

    AND SC1.OrderID = SC2.OrderID

    AND SC1.EmployeeID = SC2.EmployeeID

    AND SC1.Date = SC2.Date

    AND SC1.Money = SC2.Money

    )

    WHERE [MetricID] = 4

    AND [Date] &gt;= 20120401 and [Date] &lt;= 201200601

    GROUP BY OrderID, Date, Money


Thanks in advance!


Edit: Is formatting on Reddit always this difficult?",self,t5_2qp8q,1338840436.0,,,True,http://www.reddit.com/r/SQL/comments/ukqkk/mssql_trying_to_update_a_single_table_with_the/
1338750535.0,uiwkb,Need to brush up on SQL; not sure where to start.,SevenSignz,1,0,4,"I recently graduated college with a computer science degree and wanted to get into the database job world. I have experience scrubbing and creating databases in MS Access

The job I'm working at now (data entry, and written into the new server client. What my boss told me was that he had about 12 Access databases that he will need amalgamated using SQL to be entered to the new system.

My classes only just touched on SQL and I never actually learned how to write in it, I don't know what would be relevant to my goals. I also looked at the Stanford class mentioned in the sidebar thread, but that looked like it was too basic for what I need to do.

Can anyone nudge me in the right direction or provide some insight as to what is actually required from the task presented to me? Thanks!",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/uiwkb/need_to_brush_up_on_sql_not_sure_where_to_start/
1337714321.0,tzp1y,Novice question about updating a table,jamarax,1,0,9,"After spending a while googling this

I want to update a table where the column is a variable instead of a known fixed value. ie. Update table set $variable where...

I cant seem to do this correctly...the exact line is this:
   $updateplayer = ""UPDATE players set $equipstat = '$playerstat' where id = '$playerid'"";

$equipstat being the name of a column in the players table.

Edit: I should explain that I'm using php hence the syntax.",self,t5_2qp8q,1337717813.0,,,True,http://www.reddit.com/r/SQL/comments/tzp1y/novice_question_about_updating_a_table/
1336054956.0,t540j,JOIN question: including info from a table that may not be linked,YoureAFuckingTowel,2,1,4,"I can't figure out how to word this properly... here's my scenario: 

I have a main table and a user table. The main table has three ID fields that correspond to the user that created the record (1)

Every record in the main table will have a value for the first user

I want to see the user's names (instead of IDs). However I've tried all sorts of JOINs and when any of the 3 user IDs are not listed in the record,False,self,t5_2qp8q,False,,,t3_t540j
1335999680.0,t43yi,Code Review (T-SQL) : Last day of the year for 5 years....,nyballa,2,1,13,"for T-SQL:

I need to generate the LAST DAYS (zero hour) of the the PAST 5 years (in rows) .
This looks about right ?

				/*------------------------
				WITH numbers AS (
						SELECT 1 AS number
						UNION ALL
						SELECT number + 1 
						FROM  numbers
						WHERE number &lt; 5)
				SELECT DATEADD(dd, -1 * number, DATEADD(yy,DATEDIFF(yy,0,getdate())+1,0))) as past_end_of_year
						FROM numbers
				OPTION (MAXRECURSION 0);  
				------------------------*/
				past_end_of_year
				-----------------------
				2011-12-31 00:00:00.000
				2010-12-31 00:00:00.000
				2009-12-31 00:00:00.000
				2008-12-31 00:00:00.000
				2007-12-31 00:00:00.000
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/t43yi/code_review_tsql_last_day_of_the_year_for_5_years/
1335861658.0,t1aic,How to get your table index or ID back to 1 on a SQL or MySql Database,wordofwisdom,6,5,3,,t5_2qp8q,False
1335366652.0,sru86,(T-SQL) Why is my LIKE condition causing my statement to return 0 records? [x-post from r/SQLServer],mortodestructo,1,0,5,"SOLVED: Solution below.

This may seem a little backwards
I have a relatively simple SQL statement that is failing to return any records due to a WHERE condition that utilizes the LIKE operator.

To condense:

    SELECT * FROM Table
    WHERE '%' + RTRIM(Table.Column) + '%' LIKE @parameter

For example
However

I've wasted so much time on this already. Any ideas what I'm missing here?

____________________________________________________________________

This finally did the trick.

SELECT * FROM Table
WHERE @parameter LIKE '%' + RTRIM(Table.Column) + '%'

I feel stupid that I wasted so much time on this. Thank you all so much (especially stealth210 on [/r/SQLServer](/r/SQLServer) and buckbova) for your help.",self,t5_2qp8q,True,,,True,http://www.reddit.com/r/SQL/comments/sru86/tsql_why_is_my_like_condition_causing_my/
1335152088.0,snmsv,[MS SQL] Need Help Developing DB,SomeAwesomeDudeGuy,1,0,5,"Hello its been over a year since I did any serious DB work and been having trouble with the following:

I'm creating a DB for a Java program I am writing. The program is for viewing grades from/grading/taking/creating assignments. There are two different types of assignments that it does, type [short answer/multiple choice], # of questions, due date) that can be linked to a table of questions and/or the grades for that assignment.

I hope that all makes sense,False,self,t5_2qp8q,False,,,t3_snmsv
1334916767.0,sjfq1,Evaluation Matrix on OLAP [crosspost from /r/oracle],n4rwoo,1,0,0,"If you had to do an evaluation matrix for a comparison between ROLAP and MOLAP what would it look like?
I am looking for criterias that can be evaluated and be used as a decision support on which model is better for certain cases.

Thanks in advance.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/sjfq1/evaluation_matrix_on_olap_crosspost_from_roracle/
1334778152.0,sgiof,How do I limit the input of a varchar to predefined categories?,Guest897894,1,0,1,"I can't find anything useful on Google or in any of the books I have.

EDIT: I am using Oracle
EDIT2: I found it,False,self,t5_2qp8q,True,,,t3_sgiof
1334586146.0,scegl,[Question: MySQL] Database performance different on same server,fluffy_mass,1,0,3,"Hello r/SQL

I have an issue with my MySQL server. I have several databases. Some of them are imported from delimited files, MYI files). An example of delimited files can be found here: ftp://ftp.ncbi.nlm.nih.gov/hapmap/ld_data/latest/ and an example of latter can be found here: (Warning heavy site, don't open on your phone) ftp://hgdownload.cse.ucsc.edu/mysql/hg19/ . These are public data.

As a result my tables are around 30-60million rows in each database. But I noticed that even simplest form of query in the database that I imported from delimited file is much much slower than the ones I just copied (i.e. from the second list). I have been struggling on it for days now

Does anybody can help me find the issue behind this?

Operating system: Linux CentOS 5.8

Slow table: http://pastebin.com/yyYsFNPX
Fast table: http://pastebin.com/x9nH1s87

My skill level: Moderate. I can find my way around in Linux environment and know a little bit of programming and familiar with some terms about databases

Thanks in advance.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/scegl/question_mysql_database_performance_different_on/
1334542132.0,sbpg9,How to create a INSTEAD OF INSERT trigger to prevent duplicate records from being inserted,djgfx,2,1,3,"So I have a ""CustomerOLD"" table which has duplicate values and records in various fields (ID, even if I select DISTINCT CustomerID from the CustomerOLD table,self
1334541314.0,sbopy,[MS SQL] Grouping rows based on timestamp,OldBailey,2,1,4,"I need to find a way of grouping rows that occur within 5 minutes of the latest timestamp in the group and the displayid and object id are the same..... 

    CREATE TABLE [dbo].[ExampleLog]( 
    [ID] [uniqueidentifier] NOT NULL
    [EVENTNUMBER] [int] NULL
    [DISPLAYSERIAL] [int] NULL
    [DISPLAYID] [varchar](50) NULL
    [OBJECTSERIAL] [int] NULL
    [OBJECTRSSILEVEL] [int] NULL
    [OBJECTID] [varchar](50) NULL
    [TIMESTAMP] [datetime] NULL) 

    INSERT INTO [dbo].[ExampleLog] 
    VALUES  
    (NewID(), 'HV 644', 6885819, 66, 'WAP 8', '2012-01-01 12:12:00'), 
    (NewID(), 'HV 644', 6885819, 66, 'WAP 8', '2012-01-01 12:13:00'), 
    (NewID(), 'HV 644', 6877807, 54, 'MV 20', '2012-01-01 12:16:00'), 
    (NewID(), 'HV 644', 6898052, 118, 'HV 62', '2012-01-01 12:20:00'), 
    (NewID(), 'HV 644', 6886130, 122, 'HV 62', '2012-01-01 12:21:00'), 
    (NewID(), 'HV 644', 6886130, 106, 'HV 62', '2012-01-01 12:25:00'), 
    (NewID(), 'HV 644', 6886130, 106, 'HV 62', '2012-01-01 12:31:00'), 
    (NewID(), 'HV 644', 6886130, 106, 'HV 62', '2012-01-01 12:33:00'), 
    (NewID(), 'HV 644', 6886130, 106, 'HV 62', '2012-01-01 12:39:00') 

so using the dataset above

Rows 1 and 2 are grouped because the objectid and displayid are the same and row 2 occurs within 5 minutes of row 1

Row 3 is grouped by itself because there are no rows in the dataset where the displayid and objectid match within a 5 minute of that groups latest timestamp (row 3).

Row 4, row 5's timestamp is within 5 minutes of row 4's, and row 6 timestamp is within 5 minutes of row 5's.

Row 7 and 8 are grouped because the objectid's and displayid's are the same and row 8's timestamp is within 5 minutes of that groups latest timestamp (row 7). 

Row 9 is grouped by itself because there are no rows in the dataset where the displayid and objectid match within a 5 minute of that groups latest timestamp

*I am using SQL Server 2008 R2
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/sbopy/ms_sql_grouping_rows_based_on_timestamp/
1334315596.0,s7rqm,[Question: Access] Mixing 2 queries,Krainz,1,0,5,"Good morning fellow redditors

I have two queries

When I use the Access Assistant

'Técnicos e Engenheiros' query:

    SELECT DISTINCTROW [Regiões do Paraná].Região
        Sum([Técnicos e Engenheiros do Paraná].Técnicos) AS [Soma De Técnicos]
        Sum([Técnicos e Engenheiros do Paraná].Engenheiros) AS [Soma De Engenheiros]
    FROM [Regiões do Paraná] INNER JOIN [Técnicos e Engenheiros do Paraná] ON [Regiões do Paraná].[Código] = [Técnicos e Engenheiros do Paraná].[Região]
    GROUP BY [Regiões do Paraná].Região;

'Empresas' query:

    SELECT DISTINCTROW [Regiões do Paraná].Região
        Sum([Empresas do Paraná (numeros)].Empresas) AS [Soma De Empresas]
    FROM [Regiões do Paraná] INNER JOIN [Empresas do Paraná (numeros)] ON [Regiões do Paraná].[Código] = [Empresas do Paraná (numeros)].[Região]
    GROUP BY [Regiões do Paraná].Região;

The bizarre one generated by access:


    SELECT DISTINCTROW [Regiões do Paraná].Região
        Sum([Técnicos e Engenheiros do Paraná].Técnicos) AS [Soma De Técnicos]
        Sum([Técnicos e Engenheiros do Paraná].Engenheiros) AS [Soma De Engenheiros]
        Sum([Empresas do Paraná (numeros)].Empresas) AS [Soma De Empresas]
    FROM ([Regiões do Paraná]
        INNER JOIN [Técnicos e Engenheiros do Paraná] ON [Regiões do Paraná].[Código] = [Técnicos e Engenheiros do Paraná].[Região])
        INNER JOIN [Empresas do Paraná (numeros)] ON [Regiões do Paraná].[Código] = [Empresas do Paraná (numeros)].[Região]
    GROUP BY [Regiões do Paraná].Região

So

Thanks in advance",self,t5_2qp8q,True,,,True,http://www.reddit.com/r/SQL/comments/s7rqm/question_access_mixing_2_queries/
1334312372.0,s7qn1,Firebird SQL V2.0.7 has been released - likely to be the last for the 2.0-series,mariuz,1,0,1,,t5_2qp8q,False
1334262353.0,s6qgw,[MS SQL] v2008 R2 Reporting Services: not sure how to multiple column values together - please help :-),OK_now_what,1,0,6,"I'm a total Reporting Services novice

Let's say I've got a column called ""QTY"" and a column called PRICE""...I want to create a third column called NET PRICE and have it be QTY*PRICE

I can't figure out how to do that


EDIT: Thank you all very much for you help! I've got it working now! ",self,t5_2qp8q,True,,,True,http://www.reddit.com/r/SQL/comments/s6qgw/ms_sql_v2008_r2_reporting_services_not_sure_how/
1334221214.0,s5x6e,"[MsSQL Help please] The XML data type cannot be compared or sorted, except when using the IS NULL operator.
",0,2,http://www.reddit.com/r/SQL/comments/s5x6e/mssql_help_please_the_xml_data_type_cannot_be/,"I know i have to do a subselect here but I cannot get this right despite hours of faffing. I have  the following columns
[SerialisedObject XML] and [DateAdded DateTime]
I need the max date for each specific xml value ""ApplicationCode"" here is what i have:


Select 
    b.ApplicationCode,b.LicenceByToken,b.LicenceByTransaction,
b.NumberOfSeats
    FROM
    (
SELECT

 [Session].SerialisedObject.query ('data(/ApplicationLicence/ApplicationCode)') AS ApplicationCode
 [Session].SerialisedObject.query ('data    (/ApplicationLicence/DaysGrace)') AS DaysGrace
 [Session].SerialisedObject.query ('data    (/ApplicationLicence/LicenceBySeat)') AS  LicenceBySeat
 [Session].SerialisedObject.query ('data(/ApplicationLicence/LicenceByTransaction)') AS     LicenceByTransaction
 [Session].SerialisedObject.query ('data(/ApplicationLicence/ LicenceByToken)') AS LicenceByToken
 [Session].SerialisedObject.query ('data    (/ApplicationLicence/NumberOfSeats)') AS NumberOfSeats
 [Session].SerialisedObject.query ('data    (/ApplicationLicence/NumberOfTransactions)') AS NumberOfTransactions 
    
FROM [Session] 
WHERE sessionguid = 'E5D38E6A-78A0-4257-AA8F-168A0334ACDF'   
AND Closed = 0
AND DateAdded = 
(
SELECT MAX(DateAdded) from [session]
WHERE CAST([Session].SerialisedObject.query('data(/ApplicationLicence/ApplicationCode)') AS NVARCHAR(MAX)) =
CAST([Session].SerialisedObject.query('data (/ApplicationLicence/ApplicationCode)') AS NVARCHAR(MAX))
)
) As b
group by b.ApplicationCode




Why does this not work please help me ;)",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/s5x6e/mssql_help_please_the_xml_data_type_cannot_be/
1333635745.0,rumuq,[Question: MS SQL] Programming in Microsoft SQL 2008 : x-post SQLServer,Demeon099,1,0,0,,t5_2qp8q,False
1333040665.0,rjh0i,PgNext PostgreSQL conference CFP is open (DENVER!),smartwaffle,1,0,0,,t5_2qp8q,False
1332958790.0,rhvyi,"[MySQL] ""Invalid Column Count in CSV file""",nichiatu,1,0,4,"So, but not any more.

The row ""Long text"" includes new lines,,False,self,t5_2qp8q,True,,True
1332864742.0,rg07l,"[MySQL] Tried inserting a CSV into a table, it has characters like ""æøå"" (norwegian characters). The characters show up like HEX codes, why is this happening?",nichiatu,2,2,False,
1331588091.0,qti6o,[MS Access] Query for difficult data layout,redditaccount1975,2,1,5,"Here is Table 1 (The # under each item corresponds the CatID in table two...Column headers correspond to Type)

    PropID      VersionID    Client    Fruit    Car    Color     Size 
    dbtester      1           Bob        1        null    null          2 
    dbtester      1           Amy       null      2      null        null 
    dbtester      1           Sam       null     null     1          null 
    dbtester      1           Tom       null       1      null         1 
    dbtester      1           Lee        null     null    null        null

Here is Table two 

     PropID      VersionID     CatID       Item     Type 
     dbtester      1             1            Apple       1 
     dbtester      1             1            Ford        2 
     dbtester      1             2            Chevy      2 
     dbtester      1             1            Blue         3 
     dbtester      1             1            Large       4 
     dbtester      1             2            Small       4
 
Trying to get the output to be:

    PropID      VersionID    Client    Fruit     Car     Color    Size 
    dbtester      1           Bob       Apple                       Small 
    dbtester      1           Amy               Chevy 
    dbtester      1           Sam                            Blue 
    dbtester      1           Tom               Ford                 Large 
    dbtester      1           Lee

PropID and VersionID are variables I input each time the query runs.

Thanks very much!!",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/qti6o/ms_access_query_for_difficult_data_layout/
1330555986.0,qc070,[Oracle] Can someone please explain how OPEN cursor_name FOR query_string works?,hindermore,1,0,4,"I have been trying to understand how this works.  I have a procedure that is passed a cursor variable as an IN variable and at the very end of the procedure (just before the END;) I see this code:

    OPEN c_dailyStaffingSheet FOR 
    SELECT * FROM TEMP_DAILY_RECORDS WHERE SESSIONID = p_sessionid;

I have been reading documentation on it,False,self,t5_2qp8q,False,,,t3_qc070
1329749600.0,pxt8g,[noob question] importing XML into SQL,,1,0,2,"Hey guys


Networking guy trying to do a little side project for work to create a small video site that can pull in information. It is safe to safe that my knowledge is extremely low when it comes to this. So please kids gloves and I promise I will try not to frustrate you.



The end goal is to display data



Anyways



&lt;?xml version=""1.0"" encoding=""utf-8""?&gt;

&lt;videos&gt;

	&lt;video&gt;

		&lt;id&gt;123&lt;/id&gt;

		&lt;thumbs&gt;
		&lt;thumb&gt;&lt;![CDATA[http://internalwebsite/example.jpg]]&gt;&lt;/thumb&gt;
		&lt;/thumbs&gt;
		&lt;link&gt;&lt;![CDATA[http://www.internal.com/123]]&gt;&lt;/link&gt;
		&lt;title&gt;&lt;![CDATA[Test Link]]&gt;&lt;/title&gt;
		&lt;categories&gt;
			&lt;category&gt;&lt;![CDATA[E]]&gt;&lt;/category&gt;
		&lt;/categories&gt;
		&lt;tags&gt;
			&lt;tag&gt;&lt;![CDATA[A]]&gt;&lt;/tag&gt;
			&lt;tag&gt;&lt;![CDATA[B]]&gt;&lt;/tag&gt;
			&lt;tag&gt;&lt;![CDATA[C]]&gt;&lt;/tag&gt;
			&lt;tag&gt;&lt;![CDATA[E]]&gt;&lt;/tag&gt;
		&lt;/tags&gt;
		&lt;duration&gt;&lt;![CDATA[25:15]]&gt;&lt;/duration&gt;
		&lt;pubDate&gt;&lt;![CDATA[2012-02-18]]&gt;&lt;/pubDate&gt;
	&lt;/video&gt;
&lt;/videos&gt;

What we are thinking is that we should import

-ID

-thumbs

-link

-title

-categories

-tags

-duration

-publication date



Once we have that into a table


Any advice on where to start looking would be greatly appreciated.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/pxt8g/noob_question_importing_xml_into_sql/
1328713452.0,pgaet,Free Microsoft SQL Server 2012 Download aka SQL Server Denali,luismiguel982,2,1,0,,t5_2qp8q,False
1328206357.0,p7z54,Need help with statement ,dude2k5,2,1,3,"So here's the deal. I created a SQL statement using MS Query to get me some data from a database to an excel sheet. But it gets only a fraction of the data because in some fields there's missing data. So basically what we need to add is an IF and THEN to the following statement which gets data from a different set of fields if the data in the first set of fields are missing. 

So basically i need to add a correct IF and THEN to the block I have marked below. 



SELECT DISTINCT CUSTOMER_ORDER.ORDER_DATE, 

-----------------------------------------------
** IF CR_CUST_CUST_ADDR.CITY is not NULL then get values from the following fields.

CR_CUST_CUST_ADDR.ADDR_1, CR_CUST_CUST_ADDR.ZIPCODE, 

else get it from

SOLD_TO.ADDR_1, SOLD_TO.ZIPCODE,

-----------------------------------------
CUST_ORDER_LINE.PART_ID, CUST_ORDER_LINE.UNIT_PRICE, CUSTOMER_ORDER.ID, CUSTOMER_ORDER.CUSTOMER_ID, CUSTOMER_ORDER.CUSTOMER_PO_REF, CUSTOMER_ORDER.DESIRED_SHIP_DATE, CUST_ORDER_LINE.TRADE_DISC_PERCENT



FROM VMFG.dbo.CR_CUST_CUST_ADDR CR_CUST_CUST_ADDR, VMFG.dbo.CUSTOMER_ORDER CUSTOMER_ORDER, VMFG.dbo.PART PART




Hope this is clear. If not let me know.
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/p7z54/need_help_with_statement/
1325785867.0,o46tj,Close Enough ,TokinAg08,3,2,2,,t5_2qp8q,False
1325092140.0,ntqsq,sql noob - have a training question,aatek,1,0,6,"Hello all,,False
1324944201.0,nrmw9,Apostrophes in a string literal on Azure SQL.,snyper7,1,0,7,"I'm trying to insert a string containing an apostrophe into a table in an Azure SQL database. I want to insert ""committee's"" and I've tried:

* 'committee''s'

* 'committee' &amp; chr(39) &amp; 's'

The first parsed correctly but produced a bunch of other (seemingly unrelated) errors in the script and the second complained about not knowing what the ""chr"" function is. Anyone encounter something similar? Thanks!",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/nrmw9/apostrophes_in_a_string_literal_on_azure_sql/
1323709502.0,n9sw2,Indexing GROUP BY,gthank,2,1,0,,t5_2qp8q,False
1321400058.0,mdoo5,MS SQL Server 2008 r2 questions. (fail-over cluster),gadorp,1,0,0,"I used to work at a place where 'all I did' was create web-tools for the intranet

I now have a job where I've taken on a hell of a lot more responsibility in a smaller company. (More rewarding, SAN, VMs, etc, almost all new hardware) I run into problems fairly frequently and haven't had a full weekend-off in about 6 months. It'll get better... I hope.

My setup is basically:

Two VMs of the MS SQL 2008 r2 variety. (each 3GHz, ~10 of which have between 300,000 and 600,000 records with 10-20 columns, almost none of which have more than a 50-character limit. It's not the largest database I've ever dealt with, but I've never dealt with MS SQL intimately before this job. (I mainly dealt with a bunch of MySQL stuff about 1/10 this size and complexity)

Two VMs running IIS 7.5 serving the ASP.NET front-end.

The SQL servers are in a failover cluster

My main issue/question is this: About every 4-6 days, etc) and I switch from A to B, (or B to A whatever the case may be) and all's well for a few more days.

Obviously

I've checked logs there isn't any single proc or view giving more grief than any other. Ive optimized the more complex stored procedures and views as much as I can. Nothing has helped in any noticeable way.

I guess what I'm asking is

Any help or advice is greatly appreciated.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/mdoo5/ms_sql_server_2008_r2_questions_failover_cluster/
1318014148.0,l4eld,need to know the size of a column in data base table,,2,1,11,"I have a database with following schema: rtl_item_tbl { NetName : text reader_list : text } Now in a row,False,
1317935444.0,l3f1l,Service Pack 3 for SQL Server 2008 released,venzann,1,0,0,,t5_2qp8q,False
1317240155.0,kufn1,How to delete entities involved in relationships when the relationships are deleted?,mussorsky,1,0,5,"I have an entity called photo and an entity called photo and an entity called album.

They are connected by the relationship photo_belongs.

If an album is deleted it cascades to photo_belongs and deletes that row from the relationship table using:

    foreign key (album_id)
        references album
        on delete cascade);

However I am looking for a way to also delete the photo when the album is deleted

If I haven't provided enough information please ask.  Any help is greatly appreciated.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/kufn1/how_to_delete_entities_involved_in_relationships/
1317215991.0,ku1sh,Comparing 5 date columns,DrTrunks,1,0,12,"First of all lets say I'm new to SQL
I have 3 columns from table 1 and 2 columns from table2 and i need to make 2 comparisons. I want to make sure the data is the same (in the example it is).


table|Start time|End time|(date)|appointment_id
|:------------:|:------------:|:------------:|:------------:|:------------:|
table 1|08:00:00|09:00:00|31-10-2011|5476
table 2|31-10-11 8:00|31-10-11 9:00|null|5476


As you can see the data is formatted differently but they are all data fields and I'd rather keep them this way (not building a string).
I've tried adding the data together in table 1 but it messes up the output or I'm doing it wrong: select column1 + column3

I would like to see if it matches in an extra column,False,self,t5_2qp8q,True,,,t3_ku1sh
1317058252.0,ks05d,Materialized views with keys?,devilized,2,1,0,"So let's say I have a table with a bunch of alerts coming from various servers. Each alert has its own entry, my query will return the most recent message along with a count result of 15.

That join takes a couple of seconds to run on about 300k rows. The number of rows I get from this query is roughly 15k (which means a lot of duplicate alerts). To cut down on resources used by people querying this information

However, that won't change during subsequent updates, so I can reference it within other tables?

Please let me know if you need further details or clarification

Thanks!",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/ks05d/materialized_views_with_keys/
1316547244.0,klw8q,SSIS Package Configuration User Variable Assistance,MyVeryOwnTempAcct,1,0,1,"I'm trying to see if it is possible to set a path to a config file based on a User Variable.  Currently

i'd like to be able to extend this so other config files can be used,,False,self,t5_2qp8q,False,,True
1316301641.0,kj21n,what does '%[%]%' the square brackets mean please help :(,princeofsin,1,0,0,"Hello reddit

I got a book on beginning SQL joes 2 pros and the issue is what are the square brackets in this problem for. I will write down the part from the chapter and if someone can please explain it to me i will really appreciate it

We have a grant called ""K_Land fund trust"" with an actiual underscore in the name. We have other grants with underscores as well. How do you search for an underscore sign with a wildcard on each side? The ineffective query below gets all records that are at least one character long:

*Bad query*
[9/16/2011 12:08:09 PM] Attorney K: select *
[9/16/2011 12:11:03 PM] Attorney K: from [grant]
where grantname like '%_%'

we have 3 special characters and no literal percent sign. Again

Select *
From [Grant]
where grantname like '%[_]%'

Thank you reddit :)
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/kj21n/what_does_the_square_brackets_mean_please_help/
1315015407.0,k34mh,Need help with SQL key violation,AwfulWaffle,2,1,3,"Hi

The table is created with the following definition

* create table tblgames(GameID VARCHAR(255) Primary key, Team1 Array, Team2 Array, Team3 Array, Team4 Array, GameOver Boolean default false, Winner VARCHAR(255) references tblPlayers(PlayerID));

Here is the statement that Im using. It works the first time with one gameid but then fails the second time when I try and create a second record.

* insert into tblgames (GameID, Team2, Team3, Team4, GameOver) values (?, 1, (0,0,0,0


And here is the error that Im receiving:

* org.h2.jdbc.JdbcSQLException: Unique index or primary key violation: ""CONSTRAINT_INDEX_3EF ON PUBLIC.TBLGAMES(GAMEOVER)""; SQL statement:
insert into tblgames (GameID, Team2, Team3, Team4, GameOver) values (?, 1, (0,0,0,0

Can anyone help me see the error that is causing me to only be able to create 1 record successfully?",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/k34mh/need_help_with_sql_key_violation/
1313619972.0,jm34w,SQL stupid question: finding text with any case ,CreamyKnougat,2,1,0,"How can I query a field to return content regardless of case? What I mean is, 'no'

In the query:
    
    select free_lunch
    from student
    where free_lunch = 'YES'


only the 'YES' content will show up. How do I query so that all cases show up?

This is in Oracle 11g
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/jm34w/sql_stupid_question_finding_text_with_any_case/
1311889427.0,j2lcu,A little help please.   ,EyeBoz,1,0,0,"I work at an Eye Bank and Cornea Research Center.

After unplugging all of the electronics in the lab to move them due to a water leak

It reads...

Winstation Error
Failed to open Winstation database.
Reason&gt;&gt; SQL Server does not exist or access denied.
ConnectionOpen (Connect()).

Please Contact OIS tech. support!




I don't know if it's the exclamation mark or frugality

Thank you in advance.   :)",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/j2lcu/a_little_help_please/
1311306812.0,iwi1k,I managed to land a technical interview for a job I'd love to have.  Can you think of what SQL questions you'd want to ask an applicant?,joehouse,1,0,0,"So following are some of the requirements.  I'll just focus on the SQL related ones.

* Development and maintenance of custom SQL reports
templates
content and configuration.
* User training and user support
to vendor. Participate in user group and maintain currency with upcoming
software developments.
* Administration of setup tables for practice management
users
interfaces and peripheral devices.
* Provides support for specialized software/data installation
configuration and planning. Investigates and analyzes various specialized
computing options and solutions.
* Stays informed of new developments and technologies by reading
journals and other pertinent publications
vendors
seminars.
* Researches
Analyzes data for trends or conclusions and presents results and
recommendations to supervisor.
* Provides expert consulting services in specialized areas such as
specialized software
access/analysis

So what questions would you have for someone with a SQL background with such a vague job description?

Everything being said I feel pretty confident about the technical interview.  I just don't want to screw up on something I may not have thought about or just plain CHOKE.
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/iwi1k/i_managed_to_land_a_technical_interview_for_a_job/
1311203214.0,iva91,Ideas for joining the contents of a reporting services field in the table footer?,ITAndrew,2,1,2,"Does anyone have any ideas on how this could be done? 

If the query behind my report is:

    SELECT '1' AS NUMBER    UNION
    SELECT '2'
    UNION
    SELECT '3'

A textbox in the details section of the report would have Fields!NUMBER.Value

The query behind this is much more complex than I've described above

I'd really appreciate any ideas.",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/iva91/ideas_for_joining_the_contents_of_a_reporting/
1311184159.0,iv0ho,Need help with a cloned VM Server 2008 w/MSSQL 2008,ignathius,1,0,4,"We wanted to setup a test environment for someone so they could hammer on a DB without affecting the production DB. We found some instructions on cloning a Hyper-V VM

Also

TIA",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/iv0ho/need_help_with_a_cloned_vm_server_2008_wmssql_2008/
1310937939.0,is99l,SQL Beginner's Guide?,,1,0,0,"Hello!

I'm surprised this subreddit has so few subscribers! Anywho. I'm in a database management class

Thanks",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/is99l/sql_beginners_guide/
1309885159.0,ihasu,"I need to learn SQL to get a permanent job at my college, whats the best book to help get me started?",magnumuser,1,0,http://www.reddit.com/r/SQL/comments/ihasu/i_need_to_learn_sql_to_get_a_permanent_job_at_my/,self,
1309333374.0,ic45y,InfoPath help,,1,0,2,"My supervisor instructed me to create a search for a username and the information for that user

Can anyone give me a few tips/hints as to how to create multiple fields/views for when creating a search field for a specified username?

Thanks in advance :)",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/ic45y/infopath_help/
1308748116.0,i65t9,SQL query with two tables question.,aaneton,2,1,4,"I have to tables in a oracle database


Here are the tables and columns (only listing the once concerning this problem)

Feature:
---------
fnumber
name

Example:
    fnumber     name
    10            potato
    20            carrot
    30            apple


Feature_link:
--------------
f_feature_number
to_feature number

Example:
    f_feature_number     to_feature_number
    10                   20
    10                   30
    20                   10

So I gotten this far:


SELECT feature_link.F_FEATURE_NUMBER
FROM feature
WHERE (feature_link.F_FEATURE_NUMBER = feature.FNUMBER)


Gives the output
    f_feature_number name    to_feature_number
    10               potato  20
    10               potato  30
    20               carrot  10 


I want to find the name matching also the to_feature_number field

End result should look like this:
    f_feature_number name    to_feature_number  to_name
    10               potato  20                 carrot                 
    10               potato  30                 apple
    20               carrot  10                 potato

Any advice? all my subquery attempts have failed.
",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/i65t9/sql_query_with_two_tables_question/
1308589205.0,i4gez,Query database to find partial match?,Philip1209,1,0,2,"I need to set up an alias database to go from a name to a unique id and I am trying to figure out a way to structure the table so that it is scalable (e.g. don't have to keep adding columns). I'm thinking of an auto-incremented column with the ID then a  blob field with aliases. In my search function I need a way to identify a match of a substring. Do you have any advice on how to do this? I'm having trouble writing a query that would work. 

The table isn't terribly large,,False,self,t5_2qp8q,False,,True
1307703022.0,hwabg,Importing .SQL file to mysql 5.5 community server (X-post from /r/database),hungoverbunny,2,1,2,complete noob here just wondering how you would import a database file into a MySQL database....i have an empty database created and I have a previous database file copied over...i just want to know how to go about doing this if someone could post a guide or point me to one... I've tried this command but doesnt seem to work for me/not sure if its the one i need mysqldump -u USER -pPASSWORD DATABASE &gt; filename.sql,t5_2qp8q,True
1307552839.0,hur7g,"Trigger - after import or after commit, NOT on each row.  Oracle 10g",MisterFlibble,2,1,http://www.reddit.com/r/SQL/comments/hur7g/trigger_after_import_or_after_commit_not_on_each/

Recently

Does anyone know of a way I can build this trigger to have the procedure only run when I import these Excel sheets into the database using TOAD?

example:

    CREATE OR REPLACE TRIGGER clean_up_items
    AFTER /*(COMMIT or IMPORT)*/
    ON items_table 
    DISABLE
    begin
    schema.pkg_clean_items.p_run_all;
    END;
    /",self,t5_2qp8q,False,,,True,http://www.reddit.com/r/SQL/comments/hur7g/trigger_after_import_or_after_commit_not_on_each/
1306625232.0,hmibu,First time with a query this complex - any help appreciated,lukes386,1,0,0,"I don't have a lot of experience with SQL beyond your basic SELECT and INSERT queries

There are five tables involved: Jobs, Fields, and Expertises.

Jobs have foreign keys ""customer_id"" (points to user)

Users contains all of the application's users

Occupations have foreign keys ""user_id""

Expertises have an integer ""rank"" field. 

What I'm trying to do is return all of the jobs an employee (user) is qualified for. This means all jobs that have been assigned to them already (job.employee_id = current_user.id), the employee must have a higher ranked expertise in that field. 

Like I said, so if any of you could give me some pointers I'd be very appreciative. 

**EDIT**: I'm not sure if it matters,False,self,t5_2qp8q,True,,,t3_hmibu
